!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("three"),require("mobx"),require("bowser")):"function"==typeof define&&define.amd?define(["three","mobx","bowser"],t):"object"==typeof exports?exports.voidgl=t(require("three"),require("mobx"),require("bowser")):e.voidgl=t(e.three,e.mobx,e.bowser)}(this,function(e,t,n){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=35)}([function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR"}(t.InstanceBlockIndex||(t.InstanceBlockIndex={}));!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR",e[e.ATLAS=99]="ATLAS"}(t.InstanceAttributeSize||(t.InstanceAttributeSize={}));!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR",e[e.MATRIX3=9]="MATRIX3",e[e.MATRIX4=16]="MATRIX4",e[e.ATLAS=99]="ATLAS"}(t.UniformSize||(t.UniformSize={}));!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR"}(t.VertexAttributeSize||(t.VertexAttributeSize={}));!function(e){e[e.VERTEX=0]="VERTEX",e[e.FRAGMENT=1]="FRAGMENT",e[e.ALL=2]="ALL"}(t.ShaderInjectionTarget||(t.ShaderInjectionTarget={}))},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=function(){function e(e){this.x=0,this.y=0,this.width=0,this.height=0,this.x=e.x||e.left||0,this.y=e.y||e.top||0,this.height=e.height||e.bottom-this.y||0,this.width=e.width||e.right-this.x||0}return Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mid",{get:function(){return{x:this.x+this.width/2,y:this.y+this.height/2}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),e.emptyBounds=function(){return new e({height:0,width:0,x:0,y:0})},e.prototype.containsPoint=function(e){return!(e.x<this.x||e.y<this.y||e.x>this.right||e.y>this.bottom)},e.prototype.encapsulate=function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.right<e.right&&(this.width+=e.right-this.right),this.bottom<e.bottom&&(this.height+=e.bottom-this.bottom),!0},e.prototype.fits=function(e){return this.width===e.width&&this.height===e.height?1:this.width>=e.width&&this.height>=e.height?2:0},e.prototype.hitBounds=function(e){return!(this.right<e.x||this.x>e.right||this.bottom<e.y||this.y>e.height)},e.prototype.isInside=function(e){return this.x>=e.x&&this.right<=e.right&&this.y>=e.y&&this.bottom<=e.bottom},e.prototype.toString=function(){return"{x: "+this.x+" y:"+this.y+" w:"+this.width+" h:"+this.height+"}"},r([o.observable],e.prototype,"x",void 0),r([o.observable],e.prototype,"y",void 0),r([o.observable],e.prototype,"width",void 0),r([o.observable],e.prototype,"height",void 0),r([o.computed],e.prototype,"area",null),r([o.computed],e.prototype,"bottom",null),r([o.computed],e.prototype,"left",null),r([o.computed],e.prototype,"mid",null),r([o.computed],e.prototype,"right",null),r([o.computed],e.prototype,"top",null),e}();t.Bounds=i},function(e,n){e.exports=t},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(28)),r(n(55)),r(n(30)),r(n(31)),r(n(56)),r(n(57)),r(n(58)),r(n(32))},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=function(){function e(e){this._id=e.id,this.active=e.active}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),r([o.observable],e.prototype,"active",void 0),e}();t.Instance=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.key=e.key}return Object.defineProperty(e.prototype,"id",{get:function(){return this.key},enumerable:!0,configurable:!0}),e}();t.IdentifyByKey=r},function(e,t,n){"use strict";function r(e,t,n){for(var r=t-1,o=0,i=n.length;o<i;++o)e[c[++r]]=n[o]}var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=n(33),s=n(6),c=["x","y","z","w"],u=function(e){function t(n){var r=e.call(this,n)||this;return r.depth=0,r.instanceById=new Map,r.instanceVertexCount=0,r.addInstance=function(e,t){if(t)r.changeInstance(e,t);else{var n=r.uniformManager.add(e);e.active=!0,r.updateInstance(e,n)}},r.changeInstance=function(e,t){t?r.updateInstance(e,t):r.addInstance(e,t)},r.removeInstance=function(e,t){t&&(e.active=!1,r.updateInstance(e,t),r.uniformManager.remove(e))},r.diffProcessor=(o={},o[a.DiffType.CHANGE]=r.changeInstance,o[a.DiffType.INSERT]=r.addInstance,o[a.DiffType.REMOVE]=r.removeInstance,o),r.props=Object.assign({},t.defaultProps||{},n),r;var o}return o(t,e),t.prototype.updateInstance=function(e,t){if(e.active){for(var n=t.uniform,o=t.uniformRange[0],i=n.value,a=void 0,s=void 0,c=void 0,u=0,l=this.instanceAttributes.length;u<l;++u)a=this.instanceAttributes[u],s=a.update(e),c=i[o+a.block],a.atlas&&this.resource.setTargetAtlas(a.atlas.key),r(c,a.blockIndex,s);n.value=i}},t.prototype.destroy=function(){},t.prototype.didUpdateProps=function(){},t.prototype.draw=function(){for(var e,t,n,r,o,i,a=this.props.data.changeList,s=0,c=a.length;s<c;++s)n=a[s],r=n[0],o=n[1],i=this.uniformManager.getUniforms(r),this.diffProcessor[o](r,i);this.props.data.resolve();for(var s=0,c=this.uniforms.length-1;s<c;++s)e=this.uniforms[s],t=e.update(e),e.materialUniforms.forEach(function(e){return e.value=t})},t.prototype.getModelType=function(){return{drawMode:i.TrianglesDrawMode,modelType:i.Mesh}},t.prototype.getMaterialOptions=function(){return{}},t.prototype.initShader=function(){return{fs:n(60),instanceAttributes:[],uniforms:[],vertexAttributes:[],vertexCount:0,vs:n(61)}},t.prototype.willUpdateInstances=function(e){},t.prototype.willUpdateProps=function(e){},t.prototype.didUpdate=function(){this.props.data.resolve()},t.defaultProps={},t}(s.IdentifyByKey);t.Layer=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.handleMouseDown=function(e,t){},e.prototype.handleMouseUp=function(e){},e.prototype.handleMouseOver=function(e){},e.prototype.handleMouseOut=function(e){},e.prototype.handleMouseMove=function(e){},e.prototype.handleClick=function(e,t){},e.prototype.handleDrag=function(e,t){},e.prototype.handleWheel=function(e,t){},e}();t.EventManager=r},function(e,t,n){"use strict";function r(e,t){e&&t&&e.splice.apply(e,[0,t.length].concat(t))}Object.defineProperty(t,"__esModule",{value:!0});var o=0,i=function(){function e(e){this._id=o++,this.offset=[0,0,0],this.scale=[1,1,1],e&&(r(this.offset,e.offset),r(this.scale,e.scale))}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),e.prototype.position=function(e){this.offset=e.slice(0)},e}();t.ChartCamera=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.CONTROLLED=0]="CONTROLLED",e[e.CUSTOM=1]="CUSTOM"}(r=t.ViewCameraType||(t.ViewCameraType={}));var o=function(){function e(){this.type=r.CONTROLLED}return e}();t.ViewCamera=o},function(e,t,n){"use strict";function r(e,t){return e.depth-t.depth}var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=n(6),s=function(e){function t(t){var n=e.call(this,t)||this;return n.container=new i.Scene,n.layers=[],n.sortIsDirty=!1,n.viewById=new Map,n.container.frustumCulled=!1,n.container.autoUpdate=!1,n}return o(t,e),t.prototype.addLayer=function(e){this.layers.push(e),this.sortIsDirty=!0},t.prototype.addView=function(e){this.viewById.set(e.id,e)},t.prototype.removeLayer=function(e){if(this.layers){var t=this.layers.indexOf(e);if(t>=0)return void this.layers.splice(t,1)}console.warn("Could not remove a layer from the scene as the layer was not a part of the scene to start. Scene:",this.id,"Layer:",e.id)},t.prototype.sortLayers=function(){this.sortIsDirty&&this.layers.sort(r)},t.DEFAULT_SCENE_ID="__default__",t}(a.IdentifyByKey);t.Scene=s},function(e,t,n){"use strict";function r(e){return"left"in e}var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(37),a=n(2),s=n(6),c=n(10);!function(e){e[e.COLOR=1]="COLOR",e[e.DEPTH=2]="DEPTH",e[e.STENCIL=4]="STENCIL"}(t.ClearFlags||(t.ClearFlags={}));var u=function(e){function t(t){var n=e.call(this,t)||this;return n.depth=0,n.pixelRatio=window.devicePixelRatio,Object.assign(n,t),n}return o(t,e),t.prototype.screenToPixelSpace=function(e,t){var n=t||{x:0,y:0};return n.x=e.x*this.pixelRatio,n.y=e.y*this.pixelRatio,n},t.prototype.pixelSpaceToScreen=function(e,t){var n=t||{x:0,y:0};return n.x=e.x/this.pixelRatio,n.y=e.y/this.pixelRatio,n},t.prototype.screenToView=function(e,t){var n=this.screenToPixelSpace(e,t);return n.x=n.x-this.viewBounds.x,n.y=n.y-this.viewBounds.y,n},t.prototype.viewToScreen=function(e,t){var n={x:0,y:0};return n.x=e.x+this.viewBounds.x,n.y=e.y+this.viewBounds.y,this.pixelSpaceToScreen(n,t)},t.prototype.screenToWorld=function(e,t){var n=this.screenToView(e),r=t||{x:0,y:0};return r.x=(n.x-this.camera.offset[0]*this.camera.scale[0])/this.camera.scale[0],r.y=(n.y-this.camera.offset[1]*this.camera.scale[1])/this.camera.scale[1],this.viewCamera.type===c.ViewCameraType.CUSTOM&&console.warn("Custom View Camera projections not supported yet"),r},t.prototype.worldToScreen=function(e,t){var n={x:0,y:0};return n.x=e.x*this.camera.scale[0]+this.camera.offset[0]*this.camera.scale[0],n.y=e.y*this.camera.scale[1]+this.camera.offset[1]*this.camera.scale[1],this.viewCamera.type===c.ViewCameraType.CUSTOM&&console.warn("Custom View Camera projections not supported yet"),this.viewToScreen(n,t)},t.prototype.viewToWorld=function(e,t){var n=t||{x:0,y:0};return n.x=(e.x-this.camera.offset[0]*this.camera.scale[0])/this.camera.scale[0],n.y=(e.y-this.camera.offset[1]*this.camera.scale[1])/this.camera.scale[1],this.viewCamera.type===c.ViewCameraType.CUSTOM&&console.warn("Custom View Camera projections not supported yet"),n},t.prototype.worldToView=function(e,t){var n=t||{x:0,y:0};return n.x=e.x*this.camera.scale[0]+this.camera.offset[0]*this.camera.scale[0],n.y=e.y*this.camera.scale[1]+this.camera.offset[1]*this.camera.scale[1],this.viewCamera.type===c.ViewCameraType.CUSTOM&&console.warn("Custom View Camera projections not supported yet"),n},t.prototype.fitViewtoViewport=function(e){if(this.viewCamera.type===c.ViewCameraType.CONTROLLED&&r(this.viewCamera.baseCamera)){var t=i.getAbsolutePositionBounds(this.viewport,e),n=t.width,o=t.height,s={bottom:-o/2,far:1e7,left:-n/2,near:-100,right:n/2,top:o/2},u=this.viewCamera.baseCamera;Object.assign(u,s),u.position.set(-t.width/2*1,t.height/2*1,u.position.z),u.scale.set(1,-1,1),u.updateMatrix(),u.updateMatrixWorld(!0),u.updateProjectionMatrix(),this.viewBounds=t,this.viewBounds.data=this,this.screenBounds=new a.Bounds({height:this.viewBounds.height/this.pixelRatio,width:this.viewBounds.width/this.pixelRatio,x:this.viewBounds.x/this.pixelRatio,y:this.viewBounds.y/this.pixelRatio})}else r(this.viewCamera.baseCamera)||console.warn("Fit to viewport does not support non-orthographic cameras as a default behavior.")},t.DEFAULT_VIEW_ID="__default__",t}(s.IdentifyByKey);t.View=u},function(e,t,n){"use strict";function r(e){return Boolean(e.isMesh)}function o(e,t,n){var o=e.getModelType(),i=new o.modelType(t,n);return r(i)&&(i.drawMode=o.drawMode),i}Object.defineProperty(t,"__esModule",{value:!0}),t.generateLayerModel=o},function(e,t,n){"use strict";function r(e,t,n){var r=new Map,o=new Map,i=new Map,a=new Map,s=e.replace(/\$\{(\w+)\}/g,function(e,n){return a.set(n,(a.get(n)||0)+1),n in t?(r.set(n,(r.get(n)||0)+1),t[n]):(o.set(n,(o.get(n)||0)+1),"")});Object.keys(t).forEach(function(e){r.get(e)||i.set(e,(i.get(e)||0)+1)});var c={resolvedShaderOptions:r,shader:s,shaderProvidedOptions:a,unresolvedProvidedOptions:i,unresolvedShaderOptions:o};return n&&n.values.forEach(function(e){c.unresolvedProvidedOptions.get(e)?console.error(n.name+": Could not resolve all the required inputs. Input:",e):c.unresolvedShaderOptions.get(e)?console.error(n.name+": A required option was not provided in the options parameter. Option:",e):c.resolvedShaderOptions.get(e)||console.error(n.name+": A required option was not provided in the options parameter. Option:",e)}),c}Object.defineProperty(t,"__esModule",{value:!0}),t.shaderTemplate=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.sampleScale=1}return e}();t.BaseAtlasResource=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.BottomLeft=0]="BottomLeft",e[e.BottomMiddle=1]="BottomMiddle",e[e.BottomRight=2]="BottomRight",e[e.Custom=3]="Custom",e[e.Middle=4]="Middle",e[e.MiddleLeft=5]="MiddleLeft",e[e.MiddleRight=6]="MiddleRight",e[e.TopLeft=7]="TopLeft",e[e.TopMiddle=8]="TopMiddle",e[e.TopRight=9]="TopRight"}(t.AnchorType||(t.AnchorType={}));!function(e){e[e.ALWAYS=1]="ALWAYS",e[e.BOUND_MAX=2]="BOUND_MAX",e[e.NEVER=3]="NEVER"}(t.ScaleType||(t.ScaleType={}))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(36)),r(n(34)),r(n(63)),r(n(84)),r(n(1)),r(n(87))},function(e,t,n){"use strict";function r(e){var t=e.canvas.height,n=e.canvas.width,r=n/t,u={aspectRatio:r,bottom:-t/2,far:1e7,left:-n/2,near:-100,right:n/2,top:t/2,viewSize:t},l=new a.ViewCamera;l.baseCamera=new o.OrthographicCamera(u.left,u.right,u.top,u.bottom,u.near,u.far),l.baseCamera.scale.set(1,-1,1),l.baseCamera.position.set(0,0,-300),l.baseCamera.updateMatrixWorld(!0),l.baseCamera.updateMatrix(),l.baseCamera instanceof o.OrthographicCamera&&l.baseCamera.updateProjectionMatrix();var h=new i.ChartCamera,d={bottom:0,left:0,right:0,top:0},f=new c.View({camera:h,key:c.View.DEFAULT_VIEW_ID,viewCamera:l,viewport:d}),p=new s.Scene({key:s.Scene.DEFAULT_SCENE_ID,views:[]});return p.addView(f),{camera:h,scene:p,view:f,viewCamera:l,viewport:d}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(9),a=n(10),s=n(11),c=n(12);t.generateDefaultScene=r},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.emptyBounds=function(){return new t({height:0,width:0,x:0,y:0})},t}(o.Bounds);t.DataBounds=i},function(e,t,n){"use strict";function r(e){return!Array.isArray(e[0])}function o(e,t,n){for(var o=[],a=0,s=t.length;a<s;++a){var c=t[a];o.push(new Float32Array(c.size*n*e))}for(var u,l,h,d,f=t.length,a=0,s=n;a<s;++a)for(var p=0;p<f;++p)if(l=t[p],u=o[p],h=l.update(a),r(h))for(var y=a*l.size,v=y+l.size,m=0;y<v;++y,++m)u[y]=h[m];else d=!0;d&&console.warn("A vertex buffer updating method should not use arrays of arrays of numbers.");for(var a=0,s=t.length;a<s;++a)for(var g=t[a],b=g.size*n,p=1,w=e;p<w;++p)o[a].copyWithin(b*p,0,b);for(var x=o[0],a=0,s=e;a<s;++a)for(var _=a*n,p=0;p<n;++p)x[p+_]=a;for(var O=new i.BufferGeometry,a=0,s=t.length;a<s;++a){var C=t[a],T=new i.BufferAttribute(o[a],C.size);C.materialAttribute=T,O.addAttribute(C.name,T)}return O}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);t.generateLayerGeometry=o},function(e,t,n){"use strict";function r(e){return{type:s[e.size],value:c[e.size]}}function o(e,t,n,o,a){var s=e.getMaterialOptions();s.vertexShader=t,s.fragmentShader=n,s.uniforms={};for(var c=0,u=o.length;c<u;++c){var l=o[c],h=r(l);s.uniforms[l.name]=h}for(var c=0,u=a.length;c<u;++c){var d=a[c];s.uniforms[d.name]={type:d.type,value:d.value}}return new i.RawShaderMaterial(s)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=n(1),s=(u={},u[a.UniformSize.ONE]="f",u[a.UniformSize.TWO]="v2",u[a.UniformSize.THREE]="v3",u[a.UniformSize.FOUR]="v4",u[a.UniformSize.MATRIX3]="Matrix3fv",u[a.UniformSize.MATRIX4]="Matrix4fv",u),c=(l={},l[a.UniformSize.ONE]=[0],l[a.UniformSize.TWO]=[0,0],l[a.UniformSize.THREE]=[0,0,0],l[a.UniformSize.FOUR]=[0,0,0,0],l[a.UniformSize.MATRIX3]=[0,0,0,0,0,0,0,0,0],l[a.UniformSize.MATRIX4]=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l);t.generateLayerMaterial=o;var u,l},function(e,t,n){"use strict";function r(e){return Object.assign({},e,{materialAttribute:null})}function o(e){return Object.assign({},e,{materialUniforms:[]})}function i(e){var t=new Map,n=null,r=0;return e.forEach(function(e){var n=e.block,o=e.blockIndex,i=e.size,a=t.get(n);r=Math.max(n,r),a||(a=new Map,t.set(n,a));for(var s=o,c=o+i;s<c;++s)a.set(s,!0)}),t.forEach(function(e,t){e.get(1)||(n=[t,c.InstanceBlockIndex.ONE]),e.get(2)||(n=[t,c.InstanceBlockIndex.TWO]),e.get(3)||(n=[t,c.InstanceBlockIndex.THREE]),e.get(4)||(n=[t,c.InstanceBlockIndex.FOUR])}),n||(n=[r+1,0]),n}function a(e,t){return e.atlas&&!t.atlas?-1:1}function s(e,t){var n=[],s=new Map;t.instanceAttributes.forEach(function(e){if(e.atlas){e.size=c.InstanceAttributeSize.FOUR,e.blockIndex=c.InstanceBlockIndex.ONE;var t=e.atlas.shaderInjection||c.ShaderInjectionTarget.FRAGMENT,r=s.get(e.atlas.name);r?s.set(e.atlas.name,[r[0]||t===c.ShaderInjectionTarget.VERTEX||t===c.ShaderInjectionTarget.ALL,r[1]||t===c.ShaderInjectionTarget.FRAGMENT||t===c.ShaderInjectionTarget.ALL]):(n.push(e),s.set(e.atlas.name,[t===c.ShaderInjectionTarget.VERTEX||t===c.ShaderInjectionTarget.ALL,t===c.ShaderInjectionTarget.FRAGMENT||t===c.ShaderInjectionTarget.ALL]))}});var u=n.map(function(t){var n=s.get(t.atlas.name),r=n[0]&&n[1]&&c.ShaderInjectionTarget.ALL||n[0]&&!n[1]&&c.ShaderInjectionTarget.VERTEX||!n[0]&&n[1]&&c.ShaderInjectionTarget.FRAGMENT;return{name:t.atlas.name,shaderInjection:r,size:c.UniformSize.ATLAS,update:function(){return e.resource.getAtlasTexture(t.atlas.key)}}}),l=u.concat([{name:"projection",size:c.UniformSize.MATRIX4,update:function(){return e.view.viewCamera.baseCamera.projectionMatrix.elements}},{name:"modelView",size:c.UniformSize.MATRIX4,update:function(){return e.view.viewCamera.baseCamera.matrix.elements}},{name:"cameraOffset",size:c.UniformSize.THREE,update:function(){return e.view.camera.offset}},{name:"cameraScale",size:c.UniformSize.THREE,update:function(){return e.view.camera.scale}},{name:"viewSize",size:c.UniformSize.TWO,update:function(){return[e.view.viewBounds.width,e.view.viewBounds.height]}},{name:"pixelRatio",size:c.UniformSize.ONE,update:function(){return[e.view.pixelRatio]}}]),h=i(t.instanceAttributes),d=[{block:h[0],blockIndex:h[1],name:"_active",size:c.InstanceAttributeSize.ONE,update:function(e){return[e.active?1:0]}}],f=[{name:"instance",size:c.VertexAttributeSize.ONE,update:function(){return[0]}}],p=f.concat(t.vertexAttributes).map(r),y=l.concat(t.uniforms).map(o);return{instanceAttributes:d.concat(t.instanceAttributes).sort(a),uniforms:y,vertexAttributes:p}}Object.defineProperty(t,"__esModule",{value:!0});var c=n(1);t.injectShaderIO=s},function(e,t,n){"use strict";function r(e,t){for(var n={attributeCount:0,attributes:new Array,uniformCount:0,uniforms:new Array},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),o=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i={35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT"},a={35664:1,35665:1,35666:1,35667:1,35668:1,35669:1,35670:1,35671:1,35672:1,35673:1,35674:1,35675:3,35676:4,35678:1,35680:1,5120:1,5121:1,5122:1,5123:1,5124:1,5125:1,5126:1},s=0;s<r;++s){var c=e.getActiveUniform(t,s);c.typeName=i[c.type],n.uniforms.push(c),n.uniformCount+=c.size,c.size=c.size*a[c.type]}for(var s=0;s<o;s++){var u=e.getActiveAttrib(t,s);u.typeName=i[u.type],n.attributes.push(u),n.attributeCount+=u.size}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.getProgramInfo=r;var o=function(){function e(){}return e.MAX_VERTEX_UNIFORMS=0,e.MAX_FRAGMENT_UNIFORMS=0,e.MAX_ATTRIBUTES=0,e.WEBGL_SUPPORTED=!1,e.MAX_TEXTURE_SIZE=0,e}();t.WebGLStat=o,function(){var e=function(){try{var e=document.createElement("canvas");return window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(e){return!1}}();e&&(o.WEBGL_SUPPORTED=!0,o.MAX_VERTEX_UNIFORMS=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),o.MAX_FRAGMENT_UNIFORMS=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),o.MAX_ATTRIBUTES=e.getParameter(e.MAX_VERTEX_ATTRIBS),o.MAX_TEXTURE_SIZE=e.getParameter(e.MAX_TEXTURE_SIZE))}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.templateVars={attributeFragments:"attributeFragments",attributes:"attributes",blocksPerInstance:"blocksPerInstance",instanceBlockCount:"instanceBlockCount",instanceDataBinaryTree:"instanceDataBinaryTree",instanceDataRetrieval:"instanceDataRetrieval",instanceDestructuring:"instanceDestructuring",instanceFragments:"instanceFragments",instanceUniformDeclarations:"instanceUniformDeclarations",layerUniforms:"layerUniforms",projectionMethods:"projectionMethods",shader:"shader",shaderInput:"shaderInput",vertexAttributes:"vertexAttributes"}},function(e,t,n){"use strict";function r(){return"instanceData"}function o(e){return""+i+e.toString(31)}Object.defineProperty(t,"__esModule",{value:!0});var i="u";t.makeInstanceUniformNameArray=r,t.makeInstanceUniformNameTree=o},function(e,t,n){"use strict";function r(e,t){return t.data.depth-e.data.depth}Object.defineProperty(t,"__esModule",{value:!0});var o=n(47),i=n(52),a=function(){function e(e,t,n,o){var i=this;this._waitingForRender=!0,this.getViewsUnderMouse=function(e){var t=i.quadTree.query(e);return t.sort(r),t},this.resize=function(){i._waitingForRender=!0},this.context=e,this.setViews(t),this.setControllers(n),this.addContextListeners(o)}return Object.defineProperty(e.prototype,"waitingForRender",{get:function(){return this._waitingForRender},set:function(e){this._waitingForRender=e,e||(this.quadTree=new i.QuadTree(0,0,0,0),this.quadTree.addAll(this.views.map(function(e){return e.bounds}).filter(Boolean)))},enumerable:!0,configurable:!0}),e.prototype.addContextListeners=function(e){var t=this,n=this.context,r=null,i=null;e&&(n.onmousewheel=function(e){var a=o.eventElementPosition(e,n),s=t.makeInteraction(a,i,r),c=t.makeWheel(e);t.controllers.forEach(function(e){e.handleWheel(s,c)}),e.stopPropagation(),e.preventDefault()}),n.onmousemove=function(e){if(!t.waitingForRender){var a=o.eventElementPosition(e,n),s=t.makeInteraction(a,i,r);t.controllers.forEach(function(e){e.handleMouseMove(s)})}},n.onmousedown=function(e){if(!t.waitingForRender){i=o.eventElementPosition(e,n);var a=t.getViewsUnderMouse(i),s=!0,c=Date.now();if(!(a.length<=0)){r=a[0].data;var u=t.makeInteraction(i,i,r),l=i;t.controllers.forEach(function(t){t.handleMouseDown(u,e.button)}),e.stopPropagation(),document.onmousemove=function(e){var a=o.eventElementPosition(e,n),c=t.makeInteraction(a,i,r),u={x:a.x-l.x,y:a.y-l.y},h=t.makeDrag(a,i,l,u);l=a,t.controllers.forEach(function(e){e.handleDrag(c,h)}),s=!1},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null,document.onmouseover=null},document.onmouseover=function(e){var a=o.eventElementPosition(e,n),s=t.makeInteraction(a,i,r);t.controllers.forEach(function(e){e.handleMouseOver(s)}),e.stopPropagation()},n.onmouseup=function(e){var a=o.eventElementPosition(e,n),u=t.makeInteraction(a,i,r);t.controllers.forEach(function(e){e.handleMouseUp(u)}),s&&Date.now()-c<1e3&&t.controllers.forEach(function(t){t.handleClick(u,e.button)})},n.onselectstart=function(){return!1}}}}},e.prototype.makeDrag=function(e,t,n,r){return{screen:{current:e,delta:r,previous:n,start:t}}},e.prototype.makeInteraction=function(e,t,n){var r=this.getViewsUnderMouse(e);return{screen:{mouse:e},start:t&&n&&{mouse:n.view.screenToView(e),view:n.view},target:{mouse:r[0]&&r[0].data.view.screenToView(e),view:r[0]&&r[0].data.view},viewsUnderMouse:r.map(function(t){return{mouse:t.data.view.screenToView(e),view:t.data.view}})}},e.prototype.makeWheel=function(e){var t=o.normalizeWheel(e);return{wheel:[t.x,t.y]}},e.prototype.setControllers=function(e){this.controllers=e},e.prototype.setViews=function(e){this.views=e},e.prototype.destroy=function(){this.quadTree=null,this.context.onmousedown=null,this.context.onmousemove=null},e}();t.MouseEventManager=a},function(e,t,n){(function(r){function o(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function i(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r)}}function a(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function c(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}t=e.exports=n(50),t.log=a,t.formatArgs=i,t.save=s,t.load=c,t.useColors=o,t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(c())}).call(t,n(49))},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(6),a=n(54),s=n(29);!function(e){e[e._2=2]="_2",e[e._4=4]="_4",e[e._8=8]="_8",e[e._16=16]="_16",e[e._32=32]="_32",e[e._64=64]="_64",e[e._128=128]="_128",e[e._256=256]="_256",e[e._512=512]="_512",e[e._1024=1024]="_1024",e[e._2048=2048]="_2048",e[e._4096=4096]="_4096"}(t.AtlasSize||(t.AtlasSize={}));var c=function(e){function t(t){var n=e.call(this,t)||this;n.validResources=new Map;var r=document.createElement("canvas");return n.width=r.width=t.width,n.height=r.height=t.height,n.textureSettings=t.textureSettings,n.packing=new a.PackNode(0,0,t.width,t.height),n.updateTexture(r),n}return r(t,e),t.prototype.invalidateResource=function(e){var t={x:0,y:0};e.texture.aspectRatio=1,e.texture.atlasBL=t,e.texture.atlasBR=t,e.texture.atlasTL=t,e.texture.atlasTR=t,e.texture.atlasReferenceID="",e.texture.pixelWidth=0,e.texture.pixelHeight=0,e.texture.isValid=!1},t.prototype.setManager=function(e){this.manager=e},t.prototype.registerResource=function(e){if(void 0===this.validResources.get(e)){if(!e.texture||!e.texture.isValid)return e.texture||(e.texture=new s.SubTexture),e.texture.isValid=!0,this.validResources.set(e,!0),!0;console.warn("Atlas Error:",this.id,"Attempted to add a resource to an Atlas that is already a valid resource on another atlas.","Consider Creating a new resource to be loaded into this particular atlas.","Resource:",e)}else console.warn("Atlas Error:",this.id,"A resource was trying to be added to the atlas that has already been added before.","Consider creating a new resource to indicate what you want loaded to the atlas","Resource:",e);return!1},t.prototype.removeResource=function(e){this.validResources.get(e)?(this.validResources.set(e,!1),this.invalidateResource(e)):console.warn("Atlas Error:",this.id,"Attempted to remove a resource that does not exist on this atlas.","or the resource was already considered invalidated on this atlas.","Resource:",e)},t.prototype.updateTexture=function(e){if(this.texture){var t=this.texture.image;this.texture.dispose(),this.texture=new o.Texture(t)}else this.texture=new o.Texture(e);this.texture.generateMipmaps=!0,this.texture.premultiplyAlpha=!0,this.textureSettings&&Object.assign(this.texture,this.textureSettings),this.texture.needsUpdate=!0},t.prototype.destroy=function(){var e=this;this.texture.dispose(),this.validResources.forEach(function(t,n){e.invalidateResource(n)})},t}(i.IdentifyByKey);t.Atlas=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.aspectRatio=1}return e}();t.SubTexture=r},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(15),i=function(e){function t(t){var n=e.call(this)||this;return n.color=t,n}return r(t,e),t}(o.BaseAtlasResource);t.ColorAtlasResource=i},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.awaitContext=function(e){return r(this,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:t=e.getContext("2d"),n=0,r.label=1;case 1:return!Boolean(t)&&n<100?[4,new Promise(function(e){return setTimeout(e,10)})]:[3,4];case 2:r.sent(),r.label=3;case 3:return t=e.getContext("2d"),++n,[3,1];case 4:return[2]}})})},e.makeCSS=function(e){return"rgba("+Math.floor(256*e.r)+", "+Math.floor(256*e.g)+", "+Math.floor(256*e.b)+", "+e.opacity+")"},e.render=function(e){return r(this,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return t=document.createElement("canvas"),n=t.getContext("2d"),[4,this.awaitContext(t)];case 1:return r.sent(),n?(t.width=2,t.height=2,n.imageSmoothingEnabled=!1,n.fillStyle=this.makeCSS(e.color),n.fillRect(0,0,2,2),e.rasterization.canvas=t):console.warn("Could not create a canvas 2d context to generate a color for rasterization."),[2,e]}})})},e}();t.ColorRasterizer=i},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var i,a=function(){function e(){}return e.awaitContext=function(){return r(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return i?[3,2]:(this.getContext(),[4,new Promise(function(e){return setTimeout(e,10)})]);case 1:return e.sent(),[3,0];case 2:return[2]}})})},e.getContext=function(){return i||(i=document.createElement("canvas").getContext("2d")),i},e.calculateLabelSize=function(e,t,n){var r=e.label,o=t||e.sampleScale||1,a=this.getLabelRasterizationFontSize(r,o);i.fillStyle="white",i.font=this.makeCSSFont(r,o),i.canvas.width=i.measureText(r.text).width+a,i.canvas.height=2*a,i.fillStyle="white",i.font=this.makeCSSFont(r,o),i.fillText(r.text,a/2,a/4+a);for(var s,c=i.canvas,u=c.width,l=c.height,h=i.getImageData(0,0,u,l).data,d=Number.MAX_SAFE_INTEGER,f=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER,y=Number.MIN_SAFE_INTEGER,v=Math.min,m=Math.max,g=0;g<u;++g)for(var b=0;b<l;++b){var w=b*(4*u)+4*g;s=h[w],s>0&&(d=v(d,b),f=v(f,g),p=m(p,g),y=m(y,b))}d-=1,y+=2,p+=2,f-=1,d=Math.max(d,0),f=Math.max(f,0),e.rasterization=e.rasterization||{texture:{height:0,width:0},world:{height:0,width:0}},n?(e.rasterization.texture={height:y-d,width:p-f},e.rasterization.canvas=this.createCroppedCanvas(e,d,f),this.calculateLabelSize(e,1,!1)):e.rasterization.world={height:y-d,width:p-f}},e.createCroppedCanvas=function(e,t,n){var r=document.createElement("canvas"),o=r.getContext("2d");if(o){var a=e.rasterization.texture;r.width=a.width,r.height=a.height,o.imageSmoothingEnabled=!1,o.drawImage(i.canvas,n,t,a.width,a.height,0,0,a.width,a.height)}else console.warn("Could not create a canvas 2d context to generate a label's cropped image.");return r},e.getLabelRasterizationFontSize=function(e,t){return e.fontSize*t},e.makeCSSFont=function(e,t){return e.fontWeight+" "+this.getLabelRasterizationFontSize(e,t)+"px "+e.fontFamily},e.render=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.awaitContext()];case 1:return t.sent(),e.label.fontSize>50?(console.warn("Labels only support font sizes up to 50"),[2,e]):(this.calculateLabelSize(e,e.sampleScale,!0),[2,e])}})})},e.renderSync=function(e){return this.getContext(),i?e.label.fontSize>50?(console.warn("Labels only support font sizes up to 50"),e):(this.calculateLabelSize(e,e.sampleScale,!0),e):(console.warn("Can not render a label synchronously without the canvas context being ready."),e)},e}();t.LabelRasterizer=a},function(e,t,n){"use strict";function r(e){return Boolean(e.observe)}Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(3);!function(e){e[e.CHANGE=0]="CHANGE",e[e.INSERT=1]="INSERT",e[e.REMOVE=2]="REMOVE"}(o=t.DiffType||(t.DiffType={}));var a=function(){function e(e){var t=this;this.active=!0,this.instanceDisposers=new Map,this.instanceChanges=new Map,this.instanceById=new Map,this.isChanged=!1,this._changeList=[],this.monitorItem=function(e){return function(n){return t.active&&("update"===n.type?(e.set(n.object,o.CHANGE),t.isChanged=!0):console.warn("Received an update type not supported by monitorItem:",n.type)),n}},this._instances=i.observable(e||[]),r(this._instances)&&(this.listDisposer=i.intercept(this._instances,this.monitorList(this._instances,this.instanceChanges,this.instanceById,this.instanceDisposers)))}return Object.defineProperty(e.prototype,"instances",{get:function(){return this._instances},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"changeList",{get:function(){if(this.active=!1,this.isChanged){var e=[];this.instanceChanges.forEach(function(t,n){e.push([n,t])}),this._changeList=e}return this._changeList},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.listDisposer(),this.instanceDisposers.forEach(function(e){return e()}),this._instances=null,this.instanceChanges.clear(),this._changeList=null},e.prototype.monitorList=function(e,t,n,r){var a=this;return function(e){if(a.active)if("splice"===e.type){for(var s=e.index,c=e.index+e.removedCount;s<c;++s){var u=e.object[s];t.set(u,o.REMOVE),a.isChanged=!0;var l=r.get(u);l&&l()}for(var s=0,c=e.added.length;s<c;++s){var u=e.added[s]=i.observable(e.added[s]);t.set(u,o.INSERT),a.isChanged=!0,n.set(u.id,u),r.set(u,i.intercept(u,a.monitorItem(t)))}}else console.warn("Received an update type not supported by monitorList:",e.type);return e}},e.prototype.resolve=function(){this.instanceById.clear(),this.instanceChanges.clear(),this._changeList=[],this.active=!0},e}();t.DataProvider=a},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(9)),r(n(33)),r(n(5)),r(n(62)),r(n(14)),r(n(10)),r(n(23)),r(n(5))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(17))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(8)),r(n(18)),r(n(20)),r(n(21)),r(n(13)),r(n(22)),r(n(38)),r(n(7)),r(n(26)),r(n(11)),r(n(4)),r(n(12))},function(e,t,n){"use strict";function r(e,t){var n=""+e,r=parseFloat(n);return isNaN(r)?0:n.indexOf("%")>-1?r/100*t:r}function o(e,t){0!==t.width&&0!==t.height||console.warn("An AbsolutePosition evaluated to invalid dimensions.","Please ensure that the object provided and the reference has valid dimensions","to produce dimensions with width and height that are non-zero.","item:",e,"reference:",t.toString());var n,o,a=i.DataBounds.emptyBounds();if(e.width)a.width=r(e.width,t.width),"left"in e?a.x=r(e.left,t.width):"right"in e&&(a.x=t.width-r(e.right,t.width)-a.width);else{var s=r(e.left,t.width);n=t.width-r(e.right,t.width)-s,n<0&&console.warn("An AbsolutePosition evaluated to invalid dimensions.","Please ensure that the object provided and the reference has valid dimensions","to produce dimensions with width and height that are greater than zero.","item:",e,"reference:",t.toString()),a.x=s,a.width=n}if(e.height)a.height=r(e.height,t.height),"top"in e?a.y=r(e.top,t.height):"bottom"in e&&(a.y=t.height-r(e.bottom,t.height)-a.height);else{var c=r(e.top,t.height);o=t.height-r(e.bottom,t.height)-c,n<0&&console.warn("An AbsolutePosition evaluated to invalid dimensions.","Please ensure that the object provided and the reference has valid dimensions","to produce dimensions with width and height that are greater than zero.","item:",e,"reference:",t.toString()),a.y=c,a.height=o}return(0===a.width||0===a.height||isNaN(a.x+a.y+a.width+a.height))&&(a.x=0,a.y=0,a.width=t.width,a.height=t.height),a}Object.defineProperty(t,"__esModule",{value:!0});var i=n(19);t.getAbsolutePositionBounds=o},function(e,t,n){"use strict";function r(e){return Boolean(e.getContext)}function o(e){return Boolean(e.substr)}function i(e){return Boolean(e.canvas)}function a(e,t){return[e,t]}var s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var u=n(0),l=n(2),h=n(39),d=n(18),f=n(20),p=n(21),y=n(13),v=n(22),m=n(26),g=n(11),b=n(12),w=n(19),x=n(53),_=n(4),O=n(59),C=new u.Color(1,1,1);t.createLayer=a;var T=function(){function e(){this.atlasManager=new _.AtlasManager,this.layers=new Map,this.pixelRatio=window.devicePixelRatio,this.scenes=new Map,this.sceneViews=[],this.willDisposeLayer=new Map}return Object.defineProperty(e.prototype,"gl",{get:function(){return this.context},enumerable:!0,configurable:!0}),e.prototype.addLayer=function(e){return e.id?this.layers.get(e.id)?(console.warn("All layer's ids must be unique per layer manager"),e):(this.layers.set(e.id,e),this.initLayer(e),e):(console.warn("All layers must have an id"),e)},e.prototype.destroy=function(){this.mouseManager.destroy()},e.prototype.draw=function(){for(var e=Array.from(this.scenes.values()),t=0,n=e.length;t<n;++t){var r=e[t],o=Array.from(r.viewById.values()),i=r.layers;r.sortLayers();for(var a=0,s=o.length;a<s;++a){var c=o[a];c.fitViewtoViewport(new l.Bounds({height:this.context.canvas.height,width:this.context.canvas.width,x:0,y:0}));for(var u=0,h=i.length;u<h;++u){var d=i[u];d.view=c,d.draw()}this.drawSceneView(r.container,c)}}this.mouseManager.waitingForRender&&(this.sceneViews.forEach(function(e){e.bounds=new w.DataBounds(e.view.screenBounds),e.bounds.data=e}),this.mouseManager.waitingForRender=!1),this.resourceManager.dequeueRequests()},e.prototype.drawSceneView=function(e,t){var n={x:t.viewBounds.left,y:t.viewBounds.top},r=t.viewBounds,o=this.renderer.getSize();o.width*=this.renderer.getPixelRatio(),o.height*=this.renderer.getPixelRatio();var i=t.background;this.context.enable(this.context.SCISSOR_TEST),this.context.scissor(n.x,o.height-n.y-r.height,r.width,r.height),t.background&&this.context.clearColor(i[0],i[1],i[2],i[3]),t.clearFlags?this.context.clear((t.clearFlags.indexOf(b.ClearFlags.COLOR)>-1?this.context.COLOR_BUFFER_BIT:0)|(t.clearFlags.indexOf(b.ClearFlags.DEPTH)>-1?this.context.DEPTH_BUFFER_BIT:0)|(t.clearFlags.indexOf(b.ClearFlags.STENCIL)>-1?this.context.STENCIL_BUFFER_BIT:0)):this.context.clear(this.context.COLOR_BUFFER_BIT|this.context.DEPTH_BUFFER_BIT);var a=this.currentViewport;a&&a.x===n.x&&a.y===n.y&&a.width===r.width&&a.height===r.height||(this.renderer.setViewport(n.x/this.pixelRatio,n.y/this.pixelRatio,r.width,r.height),this.currentViewport={height:r.height,width:r.width,x:n.x,y:n.y}),this.renderer.render(e,t.viewCamera.baseCamera)},e.prototype.init=function(e){return s(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return this.pixelRatio=e.pixelRatio||this.pixelRatio,this.setContext(e.context),this.initGL(e),this.initMouseManager(e),[4,this.initResources(e)];case 1:return t.sent(),[2,this]}})})},e.prototype.initGL=function(e){var t=this;if(!this.context)return void console.error("Can not initialize Layer Surface as a valid GL context was not established.");var n=this.context.canvas,r=n.width,o=n.height;this.renderer=new u.WebGLRenderer({alpha:e.background&&e.background[3]<1,antialias:!0,canvas:n,preserveDrawingBuffer:!0}),this.renderer.autoClear=!1,this.renderer.setFaceCulling(u.CullFaceNone),this.renderer.setSize(r,o),this.renderer.setPixelRatio(this.pixelRatio),e.background?this.renderer.setClearColor(new u.Color(e.background[0],e.background[1],e.background[2]),e.background[3]):this.renderer.setClearColor(C),this.defaultSceneElements=d.generateDefaultScene(this.context),this.defaultSceneElements.view.background=e.background,this.scenes.set(this.defaultSceneElements.scene.id,this.defaultSceneElements.scene);var i=0;this.sceneViews.push({depth:++i,scene:this.defaultSceneElements.scene,view:this.defaultSceneElements.view}),this.context.enable(this.context.SCISSOR_TEST),e.scenes&&e.scenes.forEach(function(e){var n=new g.Scene(e);0===e.views.length&&(n.addView(t.defaultSceneElements.view),t.sceneViews.push({depth:++i,scene:n,view:t.defaultSceneElements.view})),e.views.forEach(function(e){var r=new b.View(e);r.camera=r.camera||t.defaultSceneElements.camera,r.viewCamera=r.viewCamera||t.defaultSceneElements.viewCamera,r.viewport=r.viewport||t.defaultSceneElements.viewport,r.pixelRatio=t.pixelRatio,n.addView(r),t.sceneViews.push({depth:++i,scene:n,view:r})}),t.scenes.set(e.key,n)})},e.prototype.initLayer=function(e){e.resource=this.resourceManager;var t=this.addLayerToScene(e),n=e.initShader(),r=v.injectShaderIO(e,n),o=r.vertexAttributes,i=r.instanceAttributes,a=r.uniforms,s=h.injectFragments(n,o,i,a),c=f.generateLayerGeometry(s.maxInstancesPerBuffer,o,n.vertexCount),u=p.generateLayerMaterial(e,s.vs,s.fs,a,s.materialUniforms),l=y.generateLayerModel(e,c,u);return e.geometry=c,e.instanceAttributes=i,e.instanceVertexCount=n.vertexCount,e.material=u,e.maxInstancesPerBuffer=s.maxInstancesPerBuffer,e.model=l,e.uniforms=a,e.vertexAttributes=o,e.uniformManager=new x.InstanceUniformManager(e,t),e},e.prototype.initMouseManager=function(e){this.mouseManager=new m.MouseEventManager(this.context.canvas,this.sceneViews,e.eventManagers||[],e.handlesWheelEvents)},e.prototype.initResources=function(e){return s(this,void 0,void 0,function(){var t,n,r;return c(this,function(o){switch(o.label){case 0:if(!e.atlasResources)return[3,4];t=0,n=e.atlasResources,o.label=1;case 1:return t<n.length?(r=n[t],[4,this.atlasManager.createAtlas(r)]):[3,4];case 2:o.sent(),o.label=3;case 3:return t++,[3,1];case 4:return this.resourceManager=new O.AtlasResourceManager({atlasManager:this.atlasManager}),[2]}})})},e.prototype.addLayerToScene=function(e){var t=this.scenes.get(e.props.scene);return t||(t=this.defaultSceneElements.scene,e.props.scene&&console.warn("Layer specified a scene that is not within the layer surface manager. Layer will be added to the default scene.")),t.addLayer(e),t},e.prototype.removeLayer=function(e){return this.layers.get(e&&e.id)?(e.uniformManager.removeFromScene(),e.destroy(),this.layers.delete(e.id),e):(console.warn("Tried to remove a layer that is not in the manager.",e),e)},e.prototype.render=function(e){var t=this;e&&e.length>0&&e.forEach(function(e){var n=e[0],r=e[1],o=t.layers.get(r.key);o?(o.willUpdateProps(r),Object.assign(o.props,r),o.didUpdateProps()):t.addLayer(new n(Object.assign(r,n.defaultProps))),t.willDisposeLayer.set(r.key,!1)}),this.willDisposeLayer.forEach(function(e,n){e&&t.removeLayer(t.layers.get(n))}),this.willDisposeLayer.clear(),this.layers.forEach(function(e,n){t.willDisposeLayer.set(n,!0)})},e.prototype.fitContainer=function(e){var t=this.context.canvas.parentElement;if(t){var n=this.context.canvas;n.className="",n.setAttribute("style",""),t.style.position="relative",n.style.position="absolute",n.style.left="0xp",n.style.top="0xp",n.style.width="100%",n.style.height="100%",n.setAttribute("width",""),n.setAttribute("height","");var r=t.getBoundingClientRect(),o=n.getBoundingClientRect();this.resize(o.width||100,r.height||100)}},e.prototype.resize=function(e,t,n){var r=this;this.pixelRatio=n||this.pixelRatio,this.sceneViews.forEach(function(e){return e.view.pixelRatio=r.pixelRatio}),this.renderer.setSize(e||100,t||100),this.renderer.setPixelRatio(this.pixelRatio),this.mouseManager.resize()},e.prototype.setContext=function(e){if(e)if(i(e))this.context=e;else if(r(e))this.context=e.getContext("webgl")||e.getContext("experimental-webgl");else if(o(e)){var t=document.getElementById(e);r(t)&&this.setContext(t)}},e}();t.LayerSurface=T},function(e,t,n){"use strict";function r(e){for(var t=0,n=0,r=e.length;n<r;++n)t+=Math.ceil(e[n].size/4);return t}function o(e,t,n,r){var o=a(t,n,r),l=(f={},f[b.templateVars.projectionMethods]=i(),f[b.templateVars.shaderInput]=o.fragment,f[b.templateVars.shader]=c(e,n,o.metrics.maxInstancesPerBuffer,o.metrics.blocksPerInstance),f),h={name:"vertex shader composition",values:[b.templateVars.projectionMethods,b.templateVars.shaderInput,b.templateVars.shader]},d=m.shaderTemplate(x,l,h);return p={},p[b.templateVars.layerUniforms]=s(r,v.ShaderInjectionTarget.FRAGMENT),p[b.templateVars.shader]=u(e),l=p,h={name:"fragment shader composition",values:[b.templateVars.layerUniforms,b.templateVars.shader]},{fs:m.shaderTemplate(_,l,h).shader,materialUniforms:o.materialUniforms,maxInstancesPerBuffer:o.metrics.maxInstancesPerBuffer,vs:d.shader};var f,p}function i(){var e={},t={name:"projection methods",values:[]};return m.shaderTemplate(T,e,t).shader}function a(e,t,n){var r={},o=f(r,t,n),i=(c={},c[b.templateVars.layerUniforms]=s(n,v.ShaderInjectionTarget.VERTEX),c[b.templateVars.vertexAttributes]=d(e),c);Object.assign(r,i);var a={name:"shader input",values:[b.templateVars.instanceDataRetrieval,b.templateVars.instanceUniformDeclarations,b.templateVars.layerUniforms,b.templateVars.vertexAttributes]};return{fragment:m.shaderTemplate(C,r,a).shader,materialUniforms:o.materialUniforms,metrics:o.metrics};var c}function s(e,t){var n="",r=t||v.ShaderInjectionTarget.VERTEX;return e.forEach(function(e){e.shaderInjection=e.shaderInjection||v.ShaderInjectionTarget.VERTEX,e.shaderInjection!==r&&e.shaderInjection!==v.ShaderInjectionTarget.ALL||(n+="uniform "+(e.qualifier||"")+(e.qualifier?" ":"")+A[e.size]+" "+e.name+";\n")}),n}function c(e,t,n,r){var o=(a={},a[b.templateVars.attributes]=l(t,r),a),i={name:"layer vertex shader",values:[b.templateVars.attributes]};return m.shaderTemplate(e.vs,o,i).shader;var a}function u(e){var t={},n={name:"layer fragment shader",values:[]};return m.shaderTemplate(e.fs,t,n).shader}function l(e,t){var n={};n[b.templateVars.blocksPerInstance]=""+t,n[b.templateVars.instanceDestructuring]=h(e,t);var r={name:"instance attributes fragment",values:[b.templateVars.instanceDestructuring]};return m.shaderTemplate(O,n,r).shader}function h(e,t){return w.makeInstanceDestructuringArray(e,t)}function d(e){var t="";return e.forEach(function(e){t+="attribute "+A[e.size]+" "+(e.qualifier||"")+(e.qualifier&&" "||"")+e.name+";\n"}),t}function f(e,t,n){var o=g.WebGLStat.MAX_VERTEX_UNIFORMS,i=o-r(n),a=t.slice(0).sort(function(e,t){return e.block-t.block}),s=a[0].block,c=0,u=new Map,l=new Map;a.forEach(function(e){e.block!==s&&(s=e.block,c++);var t=e.size,n=u.get(c)||0,r=n+t;if(r>S)return void console.error("An instance attribute was specified that over fills the maximum allowed useage for a block.","\nMax Allowed per block "+S,"\nAttribute: "+e.name+" Block Specified: "+e.block,"\nTotal blocks used with this attribute: "+r);u.set(c,r),e.blockIndex=n;var o=l.get(c)||new Map;if(e.blockIndex+t>S)return void console.error("An instance attribute was specified that would fill indices greater than the block allows.","\nMax index per block "+S,"\nAttribute: "+e.name+" Block Index: "+e.blockIndex+" Size: "+e.size+" Block Index + Size: "+(e.blockIndex+e.size));for(var i=e.blockIndex;i<e.blockIndex+t;++i)if(o.get(i))return void console.error("An instance attribute was specified who's block index overaps another attributes useage","\nMax index per block "+S,"\nAttribute: "+e.name+" Block Index: "+e.blockIndex+" Size: "+e.size+" Block Index + Size: "+(e.blockIndex+e.size));e.block=c});var h=c+1,d=Math.floor(i/h);return{materialUniforms:p(e,d,4,h,a).materialUniforms,metrics:{blocksPerInstance:h,maxInstancesPerBuffer:d}}}function p(e,t,n,r,o){for(var i=[],a=0;a<t;++a)i.push(a);var s=y(t*r,o);return e[b.templateVars.instanceUniformDeclarations]=s.fragment,e[b.templateVars.instanceBlockCount]=""+r,e[b.templateVars.instanceDataRetrieval]=w.makeInstanceRetrievalArray(r),{materialUniforms:s.materialUniforms}}function y(e,t){var n="",r=new Map,o=0;t.forEach(function(e){(r.get(e.block)||new Map).set(e.qualifier,!0),o=Math.max(o,e.block)});var i=new Map;r.forEach(function(e,t){var n=Array.from(e.keys());i.set(t,n.join(" ")+" ")});var a=w.makeUniformArrayDeclaration(e);return n+=a.fragment,n+="\n",{fragment:n,materialUniforms:a.materialUniforms}}Object.defineProperty(t,"__esModule",{value:!0});var v=n(1),m=n(14),g=n(23),b=n(24),w=n(40),x=n(42),_=n(43),O=n(44),C=n(45),T=n(46),S=4,A={1:"float",2:"vec2",3:"vec3",4:"vec4",9:"mat3",16:"mat4",99:"sampler2D"};t.injectFragments=o},function(e,t,n){"use strict";function r(e){return{fragment:"uniform vec4 "+u.makeInstanceUniformNameArray()+"["+e+"];",materialUniforms:[{name:u.makeInstanceUniformNameArray(),type:"4fv",value:new Array(e).fill(0).map(function(){return new s.Vector4(0,0,0,0)})}]}}function o(e){var t={};t[h.templateVars.instanceBlockCount]=""+e;var n={name:"makeInstanceRetrievalArray",values:[h.templateVars.instanceBlockCount]};return l.shaderTemplate(d,t,n).shader}function i(e,t){for(var n="",r=0;r<t;++r)n+="  vec4 block"+r+" = getBlock("+r+", instanceIndex);\n";return e.forEach(function(e){var t=e.block;e.size===c.InstanceAttributeSize.FOUR?n+="  "+p[e.size]+" "+e.name+" = block"+t+";\n":e.atlas?n+="  "+p[c.InstanceAttributeSize.ATLAS]+" "+e.name+" = block"+t+";\n":n+="  "+p[e.size]+" "+e.name+" = block"+t+"."+a(e.blockIndex,e.size)+";\n"}),n}function a(e,t){return f.slice(e,e+t).join("")}Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),c=n(1),u=n(25),l=n(14),h=n(24),d=n(41),f=["x","y","z","w"],p={1:"float",2:"vec2",3:"vec3",4:"vec4",9:"mat3",16:"mat4",99:"vec4"};t.makeUniformArrayDeclaration=r,t.makeInstanceRetrievalArray=o,t.makeInstanceDestructuringArray=i},function(e,t){e.exports="int instanceSize = ${instanceBlockCount};\n\nvec4 getBlock(int index, int instanceIndex) {\n  return instanceData[(instanceSize * instanceIndex) + index];\n}\n"},function(e,t){e.exports="// This is the vertex shader generated by the system\n${shaderInput}\n${projectionMethods}\n// --------------- Vertex shader provided by the layer -----------------\n${shader}\n"},function(e,t){e.exports="// This is the fragment shader generated by the system\n${layerUniforms}\n\n// --------------- The fragment shader provided by the layer ------------------\n${shader}\n"},function(e,t){e.exports="// This is the injected dereferencing of the instance attributes\n  int instanceIndex = int(instance);\n  ${instanceDestructuring}\n\n  // This is a special injected instance attribute. It lets the system\n  // control specific instances ability to draw, which allows the backend\n  // system greater control on how it optimizes draw calls and it's buffers.\n  if (_active == 0.0) {\n    gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Quick exit to prevent any geometry from arising from the instance\n    return;\n  }\n"},function(e,t){e.exports="// When instancing is enabled, it causes a major list of uniforms to be generated\n// it also generates a massive search tree to retrieve the correct unforms in question.\n${instanceUniformDeclarations}\n\n// This is the uniforms provided by the system along with the uniforms created by the layer\n${layerUniforms}\n\n// This is the attributes generated for vertex attributes\n${vertexAttributes}\n\n// This is the methods and set up needed to retrieve a block of data for an instance\n${instanceDataRetrieval}\n"},function(e,t){e.exports="// These are projection methods utilizing the simpler camera breakdown approach\n\nvec3 cameraSpace(vec3 world) {\n  return (world + cameraOffset) * cameraScale;\n}\n\nvec3 cameraSpaceSize(vec3 worldSize) {\n  return worldSize * cameraScale;\n}\n\nvec4 clipSpace(vec3 world) {\n  return vec4(((projection * modelView) * vec4(cameraSpace(world), 1.0)).xyz, 1.0);\n}\n\nvec4 clipSpaceSize(vec3 worldSize) {\n  return vec4(((projection * modelView) * vec4(cameraSpaceSize(worldSize), 0.0)).xyz, 1.0);\n}\n"},function(e,t,n){"use strict";function r(e){var t=e,n=0,r=0;return Math.sign(y[0])!==Math.sign(r)&&y.splice(0,y.length,0,0,0,0),n=t.deltaX*p,r=t.deltaY*p*v+y[0]*m+y[1]*g+y[2]*b,y.unshift(r),y.pop(),new l.Vector2(-n,-r)}function o(e){var t=e;return new l.Vector2(t.deltaX,-t.deltaY)}function i(e){var t=e,n=t.deltaX;void 0===n&&(n=void 0!==t.wheelDeltaX?t.wheelDeltaX*d:0);var r=t.deltaY;return void 0===r&&(r=void 0!==t.wheelDeltaY?t.wheelDeltaY*d:(t.wheelDelta||-t.detail)*f),new l.Vector2(-n,-r)}function a(e){var t=e,n=t.deltaX,r=t.deltaY;void 0===n&&(n=void 0!==t.wheelDeltaX?t.wheelDeltaX*d:0),void 0===r&&(r=void 0!==t.wheelDeltaY?t.wheelDeltaY*d:t.wheelDelta||-t.detail);var o=new l.Vector2(n,-r);return o.multiplyScalar(.25),o}function s(e,t){var n=0,r=0,o=0,i=0,a=t||e.nativeEvent.target;if(e||(e=window.event),e.pageX||e.pageY?(n=e.pageX,r=e.pageY):(e.clientX||e.clientY)&&(n=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,r=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),a.offsetParent)do{o+=a.offsetLeft,i+=a.offsetTop,a=a.offsetParent}while(a);return{x:n-o,y:r-i}}Object.defineProperty(t,"__esModule",{value:!0});var c,u=n(48),l=n(0),h=n(27)("CommunicationsView:Mouse"),d=1/30,f=-.25,p=100,y=[0,0,0,0],v=.1,m=.2,g=.2,b=.5;t.normalizeWheel=c,u.firefox?(h("Using mouse wheel for firefox"),t.normalizeWheel=c=r):u.msie&&+u.version>=11?(h("Using mouse wheel for IE 11"),t.normalizeWheel=c=i):u.msedge?(h("Using mouse wheel for MS EDGE"),t.normalizeWheel=c=a):(h("Using mouse wheel for Chrome"),t.normalizeWheel=c=o),t.eventElementPosition=s},function(e,t){e.exports=n},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function i(e){if(h===clearTimeout)return clearTimeout(e);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function a(){y&&f&&(y=!1,f.length?p=f.concat(p):v=-1,p.length&&s())}function s(){if(!y){var e=o(a);y=!0;for(var t=p.length;t;){for(f=p,p=[];++v<t;)f&&f[v].run();v=-1,t=p.length}f=null,y=!1,i(e)}}function c(e,t){this.fun=e,this.array=t}function u(){}var l,h,d=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(e){h=r}}();var f,p=[],y=!1,v=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new c(e,t)),1!==p.length||y||o(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=u,d.addListener=u,d.once=u,d.off=u,d.removeListener=u,d.removeAllListeners=u,d.emit=u,d.prependListener=u,d.prependOnceListener=u,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t,n){function r(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function o(e){function n(){if(n.enabled){var e=n,r=+new Date,i=r-(o||r);e.diff=i,e.prev=o,e.curr=r,o=r;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var o=t.formatters[r];if("function"==typeof o){var i=a[c];n=o.call(e,i),a.splice(c,1),c--}return n}),t.formatArgs.call(e,a);(n.log||t.log||console.log.bind(console)).apply(e,a)}}var o;return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=r(e),n.destroy=i,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function a(e){t.save(e),t.names=[],t.skips=[];var n,r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&(e=r[n].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}}function s(){t.enable("")}function c(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function u(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=o.debug=o.default=o,t.coerce=u,t.disable=s,t.enable=a,t.enabled=c,t.humanize=n(51),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t){function n(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*l;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function r(e){return e>=u?Math.round(e/u)+"d":e>=c?Math.round(e/c)+"h":e>=s?Math.round(e/s)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function o(e){return i(e,u,"day")||i(e,c,"hour")||i(e,s,"minute")||i(e,a,"second")||e+" ms"}function i(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a=1e3,s=60*a,c=60*s,u=24*c,l=365.25*u;e.exports=function(e,t){t=t||{};var i=typeof e;if("string"===i&&e.length>0)return n(e);if("number"===i&&!1===isNaN(e))return t.long?o(e):r(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){"use strict";function r(e,t){var n=[];return t.forEach(function(t){e.find(function(e){return t instanceof e})&&n.push(t)}),n}var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(2);t.filterQuery=r;var a=function(){function e(e,t){this.TL=null,this.TR=null,this.BL=null,this.BR=null;var n=e.mid;this.TL=new s(e.x,n.x,e.y,n.y,t),this.TR=new s(n.x,e.right,e.y,n.y,t),this.BL=new s(e.x,n.x,n.y,e.bottom,t),this.BR=new s(n.x,e.right,n.y,e.bottom,t)}return e.prototype.destroy=function(){this.TL.destroy(),this.TR.destroy(),this.BL.destroy(),this.BR.destroy(),this.TL=null,this.TR=null,this.BL=null,this.BR=null},e}();t.Quadrants=a;var s=function(){function e(e,t,n,r,o){this.bounds=null,this.children=[],this.depth=0,this.nodes=null,arguments.length>=4?this.bounds=new i.Bounds({height:n-r,width:t-e,x:e,y:n}):this.bounds=new i.Bounds({height:1,width:1,x:0,y:0}),this.depth=o||0}return e.prototype.destroy=function(){this.children=null,this.bounds=null,this.nodes&&(this.nodes.destroy(),this.nodes=null)},e.prototype.add=function(e,t){return e.isInside(this.bounds)?this.doAdd(e):(this.cover(e),this.add(e,t))},e.prototype.addAll=function(e,t){var n=this;t=t||[];var r=Number.MAX_VALUE,o=Number.MAX_VALUE,a=-Number.MAX_VALUE,s=-Number.MAX_VALUE;e.forEach(function(e){e.x<r&&(r=e.x),e.right>a&&(a=e.right),e.bottom>s&&(s=e.bottom),e.y<o&&(o=e.y)}),this.cover(new i.Bounds({height:s-o,width:a-r,x:r,y:o})),e.forEach(function(e,t){return n.doAdd(e)})},e.prototype.cover=function(e){var t=this;if(!e.isInside(this.bounds)){this.bounds.encapsulate(e),this.bounds.x-=1,this.bounds.y-=1,this.bounds.width+=2,this.bounds.height+=4;var n=this.gatherChildren([]);this.nodes&&(this.nodes.destroy(),this.nodes=null),n.forEach(function(e,n){return t.doAdd(e)})}},e.prototype.doAdd=function(e){return this.nodes?e.isInside(this.nodes.TL.bounds)?this.nodes.TL.doAdd(e):e.isInside(this.nodes.TR.bounds)?this.nodes.TR.doAdd(e):e.isInside(this.nodes.BL.bounds)?this.nodes.BL.doAdd(e):e.isInside(this.nodes.BR.bounds)?this.nodes.BR.doAdd(e):(this.children.push(e),!0):e.isInside(this.bounds)?(this.children.push(e),this.children.length>5&&this.depth<10&&this.split(),!0):(isNaN(e.width+e.height+e.x+e.y)?console.error("Child did not fit into bounds because a dimension is NaN",e):0===e.area&&console.error("Child did not fit into bounds because the area is zero",e),!0)},e.prototype.gatherChildren=function(e){return e=e.concat(this.children),this.nodes&&(this.nodes.TL.gatherChildren(e),this.nodes.TR.gatherChildren(e),this.nodes.BL.gatherChildren(e),this.nodes.BR.gatherChildren(e)),e},e.prototype.query=function(e,t){return e instanceof i.Bounds?e.hitBounds(this.bounds)?this.queryBounds(e,[],t):[]:this.bounds.containsPoint(e)?this.queryPoint(e,[],t):[]},e.prototype.queryBounds=function(e,t,n){return this.children.forEach(function(n,r){n.hitBounds(e)&&t.push(n)}),n&&n(this),this.nodes&&(e.hitBounds(this.nodes.TL.bounds)&&this.nodes.TL.queryBounds(e,t,n),e.hitBounds(this.nodes.TR.bounds)&&this.nodes.TR.queryBounds(e,t,n),e.hitBounds(this.nodes.BL.bounds)&&this.nodes.BL.queryBounds(e,t,n),e.hitBounds(this.nodes.BR.bounds)&&this.nodes.BR.queryBounds(e,t,n)),t},e.prototype.queryPoint=function(e,t,n){return this.children.forEach(function(n,r){n.containsPoint(e)&&t.push(n)}),n&&n(this),this.nodes&&(this.nodes.TL.bounds.containsPoint(e)&&this.nodes.TL.queryPoint(e,t,n),this.nodes.TR.bounds.containsPoint(e)&&this.nodes.TR.queryPoint(e,t,n),this.nodes.BL.bounds.containsPoint(e)&&this.nodes.BL.queryPoint(e,t,n),this.nodes.BR.bounds.containsPoint(e)&&this.nodes.BR.queryPoint(e,t,n)),t},e.prototype.split=function(){var e=this.gatherChildren([]);for(this.nodes=new a(this.bounds,this.depth+1),this.children=[];e.length>0;)this.doAdd(e.pop())},e.prototype.visit=function(e){var t=Boolean(e(this));this.nodes&&!t&&(this.nodes.TL.visit(e),this.nodes.TR.visit(e),this.nodes.BL.visit(e),this.nodes.BR.visit(e))},e}();t.Node=s;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(s);t.QuadTree=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(13),i=n(25),a=function(){function e(e,t){this.buffers=[],this.availableClusters=[],this.instanceToCluster=new Map,this.clusterToBuffer=new Map,this.layer=e;var n=0;e.instanceAttributes.forEach(function(e){n=Math.max(e.block,n)}),this.uniformBlocksPerInstance=n+1,this.scene=t}return e.prototype.add=function(e){this.availableClusters.length<=0&&this.makeNewBuffer();var t=this.availableClusters.shift();return t?this.instanceToCluster.set(e,t):console.warn("No valid cluster available for instance added to uniform manager."),t},e.prototype.getUniforms=function(e){return this.instanceToCluster.get(e)},e.prototype.remove=function(e){var t=this.instanceToCluster.get(e);return t&&(this.instanceToCluster.delete(e),this.availableClusters.unshift(t)),t},e.prototype.removeFromScene=function(){var e=this;this.buffers.forEach(function(t,n){e.scene.container.remove(t.model)}),this.scene=null},e.prototype.setScene=function(e){var t=this;this.buffers.forEach(function(e,n){t.scene.container.add(e.model)}),this.scene=e},e.prototype.makeNewBuffer=function(){var e=new r.BufferGeometry;this.layer.vertexAttributes.forEach(function(t){e.addAttribute(t.name,t.materialAttribute)}),e.drawRange.start=0,e.drawRange.count=this.layer.maxInstancesPerBuffer*this.layer.instanceVertexCount;var t=this.layer.material.clone(),n=o.generateLayerModel(this.layer,e,t);n.frustumCulled=!1;var a={activeInstances:[],clusters:[],firstInstance:0,geometry:e,lastInstance:0,material:t,model:n};this.buffers.push(a);var s=0,c=i.makeInstanceUniformNameArray(),u=t.uniforms[c];u.value=u.value.map(function(){return new r.Vector4(0,0,0,0)});for(var l=0,h=this.layer.maxInstancesPerBuffer;l<h;++l){var d={instanceIndex:l,uniform:u,uniformRange:[s,0]};s+=this.uniformBlocksPerInstance,d.uniformRange[1]=s,a.clusters.push(d),this.availableClusters.push(d),this.clusterToBuffer.set(d,a)}for(var l=0,h=this.layer.uniforms.length;l<h;++l){var f=this.layer.uniforms[l];f.materialUniforms.push(t.uniforms[f.name])}this.scene&&this.scene.container.add(a.model)},e}();t.InstanceUniformManager=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),o=function(){function e(e,t,n,o){this.child=[null,null],this.isLeaf=!0,this.nodeImage=null,this.nodeDimensions=new r.Bounds({height:o,width:n,x:e,y:t})}return e.prototype.destroy=function(){this.nodeImage=null,this.child[0]&&this.child[0].destroy(),this.child[1]&&this.child[1].destroy(),this.child[0]=void 0,this.child[1]=void 0},e.prototype.hasChild=function(){return this.child[0]&&!this.child[0].nodeImage?!this.child[0].isLeaf:!(!this.child[1]||this.child[1].nodeImage)&&!this.child[1].isLeaf},e.prototype.insert=function(t){if(!this.isLeaf){var n=this.child[0].insert(t);return null!==n?n:this.child[1].insert(t)}if(this.nodeImage)return null;var r=this.nodeDimensions.fits(t.second);if(0===r)return null;if(1===r)return this;this.isLeaf=!1;var o=t.second.width,i=t.second.height,a=this.nodeDimensions.width-o,s=this.nodeDimensions.height-t.second.height;return a>s?(this.child[0]=new e(this.nodeDimensions.x,this.nodeDimensions.y,o,this.nodeDimensions.height),this.child[1]=new e(this.nodeDimensions.x+o,this.nodeDimensions.y,a,this.nodeDimensions.height)):(this.child[0]=new e(this.nodeDimensions.x,this.nodeDimensions.y,this.nodeDimensions.width,i),this.child[1]=new e(this.nodeDimensions.x,this.nodeDimensions.y+i,this.nodeDimensions.width,s)),this.child[0].insert(t)},e.prototype.remove=function(e){if(this.isLeaf)return this.nodeImage===e&&(this.nodeImage=null,e.atlasReferenceID=null,e.pixelWidth=0,!0);var t=this.child[0].remove(e);return!!t||(t=this.child[1].remove(e),this.child[0].hasChild()||this.child[1].hasChild()||(this.child[0]=null,this.child[1]=null),t)},e}();t.PackNode=o},function(e,t,n){"use strict";function r(e){var t=!1;return e&&e.isValid&&e.pixelWidth&&e.pixelHeight&&(t=!0),t}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),s=n(2),c=n(28),u=n(30),l=n(31),h=n(32),d=n(29),f=n(27)("webgl-surface:Atlas"),p={aspectRatio:0,atlasBL:{x:0,y:0},atlasBR:{x:0,y:0},atlasReferenceID:"",atlasTexture:null,atlasTL:{x:0,y:0},atlasTR:{x:0,y:0},heightOnAtlas:0,isValid:!1,pixelHeight:0,pixelWidth:0,widthOnAtlas:0},y=function(){function e(){this.allAtlas=new Map}return e.prototype.createAtlas=function(e,t){return o(this,void 0,void 0,function(){var n;return i(this,function(r){switch(r.label){case 0:return n=new c.Atlas(e),n.setManager(this),this.allAtlas.set(n.id,n),t?[4,this.updateAtlas(n.id,t)]:[3,2];case 1:r.sent(),r.label=2;case 2:return f("Atlas Created-> %o",n),[2,n]}})})},e.prototype.destroyAtlas=function(e){var t=this.allAtlas.get(e);t&&t.destroy()},e.prototype.setDefaultImage=function(e,t){return e=Object.assign(e,p,{atlasReferenceID:t})},e.prototype.draw=function(e,t){return o(this,void 0,void 0,function(){var n,o,a,c,u,l,h,d,p,y,v,m,g,b,w,x,_,O,C;return i(this,function(i){switch(i.label){case 0:return n=e.texture.image,o=e.id,e.registerResource(t)?[4,this.loadImage(t)]:(console.warn("Could not draw resource to the atlas as the resource was not properly registered to the atlas first",e,t),[2,Promise.resolve(!1)]);case 1:return a=i.sent(),a&&r(t.texture)?(c=t.rasterization,u=t.texture,l=new s.Bounds({left:0,right:c.texture.width,top:0,bottom:c.texture.height}),h={first:u,second:l},h.second.width+=1,h.second.height+=1,d=e.packing,p=d.insert(h),p?(f("Atlas location determined: %o",p),p.nodeImage=u,y=p.nodeDimensions.x/e.width,v=p.nodeDimensions.y/e.height,m=p.nodeDimensions.width/e.width,g=p.nodeDimensions.height/e.height,b=1/e.width,w=new s.Bounds({bottom:1-v,left:y,right:y+m,top:1-(v+g)}),x=w.bottom,_=w.y,O=w.x,C=w.x+w.width-b,u.atlasReferenceID=o,u.atlasTL={x:O,y:_},u.atlasBR={x:C,y:x},u.atlasBL={x:O,y:x},u.atlasTR={x:C,y:_},u.widthOnAtlas=Math.abs(u.atlasTR.x-u.atlasTL.x),u.heightOnAtlas=Math.abs(u.atlasTR.y-u.atlasBR.y),u.pixelWidth=c.texture.width,u.pixelHeight=c.texture.height,n.getContext("2d").drawImage(a,p.nodeDimensions.x,p.nodeDimensions.y),[2,!0]):(console.error("Could not fit resource into atlas",t),t.texture=this.setDefaultImage(t.texture,o),[2,!1])):(console.error("Could not load resource:",t),t.texture=this.setDefaultImage(t.texture,o),[2,!1])}})})},e.prototype.getAtlasTexture=function(e){return this.allAtlas.get(e)},e.prototype.loadImage=function(e){return o(this,void 0,void 0,function(){var t,n,r,o,o;return i(this,function(i){switch(i.label){case 0:return n=e.texture||new d.SubTexture,e.texture=n,e instanceof a.ImageAtlasResource?e.image.element?0!==e.image.element.width&&0!==e.image.element.height?(r=e.image.element,n.pixelWidth=r.width,n.pixelHeight=r.height,n.aspectRatio=r.width/r.height,[2,r]):[4,new Promise(function(t,r){var o=e.image.element;o.onload=function(){n.pixelWidth=o.width,n.pixelHeight=o.height,n.aspectRatio=o.width/o.height,t(o)},o.onerror=function(){t(null)}})]:[3,2]:[3,4];case 1:return o=i.sent(),[2,o];case 2:e.image.path&&(t=e.image.path),i.label=3;case 3:return[3,10];case 4:return e instanceof a.LabelAtlasResource?e.rasterization.canvas?[3,6]:[4,h.LabelRasterizer.render(e)]:[3,7];case 5:i.sent(),i.label=6;case 6:return e.rasterization.canvas?(f("Rasterized label %o",e.rasterization),t=e.rasterization.canvas.toDataURL("image/png")):console.warn("The label was not able to be rasterized"),[3,10];case 7:return e instanceof u.ColorAtlasResource?e.rasterization.canvas?[3,9]:[4,l.ColorRasterizer.render(e)]:[3,10];case 8:i.sent(),i.label=9;case 9:e.rasterization.canvas?(f("Rasterized color %o",e.rasterization),t=e.rasterization.canvas.toDataURL("image/png")):console.warn("The color was not able to be rasterized"),i.label=10;case 10:return t?[4,new Promise(function(e,r){var o=new Image;o.onload=function(){n.pixelWidth=o.width,n.pixelHeight=o.height,n.aspectRatio=o.width/o.height,e(o)},o.onerror=function(){e(null)},o.src=t})]:[3,12];case 11:return o=i.sent(),[2,o];case 12:return[2,null]}})})},e.prototype.updateAtlas=function(e,t){return o(this,void 0,void 0,function(){var n,r,o,a;return i(this,function(i){switch(i.label){case 0:if(!(n=this.allAtlas.get(e)))return[3,5];r=0,o=t,i.label=1;case 1:return r<o.length?(a=o[r],[4,this.draw(n,a)]):[3,4];case 2:i.sent(),i.label=3;case 3:return r++,[3,1];case 4:return n.updateTexture(),[3,6];case 5:console.warn("Can not update non-existing atlas:",e,"These resources will not be loaded:",t),i.label=6;case 6:return[2]}})})},e}();t.AtlasManager=y},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(15),i=function(e){function t(t){var n=e.call(this)||this;return n.image=t,n}return r(t,e),t}(o.BaseAtlasResource);t.ImageAtlasResource=i},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var i,a=function(){function e(){}return e.awaitContext=function(){return r(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return i?[3,2]:(this.getContext(),[4,new Promise(function(e){return setTimeout(e,10)})]);case 1:return e.sent(),[3,0];case 2:return[2]}})})},e.getContext=function(){return i||(i=document.createElement("canvas").getContext("2d")),i},e.calculateImageSize=function(e,t){var n=e.image.element;if(0===n.width||0===n.height)return void console.warn("Images provided shoud have valid dimensions! Please ensure the image is loaded first.");i.canvas.width=100,i.canvas.height=100,i.drawImage(n,0,0),e.rasterization=e.rasterization||{texture:{height:0,width:0},world:{height:0,width:0}},e.rasterization.texture={height:n.height*e.sampleScale,width:n.width*e.sampleScale},e.rasterization.world={height:n.height,width:n.width},e.rasterization.image=n},e.render=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.awaitContext()];case 1:return t.sent(),this.calculateImageSize(e,e.sampleScale),[2,e]}})})},e.renderSync=function(e){return this.getContext(),i?(this.calculateImageSize(e,e.sampleScale),e):(console.warn("Can not render a image synchronously without the canvas context being ready."),e)},e}();t.ImageRasterizer=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(15),i=function(e){function t(t){var n=e.call(this)||this;return n.label=t,n}return r(t,e),t}(o.BaseAtlasResource);t.LabelAtlasResource=i},function(e,t,n){"use strict";function r(e){return e?[e.atlasTL.x,e.atlasTL.y,e.atlasBR.x,e.atlasBR.y]:[0,0,0,0]}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){this.targetAtlas="",this.requestQueue=[],this.requestLookup=new Map,this.atlasManager=e.atlasManager}return e.prototype.dequeueRequests=function(){return o(this,void 0,void 0,function(){var e,t=this;return i(this,function(n){switch(n.label){case 0:return this.requestQueue.length?(e=this.requestQueue.slice(0),this.requestQueue=[],[4,this.atlasManager.updateAtlas(this.targetAtlas,e)]):[3,2];case 1:n.sent(),e.forEach(function(e){t.requestLookup.get(e).forEach(function(e){var t=e[0],n=e[1];t.uniformManager.getUniforms(n)&&(n.active=!0)})}),n.label=2;case 2:return[2]}})})},e.prototype.getAtlasTexture=function(e){var t=this.atlasManager.getAtlasTexture(e);return t?t.texture:null},e.prototype.request=function(e,t,n){var o=n.texture;if(o)return r(o);var i=this.requestLookup.get(n);return i?(i.push([e,t]),t.active=!1,r(o)):(t.active=!1,this.requestQueue.push(n),this.requestLookup.set(n,[[e,t]]),r(o))},e.prototype.setTargetAtlas=function(e){this.targetAtlas=e},e}();t.AtlasResourceManager=a},function(e,t){e.exports=""},function(e,t){e.exports="void main() {\n  gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n}"},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),i=function(e){function t(t){var n=e.call(this)||this;return n.offsetFilter=function(e){return e},n.scaleFilter=function(e){return e},Object.assign(n,t),n}return r(t,e),Object.defineProperty(t.prototype,"offset",{get:function(){return this.offsetFilter(this.base.offset)},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.scaleFilter(this.base.scale)},set:function(e){},enumerable:!0,configurable:!0}),t}(o.ChartCamera);t.ReferenceCamera=i},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(64)),r(n(69)),r(n(74)),r(n(79)),r(n(16))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(65)),r(n(68))},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(7),a=n(1),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initShader=function(){return{fs:n(66),instanceAttributes:[{block:0,blockIndex:a.InstanceBlockIndex.ONE,name:"center",size:a.InstanceAttributeSize.TWO,update:function(e){return[e.x,e.y]}},{block:0,blockIndex:a.InstanceBlockIndex.THREE,name:"radius",size:a.InstanceAttributeSize.ONE,update:function(e){return[e.radius]}},{block:0,blockIndex:a.InstanceBlockIndex.FOUR,name:"depth",size:a.InstanceAttributeSize.ONE,update:function(e){return[e.depth]}},{block:1,blockIndex:a.InstanceBlockIndex.ONE,name:"color",size:a.InstanceAttributeSize.FOUR,update:function(e){return e.color}}],uniforms:[{name:"scaleFactor",size:a.UniformSize.ONE,update:function(e){return[1]}}],vertexAttributes:[{defaults:[0],name:"position",size:a.VertexAttributeSize.THREE,update:function(e){return[0,0,0]}}],vertexCount:1,vs:n(67)}},t.prototype.getModelType=function(){return{modelType:o.Points}},t.prototype.getMaterialOptions=function(){return{blending:o.CustomBlending,blendSrc:o.OneFactor,premultipliedAlpha:!0,transparent:!0}},t}(i.Layer);t.CircleLayer=s},function(e,t){e.exports="precision highp float;\n\nvarying vec4 vertexColor;\nvarying float edgeSharpness;\n\nfloat circle(vec2 coord, float radius){\n  vec2 dist = coord - vec2(0.5);\n\n  return 1.0 - smoothstep(\n    radius - (radius * edgeSharpness),\n    radius + (radius * 0.01),\n    dot(dist, dist) * 4.0\n  );\n}\n\nvoid main() {\n  float step_factor = circle(gl_PointCoord.xy, 1.0);\n  gl_FragColor = mix(\n    vec4(0.0, 0.0, 0.0, 0.0),\n    vertexColor,\n    step_factor\n  );\n}\n"},function(e,t){e.exports="precision highp float;\n\nvarying vec4 vertexColor;\nvarying float edgeSharpness;\n\nvoid main() {\n  ${attributes}\n\n  vertexColor = color;\n  gl_PointSize = radius * 2.0 * pixelRatio;\n  edgeSharpness = mix(0.8, 0.01, min(gl_PointSize / (45.0 * pixelRatio), 1.0));\n  gl_Position = clipSpace(vec3(center, depth));\n}\n"},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),a=n(5),s=function(e){function t(t){var n=e.call(this,t)||this;return n.color=[1,1,1,1],n.radius=0,n.x=0,n.y=0,n.depth=0,n.color=t.color||n.color,n.radius=t.radius||n.radius,n.x=t.x||n.x,n.y=t.y||n.y,n.depth=t.depth||n.depth,n}return r(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return 2*this.radius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return 2*this.radius},enumerable:!0,configurable:!0}),o([i.observable],t.prototype,"color",void 0),o([i.observable],t.prototype,"radius",void 0),o([i.observable],t.prototype,"x",void 0),o([i.observable],t.prototype,"y",void 0),o([i.observable],t.prototype,"depth",void 0),o([i.computed],t.prototype,"width",null),o([i.computed],t.prototype,"height",null),t}(a.Instance);t.CircleInstance=s},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(70)),r(n(73))},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(7),a=n(1),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initShader=function(){var e=this,t={0:1,1:1,2:-1,3:1,4:-1,5:-1},r={0:0,1:0,2:0,3:1,4:1,5:1};return{fs:n(71),instanceAttributes:[{block:0,blockIndex:a.InstanceBlockIndex.ONE,name:"location",size:a.InstanceAttributeSize.TWO,update:function(e){return[e.x,e.y]}},{block:0,blockIndex:a.InstanceBlockIndex.THREE,name:"anchor",size:a.InstanceAttributeSize.TWO,update:function(e){return[e.anchor.x,e.anchor.y]}},{block:1,blockIndex:a.InstanceBlockIndex.ONE,name:"size",size:a.InstanceAttributeSize.TWO,update:function(e){return[e.width,e.height]}},{block:1,blockIndex:a.InstanceBlockIndex.THREE,name:"depth",size:a.InstanceAttributeSize.ONE,update:function(e){return[e.depth]}},{block:1,blockIndex:a.InstanceBlockIndex.FOUR,name:"scaling",size:a.InstanceAttributeSize.ONE,update:function(e){return[e.scaling]}},{atlas:{key:this.props.atlas,name:"imageAtlas"},block:2,name:"texture",update:function(t){return e.resource.request(e,t,t.resource)}},{block:3,blockIndex:a.InstanceBlockIndex.ONE,name:"tint",size:a.InstanceAttributeSize.FOUR,update:function(e){return e.tint}}],uniforms:[{name:"scaleFactor",size:a.UniformSize.ONE,update:function(e){return[1]}}],vertexAttributes:[{name:"position",size:a.VertexAttributeSize.THREE,update:function(e){return[t[e],r[e],0]}}],vertexCount:6,vs:n(72)}},t.prototype.getModelType=function(){return{drawMode:o.TriangleStripDrawMode,modelType:o.Mesh}},t.prototype.getMaterialOptions=function(){return{blending:o.CustomBlending,blendSrc:o.OneFactor,premultipliedAlpha:!0,transparent:!0}},t}(i.Layer);t.ImageLayer=s},function(e,t){e.exports="precision highp float;\n\nvarying vec4 vertexColor;\nvarying vec2 texCoord;\n\nvoid main() {\n  gl_FragColor = texture2D(imageAtlas, texCoord) * vertexColor;\n}\n"},function(e,t){e.exports="precision highp float;\n\nvarying vec4 vertexColor;\nvarying vec2 texCoord;\n\nvoid main() {\n  ${attributes}\n\n  float normal = position.x;\n  float side = position.y;\n\n  // Get the location of the anchor in world space\n  vec2 worldAnchor = location + anchor;\n  // Get the position of the current vertex\n  vec2 vertex = vec2(side, float(normal == 1.0)) * size + location - anchor;\n  // Get the tex coord from our inject texture info\n  texCoord = texture.xy + ((texture.zw - texture.xy) * vec2(side, float(normal == -1.0)));\n  // Apply the image's tint as a tint to the image\n  vertexColor = tint;\n\n  // Figure out the size of the image as it'd show on the screen\n  vec3 screenSize = cameraSpaceSize(vec3(size, 1.0));\n  // See how scaled the size on screen will be from the actual height of the image\n  float imageScreenScale = screenSize.y / size.y;\n\n  // If our screen rendering is larger than the size the image is supposed to be, then we automagically\n  // scale down our image to stay the correct size, centered on the anchor point\n  vec2 anchorToVertex = vertex - location;\n  // Do the test for when the image is larger on the screen than the font size\n  bool largerOnScreen = screenSize.y > size.y;\n\n  // We now choose between keeping the same image size or keeping it in world space\n  vertex = mix(\n    // This option keeps the image size in world space\n    vertex,\n    // This option counters the scaling of the image on the screen keeping it a static size\n    (anchorToVertex / imageScreenScale) + location,\n    // Logic choice of which method for scaling to use\n    float(\n      (\n        scaling == 3.0 ||                  // NEVER mode - keep the image the same size always\n        (largerOnScreen && scaling == 2.0) // BOUND_MAX mode - only if we're larger than the font size do we scale down\n      ) &&\n      scaling != 1.0                       // ALWAYS mode - the image stays completely in world space allowing it to scale freely\n    )\n  );\n\n  gl_Position = clipSpace(vec3(vertex, depth));\n}\n"},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),a=n(4),s=n(5),c=n(16),u=new Map,l=(d={},d[c.AnchorType.TopLeft]=function(e,t){e.x=-e.padding,e.y=-e.padding},d[c.AnchorType.TopMiddle]=function(e,t){e.x=t.width/2,e.y=-e.padding},d[c.AnchorType.TopRight]=function(e,t){e.x=t.width+e.padding,e.y=-e.padding},d[c.AnchorType.MiddleLeft]=function(e,t){e.x=-e.padding,e.y=t.height/2},d[c.AnchorType.Middle]=function(e,t){e.x=t.width/2,e.y=t.height/2},d[c.AnchorType.MiddleRight]=function(e,t){e.x=t.width+e.padding,e.y=t.height/2},d[c.AnchorType.BottomLeft]=function(e,t){e.x=-e.padding,e.y=t.height+e.padding},d[c.AnchorType.BottomMiddle]=function(e,t){e.x=t.width/2,e.y=t.height+e.padding},d[c.AnchorType.BottomRight]=function(e,t){e.x=t.width+e.padding,e.y=t.height+e.padding},d[c.AnchorType.Custom]=function(e,t){e.x=e.x||0,e.y=e.y||0},d),h=function(e){function t(t){var n=e.call(this,t)||this;n.tint=[0,0,0,1],n.depth=0,n.height=1,n.scaling=c.ScaleType.BOUND_MAX,n.width=1,n.x=0,n.y=0,n._sourceWidth=0,n._sourceHeight=0,n._isDestroyed=!1,n._anchor={padding:0,type:c.AnchorType.TopLeft,x:0,y:0},n.depth=t.depth||n.depth,n.tint=t.tint||n.tint,n.scaling=t.scaling||n.scaling,n.x=t.x||n.x,n.y=t.y||n.y,n._element=t.element;var r=u.get(n._path||n._element);return r&&r.references++,r||(r={references:1,resource:new a.ImageAtlasResource(n)},r.resource.sampleScale=r.resource.sampleScale||1,a.ImageRasterizer.renderSync(r.resource),u.set(n._path||n._element,r)),n._rasterization=r,n._sourceWidth=r.resource.rasterization.world.width,n._sourceHeight=r.resource.rasterization.world.height,n.width=t.width||n._sourceWidth||1,n.height=t.height||n._sourceHeight||1,t.anchor&&n.setAnchor(t.anchor),n}return r(t,e),Object.defineProperty(t.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDestroyed",{get:function(){return this._isDestroyed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resource",{get:function(){return this._rasterization.resource},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sourceWidth",{get:function(){return this._sourceWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sourceHeight",{get:function(){return this._sourceHeight},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,0===--this._rasterization.references&&(this._rasterization.resource,console.warn("The destroy method still needs completion")))},Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},enumerable:!0,configurable:!0}),t.prototype.setAnchor=function(e){var t={padding:e.padding||0,type:e.type,x:e.x||0,y:e.y||0};l[t.type](t,this),this._anchor=t},o([i.observable],t.prototype,"tint",void 0),o([i.observable],t.prototype,"depth",void 0),o([i.observable],t.prototype,"height",void 0),o([i.observable],t.prototype,"scaling",void 0),o([i.observable],t.prototype,"width",void 0),o([i.observable],t.prototype,"x",void 0),o([i.observable],t.prototype,"y",void 0),o([i.observable],t.prototype,"_anchor",void 0),o([i.computed],t.prototype,"anchor",null),t}(s.Instance);t.ImageInstance=h;var d},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(75)),r(n(78))},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(7),a=n(1),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initShader=function(){var e=this,t={0:1,1:1,2:-1,3:1,4:-1,5:-1},r={0:0,1:0,2:0,3:1,4:1,5:1};return{fs:n(76),instanceAttributes:[{block:0,blockIndex:a.InstanceBlockIndex.ONE,name:"location",size:a.InstanceAttributeSize.TWO,update:function(e){return[e.x,e.y]}},{block:0,blockIndex:a.InstanceBlockIndex.THREE,name:"anchor",size:a.InstanceAttributeSize.TWO,update:function(e){return[e.anchor.x,e.anchor.y]}},{block:1,blockIndex:a.InstanceBlockIndex.ONE,name:"size",size:a.InstanceAttributeSize.TWO,update:function(e){return[e.width,e.height]}},{block:1,blockIndex:a.InstanceBlockIndex.THREE,name:"depth",size:a.InstanceAttributeSize.ONE,update:function(e){return[e.depth]}},{block:1,blockIndex:a.InstanceBlockIndex.FOUR,name:"scaling",size:a.InstanceAttributeSize.ONE,update:function(e){return[e.scaling]}},{atlas:{key:this.props.atlas,name:"labelAtlas"},block:2,name:"texture",update:function(t){return e.resource.request(e,t,t.resource)}},{block:3,blockIndex:a.InstanceBlockIndex.ONE,name:"color",size:a.InstanceAttributeSize.FOUR,update:function(e){return e.color}}],uniforms:[{name:"scaleFactor",size:a.UniformSize.ONE,update:function(e){return[1]}}],vertexAttributes:[{name:"position",size:a.VertexAttributeSize.THREE,update:function(e){return[t[e],r[e],0]}}],vertexCount:6,vs:n(77)}},t.prototype.getModelType=function(){return{drawMode:o.TriangleStripDrawMode,modelType:o.Mesh}},t.prototype.getMaterialOptions=function(){return{blending:o.CustomBlending,blendSrc:o.OneFactor,premultipliedAlpha:!0,transparent:!0}},t}(i.Layer);t.LabelLayer=s},function(e,t){e.exports="precision highp float;\n\nvarying vec4 vertexColor;\nvarying vec2 texCoord;\n\nvoid main() {\n  gl_FragColor = texture2D(labelAtlas, texCoord) * vertexColor;\n}\n"},function(e,t){e.exports="precision highp float;\n\nvarying vec4 vertexColor;\nvarying vec2 texCoord;\n\nvoid main() {\n  ${attributes}\n\n  // Destructure threejs's bug with the position requirement\n  float normal = position.x;\n  float side = position.y;\n  // Get the location of the anchor in world space\n  vec2 worldAnchor = location + anchor;\n  // Get the position of the current vertex\n  vec2 vertex = vec2(side, float(normal == 1.0)) * size + location - anchor;\n  // Get the tex coord from our inject texture info\n  texCoord = texture.xy + ((texture.zw - texture.xy) * vec2(side, float(normal == -1.0)));\n  // Apply the label's color as a tint to the label (all labels are rendered white to the base texture)\n  vertexColor = color;\n\n  // Figure out the size of the label as it'd show on the screen\n  vec3 screenSize = cameraSpaceSize(vec3(size, 1.0));\n  // See how scaled the size on screen will be from the actual height of the label\n  float labelScreenScale = screenSize.y / size.y;\n\n  // If our screen rendering is larger than the size the label is supposed to be, then we automagically\n  // scale down our label to stay the correct size, centered on the anchor point\n  vec2 anchorToVertex = vertex - location;\n  // Do the test for when the label is larger on the screen than the font size\n  bool largerOnScreen = screenSize.y > size.y;\n\n  // We now choose between keeping the same label size or keeping it in world space\n  vertex = mix(\n    // This option keeps the label size in world space\n    vertex,\n    // This option counters the scaling of the label on the screen keeping it a static size\n    (anchorToVertex / labelScreenScale) + location,\n    // Logic choice of which method for scaling to use\n    float(\n      (\n        scaling == 3.0 ||                  // NEVER mode - keep the label the same size always\n        (largerOnScreen && scaling == 2.0) // BOUND_MAX mode - only if we're larger than the font size do we scale down\n      ) &&\n      scaling != 1.0                       // ALWAYS mode - the label stays completely in world space allowing it to scale freely\n    )\n  );\n\n  gl_Position = clipSpace(vec3(vertex, depth));\n}\n"},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),a=n(4),s=n(5),c=n(16),u=new Map,l=(d={},d[c.AnchorType.TopLeft]=function(e,t){e.x=-e.padding,e.y=-e.padding},d[c.AnchorType.TopMiddle]=function(e,t){e.x=t.width/2,e.y=-e.padding},d[c.AnchorType.TopRight]=function(e,t){e.x=t.width+e.padding,e.y=-e.padding},d[c.AnchorType.MiddleLeft]=function(e,t){e.x=-e.padding,e.y=t.height/2},d[c.AnchorType.Middle]=function(e,t){e.x=t.width/2,e.y=t.height/2},d[c.AnchorType.MiddleRight]=function(e,t){e.x=t.width+e.padding,e.y=t.height/2},d[c.AnchorType.BottomLeft]=function(e,t){e.x=-e.padding,e.y=t.height+e.padding},d[c.AnchorType.BottomMiddle]=function(e,t){e.x=t.width/2,e.y=t.height+e.padding},d[c.AnchorType.BottomRight]=function(e,t){e.x=t.width+e.padding,e.y=t.height+e.padding},d[c.AnchorType.Custom]=function(e,t){e.x=e.x||0,e.y=e.y||0},d),h=function(e){function t(t){var n=e.call(this,t)||this;n.color=[0,0,0,1],n.depth=0,n.scaling=c.ScaleType.BOUND_MAX,n.x=0,n.y=0,n._cssFont="",n._fontFamily="Arial",n._fontSize=12,n._fontStyle="normal",n._fontWeight=400,n._text="",n._width=0,n._height=0,n._isDestroyed=!1,n._anchor={padding:0,type:c.AnchorType.TopLeft,x:0,y:0},n.depth=t.depth||n.depth,n.color=t.color||n.color,n.scaling=t.scaling||n.scaling,n.x=t.x||n.x,n.y=t.y||n.y,n._fontFamily=t.fontFamily||n._fontFamily,n._fontSize=t.fontSize||n._fontSize,n._fontStyle=t.fontStyle||n._fontStyle,n._fontWeight=t.fontWeight||n._fontWeight,n._text=t.text||n._text,n._cssFont=a.LabelRasterizer.makeCSSFont(n,1);var r,o=u.get(n._text);return o?(r=o.get(n._cssFont))&&r.references++:o=new Map,r||(r={references:1,resource:new a.LabelAtlasResource(n)},t.rasterization&&(r.resource.sampleScale=t.rasterization.scale||1),r.resource.sampleScale=r.resource.sampleScale||1,a.LabelRasterizer.renderSync(r.resource),u.set(n._text,o),o.set(n._cssFont,r)),n._rasterization=r,n._width=r.resource.rasterization.world.width,n._height=r.resource.rasterization.world.height,t.anchor&&n.setAnchor(t.anchor),n}return r(t,e),Object.defineProperty(t.prototype,"cssFont",{get:function(){return this._cssFont},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDestroyed",{get:function(){return this._isDestroyed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resource",{get:function(){return this._rasterization.resource},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,0===--this._rasterization.references&&this._rasterization.resource)},Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},enumerable:!0,configurable:!0}),t.prototype.setAnchor=function(e){var t={padding:e.padding||0,type:e.type,x:e.x||0,y:e.y||0};l[t.type](t,this),this._anchor=t},o([i.observable],t.prototype,"color",void 0),o([i.observable],t.prototype,"depth",void 0),o([i.observable],t.prototype,"scaling",void 0),o([i.observable],t.prototype,"x",void 0),o([i.observable],t.prototype,"y",void 0),o([i.observable],t.prototype,"_anchor",void 0),o([i.computed],t.prototype,"anchor",null),t}(s.Instance);t.LabelInstance=h;var d},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(80)),r(n(81))},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),a=n(34),s=function(e){function t(t){var n=e.call(this,t)||this;return n.color=[1,1,1,1],n.depth=0,n.radius=0,n.thickness=1,n.x=0,n.y=0,n.color=t.color||[1,1,1,1],n.depth=t.depth||0,n.radius=t.radius,n.thickness=t.thickness||n.thickness,n.x=t.x,n.y=t.y,n}return r(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return 2*this.radius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return 2*this.radius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerRadius",{get:function(){return this.radius-this.thickness},enumerable:!0,configurable:!0}),o([i.observable],t.prototype,"color",void 0),o([i.observable],t.prototype,"depth",void 0),o([i.observable],t.prototype,"radius",void 0),o([i.observable],t.prototype,"thickness",void 0),o([i.observable],t.prototype,"x",void 0),o([i.observable],t.prototype,"y",void 0),o([i.computed],t.prototype,"width",null),o([i.computed],t.prototype,"height",null),o([i.computed],t.prototype,"innerRadius",null),t}(a.Instance);t.RingInstance=s},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(17),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initShader=function(){return{fs:n(82),instanceAttributes:[{block:0,blockIndex:i.InstanceBlockIndex.ONE,name:"center",size:i.InstanceAttributeSize.TWO,update:function(e){return[e.x,e.y]}},{block:0,blockIndex:i.InstanceBlockIndex.THREE,name:"radius",size:i.InstanceAttributeSize.ONE,update:function(e){return[e.radius]}},{block:0,blockIndex:i.InstanceBlockIndex.FOUR,name:"depth",size:i.InstanceAttributeSize.ONE,update:function(e){return[e.depth]}},{block:1,blockIndex:i.InstanceBlockIndex.ONE,name:"color",size:i.InstanceAttributeSize.FOUR,update:function(e){return e.color}},{block:2,blockIndex:i.InstanceBlockIndex.ONE,name:"thickness",size:i.InstanceAttributeSize.ONE,update:function(e){return[e.thickness]}}],uniforms:[{name:"scaleFactor",size:i.UniformSize.ONE,update:function(e){return[1]}},{name:"atlas",size:i.UniformSize.ONE,update:function(e){return[1]}}],vertexAttributes:[{defaults:[0],name:"position",size:i.VertexAttributeSize.THREE,update:function(e){return[0,0,0]}}],vertexCount:1,vs:n(83)}},t.prototype.getModelType=function(){return{modelType:o.Points}},t.prototype.getMaterialOptions=function(){return{blending:o.CustomBlending,blendSrc:o.OneFactor,premultipliedAlpha:!0,transparent:!0}},t}(i.Layer);t.RingLayer=a},function(e,t){e.exports="precision highp float;\n\n/** This is the color of the ring */\nvarying vec4 vertexColor;\n/**\n * This is how sharp the ring renders. For tiny rings, it's best to have\n * less sharpness to better convey the shape of a circle. A good starter setting:\n * edgeSharpness = mix(0.8, 0.01, min(gl_PointSize / 45.0, 1.0));\n */\nvarying float edgeSharpness;\n/**\n * This should be a value that sets the thickness of the ring in normal space\n * relative to the PointSize\n */\nvarying float borderSize;\n\nfloat circle(vec2 coord, float radius){\n  vec2 dist = coord - vec2(0.5);\n\n  return 1.0 - smoothstep(\n    radius - (radius * edgeSharpness),\n    radius + (radius * 0.01),\n    dot(dist, dist) * 4.0\n  );\n}\n\nvoid main() {\n  float outer_step_factor = circle(gl_PointCoord.xy, 1.0);\n  float inner_step_factor = circle(gl_PointCoord.xy, 1.0 - borderSize);\n\n  gl_FragColor = mix(\n    mix(                        // Select the outer color outside of the inner radius\n      vec4(0.0, 0.0, 0.0, 0.0),    // Select invisible outside of inner and outer radius\n      vertexColor,                  // Select outer color outside of inner, but inside outer\n      outer_step_factor\n    ),\n    vec4(0.0, 0.0, 0.0, 0.0),                 // Select inner color inside inner\n    inner_step_factor\n  );\n}\n"},function(e,t){e.exports="precision highp float;\n\nvarying vec4 vertexColor;\nvarying float edgeSharpness;\nvarying float borderSize;\n\nvoid main() {\n  ${attributes}\n\n  vertexColor = color;\n  gl_PointSize = radius * 2.0 * pixelRatio;\n  borderSize = ((thickness * pixelRatio) / gl_PointSize) * 2.0;\n  edgeSharpness = mix(0.8, 0.01, min(gl_PointSize / (45.0 * pixelRatio), 1.0));\n  gl_Position = clipSpace(vec3(center, depth));\n}\n"},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(85)),r(n(86))},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.handleMouseDown=function(e,t){console.warn("MOUSE DOWN",e,t)},t.prototype.handleMouseUp=function(e){console.warn("MOUSE UP",e)},t.prototype.handleMouseOver=function(e){console.warn("MOUSE OVER",e)},t.prototype.handleMouseOut=function(e){console.warn("MOUSE OUT",e)},t.prototype.handleMouseMove=function(e){console.warn("MOUSE MOVE",e)},t.prototype.handleClick=function(e,t){console.warn("CLICK",e,t)},t.prototype.handleDrag=function(e,t){console.warn("DRAG",e,t)},t}(o.EventManager);t.LogController=i},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),i=function(e){function t(t){var n=e.call(this)||this;return n.startViewDidStart=!1,n.camera=t.camera,n.scaleFactor=t.scaleFactor||1e3,n.ignoreCoverViews=t.ignoreCoverViews||!1,t.startView&&(n.startViews=Array.isArray(t.startView)?t.startView:[t.startView]),n}return r(t,e),t.prototype.findCoveredStartView=function(e){var t=this,n=e.viewsUnderMouse.find(function(e){return t.startViews.indexOf(e.view.id)>-1});this.startViewDidStart=Boolean(n),n&&(this.coveredStartView=n.view)},t.prototype.getTargetView=function(e){return this.startViews&&!this.ignoreCoverViews?e.target.view:this.coveredStartView},t.prototype.handleMouseDown=function(e,t){this.findCoveredStartView(e)},t.prototype.handleMouseUp=function(e){this.startViewDidStart=!1},t.prototype.handleDrag=function(e,t){this.canStart(e.start.view.id)&&(this.camera.offset[0]+=t.screen.delta.x/this.camera.scale[0],this.camera.offset[1]+=t.screen.delta.y/this.camera.scale[1])},t.prototype.handleWheel=function(e,t){if(this.findCoveredStartView(e),this.canStart(e.target.view.id)){var n=this.getTargetView(e),r=n.screenToWorld(e.screen.mouse),o=this.camera.scale[0]||1;this.camera.scale[0]=o+t.wheel[1]/this.scaleFactor*o;var i=this.camera.scale[1]||1;this.camera.scale[1]=i+t.wheel[1]/this.scaleFactor*i;var a=n.screenToWorld(e.screen.mouse);this.camera.offset[0]-=(r.x-a.x)/n.pixelRatio,this.camera.offset[1]-=(r.y-a.y)/n.pixelRatio}},t.prototype.canStart=function(e){return!this.startViews||0===this.startViews.length||this.startViews&&this.startViews.indexOf(e)>-1||this.startViewDidStart&&this.ignoreCoverViews},t}(o.EventManager);t.BasicCameraController=i},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(2)),r(n(88))},function(e,t,n){"use strict";function r(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.add=function(e,t,n){return n?(n.x=e.x+t.x,n.y=e.y+t.y,n):{x:e.x+t.x,y:e.y+t.y}},e.getClosest=function(e,t){var n,o=Number.MAX_VALUE,i=null,a=function(t){(n=r(t,e))<o&&(o=n,i=t)};return t.forEach(a),i},e.getClosestIndex=function(e,t){var n,o=Number.MAX_VALUE,i=0,a=function(t,a){(n=r(t,e))<o&&(o=n,i=a)};return t.forEach(a),i},e.subtract=function(e,t,n){void 0===n&&(n=!1);var r=t.x-e.x,o=t.y-e.y;if(n){var i=Math.sqrt(r*r+o*o);r/=i,o/=i}return{x:r,y:o}},e.getDistance=function(e,t,n){return void 0===n&&(n=!1),n?r(e,t):Math.sqrt(r(e,t))},e.getMidpoint=function(t,n){var r=e.subtract(t,n);return{x:r.x/2+t.x,y:r.y/2+t.y}},e.make=function(e,t){return{x:e,y:t}},e.scale=function(e,t,n){return n?(n.x=e.x*t,n.y=e.y*t,n):{x:e.x*t,y:e.y*t}},e.zero=function(){return{x:0,y:0}},e}();t.Point=o}])});