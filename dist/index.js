!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("three"),require("mobx"),require("bowser")):"function"==typeof define&&define.amd?define(["three","mobx","bowser"],t):"object"==typeof exports?exports.voidgl=t(require("three"),require("mobx"),require("bowser")):e.voidgl=t(e.three,e.mobx,e.bowser)}(this,function(e,t,n){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=29)}([function(t,n){t.exports=e},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=function(){function e(e){this.x=0,this.y=0,this.width=0,this.height=0,this.x=e.x||e.left||0,this.y=e.y||e.top||0,this.height=e.height||this.right-this.x||0,this.width=e.width||this.bottom-this.y||0}return Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mid",{get:function(){return{x:this.x+this.width/2,y:this.y+this.height/2}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),e.emptyBounds=function(){return new e({height:0,width:0,x:0,y:0})},e.prototype.containsPoint=function(e){return!(e.x<this.x||e.y<this.y||e.x>this.right||e.y>this.bottom)},e.prototype.encapsulate=function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.right<e.right&&(this.width+=e.right-this.right),this.bottom<e.bottom&&(this.height+=e.bottom-this.bottom),!0},e.prototype.fits=function(e){return this.width===e.width&&this.height===e.height?1:this.width>e.width&&this.height>e.height?2:0},e.prototype.hitBounds=function(e){return!(this.right<e.x||this.x>e.right||this.bottom<e.y||this.y>e.height)},e.prototype.isInside=function(e){return this.x>=e.x&&this.right<=e.right&&this.y>=e.y&&this.bottom<=e.bottom},e.prototype.toString=function(){return"{x: "+this.x+" y:"+this.y+" w:"+this.width+" h:"+this.height+"}"},r([i.observable],e.prototype,"x",void 0),r([i.observable],e.prototype,"y",void 0),r([i.observable],e.prototype,"width",void 0),r([i.observable],e.prototype,"height",void 0),r([i.computed],e.prototype,"area",null),r([i.computed],e.prototype,"bottom",null),r([i.computed],e.prototype,"left",null),r([i.computed],e.prototype,"mid",null),r([i.computed],e.prototype,"right",null),r([i.computed],e.prototype,"top",null),e}();t.Bounds=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR"}(t.InstanceBlockIndex||(t.InstanceBlockIndex={}));!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR"}(t.InstanceAttributeSize||(t.InstanceAttributeSize={}));!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR",e[e.MATRIX3=9]="MATRIX3",e[e.MATRIX4=16]="MATRIX4"}(t.UniformSize||(t.UniformSize={}));!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR"}(t.VertexAttributeSize||(t.VertexAttributeSize={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.key=e.key}return Object.defineProperty(e.prototype,"id",{get:function(){return this.key},enumerable:!0,configurable:!0}),e}();t.IdentifyByKey=r},function(e,n){e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.handleMouseDown=function(e,t){},e.prototype.handleMouseUp=function(e){},e.prototype.handleMouseOver=function(e){},e.prototype.handleMouseOut=function(e){},e.prototype.handleMouseMove=function(e){},e.prototype.handleClick=function(e,t){},e.prototype.handleDrag=function(e,t){},e.prototype.handleWheel=function(e,t){},e}();t.EventManager=r},function(e,t,n){"use strict";function r(e,t){e&&t&&t.forEach(function(n,r){return e[r]=t[r]})}Object.defineProperty(t,"__esModule",{value:!0});var i=0,o=function(){function e(e){this._id=i++,this.offset=[0,0,0],this.scale=[1,1,1],e&&(r(this.offset,e.offset),r(this.scale,e.scale))}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),e.prototype.position=function(e){this.offset=e.slice(0)},e}();t.ChartCamera=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.CONTROLLED=0]="CONTROLLED",e[e.CUSTOM=1]="CUSTOM"}(r=t.ViewCameraType||(t.ViewCameraType={}));var i=function(){function e(){this.type=r.CONTROLLED}return e}();t.ViewCamera=i},function(e,t,n){"use strict";function r(e,t){return e.depth-t.depth}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(3),s=function(e){function t(t){var n=e.call(this,t)||this;return n.container=new o.Scene,n.layers=[],n.sortIsDirty=!1,n.viewById=new Map,n.container.frustumCulled=!1,n}return i(t,e),t.prototype.addLayer=function(e){this.layers.push(e),this.sortIsDirty=!0},t.prototype.addView=function(e){this.viewById.set(e.id,e)},t.prototype.removeLayer=function(e){if(this.layers){var t=this.layers.indexOf(e);if(t>=0)return void this.layers.splice(t,1)}console.warn("Could not remove a layer from the scene as the layer was not a part of the scene to start. Scene:",this.id,"Layer:",e.id)},t.prototype.sortLayers=function(){this.sortIsDirty&&this.layers.sort(r)},t.DEFAULT_SCENE_ID="__default__",t}(a.IdentifyByKey);t.Scene=s},function(e,t,n){"use strict";function r(e){return"left"in e}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(32),a=n(3),s=n(7);!function(e){e[e.COLOR=1]="COLOR",e[e.DEPTH=2]="DEPTH",e[e.STENCIL=4]="STENCIL"}(t.ClearFlags||(t.ClearFlags={}));var c=function(e){function t(t){var n=e.call(this,t)||this;return n.depth=0,Object.assign(n,t),n}return i(t,e),t.prototype.screenToView=function(e,t){var n=t||{x:0,y:0};return n.x=e.x-this.viewBounds.x,n.y=e.y-this.viewBounds.y,n},t.prototype.viewToScreen=function(e,t){var n=t||{x:0,y:0};return n.x=e.x+this.viewBounds.x,n.y=e.y+this.viewBounds.y,n},t.prototype.screenToWorld=function(e,t){var n=this.screenToView(e),r=t||{x:0,y:0};return r.x=(n.x-this.camera.offset[0]*this.camera.scale[0])/this.camera.scale[0],r.y=(n.y-this.camera.offset[1]*this.camera.scale[1])/this.camera.scale[1],this.viewCamera.type===s.ViewCameraType.CUSTOM&&console.warn("Custom View Camera projections not supported yet"),r},t.prototype.worldToScreen=function(e,t){var n=t||{x:0,y:0};return n.x=e.x*this.camera.scale[0]+this.camera.offset[0]*this.camera.scale[0],n.y=e.y*this.camera.scale[1]+this.camera.offset[1]*this.camera.scale[1],this.viewCamera.type===s.ViewCameraType.CUSTOM&&console.warn("Custom View Camera projections not supported yet"),n=this.viewToScreen(n)},t.prototype.viewToWorld=function(e,t){var n=t||{x:0,y:0};return n.x=(e.x-this.camera.offset[0]*this.camera.scale[0])/this.camera.scale[0],n.y=(e.y-this.camera.offset[1]*this.camera.scale[1])/this.camera.scale[1],this.viewCamera.type===s.ViewCameraType.CUSTOM&&console.warn("Custom View Camera projections not supported yet"),n},t.prototype.worldToView=function(e,t){var n=t||{x:0,y:0};return n.x=e.x*this.camera.scale[0]+this.camera.offset[0]*this.camera.scale[0],n.y=e.y*this.camera.scale[1]+this.camera.offset[1]*this.camera.scale[1],this.viewCamera.type===s.ViewCameraType.CUSTOM&&console.warn("Custom View Camera projections not supported yet"),n},t.prototype.fitViewtoViewport=function(e){if(this.viewCamera.type===s.ViewCameraType.CONTROLLED&&r(this.viewCamera.baseCamera)){var t=o.getAbsolutePositionBounds(this.viewport,e),n=t.width,i=t.height,a={bottom:-i/2,far:1e7,left:-n/2,near:-100,right:n/2,top:i/2},c=e.width/t.width,u=e.height/t.height,l=this.viewCamera.baseCamera;Object.assign(this.viewCamera,a),l.position.set(-t.width/2*c,t.height/2*u,l.position.z),l.scale.set(c,-u,1),l.updateMatrix(),l.updateMatrixWorld(!0),this.viewBounds=t,this.viewBounds.data=this}else r(this.viewCamera.baseCamera)||console.warn("Fit to viewport does not support non-orthographic cameras as a default behavior.")},t.DEFAULT_VIEW_ID="__default__",t}(a.IdentifyByKey);t.View=c},function(e,t,n){"use strict";function r(e){return Boolean(e.isMesh)}function i(e,t,n){var i=e.getModelType(),o=new i.modelType(t,n);return r(o)&&(o.drawMode=i.drawMode),o}Object.defineProperty(t,"__esModule",{value:!0}),t.generateLayerModel=i},function(e,t,n){"use strict";function r(e,t,n){var r=new Map,i=new Map,o=new Map,a=new Map,s=e.replace(/\$\{(\w+)\}/g,function(e,n){return a.set(n,(a.get(n)||0)+1),n in t?(r.set(n,(r.get(n)||0)+1),t[n]):(i.set(n,(i.get(n)||0)+1),"")});Object.keys(t).forEach(function(e){r.get(e)||o.set(e,(o.get(e)||0)+1)});var c={resolvedShaderOptions:r,shader:s,shaderProvidedOptions:a,unresolvedProvidedOptions:o,unresolvedShaderOptions:i};return n&&n.values.forEach(function(e){c.unresolvedProvidedOptions.get(e)?console.error(n.name+": Could not resolve all the required inputs. Input:",e):c.unresolvedShaderOptions.get(e)?console.error(n.name+": A required option was not provided in the options parameter. Option:",e):c.resolvedShaderOptions.get(e)||console.error(n.name+": A required option was not provided in the options parameter. Option:",e)}),c}Object.defineProperty(t,"__esModule",{value:!0}),t.shaderTemplate=r},function(e,t,n){"use strict";function r(e){var t=e.canvas.height,n=e.canvas.width,r=n/t,u={aspectRatio:r,bottom:-t/2,far:1e7,left:-n/2,near:-100,right:n/2,top:t/2,viewSize:t},l=new a.ViewCamera;l.baseCamera=new i.OrthographicCamera(u.left,u.right,u.top,u.bottom,u.near,u.far),l.baseCamera.scale.set(1,-1,1),l.baseCamera.position.set(0,0,-300),l.baseCamera.updateMatrixWorld(!0),l.baseCamera.updateMatrix(),l.baseCamera instanceof i.OrthographicCamera&&l.baseCamera.updateProjectionMatrix();var h=new o.ChartCamera,f={bottom:0,left:0,right:0,top:0},d=new c.View({camera:h,key:c.View.DEFAULT_VIEW_ID,viewCamera:l,viewport:f}),p=new s.Scene({key:s.Scene.DEFAULT_SCENE_ID,views:[]});return p.addView(d),{camera:h,scene:p,view:d,viewCamera:l,viewport:f}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(6),a=n(7),s=n(8),c=n(9);t.generateDefaultScene=r},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.emptyBounds=function(){return new t({height:0,width:0,x:0,y:0})},t}(i.Bounds);t.DataBounds=o},function(e,t,n){"use strict";function r(e){return!Array.isArray(e[0])}function i(e,t,n){for(var i=[],a=0,s=t.length;a<s;++a){var c=t[a];i.push(new Float32Array(c.size*n*e))}for(var u,l,h,f,d=t.length,a=0,s=n;a<s;++a)for(var p=0;p<d;++p)if(l=t[p],u=i[p],h=l.update(a),r(h))for(var m=a*l.size,v=m+l.size,y=0;m<v;++m,++y)u[m]=h[y];else f=!0;f&&console.warn("A vertex buffer updating method should not use arrays of arrays of numbers.");for(var a=0,s=t.length;a<s;++a)for(var g=t[a],w=g.size*n,p=1,b=e;p<b;++p)i[a].copyWithin(w*p,0,w);for(var x=i[0],a=0,s=e;a<s;++a)for(var _=a*n,p=0;p<n;++p)x[p+_]=a;for(var C=new o.BufferGeometry,a=0,s=t.length;a<s;++a){var O=t[a],E=new o.BufferAttribute(i[a],O.size);O.materialAttribute=E,C.addAttribute(O.name,E)}return C}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.generateLayerGeometry=i},function(e,t,n){"use strict";function r(e){return{type:s[e.size],value:c[e.size]}}function i(e,t,n,i,a){var s=e.getMaterialOptions();s.vertexShader=t,s.fragmentShader=n,s.uniforms={};for(var c=0,u=i.length;c<u;++c){var l=i[c],h=r(l);s.uniforms[l.name]=h}for(var c=0,u=a.length;c<u;++c){var f=a[c];s.uniforms[f.name]={type:f.type,value:f.value}}return new o.RawShaderMaterial(s)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(2),s=(u={},u[a.UniformSize.ONE]="f",u[a.UniformSize.TWO]="v2",u[a.UniformSize.THREE]="v3",u[a.UniformSize.FOUR]="v4",u[a.UniformSize.MATRIX3]="Matrix3fv",u[a.UniformSize.MATRIX4]="Matrix4fv",u),c=(l={},l[a.UniformSize.ONE]=[0],l[a.UniformSize.TWO]=[0,0],l[a.UniformSize.THREE]=[0,0,0],l[a.UniformSize.FOUR]=[0,0,0,0],l[a.UniformSize.MATRIX3]=[0,0,0,0,0,0,0,0,0],l[a.UniformSize.MATRIX4]=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l);t.generateLayerMaterial=i;var u,l},function(e,t,n){"use strict";function r(e){return Object.assign({},e,{materialAttribute:null})}function i(e){return Object.assign({},e,{materialUniforms:[]})}function o(e){var t=new Map,n=null,r=0;return e.forEach(function(e){var n=e.block,i=e.blockIndex,o=e.size,a=t.get(n);r=Math.max(n,r),a||(a=new Map,t.set(n,a));for(var s=i,c=i+o;s<c;++s)a.set(s,!0)}),t.forEach(function(e,t){e.get(1)||(n=[t,s.InstanceBlockIndex.ONE]),e.get(2)||(n=[t,s.InstanceBlockIndex.TWO]),e.get(3)||(n=[t,s.InstanceBlockIndex.THREE]),e.get(4)||(n=[t,s.InstanceBlockIndex.FOUR])}),n||(n=[r+1,0]),n}function a(e,t){var n=[{name:"projection",size:s.UniformSize.MATRIX4,update:function(){return e.view.viewCamera.baseCamera.projectionMatrix.elements}},{name:"modelView",size:s.UniformSize.MATRIX4,update:function(){return e.view.viewCamera.baseCamera.matrix.elements}},{name:"cameraOffset",size:s.UniformSize.THREE,update:function(){return e.view.camera.offset}},{name:"cameraScale",size:s.UniformSize.THREE,update:function(){return e.view.camera.scale}}],a=o(t.instanceAttributes),c=[{block:a[0],blockIndex:a[1],name:"_active",size:s.InstanceAttributeSize.ONE,update:function(e){return[e.active?1:0]}}],u=[{name:"instance",size:s.VertexAttributeSize.ONE,update:function(){return[0]}}],l=u.concat(t.vertexAttributes).map(r),h=n.concat(t.uniforms).map(i);return{instanceAttributes:c.concat(t.instanceAttributes),uniforms:h,vertexAttributes:l}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(2);t.injectShaderIO=a},function(e,t,n){"use strict";function r(e,t){for(var n={attributeCount:0,attributes:new Array,uniformCount:0,uniforms:new Array},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o={35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT"},a={35664:1,35665:1,35666:1,35667:1,35668:1,35669:1,35670:1,35671:1,35672:1,35673:1,35674:1,35675:3,35676:4,35678:1,35680:1,5120:1,5121:1,5122:1,5123:1,5124:1,5125:1,5126:1},s=0;s<r;++s){var c=e.getActiveUniform(t,s);c.typeName=o[c.type],n.uniforms.push(c),n.uniformCount+=c.size,c.size=c.size*a[c.type]}for(var s=0;s<i;s++){var u=e.getActiveAttrib(t,s);u.typeName=o[u.type],n.attributes.push(u),n.attributeCount+=u.size}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.getProgramInfo=r;var i=function(){function e(){}return e.MAX_VERTEX_UNIFORMS=0,e.MAX_FRAGMENT_UNIFORMS=0,e.MAX_ATTRIBUTES=0,e.WEBGL_SUPPORTED=!1,e.MAX_TEXTURE_SIZE=0,e}();t.WebGLStat=i,function(){var e=function(){try{var e=document.createElement("canvas");return window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(e){return!1}}();e&&(i.WEBGL_SUPPORTED=!0,i.MAX_VERTEX_UNIFORMS=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),i.MAX_FRAGMENT_UNIFORMS=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),i.MAX_ATTRIBUTES=e.getParameter(e.MAX_VERTEX_ATTRIBS),i.MAX_TEXTURE_SIZE=e.getParameter(e.MAX_TEXTURE_SIZE))}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.templateVars={attributeFragments:"attributeFragments",attributes:"attributes",blocksPerInstance:"blocksPerInstance",instanceBlockCount:"instanceBlockCount",instanceDataBinaryTree:"instanceDataBinaryTree",instanceDataRetrieval:"instanceDataRetrieval",instanceDestructuring:"instanceDestructuring",instanceFragments:"instanceFragments",instanceUniformDeclarations:"instanceUniformDeclarations",layerUniforms:"layerUniforms",projectionMethods:"projectionMethods",shader:"shader",shaderInput:"shaderInput",vertexAttributes:"vertexAttributes"}},function(e,t,n){"use strict";function r(){return"instanceData"}function i(e){return""+o+e.toString(31)}Object.defineProperty(t,"__esModule",{value:!0});var o="u";t.makeInstanceUniformNameArray=r,t.makeInstanceUniformNameTree=i},function(e,t,n){"use strict";function r(e,t){return t.data.depth-e.data.depth}Object.defineProperty(t,"__esModule",{value:!0});var i=n(42),o=n(47),a=function(){function e(e,t,n,r){this._waitingForRender=!0,this.context=e,this.setViews(t),this.setControllers(n),this.addContextListeners(r)}return Object.defineProperty(e.prototype,"waitingForRender",{get:function(){return this._waitingForRender},set:function(e){this._waitingForRender=e,e||(this.quadTree=new o.QuadTree(0,0,0,0),this.quadTree.addAll(this.views.map(function(e){return e.bounds}).filter(Boolean)))},enumerable:!0,configurable:!0}),e.prototype.addContextListeners=function(e){var t=this,n=this.context,r=null,o=null;e&&(n.onmousewheel=function(e){var a=i.eventElementPosition(e,n),s=t.makeInteraction(a,o,r),c=t.makeWheel(e);t.controllers.forEach(function(e){e.handleWheel(s,c)}),e.stopPropagation(),e.preventDefault()}),n.onmousemove=function(e){if(!t.waitingForRender){var a=i.eventElementPosition(e,n),s=t.makeInteraction(a,o,r);t.controllers.forEach(function(e){e.handleMouseMove(s)})}},n.onmousedown=function(e){if(!t.waitingForRender){o=i.eventElementPosition(e,n);var a=t.getViewsUnderMouse(o),s=!0,c=Date.now();if(!(a.length<=0)){r=a[0].data;var u=t.makeInteraction(o,o,r),l=o;t.controllers.forEach(function(t){t.handleMouseDown(u,e.button)}),e.stopPropagation(),document.onmousemove=function(e){var a=i.eventElementPosition(e,n),c=t.makeInteraction(a,o,r),u={x:a.x-l.x,y:a.y-l.y},h=t.makeDrag(a,o,l,u);l=a,t.controllers.forEach(function(e){e.handleDrag(c,h)}),s=!1},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null,document.onmouseover=null},document.onmouseover=function(e){var a=i.eventElementPosition(e,n),s=t.makeInteraction(a,o,r);t.controllers.forEach(function(e){e.handleMouseOver(s)}),e.stopPropagation()},n.onmouseup=function(e){var a=i.eventElementPosition(e,n),u=t.makeInteraction(a,o,r);t.controllers.forEach(function(e){e.handleMouseUp(u)}),s&&Date.now()-c<1e3&&t.controllers.forEach(function(t){t.handleClick(u,e.button)})},n.onselectstart=function(){return!1}}}}},e.prototype.getViewsUnderMouse=function(e){var t=this.quadTree.query(e);return t.sort(r),t},e.prototype.makeDrag=function(e,t,n,r){return{screen:{current:e,delta:r,previous:n,start:t}}},e.prototype.makeInteraction=function(e,t,n){var r=this.getViewsUnderMouse(e);return{screen:{mouse:e},start:t&&n&&{mouse:n.view.screenToView(e),view:n.view},target:{mouse:r[0]&&r[0].data.view.screenToView(e),view:r[0]&&r[0].data.view},viewsUnderMouse:r.map(function(t){return{mouse:t.data.view.screenToView(e),view:t.data.view}})}},e.prototype.makeWheel=function(e){var t=i.normalizeWheel(e);return{wheel:[t.x,t.y]}},e.prototype.setControllers=function(e){this.controllers=e},e.prototype.setViews=function(e){this.views=e},e.prototype.destroy=function(){this.quadTree=null,this.context.onmousedown=null,this.context.onmousemove=null},e}();t.MouseEventManager=a},function(e,t,n){(function(r){function i(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function o(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,r)}}function a(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function c(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}t=e.exports=n(45),t.log=a,t.formatArgs=o,t.save=s,t.load=c,t.useColors=i,t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(c())}).call(t,n(44))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(23)),r(n(49)),r(n(50)),r(n(51)),r(n(25)),r(n(24))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.color=e}return e}();t.ColorAtlasResource=r},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.awaitContext=function(e){return r(this,void 0,void 0,function(){var t,n;return i(this,function(r){switch(r.label){case 0:t=e.getContext("2d"),n=0,r.label=1;case 1:return!Boolean(t)&&n<100?[4,new Promise(function(e){return setTimeout(e,10)})]:[3,4];case 2:r.sent(),r.label=3;case 3:return t=e.getContext("2d"),++n,[3,1];case 4:return[2]}})})},e.makeCSS=function(e){return"rgba("+Math.floor(256*e.r)+", "+Math.floor(256*e.g)+", "+Math.floor(256*e.b)+", "+e.opacity+")"},e.render=function(e){return r(this,void 0,void 0,function(){var t,n;return i(this,function(r){switch(r.label){case 0:return t=document.createElement("canvas"),n=t.getContext("2d"),[4,this.awaitContext(t)];case 1:return r.sent(),n?(t.width=2,t.height=2,n.imageSmoothingEnabled=!1,n.fillStyle=this.makeCSS(e.color),n.fillRect(0,0,2,2),e.rasterization.canvas=t,e.rasterization.width=2,e.rasterization.height=2):console.warn("Could not create a canvas 2d context to generate a color for rasterization."),[2,e]}})})},e}();t.ColorRasterizer=o},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var o,a=function(){function e(){}return e.awaitContext=function(){return r(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return o?[3,2]:(o=document.createElement("canvas").getContext("2d"),[4,new Promise(function(e){return setTimeout(e,10)})]);case 1:return e.sent(),[3,0];case 2:return[2]}})})},e.calculateLabelSize=function(e,t){var n=e.label,r=t||e.sampleScale||1,i=this.getLabelRasterizationFontSize(n,r);o.fillStyle="white",o.font=this.makeCSSFont(n,r),o.canvas.width=o.measureText(n.text).width+i,o.canvas.height=2*i,o.fillStyle="white",o.font=this.makeCSSFont(n,r),o.fillText(n.text,i/2,i/4+i);for(var a,s=o.canvas,c=s.width,u=s.height,l=o.getImageData(0,0,c,u).data,h=Number.MAX_SAFE_INTEGER,f=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER,m=Math.min,v=Math.max,y=0;y<c;++y)for(var g=0;g<u;++g){var w=g*(4*c)+4*y;a=l[w],a>0&&(h=m(h,g),f=m(f,y),d=v(d,y),p=v(p,g))}h-=1,p+=2,d+=2,f-=1,h=Math.max(h,0),f=Math.max(f,0),e.rasterization=e.rasterization||{texture:{height:0,width:0},world:{height:0,width:0}},r?e.rasterization.world={height:p-h,width:d-f}:(e.rasterization.texture={height:p-h,width:d-f},e.rasterization.canvas=this.createCroppedCanvas(e,h,f),this.calculateLabelSize(e,1))},e.createCroppedCanvas=function(e,t,n){var r=document.createElement("canvas"),i=r.getContext("2d");if(i){var a=e.rasterization.texture;r.width=a.width,r.height=a.height,i.imageSmoothingEnabled=!1,i.drawImage(o.canvas,n,t,a.width,a.height,0,0,a.width,a.height)}else console.warn("Could not create a canvas 2d context to generate a label's cropped image.");return r},e.getLabelRasterizationFontSize=function(e,t){return e.fontSize*t},e.makeCSSFont=function(e,t){return e.fontWeight+" "+this.getLabelRasterizationFontSize(e,t)+"px "+e.fontFamily},e.render=function(e){return r(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,this.awaitContext()];case 1:return t.sent(),e.label.fontSize>50?(console.warn("Labels only support font sizes up to 50"),[2,e]):(this.calculateLabelSize(e),[2,e])}})})},e}();t.LabelRasterizer=a},function(e,t,n){"use strict";function r(e,t,n){for(var r=t-1,i=0,o=n.length;i<o;++i)e[c[++r]]=n[i]}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(27),s=n(3),c=["x","y","z","w"],u=function(e){function t(n){var r=e.call(this,n)||this;return r.depth=0,r.instanceById=new Map,r.instanceVertexCount=0,r.add=function(e,t){if(t)r.change(e,t);else{var n=r.uniformManager.add(e);e.active=!0,r.update(e,n)}},r.change=function(e,t){t?r.update(e,t):r.add(e,t)},r.remove=function(e,t){t&&(e.active=!1,r.update(e,t),r.uniformManager.remove(e))},r.diffProcessor=(i={},i[a.DiffType.CHANGE]=r.change,i[a.DiffType.INSERT]=r.add,i[a.DiffType.REMOVE]=r.remove,i),r.props=Object.assign({},t.defaultProps||{},n),r;var i}return i(t,e),t.prototype.update=function(e,t){for(var n,i,o,a=t.uniform,s=t.uniformRange[0],c=a.value,u=0,l=this.instanceAttributes.length;u<l;++u)n=this.instanceAttributes[u],i=n.update(e),o=c[s+n.block],r(o,n.blockIndex,i);a.value=c},t.prototype.destroy=function(){},t.prototype.didUpdateProps=function(){},t.prototype.draw=function(){for(var e,t,n=this.props.data.changeList,r=0,i=n.length;r<i;++r){var o=n[r],a=o[0],s=o[1],c=this.uniformManager.getUniforms(a);this.diffProcessor[s](a,c)}this.props.data.resolve();for(var r=0,i=this.uniforms.length-1;r<i;++r)e=this.uniforms[r],t=e.update(e),e.materialUniforms.forEach(function(e){return e.value=t})},t.prototype.getModelType=function(){return{drawMode:o.TrianglesDrawMode,modelType:o.Mesh}},t.prototype.getMaterialOptions=function(){return{}},t.prototype.initShader=function(){return{fs:n(55),instanceAttributes:[],uniforms:[],vertexAttributes:[],vertexCount:0,vs:n(56)}},t.prototype.willUpdateInstances=function(e){},t.prototype.willUpdateProps=function(e){},t.defaultProps={},t}(s.IdentifyByKey);t.Layer=u},function(e,t,n){"use strict";function r(e){return Boolean(e.observe)}Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(4);!function(e){e[e.CHANGE=0]="CHANGE",e[e.INSERT=1]="INSERT",e[e.REMOVE=2]="REMOVE"}(i=t.DiffType||(t.DiffType={}));var a=function(){function e(e){var t=this;this.active=!0,this.instanceDisposers=new Map,this.instanceChanges=new Map,this.instanceById=new Map,this.isChanged=!1,this._changeList=[],this.monitorItem=function(e){return function(n){return t.active&&("update"===n.type?(e.set(n.object,i.CHANGE),t.isChanged=!0):console.warn("Received an update type not supported by monitorItem:",n.type)),n}},this._instances=o.observable(e||[]),r(this._instances)&&(this.listDisposer=o.intercept(this._instances,this.monitorList(this._instances,this.instanceChanges,this.instanceById,this.instanceDisposers)))}return Object.defineProperty(e.prototype,"instances",{get:function(){return this._instances},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"changeList",{get:function(){if(this.active=!1,this.isChanged){var e=[];this.instanceChanges.forEach(function(t,n){e.push([n,t])}),this._changeList=e}return this._changeList},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.listDisposer(),this.instanceDisposers.forEach(function(e){return e()}),this._instances=null,this.instanceChanges.clear(),this._changeList=null},e.prototype.monitorList=function(e,t,n,r){var a=this;return function(e){if(a.active)if("splice"===e.type){for(var s=e.index,c=e.index+e.removedCount;s<c;++s){var u=e.object[s];t.set(u,i.REMOVE),a.isChanged=!0;var l=r.get(u);l&&l()}for(var s=0,c=e.added.length;s<c;++s){var u=e.added[s]=o.observable(e.added[s]);t.set(u,i.INSERT),a.isChanged=!0,n.set(u.id,u),r.set(u,o.intercept(u,a.monitorItem(t)))}}else console.warn("Received an update type not supported by monitorList:",e.type);return e}},e.prototype.resolve=function(){this.instanceById.clear(),this.instanceChanges.clear(),this._changeList=[],this.active=!0},e}();t.DataProvider=a},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=function(){function e(e){this._id=e.id,this.active=e.active}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),r([i.observable],e.prototype,"active",void 0),e}();t.Instance=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(30))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(31)),r(n(57)),r(n(59)),r(n(65)),r(n(2)),r(n(68))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(5)),r(n(12)),r(n(14)),r(n(15)),r(n(10)),r(n(16)),r(n(33)),r(n(26)),r(n(20)),r(n(8)),r(n(9))},function(e,t,n){"use strict";function r(e,t){var n=""+e,r=parseFloat(n);return isNaN(r)?0:n.indexOf("%")>-1?r/100*t:r}function i(e,t){0!==t.width&&0!==t.height||console.warn("An AbsolutePosition evaluated to invalid dimensions.","Please ensure that the object provided and the reference has valid dimensions","to produce dimensions with width and height that are non-zero.","item:",e,"reference:",t.toString());var n,i,a=o.DataBounds.emptyBounds();if(e.width)a.width=r(e.width,t.width),"left"in e?a.x=r(e.left,t.width):"right"in e&&(a.x=t.width-r(e.right,t.width)-a.width);else{var s=r(e.left,t.width);n=t.width-r(e.right,t.width)-s,n<0&&console.warn("An AbsolutePosition evaluated to invalid dimensions.","Please ensure that the object provided and the reference has valid dimensions","to produce dimensions with width and height that are greater than zero.","item:",e,"reference:",t.toString()),a.x=s,a.width=n}if(e.height)a.height=r(e.height,t.height),"top"in e?a.y=r(e.top,t.height):"bottom"in e&&(a.y=t.height-r(e.bottom,t.height)-a.height);else{var c=r(e.top,t.height);i=t.height-r(e.bottom,t.height)-c,n<0&&console.warn("An AbsolutePosition evaluated to invalid dimensions.","Please ensure that the object provided and the reference has valid dimensions","to produce dimensions with width and height that are greater than zero.","item:",e,"reference:",t.toString()),a.y=c,a.height=i}return(0===a.width||0===a.height||isNaN(a.x+a.y+a.width+a.height))&&(a.x=0,a.y=0,a.width=t.width,a.height=t.height),a}Object.defineProperty(t,"__esModule",{value:!0});var o=n(13);t.getAbsolutePositionBounds=i},function(e,t,n){"use strict";function r(e){return Boolean(e.getContext)}function i(e){return Boolean(e.substr)}function o(e){return Boolean(e.canvas)}function a(e,t){return[e,t]}var s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var u=n(0),l=n(1),h=n(34),f=n(12),d=n(14),p=n(15),m=n(10),v=n(16),y=n(20),g=n(8),w=n(9),b=n(13),x=n(48),_=n(22),C=new u.Color(1,1,1);t.createLayer=a;var O=function(){function e(e){this.atlasManager=new _.AtlasManager,this.layers=new Map,this.scenes=new Map,this.sceneViews=[],this.willDisposeLayer=new Map,this.setContext(e.context),this.initGL(e),this.initMouseManager(e),this.initResources(e)}return Object.defineProperty(e.prototype,"gl",{get:function(){return this.context},enumerable:!0,configurable:!0}),e.prototype.addLayer=function(e){return e.id?this.layers.get(e.id)?(console.warn("All layer's ids must be unique per layer manager"),e):(this.layers.set(e.id,e),this.initLayer(e),e):(console.warn("All layers must have an id"),e)},e.prototype.destroy=function(){this.mouseManager.destroy()},e.prototype.draw=function(){for(var e=Array.from(this.scenes.values()),t=0,n=e.length;t<n;++t){var r=e[t],i=Array.from(r.viewById.values()),o=r.layers;r.sortLayers();for(var a=0,s=i.length;a<s;++a){var c=i[a];c.fitViewtoViewport(new l.Bounds({height:this.context.canvas.height,width:this.context.canvas.width,x:0,y:0}));for(var u=0,h=o.length;u<h;++u){var f=o[u];f.view=c,f.draw()}this.drawSceneView(r.container,c)}}this.mouseManager.waitingForRender&&(this.sceneViews.forEach(function(e){e.bounds=new b.DataBounds(e.view.viewBounds),e.bounds.data=e}),this.mouseManager.waitingForRender=!1)},e.prototype.drawSceneView=function(e,t){var n={x:t.viewBounds.left,y:t.viewBounds.top},r=t.viewBounds,i=this.renderer.getSize(),o=t.background;this.context.enable(this.context.SCISSOR_TEST),this.context.scissor(n.x,i.height-n.y-r.height,r.width,r.height),t.background&&this.context.clearColor(o[0],o[1],o[2],o[3]),t.clearFlags?this.context.clear((t.clearFlags.indexOf(w.ClearFlags.COLOR)>-1?this.context.COLOR_BUFFER_BIT:0)|(t.clearFlags.indexOf(w.ClearFlags.DEPTH)>-1?this.context.DEPTH_BUFFER_BIT:0)|(t.clearFlags.indexOf(w.ClearFlags.STENCIL)>-1?this.context.STENCIL_BUFFER_BIT:0)):this.context.clear(this.context.COLOR_BUFFER_BIT|this.context.DEPTH_BUFFER_BIT);var a=this.currentViewport;a&&a.x===n.x&&a.y===n.y&&a.width===r.width&&a.height===r.height||(this.renderer.setViewport(n.x,n.y,r.width,r.height),this.currentViewport={height:r.height,width:r.width,x:n.x,y:n.y}),this.renderer.render(e,t.viewCamera.baseCamera)},e.prototype.initGL=function(e){var t=this;if(!this.context)return void console.error("Can not initialize Layer Surface as a valid GL context was not established.");var n=this.context.canvas,r=n.width,i=n.height;this.renderer=new u.WebGLRenderer({alpha:e.background&&e.background[3]<1,antialias:!0,canvas:n,preserveDrawingBuffer:!0}),this.renderer.autoClear=!1,this.renderer.setFaceCulling(u.CullFaceNone),this.renderer.setSize(r,i),e.background?this.renderer.setClearColor(new u.Color(e.background[0],e.background[1],e.background[2]),e.background[3]):this.renderer.setClearColor(C),this.defaultSceneElements=f.generateDefaultScene(this.context),this.defaultSceneElements.view.background=e.background,this.scenes.set(this.defaultSceneElements.scene.id,this.defaultSceneElements.scene);var o=0;this.sceneViews.push({depth:++o,scene:this.defaultSceneElements.scene,view:this.defaultSceneElements.view}),this.context.enable(this.context.SCISSOR_TEST),e.scenes&&e.scenes.forEach(function(e){var n=new g.Scene(e);0===e.views.length&&(n.addView(t.defaultSceneElements.view),t.sceneViews.push({depth:++o,scene:n,view:t.defaultSceneElements.view})),e.views.forEach(function(e){var r=new w.View(e);r.camera=r.camera||t.defaultSceneElements.camera,r.viewCamera=r.viewCamera||t.defaultSceneElements.viewCamera,r.viewport=r.viewport||t.defaultSceneElements.viewport,n.addView(r),t.sceneViews.push({depth:++o,scene:n,view:r})}),t.scenes.set(e.key,n)})},e.prototype.initLayer=function(e){var t=this.addLayerToScene(e),n=e.initShader(),r=v.injectShaderIO(e,n),i=r.vertexAttributes,o=r.instanceAttributes,a=r.uniforms,s=h.injectFragments(n,i,o,a),c=d.generateLayerGeometry(s.maxInstancesPerBuffer,i,n.vertexCount),u=p.generateLayerMaterial(e,s.vs,s.fs,a,s.materialUniforms),l=m.generateLayerModel(e,c,u);return e.geometry=c,e.instanceAttributes=o,e.instanceVertexCount=n.vertexCount,e.material=u,e.maxInstancesPerBuffer=s.maxInstancesPerBuffer,e.model=l,e.uniforms=a,e.vertexAttributes=i,e.uniformManager=new x.InstanceUniformManager(e,t),e},e.prototype.initMouseManager=function(e){this.mouseManager=new y.MouseEventManager(this.context.canvas,this.sceneViews,e.eventManagers||[],e.handlesWheelEvents)},e.prototype.initResources=function(e){return s(this,void 0,void 0,function(){var t,n,r;return c(this,function(i){switch(i.label){case 0:if(!e.atlasResources)return[3,4];t=0,n=e.atlasResources,i.label=1;case 1:return t<n.length?(r=n[t],[4,this.atlasManager.createAtlas(r)]):[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},e.prototype.addLayerToScene=function(e){var t=this.scenes.get(e.props.scene);return t||(t=this.defaultSceneElements.scene,e.props.scene&&console.warn("Layer specified a scene that is not within the layer surface manager. Layer will be added to the default scene.")),t.addLayer(e),t},e.prototype.removeLayer=function(e){return this.layers.get(e&&e.id)?(e.uniformManager.removeFromScene(),e.destroy(),this.layers.delete(e.id),e):(console.warn("Tried to remove a layer that is not in the manager.",e),e)},e.prototype.render=function(e){var t=this;e&&e.length>0&&e.forEach(function(e){var n=e[0],r=e[1],i=t.layers.get(r.key);i?(i.willUpdateProps(r),Object.assign(i.props,r),i.didUpdateProps()):t.addLayer(new n(Object.assign(r,n.defaultProps))),t.willDisposeLayer.set(r.key,!1)}),this.willDisposeLayer.forEach(function(e,n){e&&t.removeLayer(t.layers.get(n))}),this.willDisposeLayer.clear(),this.layers.forEach(function(e,n){t.willDisposeLayer.set(n,!0)})},e.prototype.setContext=function(e){if(e)if(o(e))this.context=e;else if(r(e))this.context=e.getContext("webgl")||e.getContext("experimental-webgl");else if(i(e)){var t=document.getElementById(e);r(t)&&this.setContext(t)}},e}();t.LayerSurface=O},function(e,t,n){"use strict";function r(e){for(var t=0,n=0,r=e.length;n<r;++n)t+=Math.ceil(e[n].size/4);return t}function i(e,t,n,r){var i=a(t,n,r),s=(f={},f[g.templateVars.projectionMethods]=o(),f[g.templateVars.shaderInput]=i.fragment,f[g.templateVars.shader]=c(e,n,i.metrics.maxInstancesPerBuffer,i.metrics.blocksPerInstance),f),l={name:"vertex shader composition",values:[g.templateVars.projectionMethods,g.templateVars.shaderInput,g.templateVars.shader]},h=v.shaderTemplate(b,s,l);return d={},d[g.templateVars.shader]=u(e),s=d,l={name:"fragment shader composition",values:[g.templateVars.shader]},{fs:v.shaderTemplate(x,s,l).shader,materialUniforms:i.materialUniforms,maxInstancesPerBuffer:i.metrics.maxInstancesPerBuffer,vs:h.shader};var f,d}function o(){var e={},t={name:"projection methods",values:[]};return v.shaderTemplate(O,e,t).shader}function a(e,t,n){var r={},i=d(r,t,n),o=(c={},c[g.templateVars.layerUniforms]=s(n),c[g.templateVars.vertexAttributes]=f(e),c);Object.assign(r,o);var a={name:"shader input",values:[g.templateVars.instanceDataRetrieval,g.templateVars.instanceUniformDeclarations,g.templateVars.layerUniforms,g.templateVars.vertexAttributes]};return{fragment:v.shaderTemplate(C,r,a).shader,materialUniforms:i.materialUniforms,metrics:i.metrics};var c}function s(e){var t="";return e.forEach(function(e){t+="uniform "+(e.qualifier||"")+(e.qualifier?" ":"")+T[e.size]+" "+e.name+";\n"}),t}function c(e,t,n,r){var i={};i[g.templateVars.attributes]=l(t,r);var o={name:"layer vertex shader",values:[g.templateVars.attributes]};return v.shaderTemplate(e.vs,i,o).shader}function u(e){var t={},n={name:"layer fragment shader",values:[]};return v.shaderTemplate(e.fs,t,n).shader}function l(e,t){var n={};n[g.templateVars.blocksPerInstance]=""+t,n[g.templateVars.instanceDestructuring]=h(e,t);var r={name:"instance attributes fragment",values:[g.templateVars.instanceDestructuring]};return v.shaderTemplate(_,n,r).shader}function h(e,t){return w.makeInstanceDestructuringArray(e,t)}function f(e){var t="";return e.forEach(function(e){"position"!==e.name&&(t+="attribute "+T[e.size]+" "+(e.qualifier||"")+(e.qualifier&&" "||"")+e.name+";\n")}),t}function d(e,t,n){var i=y.WebGLStat.MAX_VERTEX_UNIFORMS,o=i-r(n);t.sort(function(e,t){return e.block-t.block});var a=t[0].block,s=0,c=new Map,u=new Map;t.forEach(function(e){e.block!==a&&(a=e.block,s++);var t=e.size,n=c.get(s)||0,r=n+t;if(r>E)return void console.error("An instance attribute was specified that over fills the maximum allowed useage for a block.","\nMax Allowed per block "+E,"\nAttribute: "+e.name+" Block Specified: "+e.block,"\nTotal blocks used with this attribute: "+r);c.set(s,r),e.blockIndex=n;var i=u.get(s)||new Map;if(e.blockIndex+t>E)return void console.error("An instance attribute was specified that would fill indices greater than the block allows.","\nMax index per block "+E,"\nAttribute: "+e.name+" Block Index: "+e.blockIndex+" Size: "+e.size+" Block Index + Size: "+(e.blockIndex+e.size));for(var o=e.blockIndex;o<e.blockIndex+t;++o)if(i.get(o))return void console.error("An instance attribute was specified who's block index overaps another attributes useage","\nMax index per block "+E,"\nAttribute: "+e.name+" Block Index: "+e.blockIndex+" Size: "+e.size+" Block Index + Size: "+(e.blockIndex+e.size));e.block=s});var l=s+1,h=Math.floor(o/l);return{materialUniforms:p(e,h,4,l,t).materialUniforms,metrics:{blocksPerInstance:l,maxInstancesPerBuffer:h}}}function p(e,t,n,r,i){for(var o=[],a=0;a<t;++a)o.push(a);var s=m(t*r,i);return e[g.templateVars.instanceUniformDeclarations]=s.fragment,e[g.templateVars.instanceBlockCount]=""+r,e[g.templateVars.instanceDataRetrieval]=w.makeInstanceRetrievalArray(r),{materialUniforms:s.materialUniforms}}function m(e,t){var n="",r=new Map,i=0;t.forEach(function(e){(r.get(e.block)||new Map).set(e.qualifier,!0),i=Math.max(i,e.block)});var o=new Map;r.forEach(function(e,t){var n=Array.from(e.keys());o.set(t,n.join(" ")+" ")});var a=w.makeUniformArrayDeclaration(e);return n+=a.fragment,n+="\n",{fragment:n,materialUniforms:a.materialUniforms}}Object.defineProperty(t,"__esModule",{value:!0});var v=n(11),y=n(17),g=n(18),w=n(35),b=n(37),x=n(38),_=n(39),C=n(40),O=n(41),E=4,T={1:"float",2:"vec2",3:"vec3",4:"vec4",9:"mat3",16:"mat4"};t.injectFragments=i},function(e,t,n){"use strict";function r(e){return{fragment:"uniform vec4 "+u.makeInstanceUniformNameArray()+"["+e+"];",materialUniforms:[{name:u.makeInstanceUniformNameArray(),type:"4fv",value:new Array(e).fill(0).map(function(){return new s.Vector4(0,0,0,0)})}]}}function i(e){var t={};t[h.templateVars.instanceBlockCount]=""+e;var n={name:"makeInstanceRetrievalArray",values:[h.templateVars.instanceBlockCount]};return l.shaderTemplate(f,t,n).shader}function o(e,t){for(var n="",r=0;r<t;++r)n+="  vec4 block"+r+" = getBlock("+r+", instanceIndex);\n";return e.forEach(function(e){var t=e.block;e.size===c.InstanceAttributeSize.FOUR?n+="  "+p[e.size]+" "+e.name+" = block"+t+";\n":n+="  "+p[e.size]+" "+e.name+" = block"+t+"."+a(e.blockIndex,e.size)+";\n"}),n}function a(e,t){return d.slice(e,e+t).join("")}Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),c=n(2),u=n(19),l=n(11),h=n(18),f=n(36),d=["x","y","z","w"],p={1:"float",2:"vec2",3:"vec3",4:"vec4",9:"mat3",16:"mat4"};t.makeUniformArrayDeclaration=r,t.makeInstanceRetrievalArray=i,t.makeInstanceDestructuringArray=o},function(e,t){e.exports="int instanceSize = ${instanceBlockCount};\n\nvec4 getBlock(int index, int instanceIndex) {\n  return instanceData[(instanceSize * instanceIndex) + index];\n}\n"},function(e,t){e.exports="// This is the vertex shader generated by the system\n${shaderInput}\n${projectionMethods}\n// --------------- Vertex shader provided by the layer -----------------\n${shader}\n"},function(e,t){e.exports="// This is the fragment shader generated by the system\n\n// --------------- The fragment shader provided by the layer ------------------\n${shader}\n"},function(e,t){e.exports="// This is the injected dereferencing of the instance attributes\n  int instanceIndex = int(instance);\n  ${instanceDestructuring}\n\n  // This is a special injected instance attribute. It lets the system\n  // control specific instances ability to draw, which allows the backend\n  // system greater control on how it optimizes draw calls and it's buffers.\n  if (_active == 0.0) {\n    gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Quick exit to prevent any geometry from arising from the instance\n    return;\n  }\n"},function(e,t){e.exports="// When instancing is enabled, it causes a major list of uniforms to be generated\n// it also generates a massive search tree to retrieve the correct unforms in question.\n${instanceUniformDeclarations}\n\n// This is the uniforms provided by the system along with the uniforms created by the layer\n${layerUniforms}\n\n// This is the attributes generated for vertex attributes\n${vertexAttributes}\n\n// This is the methods and set up needed to retrieve a block of data for an instance\n${instanceDataRetrieval}\n"},function(e,t){e.exports="// These are projection methods utilizing the simpler camera breakdown approach\n\nvec3 cameraSpace(vec3 world) {\n  return (world + cameraOffset) * cameraScale;\n}\n\nvec4 clipSpace(vec3 world) {\n  return vec4(((projection * modelView) * vec4(cameraSpace(world), 1.0)).xyz, 1.0);\n}\n"},function(e,t,n){"use strict";function r(e){var t=e,n=0,r=0;return Math.sign(m[0])!==Math.sign(r)&&m.splice(0,m.length,0,0,0,0),n=t.deltaX*p,r=t.deltaY*p*v+m[0]*y+m[1]*g+m[2]*w,m.unshift(r),m.pop(),new l.Vector2(-n,-r)}function i(e){var t=e;return new l.Vector2(t.deltaX,-t.deltaY)}function o(e){var t=e,n=t.deltaX;void 0===n&&(n=void 0!==t.wheelDeltaX?t.wheelDeltaX*f:0);var r=t.deltaY;return void 0===r&&(r=void 0!==t.wheelDeltaY?t.wheelDeltaY*f:(t.wheelDelta||-t.detail)*d),new l.Vector2(-n,-r)}function a(e){var t=e,n=t.deltaX,r=t.deltaY;void 0===n&&(n=void 0!==t.wheelDeltaX?t.wheelDeltaX*f:0),void 0===r&&(r=void 0!==t.wheelDeltaY?t.wheelDeltaY*f:t.wheelDelta||-t.detail);var i=new l.Vector2(n,-r);return i.multiplyScalar(.25),i}function s(e,t){var n=0,r=0,i=0,o=0,a=t||e.nativeEvent.target;if(e||(e=window.event),e.pageX||e.pageY?(n=e.pageX,r=e.pageY):(e.clientX||e.clientY)&&(n=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,r=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),a.offsetParent)do{i+=a.offsetLeft,o+=a.offsetTop,a=a.offsetParent}while(a);return{x:n-i,y:r-o}}Object.defineProperty(t,"__esModule",{value:!0});var c,u=n(43),l=n(0),h=n(21)("CommunicationsView:Mouse"),f=1/30,d=-.25,p=100,m=[0,0,0,0],v=.1,y=.2,g=.2,w=.5;t.normalizeWheel=c,u.firefox?(h("Using mouse wheel for firefox"),t.normalizeWheel=c=r):u.msie&&+u.version>=11?(h("Using mouse wheel for IE 11"),t.normalizeWheel=c=o):u.msedge?(h("Using mouse wheel for MS EDGE"),t.normalizeWheel=c=a):(h("Using mouse wheel for Chrome"),t.normalizeWheel=c=i),t.eventElementPosition=s},function(e,t){e.exports=n},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(e){if(h===clearTimeout)return clearTimeout(e);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function a(){m&&d&&(m=!1,d.length?p=d.concat(p):v=-1,p.length&&s())}function s(){if(!m){var e=i(a);m=!0;for(var t=p.length;t;){for(d=p,p=[];++v<t;)d&&d[v].run();v=-1,t=p.length}d=null,m=!1,o(e)}}function c(e,t){this.fun=e,this.array=t}function u(){}var l,h,f=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(e){h=r}}();var d,p=[],m=!1,v=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new c(e,t)),1!==p.length||m||i(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.prependListener=u,f.prependOnceListener=u,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,n){function r(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function i(e){function n(){if(n.enabled){var e=n,r=+new Date,o=r-(i||r);e.diff=o,e.prev=i,e.curr=r,i=r;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var i=t.formatters[r];if("function"==typeof i){var o=a[c];n=i.call(e,o),a.splice(c,1),c--}return n}),t.formatArgs.call(e,a);(n.log||t.log||console.log.bind(console)).apply(e,a)}}var i;return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=r(e),n.destroy=o,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function a(e){t.save(e),t.names=[],t.skips=[];var n,r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&(e=r[n].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var o=t.instances[n];o.enabled=t.enabled(o.namespace)}}function s(){t.enable("")}function c(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function u(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=i.debug=i.default=i,t.coerce=u,t.disable=s,t.enable=a,t.enabled=c,t.humanize=n(46),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t){function n(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*l;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function r(e){return e>=u?Math.round(e/u)+"d":e>=c?Math.round(e/c)+"h":e>=s?Math.round(e/s)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function i(e){return o(e,u,"day")||o(e,c,"hour")||o(e,s,"minute")||o(e,a,"second")||e+" ms"}function o(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a=1e3,s=60*a,c=60*s,u=24*c,l=365.25*u;e.exports=function(e,t){t=t||{};var o=typeof e;if("string"===o&&e.length>0)return n(e);if("number"===o&&!1===isNaN(e))return t.long?i(e):r(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){"use strict";function r(e,t){var n=[];return t.forEach(function(t){e.find(function(e){return t instanceof e})&&n.push(t)}),n}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1);t.filterQuery=r;var a=function(){function e(e,t){this.TL=null,this.TR=null,this.BL=null,this.BR=null;var n=e.mid;this.TL=new s(e.x,n.x,e.y,n.y,t),this.TR=new s(n.x,e.right,e.y,n.y,t),this.BL=new s(e.x,n.x,n.y,e.bottom,t),this.BR=new s(n.x,e.right,n.y,e.bottom,t)}return e.prototype.destroy=function(){this.TL.destroy(),this.TR.destroy(),this.BL.destroy(),this.BR.destroy(),this.TL=null,this.TR=null,this.BL=null,this.BR=null},e}();t.Quadrants=a;var s=function(){function e(e,t,n,r,i){this.bounds=null,this.children=[],this.depth=0,this.nodes=null,arguments.length>=4?this.bounds=new o.Bounds({height:n-r,width:t-e,x:e,y:n}):this.bounds=new o.Bounds({height:1,width:1,x:0,y:0}),this.depth=i||0}return e.prototype.destroy=function(){this.children=null,this.bounds=null,this.nodes&&(this.nodes.destroy(),this.nodes=null)},e.prototype.add=function(e,t){return e.isInside(this.bounds)?this.doAdd(e):(this.cover(e),this.add(e,t))},e.prototype.addAll=function(e,t){var n=this;t=t||[];var r=Number.MAX_VALUE,i=Number.MAX_VALUE,a=-Number.MAX_VALUE,s=-Number.MAX_VALUE;e.forEach(function(e){e.x<r&&(r=e.x),e.right>a&&(a=e.right),e.bottom>s&&(s=e.bottom),e.y<i&&(i=e.y)}),this.cover(new o.Bounds({height:s-i,width:a-r,x:r,y:i})),e.forEach(function(e,t){return n.doAdd(e)})},e.prototype.cover=function(e){var t=this;if(!e.isInside(this.bounds)){this.bounds.encapsulate(e),this.bounds.x-=1,this.bounds.y-=1,this.bounds.width+=2,this.bounds.height+=4;var n=this.gatherChildren([]);this.nodes&&(this.nodes.destroy(),this.nodes=null),n.forEach(function(e,n){return t.doAdd(e)})}},e.prototype.doAdd=function(e){return this.nodes?e.isInside(this.nodes.TL.bounds)?this.nodes.TL.doAdd(e):e.isInside(this.nodes.TR.bounds)?this.nodes.TR.doAdd(e):e.isInside(this.nodes.BL.bounds)?this.nodes.BL.doAdd(e):e.isInside(this.nodes.BR.bounds)?this.nodes.BR.doAdd(e):(this.children.push(e),!0):e.isInside(this.bounds)?(this.children.push(e),this.children.length>5&&this.depth<10&&this.split(),!0):(isNaN(e.width+e.height+e.x+e.y)?console.error("Child did not fit into bounds because a dimension is NaN",e):0===e.area&&console.error("Child did not fit into bounds because the area is zero",e),!0)},e.prototype.gatherChildren=function(e){return e=e.concat(this.children),this.nodes&&(this.nodes.TL.gatherChildren(e),this.nodes.TR.gatherChildren(e),this.nodes.BL.gatherChildren(e),this.nodes.BR.gatherChildren(e)),e},e.prototype.query=function(e,t){return e instanceof o.Bounds?e.hitBounds(this.bounds)?this.queryBounds(e,[],t):[]:this.bounds.containsPoint(e)?this.queryPoint(e,[],t):[]},e.prototype.queryBounds=function(e,t,n){return this.children.forEach(function(n,r){n.hitBounds(e)&&t.push(n)}),n&&n(this),this.nodes&&(e.hitBounds(this.nodes.TL.bounds)&&this.nodes.TL.queryBounds(e,t,n),e.hitBounds(this.nodes.TR.bounds)&&this.nodes.TR.queryBounds(e,t,n),e.hitBounds(this.nodes.BL.bounds)&&this.nodes.BL.queryBounds(e,t,n),e.hitBounds(this.nodes.BR.bounds)&&this.nodes.BR.queryBounds(e,t,n)),t},e.prototype.queryPoint=function(e,t,n){return this.children.forEach(function(n,r){n.containsPoint(e)&&t.push(n)}),n&&n(this),this.nodes&&(this.nodes.TL.bounds.containsPoint(e)&&this.nodes.TL.queryPoint(e,t,n),this.nodes.TR.bounds.containsPoint(e)&&this.nodes.TR.queryPoint(e,t,n),this.nodes.BL.bounds.containsPoint(e)&&this.nodes.BL.queryPoint(e,t,n),this.nodes.BR.bounds.containsPoint(e)&&this.nodes.BR.queryPoint(e,t,n)),t},e.prototype.split=function(){var e=this.gatherChildren([]);for(this.nodes=new a(this.bounds,this.depth+1),this.children=[];e.length>0;)this.doAdd(e.pop())},e.prototype.visit=function(e){var t=Boolean(e(this));this.nodes&&!t&&(this.nodes.TL.visit(e),this.nodes.TR.visit(e),this.nodes.BL.visit(e),this.nodes.BR.visit(e))},e}();t.Node=s;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(s);t.QuadTree=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(10),o=n(19),a=function(){function e(e,t){this.buffers=[],this.availableClusters=[],this.instanceToCluster=new Map,this.clusterToBuffer=new Map,this.layer=e;var n=0;e.instanceAttributes.forEach(function(e){n=Math.max(e.block,n)}),this.uniformBlocksPerInstance=n+1,this.scene=t}return e.prototype.add=function(e){this.availableClusters.length<=0&&this.makeNewBuffer();var t=this.availableClusters.shift();return t?this.instanceToCluster.set(e,t):console.warn("No valid cluster available for instance added to uniform manager."),t},e.prototype.getUniforms=function(e){return this.instanceToCluster.get(e)},e.prototype.remove=function(e){var t=this.instanceToCluster.get(e);return t&&(this.instanceToCluster.delete(e),this.availableClusters.unshift(t)),t},e.prototype.removeFromScene=function(){var e=this;this.buffers.forEach(function(t,n){e.scene.container.remove(t.model)}),this.scene=null},e.prototype.setScene=function(e){var t=this;this.buffers.forEach(function(e,n){t.scene.container.add(e.model)}),this.scene=e},e.prototype.makeNewBuffer=function(){var e=new r.BufferGeometry;this.layer.vertexAttributes.forEach(function(t){e.addAttribute(t.name,t.materialAttribute)}),e.drawRange.start=0,e.drawRange.count=this.layer.maxInstancesPerBuffer*this.layer.instanceVertexCount;var t=this.layer.material.clone(),n=i.generateLayerModel(this.layer,e,t);n.frustumCulled=!1;var a={activeInstances:[],clusters:[],firstInstance:0,geometry:e,lastInstance:0,material:t,model:n};this.buffers.push(a);var s=0,c=o.makeInstanceUniformNameArray(),u=t.uniforms[c];u.value=u.value.map(function(){return new r.Vector4(0,0,0,0)});for(var l=0,h=this.layer.maxInstancesPerBuffer;l<h;++l){var f={instanceIndex:l,uniform:u,uniformRange:[s,0]};s+=this.uniformBlocksPerInstance,f.uniformRange[1]=s,a.clusters.push(f),this.availableClusters.push(f),this.clusterToBuffer.set(f,a)}for(var l=0,h=this.layer.uniforms.length;l<h;++l){var d=this.layer.uniforms[l];d.materialUniforms.push(t.uniforms[d.name])}this.scene&&this.scene.container.add(a.model)},e}();t.InstanceUniformManager=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.label=e}return e}();t.LabelAtlasResource=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.image=e}return e}();t.ImageAtlasResource=r},function(e,t,n){"use strict";function r(e){var t=!1;return e&&e.isValid&&e.pixelWidth&&e.pixelHeight&&(t=!0),t}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var a=n(22),s=n(1),c=n(52),u=n(23),l=n(24),h=n(25),f=n(54),d=n(21)("webgl-surface:Atlas"),p={aspectRatio:0,atlasBL:{x:0,y:0},atlasBR:{x:0,y:0},atlasReferenceID:"",atlasTexture:null,atlasTL:{x:0,y:0},atlasTR:{x:0,y:0},isValid:!1,pixelHeight:0,pixelWidth:0},m=function(){function e(){this.allAtlas=new Map}return e.prototype.createAtlas=function(e,t){return i(this,void 0,void 0,function(){var n;return o(this,function(r){switch(r.label){case 0:return n=new c.Atlas(e),n.setManager(this),this.allAtlas.set(n.id,n),t?[4,this.updateAtlas(n.id,t)]:[3,2];case 1:r.sent(),r.label=2;case 2:return d("Atlas Created-> %o",n),[2,n]}})})},e.prototype.destroyAtlas=function(e){var t=this.allAtlas.get(e);t&&t.destroy()},e.prototype.setDefaultImage=function(e,t){return e=Object.assign(e,p,{atlasReferenceID:t})},e.prototype.draw=function(e,t){return i(this,void 0,void 0,function(){var n,i,a,c,u,l,h,f,p,m,v,y,g,w;return o(this,function(o){switch(o.label){case 0:return n=e.texture.image,i=e.id,e.registerResource(t)?[4,this.loadImage(t)]:(console.warn("Could not draw resource to the atlas as the resource was not properly registered to the atlas first",e,t),[2,Promise.resolve(!1)]);case 1:return a=o.sent(),a&&r(t.texture)?(c=t.texture,u=new s.Bounds({left:0,right:c.pixelWidth,top:c.pixelHeight,bottom:0}),l={first:c,second:u},l.second.width+=1,l.second.height+=1,h=e.packing,f=h.insert(l),f?(d("Atlas location determined: %o",f),f.nodeImage=c,p=f.nodeDimensions.x/e.width,m=f.nodeDimensions.y/e.height,v=f.nodeDimensions.width/e.width,y=f.nodeDimensions.height/e.height,g=1/e.width,w=new s.Bounds({bottom:1-(m+y),left:p,right:p+v,top:1-m}),c.atlasReferenceID=i,c.atlasBL={x:w.x,y:w.y-w.height},c.atlasBR={x:w.x+w.width-g,y:w.y-w.height},c.atlasTL={x:w.x,y:w.y},c.atlasTR={x:w.x+w.width-g,y:w.y},n.drawImage(a,f.nodeDimensions.x,f.nodeDimensions.y),[2,!0]):(console.error("Could not fit resource into atlas",t),t.texture=this.setDefaultImage(t.texture,i),[2,!1])):(console.error("Could not load resource:",t),t.texture=this.setDefaultImage(t.texture,i),[2,!1])}})})},e.prototype.getAtlasTexture=function(e){return this.allAtlas.get(e)},e.prototype.loadImage=function(e){var t,n=this,r=new f.SubTexture;if(e.texture=r,e instanceof a.ImageAtlasResource){if(e.image.element){var s=e.image.element;return r.pixelWidth=s.width,r.pixelHeight=s.height,r.aspectRatio=s.width/s.height,Promise.resolve(e.image.element)}e.image.path&&(t=e.image.path)}else{if(e instanceof a.LabelAtlasResource)return new Promise(function(r,a){return i(n,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return e.rasterization.canvas?[3,2]:[4,h.LabelRasterizer.render(e)];case 1:n.sent(),n.label=2;case 2:return e.rasterization.canvas?(d("Rasterized label %o",e.rasterization),t=e.rasterization.canvas.toDataURL("image/png")):console.warn("The label was not able to be rasterized"),[2]}})})});if(e instanceof u.ColorAtlasResource)return new Promise(function(r,a){return i(n,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return e.rasterization.canvas?[3,2]:[4,l.ColorRasterizer.render(e)];case 1:n.sent(),n.label=2;case 2:return e.rasterization.canvas?(d("Rasterized color %o",e.rasterization),t=e.rasterization.canvas.toDataURL("image/png")):console.warn("The label was not able to be rasterized"),[2]}})})})}return t?new Promise(function(e,n){var i=new Image;i.onload=function(){r.pixelWidth=i.width,r.pixelHeight=i.height,r.aspectRatio=i.width/i.height,e(i)},i.onerror=function(){e(null)},i.src=t}):Promise.resolve(null)},e.prototype.updateAtlas=function(e,t){return i(this,void 0,void 0,function(){var n,r,i,a;return o(this,function(o){switch(o.label){case 0:if(!(n=this.allAtlas.get(e)))return[3,5];r=0,i=t,o.label=1;case 1:return r<i.length?(a=i[r],[4,this.draw(n,a)]):[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return[3,6];case 5:console.warn("Can not update non-existing atlas:",e,"These resources will not be loaded:",t),o.label=6;case 6:return[2]}})})},e}();t.AtlasManager=m},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(3),a=n(53);!function(e){e[e._2=2]="_2",e[e._4=4]="_4",e[e._8=8]="_8",e[e._16=16]="_16",e[e._32=32]="_32",e[e._64=64]="_64",e[e._128=128]="_128",e[e._256=256]="_256",e[e._512=512]="_512",e[e._1024=1024]="_1024",e[e._2048=2048]="_2048",e[e._4096=4096]="_4096"}(t.AtlasSize||(t.AtlasSize={}));var s=function(e){function t(t){var n=e.call(this,t)||this;n.validResources=new Map;var r=document.createElement("canvas");return r.width=t.width,r.height=t.height,n.texture=new i.Texture(r),n.texture.generateMipmaps=!1,n.texture.premultiplyAlpha=!0,n.packing=new a.PackNode(0,0,t.width,t.height),t.textureSettings&&Object.assign(n.texture,t.textureSettings),n}return r(t,e),t.prototype.invalidateResource=function(e){var t={x:0,y:0};e.texture.aspectRatio=1,e.texture.atlasBL=t,e.texture.atlasBR=t,e.texture.atlasTL=t,e.texture.atlasTR=t,e.texture.atlasReferenceID="",e.texture.pixelWidth=0,e.texture.pixelHeight=0,e.texture.isValid=!1},t.prototype.setManager=function(e){this.manager=e},t.prototype.registerResource=function(e){if(void 0===this.validResources.get(e)){if(!e.texture.isValid)return e.texture.isValid=!0,this.validResources.set(e,!0),!0;console.warn("Atlas Error:",this.id,"Attempted to add a resource to an Atlas that is already a valid resource on another atlas.","Consider Creating a new resource to be loaded into this particular atlas.","Resource:",e)}else console.warn("Atlas Error:",this.id,"A resource was trying to be added to the atlas that has already been added before.","Consider creating a new resource to indicate what you want loaded to the atlas","Resource:",e);return!1},t.prototype.removeResource=function(e){this.validResources.get(e)?(this.validResources.set(e,!1),this.invalidateResource(e)):console.warn("Atlas Error:",this.id,"Attempted to remove a resource that does not exist on this atlas.","or the resource was already considered invalidated on this atlas.","Resource:",e)},t.prototype.destroy=function(){var e=this;this.texture.dispose(),this.validResources.forEach(function(t,n){e.invalidateResource(n)})},t}(o.IdentifyByKey);t.Atlas=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(){function e(e,t,n,i){this.child=[null,null],this.isLeaf=!0,this.nodeImage=null,this.nodeDimensions=new r.Bounds({height:i,width:n,x:e,y:t})}return e.prototype.destroy=function(){this.nodeImage=null,this.child[0]&&this.child[0].destroy(),this.child[1]&&this.child[1].destroy(),this.child[0]=void 0,this.child[1]=void 0},e.prototype.hasChild=function(){return this.child[0]&&!this.child[0].nodeImage?!this.child[0].isLeaf:!(!this.child[1]||this.child[1].nodeImage)&&!this.child[1].isLeaf},e.prototype.insert=function(t){if(!this.isLeaf){var n=this.child[0].insert(t);return null!==n?n:this.child[1].insert(t)}if(this.nodeImage)return null;var r=this.nodeDimensions.fits(t.second);if(0===r)return null;if(1===r)return this;this.isLeaf=!1;var i=t.second.width,o=t.second.height,a=this.nodeDimensions.width-i,s=this.nodeDimensions.height-t.second.height;return a>s?(this.child[0]=new e(this.nodeDimensions.x,this.nodeDimensions.y,i,this.nodeDimensions.height),this.child[1]=new e(this.nodeDimensions.x+i,this.nodeDimensions.y,a,this.nodeDimensions.height)):(this.child[0]=new e(this.nodeDimensions.x,this.nodeDimensions.y,this.nodeDimensions.width,o),this.child[1]=new e(this.nodeDimensions.x,this.nodeDimensions.y+o,this.nodeDimensions.width,s)),this.child[0].insert(t)},e.prototype.remove=function(e){if(this.isLeaf)return this.nodeImage===e&&(this.nodeImage=null,e.atlasReferenceID=null,e.pixelWidth=0,!0);var t=this.child[0].remove(e);return!!t||(t=this.child[1].remove(e),this.child[0].hasChild()||this.child[1].hasChild()||(this.child[0]=null,this.child[1]=null),t)},e}();t.PackNode=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.aspectRatio=1}return e}();t.SubTexture=r},function(e,t){e.exports=""},function(e,t){e.exports="void main() {\n  gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n}"},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(6)),r(n(27)),r(n(28)),r(n(58)),r(n(11)),r(n(7)),r(n(17))},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=function(e){function t(t){var n=e.call(this)||this;return n.offsetFilter=function(e){return e},n.scaleFilter=function(e){return e},Object.assign(n,t),n}return r(t,e),Object.defineProperty(t.prototype,"offset",{get:function(){return this.offsetFilter(this.base.offset)},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.scaleFilter(this.base.scale)},set:function(e){},enumerable:!0,configurable:!0}),t}(i.ChartCamera);t.ReferenceCamera=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(60))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(61)),r(n(64))},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(26),a=n(2),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initShader=function(){return{fs:n(62),instanceAttributes:[{block:0,blockIndex:a.InstanceBlockIndex.ONE,name:"center",size:a.InstanceAttributeSize.TWO,update:function(e){return[e.x,e.y]}},{block:0,blockIndex:a.InstanceBlockIndex.THREE,name:"radius",size:a.InstanceAttributeSize.ONE,update:function(e){return[e.radius]}},{block:0,blockIndex:a.InstanceBlockIndex.FOUR,name:"depth",size:a.InstanceAttributeSize.ONE,update:function(e){return[e.depth]}},{block:1,blockIndex:a.InstanceBlockIndex.ONE,name:"color",size:a.InstanceAttributeSize.FOUR,update:function(e){return e.color}}],uniforms:[{name:"scaleFactor",size:a.UniformSize.ONE,update:function(e){return[1]}},{name:"atlas",size:a.UniformSize.ONE,update:function(e){return[1]}}],vertexAttributes:[{defaults:[0],name:"position",size:a.VertexAttributeSize.THREE,update:function(e){return[0,0,0]}}],vertexCount:1,vs:n(63)}},t.prototype.getModelType=function(){return{modelType:i.Points}},t.prototype.getMaterialOptions=function(){return{blending:i.CustomBlending,blendSrc:i.OneFactor,premultipliedAlpha:!0,transparent:!0}},t}(o.Layer);t.CircleLayer=s},function(e,t){e.exports="precision highp float;\n\nvarying vec4 vertexColor;\nvarying float edgeSharpness;\n\nfloat circle(vec2 coord, float radius){\n  vec2 dist = coord - vec2(0.5);\n\n  return 1.0 - smoothstep(\n    radius - (radius * edgeSharpness),\n    radius + (radius * 0.01),\n    dot(dist, dist) * 4.0\n  );\n}\n\nvoid main() {\n  float step_factor = circle(gl_PointCoord.xy, 1.0);\n  gl_FragColor = mix(\n    vec4(0.0, 0.0, 0.0, 0.0),\n    vertexColor,\n    step_factor\n  );\n}\n"},function(e,t){e.exports="precision highp float;\n\nvarying vec4 vertexColor;\nvarying float edgeSharpness;\n\nvoid main() {\n  ${attributes}\n\n  vertexColor = color;\n  gl_PointSize = radius * 2.0;\n  edgeSharpness = mix(0.8, 0.01, min(gl_PointSize / 45.0, 1.0));\n  gl_Position = clipSpace(vec3(center, depth));\n}\n"},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),a=n(28),s=function(e){function t(t){var n=e.call(this,t)||this;return n.color=[1,1,1,1],n.radius=0,n.x=0,n.y=0,n.depth=0,n.color=t.color,n.radius=t.radius,n.x=t.x,n.y=t.y,n.depth=t.depth,n}return r(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return 2*this.radius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return 2*this.radius},enumerable:!0,configurable:!0}),i([o.observable],t.prototype,"color",void 0),i([o.observable],t.prototype,"radius",void 0),i([o.observable],t.prototype,"x",void 0),i([o.observable],t.prototype,"y",void 0),i([o.observable],t.prototype,"depth",void 0),i([o.computed],t.prototype,"width",null),i([o.computed],t.prototype,"height",null),t}(a.Instance);t.CircleInstance=s},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(66)),r(n(67))},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.handleMouseDown=function(e,t){console.warn("MOUSE DOWN",e,t)},t.prototype.handleMouseUp=function(e){console.warn("MOUSE UP",e)},t.prototype.handleMouseOver=function(e){console.warn("MOUSE OVER",e)},t.prototype.handleMouseOut=function(e){console.warn("MOUSE OUT",e)},t.prototype.handleMouseMove=function(e){console.warn("MOUSE MOVE",e)},t.prototype.handleClick=function(e,t){console.warn("CLICK",e,t)},t.prototype.handleDrag=function(e,t){console.warn("DRAG",e,t)},t}(i.EventManager);t.LogController=o},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=function(e){function t(t){var n=e.call(this)||this;return n.camera=t.camera,n.scaleFactor=t.scaleFactor||1e3,n.startViews=Array.isArray(t.startView)?t.startView:[t.startView],n}return r(t,e),t.prototype.handleDrag=function(e,t){this.canStart(e.start.view.id)&&(this.camera.offset[0]+=t.screen.delta.x/this.camera.scale[0],this.camera.offset[1]+=t.screen.delta.y/this.camera.scale[1])},t.prototype.handleWheel=function(e,t){if(this.canStart(e.target.view.id)){var n=e.target.view.screenToWorld(e.screen.mouse),r=this.camera.scale[0]||1;this.camera.scale[0]=r+t.wheel[1]/this.scaleFactor*r;var i=this.camera.scale[1]||1;this.camera.scale[1]=i+t.wheel[1]/this.scaleFactor*i;var o=e.target.view.screenToWorld(e.screen.mouse);this.camera.offset[0]-=n.x-o.x,this.camera.offset[1]-=n.y-o.y}},t.prototype.canStart=function(e){return!this.startViews||0===this.startViews.length||this.startViews&&this.startViews.indexOf(e)>-1},t}(i.EventManager);t.BasicCameraController=o},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(1)),r(n(69))},function(e,t,n){"use strict";function r(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.add=function(e,t,n){return n?(n.x=e.x+t.x,n.y=e.y+t.y,n):{x:e.x+t.x,y:e.y+t.y}},e.getClosest=function(e,t){var n,i=Number.MAX_VALUE,o=null,a=function(t){(n=r(t,e))<i&&(i=n,o=t)};return t.forEach(a),o},e.getClosestIndex=function(e,t){var n,i=Number.MAX_VALUE,o=0,a=function(t,a){(n=r(t,e))<i&&(i=n,o=a)};return t.forEach(a),o},e.subtract=function(e,t,n){void 0===n&&(n=!1);var r=t.x-e.x,i=t.y-e.y;if(n){var o=Math.sqrt(r*r+i*i);r/=o,i/=o}return{x:r,y:i}},e.getDistance=function(e,t,n){return void 0===n&&(n=!1),n?r(e,t):Math.sqrt(r(e,t))},e.getMidpoint=function(t,n){var r=e.subtract(t,n);return{x:r.x/2+t.x,y:r.y/2+t.y}},e.make=function(e,t){return{x:e,y:t}},e.scale=function(e,t,n){return n?(n.x=e.x*t,n.y=e.y*t,n):{x:e.x*t,y:e.y*t}},e.zero=function(){return{x:0,y:0}},e}();t.Point=i}])});