{"version":3,"sources":["webpack://network-bubble-chart/webpack/universalModuleDefinition","webpack://network-bubble-chart/webpack/bootstrap","webpack://network-bubble-chart/./src/types.ts","webpack://network-bubble-chart/./src/util/index.ts","webpack://network-bubble-chart/./src/instance-provider/index.ts","webpack://network-bubble-chart/./node_modules/debug/src/browser.js","webpack://network-bubble-chart/./src/util/vector.ts","webpack://network-bubble-chart/./src/primitives/bounds.ts","webpack://network-bubble-chart/./src/surface/layer.ts","webpack://network-bubble-chart/./src/instance-provider/instance.ts","webpack://network-bubble-chart/./src/gl/index.ts","webpack://network-bubble-chart/./src/gl/gl-settings.ts","webpack://network-bubble-chart/./src/base-layers/types.ts","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Bounds.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Color.js","webpack://network-bubble-chart/./src/shaders/processing/index.ts","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Length.js","webpack://network-bubble-chart/./src/primitives/index.ts","webpack://network-bubble-chart/./src/surface/layer-processing/layer-buffer-type.ts","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Util.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/NodeContainer.js","webpack://network-bubble-chart/./src/resources/texture/sub-texture.ts","webpack://network-bubble-chart/./src/surface/buffer-management/buffer-manager-base.ts","webpack://network-bubble-chart/./src/gl/texture.ts","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/background.js","webpack://network-bubble-chart/./src/resources/texture/pack-node.ts","webpack://network-bubble-chart/./src/resources/index.ts","webpack://network-bubble-chart/./src/surface/layer-processing/generate-layer-model.ts","webpack://network-bubble-chart/./src/util/identify-by-key.ts","webpack://network-bubble-chart/./src/instance-provider/observable.ts","webpack://network-bubble-chart/./src/gl/webgl-stat.ts","webpack://network-bubble-chart/./src/gl/types.ts","webpack://network-bubble-chart/./src/util/uid.ts","webpack://network-bubble-chart/./src/surface/layer-processing/base-io-expansion.ts","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Feature.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/TextContainer.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/listStyle.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/drawing/Vector.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/drawing/Path.js","webpack://network-bubble-chart/./src/resources/base-resource-manager.ts","webpack://network-bubble-chart/./src/surface/buffer-management/uniform-buffering/uniform-buffer-manager.ts","webpack://network-bubble-chart/./src/util/shader-templating.ts","webpack://network-bubble-chart/./src/surface/view.ts","webpack://network-bubble-chart/./src/surface/layer-scene.ts","webpack://network-bubble-chart/./src/surface/layer-surface.ts","webpack://network-bubble-chart/./src/resources/texture/atlas.ts","webpack://network-bubble-chart/./src/resources/texture/texture-io-expansion.ts","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/ListItem.js","webpack://network-bubble-chart/./node_modules/css-line-break/dist/Util.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/border.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/textDecoration.js","webpack://network-bubble-chart/./src/base-layers/edges/types.ts","webpack://network-bubble-chart/./src/surface/buffer-management/uniform-buffering/uniform-diff-processor.ts","webpack://network-bubble-chart/./src/surface/buffer-management/instance-attribute-buffering/instance-attribute-diff-processor.ts","webpack://network-bubble-chart/./src/constants.ts","webpack://network-bubble-chart/./src/gl/scene.ts","webpack://network-bubble-chart/./src/gl/gl-decode.ts","webpack://network-bubble-chart/./src/util/view-camera.ts","webpack://network-bubble-chart/./src/util/chart-camera.ts","webpack://network-bubble-chart/./src/surface/event-manager.ts","webpack://network-bubble-chart/./src/base-layers/labels/glyph-layer.ts","webpack://network-bubble-chart/./src/base-layers/labels/glyph-instance.ts","webpack://network-bubble-chart/./src/surface/mouse-event-manager.ts","webpack://network-bubble-chart/./src/surface/layer-processing/generate-layer-material.ts","webpack://network-bubble-chart/./src/surface/layer-processing/generate-layer-geometry.ts","webpack://network-bubble-chart/./src/util/camera.ts","webpack://network-bubble-chart/./src/surface/layer-processing/generate-default-scene.ts","webpack://network-bubble-chart/./src/shaders/processing/shader-module-unit.ts","webpack://network-bubble-chart/./src/shaders/processing/shader-module.ts","webpack://network-bubble-chart/./src/surface/layer-processing/inject-shader-io.ts","webpack://network-bubble-chart/./src/resources/texture/atlas-resource-request.ts","webpack://network-bubble-chart/./src/resources/texture/atlas-resource-manager.ts","webpack://network-bubble-chart/./src/resources/texture/image-rasterizer.ts","webpack://network-bubble-chart/./src/resources/texture/atlas-manager.ts","webpack://network-bubble-chart/./src/resources/text/font-resource-request.ts","webpack://network-bubble-chart/./src/shaders/processing/base-shader-io-injection.ts","webpack://network-bubble-chart/./src/resources/text/glyph-renderer.ts","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Proxy.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Font.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Unicode.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/renderer/ForeignObjectRenderer.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/TextBounds.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Input.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/textTransform.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/position.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/overflowWrap.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/padding.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Logger.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/renderer/CanvasRenderer.js","webpack://network-bubble-chart/./src/resources/text/font-renderer.ts","webpack://network-bubble-chart/./src/resources/text/font-map.ts","webpack://network-bubble-chart/./src/resources/text/font-manager.ts","webpack://network-bubble-chart/./src/util/data-bounds.ts","webpack://network-bubble-chart/./src/primitives/absolute-position.ts","webpack://network-bubble-chart/./src/surface/buffer-management/base-diff-processor.ts","webpack://network-bubble-chart/./src/util/emit-once.ts","webpack://network-bubble-chart/./src/util/easing-props.ts","webpack://network-bubble-chart/./src/instance-provider/instance-provider.ts","webpack://network-bubble-chart/./src/gl/webgl-renderer.ts","webpack://network-bubble-chart/./src/gl/model.ts","webpack://network-bubble-chart/./src/gl/material.ts","webpack://network-bubble-chart/./src/gl/render-target.ts","webpack://network-bubble-chart/./src/gl/gl-state.ts","webpack://network-bubble-chart/./src/gl/gl-proxy.ts","webpack://network-bubble-chart/./src/gl/geometry.ts","webpack://network-bubble-chart/./src/gl/attribute.ts","webpack://network-bubble-chart/./src/util/next-frame.ts","webpack://network-bubble-chart/./src/util/matrix.ts","webpack://network-bubble-chart/./src/util/mouse.ts","webpack://network-bubble-chart/./src/shaders/template-vars.ts","webpack://network-bubble-chart/./src/shaders/util/extend-shader.ts","webpack://network-bubble-chart/./src/util/auto-easing-method.ts","webpack://network-bubble-chart/./src/util/common-options.ts","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/no-op.fs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/no-op.vs","webpack://network-bubble-chart/./src/shaders/base-modules/util-modules.ts","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/no-picking.fs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/no-picking.vs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/picking.fs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/picking.vs","webpack://network-bubble-chart/./src/shaders/base-modules/picking.ts","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/fsin.vs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/fcos.vs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/arc.vs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/bezier2.vs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/bezier1.vs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/constants/to-radians.vs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/constants/to-degrees.vs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/constants/pi2.vs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/constants/pi.vs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/constants/pi_4.vs","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/constants/pi_2.vs","webpack://network-bubble-chart/./src/shaders/base-modules/math-modules.ts","webpack://network-bubble-chart/./src/shaders/base-modules/instancing.ts","webpack://network-bubble-chart/./src/shaders/base-modules/frame-metrics.ts","webpack://network-bubble-chart/./src/shaders/base-modules/shader-fragments/projection.vs","webpack://network-bubble-chart/./src/shaders/base-modules/camera-metrics.ts","webpack://network-bubble-chart/./src/shaders/base-modules/index.ts","webpack://network-bubble-chart/./src/shaders/index.ts","webpack://network-bubble-chart/./src/surface/index.ts","webpack://network-bubble-chart/./src/base-layers/rings/ring-layer.vs","webpack://network-bubble-chart/./src/base-layers/rings/ring-layer.fs","webpack://network-bubble-chart/./src/base-layers/rings/ring-layer.ts","webpack://network-bubble-chart/./src/base-layers/rings/ring-instance.ts","webpack://network-bubble-chart/./src/base-layers/rings/index.ts","webpack://network-bubble-chart/./src/base-layers/rectangle/rectangle-instance.ts","webpack://network-bubble-chart/./src/base-layers/rectangle/rectangle-layer.vs","webpack://network-bubble-chart/./src/base-layers/rectangle/rectangle-layer.fs","webpack://network-bubble-chart/./src/base-layers/rectangle/rectangle-layer.ts","webpack://network-bubble-chart/./src/base-layers/rectangle/index.ts","webpack://network-bubble-chart/./src/base-layers/labels/label-instance.ts","webpack://network-bubble-chart/./src/base-layers/labels/glyph-layer-always.vs","webpack://network-bubble-chart/./src/base-layers/labels/glyph-layer-always.fs","webpack://network-bubble-chart/./src/base-layers/labels/glyph-layer-never.vs","webpack://network-bubble-chart/./src/base-layers/labels/glyph-layer-never.fs","webpack://network-bubble-chart/./src/base-layers/labels/glyph-layer-bound-max.vs","webpack://network-bubble-chart/./src/base-layers/labels/glyph-layer-bound-max.fs","webpack://network-bubble-chart/./src/base-layers/labels/label-layer.ts","webpack://network-bubble-chart/./src/base-layers/labels/index.ts","webpack://network-bubble-chart/./src/base-layers/images/image-instance.ts","webpack://network-bubble-chart/./src/base-layers/images/image-layer.vs","webpack://network-bubble-chart/./src/base-layers/images/image-layer.fs","webpack://network-bubble-chart/./src/base-layers/images/image-render-layer.ts","webpack://network-bubble-chart/./src/util/quad-tree.ts","webpack://network-bubble-chart/./src/surface/layer-processing/base-io-expanders/easing-io-expansion.ts","webpack://network-bubble-chart/./src/surface/layer-processing/base-io-expanders/basic-io-expansion.ts","webpack://network-bubble-chart/./src/surface/event-managers/layer-mouse-events.ts","webpack://network-bubble-chart/./src/surface/base-io-sorting.ts","webpack://network-bubble-chart/./src/util/color-picking-analysis.ts","webpack://network-bubble-chart/./src/surface/layer-processing/base-io-expanders/fragments/active-attribute-handler.vs","webpack://network-bubble-chart/./src/surface/layer-processing/base-io-expanders/active-io-expansion.ts","webpack://network-bubble-chart/./src/surface/layer-interaction-handler.ts","webpack://network-bubble-chart/./src/shaders/processing/metrics-processing.ts","webpack://network-bubble-chart/./src/surface/layer-processing/pack-attributes.ts","webpack://network-bubble-chart/./src/shaders/processing/shader-processor.ts","webpack://network-bubble-chart/./src/gl/debug-resources.ts","webpack://network-bubble-chart/./src/resources/texture/index.ts","webpack://network-bubble-chart/./src/resources/text/font-resource-manager.ts","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/PseudoNodeContent.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/ResourceLoader.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Clone.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Angle.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Gradient.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Renderer.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/drawing/Circle.js","webpack://network-bubble-chart/./node_modules/css-line-break/dist/linebreak-trie.js","webpack://network-bubble-chart/./node_modules/css-line-break/dist/Trie.js","webpack://network-bubble-chart/./node_modules/css-line-break/dist/LineBreak.js","webpack://network-bubble-chart/./node_modules/css-line-break/dist/index.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/zIndex.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/word-break.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/visibility.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/transform.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/textShadow.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/overflow.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/margin.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/lineBreak.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/letterSpacing.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/font.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/float.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/display.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/parsing/borderRadius.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/drawing/BezierCurve.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/drawing/Size.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/StackingContext.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/NodeParser.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/Window.js","webpack://network-bubble-chart/./node_modules/html2canvas/dist/npm/index.js","webpack://network-bubble-chart/./src/resources/text/cpu-sdf.ts","webpack://network-bubble-chart/./src/resources/text/index.ts","webpack://network-bubble-chart/./src/resources/resource-manager.ts","webpack://network-bubble-chart/./src/base-layers/images/image-layer.ts","webpack://network-bubble-chart/./src/base-layers/images/index.ts","webpack://network-bubble-chart/./src/base-layers/edges/edge-instance.ts","webpack://network-bubble-chart/./src/base-layers/edges/shader/edge-layer.fs","webpack://network-bubble-chart/./src/base-layers/edges/shader/edge-layer-screen-curve.vs","webpack://network-bubble-chart/./src/base-layers/edges/shader/edge-layer.vs","webpack://network-bubble-chart/./src/base-layers/edges/shader/edge-layer-bezier2.vs","webpack://network-bubble-chart/./src/base-layers/edges/shader/edge-layer-bezier.vs","webpack://network-bubble-chart/./src/base-layers/edges/shader/edge-layer-line.vs","webpack://network-bubble-chart/./src/base-layers/edges/edge-picking.ts","webpack://network-bubble-chart/./src/base-layers/edges/edge-layer.ts","webpack://network-bubble-chart/./src/base-layers/edges/index.ts","webpack://network-bubble-chart/./src/base-layers/circles/circle-instance.ts","webpack://network-bubble-chart/./src/base-layers/circles/circle-layer.vs","webpack://network-bubble-chart/./src/base-layers/circles/circle-layer.fs","webpack://network-bubble-chart/./src/primitives/point.ts","webpack://network-bubble-chart/./src/base-layers/circles/circle-layer.ts","webpack://network-bubble-chart/./src/base-layers/circles/index.ts","webpack://network-bubble-chart/./src/base-layers/arcs/arc-instance.ts","webpack://network-bubble-chart/./src/base-layers/arcs/arc-layer.fs","webpack://network-bubble-chart/./src/base-layers/arcs/arc-layer-screen-space.vs","webpack://network-bubble-chart/./src/base-layers/arcs/arc-layer.vs","webpack://network-bubble-chart/./src/surface/buffer-management/uniform-buffering/uniform-quad-diff-processor.ts","webpack://network-bubble-chart/./src/surface/buffer-management/uniform-buffering/uniform-color-diff-processor.ts","webpack://network-bubble-chart/./src/surface/buffer-management/instance-attribute-buffering/instance-attribute-quad-diff-processor.ts","webpack://network-bubble-chart/./src/surface/buffer-management/instance-attribute-buffering/instance-attribute-color-diff-processor.ts","webpack://network-bubble-chart/./src/surface/buffer-management/instance-attribute-packed-buffering/instance-attribute-packing-buffer-manager.ts","webpack://network-bubble-chart/./src/surface/buffer-management/instance-attribute-buffering/instance-attribute-buffer-manager.ts","webpack://network-bubble-chart/./src/surface/buffer-management/instance-diff-manager.ts","webpack://network-bubble-chart/./src/instance-provider/basic-instance.ts","webpack://network-bubble-chart/./node_modules/ms/index.js","webpack://network-bubble-chart/./node_modules/debug/src/debug.js","webpack://network-bubble-chart/./node_modules/process/browser.js","webpack://network-bubble-chart/./src/base-layers/arcs/arc-layer.ts","webpack://network-bubble-chart/./src/base-layers/arcs/index.ts","webpack://network-bubble-chart/./src/base-layers/index.ts","webpack://network-bubble-chart/./src/util/easing-util.ts","webpack://network-bubble-chart/./src/util/tracked-quad-tree.ts","webpack://network-bubble-chart/./src/util/reference-camera.ts","webpack://network-bubble-chart/./src/util/normalize-wheel/ExecutionEnvironment.js","webpack://network-bubble-chart/./src/util/normalize-wheel/isEventSupported.js","webpack://network-bubble-chart/./src/util/normalize-wheel/UserAgent_DEPRECATED.js","webpack://network-bubble-chart/./src/util/normalize-wheel/normalizeWheel.ts","webpack://network-bubble-chart/./src/util/normalize-wheel/index.ts","webpack://network-bubble-chart/./src/util/extend-shader-io.ts","webpack://network-bubble-chart/./src/util/animation-helper.ts","webpack://network-bubble-chart/./src/base-event-managers/basic-camera-controller.ts","webpack://network-bubble-chart/./src/base-event-managers/index.ts","webpack://network-bubble-chart/./src/util/webgl2-type-shim.ts","webpack://network-bubble-chart/./src/index.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","InstanceAttributeSize","InstanceBlockIndex","instanceAttributeSizeFloatCount","_a","ONE","TWO","THREE","FOUR","ATLAS","UniformSize","VertexAttributeSize","TextureSize","ResourceType","isResourceAttribute","val","Boolean","resource","ShaderInjectionTarget","NOOP","whiteSpaceRegEx","whiteSpaceCharRegEx","isWhiteSpace","test","bind","newLineRegEx","newLineCharRegEx","isNewline","createMaterialOptions","options","PickType","InstanceDiffType","__export","process","load","storage","debug","e","env","DEBUG","log","console","Function","apply","arguments","formatArgs","args","useColors","this","namespace","humanize","diff","color","splice","index","lastC","replace","match","save","namespaces","removeItem","type","navigator","userAgent","toLowerCase","document","documentElement","style","WebkitAppearance","firebug","exception","table","parseInt","RegExp","$1","chrome","local","localStorage","localstorage","colors","formatters","j","v","JSON","stringify","err","message","enable","sqrt","Math","max","min","floor","ceil","add1","left","right","ceil1","vec","compare1","copy1","divide1","top","bottom","flatten1","list","out","iMax","length","push","floor1","inverse1","scale1","scale","subtract1","max1","min1","multiply1","dot1","linear1","start","end","t","length1","add2","ceil2","copy2","compare2","divide2","flatten2","floor2","inverse2","max2","min2","scale2","subtract2","multiply2","dot2","linear2","length2","add3","ceil3","copy3","compare3","divide3","flatten3","floor3","inverse3","scale3","subtract3","multiply3","linear3","length3","dot3","max3","min3","add4","ceil4","copy4","compare4","divide4","flatten4","floor4","inverse4","scale4","subtract4","multiply4","dot4","linear4","length4","max4","min4","isVec1","Array","isArray","isVec2","isVec3","isVec4","vec1","values","_i","slice","next","vec2","vec3","vec4","vec1Methods","add","copy","compare","divide","dot","flatten","inverse","linear","multiply","subtract","vec2Methods","vec3Methods","vec4Methods","VecMath","Bounds","x","y","width","height","emptyBounds","containsPoint","point","encapsulate","item","abs","fits","bounds","hitBounds","isInside","toString","observable_1","types_1","util_1","identify_by_key_1","instance_diff_manager_1","Layer","_super","props","_this","animationEndTime","depth","instanceAttributes","instanceVertexCount","lastFrameTime","needsViewDrawn","uniforms","_uid","uid","vertexAttributes","willRebuildLayer","assign","defaultProps","picking","NONE","ALL","pickingMethods","getInstancePickingMethods","currentPickMode","hitTest","quadTree","TrackedQuadTree","boundsAccessor","SINGLE","uidToInstance","Map","__extends","_bufferManager","_bufferType","baseShaderModules","shaderIO","additionalImportsVS","additionalImportsFS","find","check","easing","fs","vs","childLayers","destroy","bufferManager","scene","removeLayer","removeFromScene","didUpdateProps","draw","change","instance","bufferLocations","changeList","data","diffManager","processing","processor","incomingChangeList","getBufferLocations","changes","commit","changesProcessed","resolve","id","updateUniforms","getInstanceObservableIds","properties","ObservableMonitoring","setObservableMonitor","propertyIds","getObservableMonitorIds","undefined","Error","getMaterialOptions","initShader","vertexCount","makeInstanceAttribute","block","blockIndex","size","update","makeUniform","shaderInjection","qualifier","managesInstance","rebuildLayer","children","resolveChanges","preserveProvider","setBufferManager","warn","InstanceDiffManager","makeProcessor","setBufferType","shouldDrawView","oldProps","newProps","key","uniform","materialUniforms","forEach","materialUniform","willUpdateInstances","_changes","willUpdateProps","_newProps","IdentifyByKey","easing_props_1","instanceUID","Instance","_easing","observableStorage","newUID","_id","active","_observer","oldObserver","clear","remove","clearEasing","easingId","getEasing","attributeName","EasingProps","resourceTrigger","__decorate","observable","GLSettings","RenderTarget","ColorBufferFormat","DepthBufferFormat","StencilBufferFormat","Material","Blending","BlendingDstFactor","BlendingSrcFactor","BlendingEquations","DepthFunctions","CullSide","Model","DrawMode","Texture","TextureBindingTarget","Wrapping","TextureMinFilter","TextureMagFilter","SourcePixelFormat","TexelDataType","PackAlignment","UnpackAlignment","Renderer","ReadFilter","ReadTargetArrayFormat","AnchorType","ScaleMode","parseBoundCurves","calculatePaddingBoxPath","calculateBorderBoxPath","parsePathForBorder","parseDocumentSize","calculateContentBox","calculatePaddingBox","parseBounds","_createClass","defineProperties","target","descriptor","writable","Constructor","protoProps","staticProps","_Vector2","_interopRequireDefault","_BezierCurve2","obj","default","w","h","TypeError","_classCallCheck","clientRect","scrollX","scrollY","createPathFromCurves","node","fromClientRect","getBoundingClientRect","borders","borderWidth","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","body","scrollWidth","offsetWidth","clientWidth","scrollHeight","offsetHeight","clientHeight","curves","borderSide","topLeftOuter","topLeftInner","topRightOuter","topRightInner","bottomRightOuter","bottomRightInner","bottomLeftOuter","bottomLeftInner","outer1","inner1","outer2","inner2","path","subdivide","reverse","CORNER","borderRadius","HALF_WIDTH","HALF_HEIGHT","tlh","TOP_LEFT","getAbsoluteValue","tlv","trh","TOP_RIGHT","trv","brh","BOTTOM_RIGHT","brv","blh","BOTTOM_LEFT","blv","topWidth","rightHeight","bottomWidth","leftHeight","getCurvePoints","r1","r2","position","kappa","ox","oy","xm","ym","_slicedToArray","arr","Symbol","iterator","_arr","_n","_d","_e","_s","done","sliceIterator","HEX3","hex3","HEX6","hex6","substring","RGB","rgb","Number","RGBA","rgba","fromArray","array","namedColor","NAMED_COLORS","Color","_ref","_ref2","g","b","a","transparent","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","TRANSPARENT","calculateLengthFromValueWithUnit","LENGTH_TYPE","PX","PERCENTAGE","Length","substr","parsedValue","parseFloat","isNaN","parentLength","isPercentage","container","unit","font","fontSize","getRootFontSize","parent","LayerBufferType","webgl_stat_1","instance_attribute_buffer_manager_1","instance_attribute_packing_buffer_manager_1","uniform_buffer_manager_1","getLayerBufferType","_gl","layer","UNIFORM","attributesUsed","bufferType","WebGLStat","HARDWARE_INSTANCING","attribute","MAX_VERTEX_ATTRIBUTES","INSTANCE_ATTRIBUTE_PACKING","INSTANCE_ATTRIBUTE","makeLayerBufferManager","gl","InstanceAttributeBufferManager","InstanceAttributePackingBufferManager","UniformBufferManager","contains","bit","distance","copyCSSStyles","setProperty","getPropertyValue","SMALL_IMAGE","_Color2","_Util","_background","_border","_borderRadius","_display","_float","_font","_letterSpacing","_lineBreak","_listStyle","_margin","_overflow","_overflowWrap","_padding","_position","_textDecoration","_textShadow","_textTransform","_transform","_visibility","_wordBreak","_zIndex","_Bounds","_Input","_ListItem","INPUT_TAGS","NodeContainer","resourceLoader","tagName","childNodes","listItems","listStart","defaultView","ownerDocument","pageXOffset","pageYOffset","getComputedStyle","display","parseDisplay","IS_INPUT","parsePosition","background","INPUT_BACKGROUND","parseBackground","border","INPUT_BORDERS","parseBorder","HTMLInputElement","getInputBorderRadius","parseBorderRadius","INPUT_COLOR","float","parseCSSFloat","parseFont","letterSpacing","parseLetterSpacing","listStyle","DISPLAY","LIST_ITEM","parseListStyle","lineBreak","parseLineBreak","margin","parseMargin","opacity","overflow","indexOf","parseOverflow","OVERFLOW","HIDDEN","overflowWrap","parseOverflowWrap","wordWrap","parsePadding","textDecoration","parseTextDecoration","textShadow","parseTextShadow","textTransform","parseTextTransform","transform","parseTransform","visibility","parseVisibility","wordBreak","parseWordBreak","zIndex","parseZIndex","POSITION","STATIC","isTransformed","listOwner","getListOwner","listIndex","hasAttribute","addEventListener","curvedBounds","image","getImage","reformatInputBounds","parentClips","getClipPaths","VISIBLE","concat","isRootElement","isFloating","isAbsolutelyPositioned","VISIBILITY","RELATIVE","FLOAT","isPositioned","auto","INLINE","INLINE_BLOCK","INLINE_FLEX","INLINE_GRID","INLINE_LIST_ITEM","INLINE_TABLE","SVGSVGElement","XMLSerializer","loadImage","encodeURIComponent","serializeToString","img","currentSrc","src","canvas","loadCanvas","iframeKey","getAttribute","bounds_1","subTextureIOValue","texture","atlasTL","atlasBR","SubTexture","aspectRatio","atlasTR","atlasBL","heightOnAtlas","isValid","pixelWidth","pixelHeight","textureReferenceID","widthOnAtlas","fromRegion","source","region","ux","uy","uw","uh","atlasDimensions","sub","isBufferLocation","buffer","isBufferLocationGroup","propertyToBufferLocation","BufferManagerBase","changeListContext","gl_settings_1","_flipY","_format","_generateMipmaps","_magFilter","Linear","_minFilter","LinearMipMapLinear","needsDataUpload","needsPartialDataUpload","needsSettingsUpdate","_packAlignment","_premultiplyAlpha","_type","UnsignedByte","_unpackAlignment","_updateRegions","_wrapHorizontal","CLAMP_TO_EDGE","_wrapVertical","_anisotropy","_data","dispose","proxy","disposeTexture","parseBackgroundImage","calculateBackgroundRepeatPath","calculateBackgroundPosition","calculateBackgroungPositioningArea","calculateBackgroungPaintingArea","calculateGradientBackgroundSize","calculateBackgroundSize","BACKGROUND_ORIGIN","BACKGROUND_CLIP","BACKGROUND_SIZE","BACKGROUND_REPEAT","_Length2","_Size2","REPEAT","NO_REPEAT","REPEAT_X","REPEAT_Y","AUTO","CONTAIN","COVER","LENGTH","BORDER_BOX","PADDING_BOX","CONTENT_BOX","BackgroundSize","AUTO_SIZE","backgroundImage","targetRatio","currentRatio","parseBackgroundClip","clip","backgroundOrigin","paddingBox","PADDING_SIDES","LEFT","RIGHT","TOP","BOTTOM","backgroundPositioningArea","repeat","round","backgroundColor","parseBackgroundImages","backgroundClip","parseBackgroundOrigin","sources","map","method","positions","backgroundPosition","split","repeats","backgroundRepeat","sizes","backgroundSize","trim","parseBackgroundSize","parseBackgoundPosition","parseBackgroundRepeat","whitespace","results","quote","definition","mode","numParen","appendResult","prefix","prefix_i","PackNode","child","isLeaf","child0","child1","hasChild","insert","newNode","fitFlag","imgWidth","imgHeight","dWidth","dHeight","removed","applyToSubTexture","flipY","gl_1","generateLayerModel","geometry","material","drawMode","model","TRIANGLE_STRIP","_key","uid_1","enabled","gatherIds","observableIds","observableNamesToUID","propertyUID","set","newVal","observer","instanceUpdated","getProgramInfo","program","result","attributeCount","attributes","uniformCount","activeUniforms","getProgramParameter","ACTIVE_UNIFORMS","activeAttributes","ACTIVE_ATTRIBUTES","enums","35664","35665","35666","35667","35668","35669","35670","35671","35672","35673","35674","35675","35676","35678","35680","5120","5121","5122","5123","5124","5125","5126","blocks","getActiveUniform","typeName","getActiveAttrib","MAX_VERTEX_UNIFORMS","MAX_FRAGMENT_UNIFORMS","WEBGL_SUPPORTED","MAX_TEXTURE_SIZE","HARDWARE_INSTANCING_ANGLE","createElement","WebGLRenderingContext","getContext","getAContext","getParameter","MAX_VERTEX_UNIFORM_VECTORS","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_VERTEX_ATTRIBS","getExtension","initStats","MaterialUniformType","isUniformVec2","VEC2","isUniformVec3","VEC3","isUniformVec4","VEC4","isUniformVec4Array","VEC4_ARRAY","isUniformMat3","MATRIX3x3","isUniformMat4","MATRIX4x4","isUniformTexture","TEXTURE","isUniformFloat","UID","CUID","colorUID","BaseIOExpansion","expand","_layer","_instanceAttributes","_vertexAttributes","_uniforms","validate","processHeaderInjection","_target","_declarations","_metrics","injection","processAttributeDestructuring","BaseShaderIOInjection","_ForeignObjectRenderer","isGreenPixel","FEATURES","SUPPORT_RANGE_BOUNDS","createRange","range","testElement","TEST_HEIGHT","appendChild","selectNode","rangeBounds","rangeHeight","removeChild","testRangeBounds","SUPPORT_SVG_DRAWING","Image","ctx","drawImage","toDataURL","testSVG","SUPPORT_BASE64_DRAWING","_value","Promise","onload","onerror","complete","setTimeout","testBase64","SUPPORT_FOREIGNOBJECT_DRAWING","from","fetch","fillStyle","fillRect","greenImageSrc","svg","createForeignObjectSVG","loadSerializedSVG","then","getImageData","reject","catch","testForeignObject","SUPPORT_CORS_IMAGES","crossOrigin","SUPPORT_RESPONSE_TYPE","XMLHttpRequest","responseType","SUPPORT_CORS_XHR","_TextBounds","TextContainer","text","parseTextBounds","CAPITALIZE","TEXT_TRANSFORM","LOWERCASE","capitalize","UPPERCASE","toUpperCase","p1","p2","parseListStyleType","LIST_STYLE_TYPE","LIST_STYLE_POSITION","INSIDE","OUTSIDE","DISC","CIRCLE","SQUARE","DECIMAL","CJK_DECIMAL","DECIMAL_LEADING_ZERO","LOWER_ROMAN","UPPER_ROMAN","LOWER_GREEK","LOWER_ALPHA","UPPER_ALPHA","ARABIC_INDIC","ARMENIAN","BENGALI","CAMBODIAN","CJK_EARTHLY_BRANCH","CJK_HEAVENLY_STEM","CJK_IDEOGRAPHIC","DEVANAGARI","ETHIOPIC_NUMERIC","GEORGIAN","GUJARATI","GURMUKHI","HEBREW","HIRAGANA","HIRAGANA_IROHA","JAPANESE_FORMAL","JAPANESE_INFORMAL","KANNADA","KATAKANA","KATAKANA_IROHA","KHMER","KOREAN_HANGUL_FORMAL","KOREAN_HANJA_FORMAL","KOREAN_HANJA_INFORMAL","LAO","LOWER_ARMENIAN","MALAYALAM","MONGOLIAN","MYANMAR","ORIYA","PERSIAN","SIMP_CHINESE_FORMAL","SIMP_CHINESE_INFORMAL","TAMIL","TELUGU","THAI","TIBETAN","TRAD_CHINESE_FORMAL","TRAD_CHINESE_INFORMAL","UPPER_ARMENIAN","DISCLOSURE_OPEN","DISCLOSURE_CLOSED","parseListStylePosition","listStyleImage","listStyleType","listStylePosition","_Path","Vector","PATH","VECTOR","BEZIER_CURVE","BaseResourceManager","getIOExpansion","setAttributeContext","_attribute","InvalidResourceManager","resources","initResource","dequeueRequests","getResource","resourceKey","request","_instance","_resource","INVALID_RESOURCE_MANAGER","constants_1","generate_layer_model_1","buffer_manager_base_1","isUniformBufferLocation","buffers","availableClusters","instanceToCluster","clusterToBuffer","makeNewBuffer","cluster","pop","maxUniformBlock","uniformBlocksPerInstance","getActiveAttributePropertyId","getInstanceCount","getUpdateAllPropertyIdList","setScene","newGeometry","Geometry","materialAttribute","addAttribute","newMaterial","clone","newModel","vertexDrawRange","maxInstancesPerBuffer","activeInstances","clusters","firstInstance","lastInstance","uniformIndex","uniformName","uniformBufferInstanceBufferName","instanceData","fakeAttribute","bufferAttribute","Attribute","Float32Array","instanceIndex","shaderTemplate","templateOptions","shader","required","onError","onToken","matched","noValueProvided","notFound","shaderOptions","shaderResults","_x","keys","option","resolvedShaderOptions","shaderProvidedOptions","unresolvedProvidedOptions","unresolvedShaderOptions","require","msg","error","absolute_position_1","camera_1","view_camera_1","isOrthographic","projectionType","CameraProjectionType","ORTHOGRAPHIC","ClearFlags","View","needsDraw","optimizeRendering","pixelRatio","devicePixelRatio","toAssign","screenToPixelSpace","pixelSpaceToScreen","screenToView","viewBounds","viewToScreen","screenToWorld","view","world","camera","offset","viewCamera","ViewCameraType","CUSTOM","worldToScreen","screen","viewToWorld","worldToView","fitViewtoViewport","surfaceDimensions","CONTROLLED","baseCamera","getAbsolutePositionBounds","viewport","far","near","projectionOptions","screenBounds","DEFAULT_VIEW_ID","scene_1","sortByDepth","LayerScene","Scene","layers","sortIsDirty","viewById","addLayer","addView","sortLayers","sort","DEFAULT_SCENE_ID","debug_resources_1","webgl_renderer_1","resources_1","atlas_resource_manager_1","shader_processor_1","layer_interaction_handler_1","active_io_expansion_1","types_2","color_picking_analysis_1","data_bounds_1","vector_1","base_io_sorting_1","layer_mouse_events_1","basic_io_expansion_1","easing_io_expansion_1","generate_default_scene_1","generate_layer_geometry_1","generate_layer_material_1","layer_buffer_type_1","layer_scene_1","mouse_event_manager_1","view_1","DEFAULT_IO_EXPANSION","BasicIOExpansion","ActiveIOExpansion","EasingIOExpansion","DEFAULT_RESOURCE_MANAGEMENT","manager","AtlasResourceManager","FONT","FontResourceManager","DEFAULT_BACKGROUND_COLOR","createLayer","layerClass","LayerSurface","frameMetrics","currentFrame","currentTime","Date","now","frameDuration","previousTime","isBufferingResources","ioExpanders","ioSorting","BaseIOSorting","scenes","sceneViews","willDisposeLayer","viewDrawDependencies","loadReady","loadReadyResolve","context","layerId","initLayer","delete","time","frameIncrement","onViewReady","validLayers","erroredLayers","pickingPassByView","views","k","endk","pickingPass","endj","overlapViews","errors","passed","stack","singleMessage_1","errorCount_1","attr","render","initializer","resourceManager","mouseManager","sceneView","renderer","pickingTarget","analyzePickRendering","queuedPicking","mouse","Uint8Array","pickWidth","readPixels","pickHeight","pickingData","analyzeColorPickingRendering","interactions","colorPicking","toPick","drawSceneView","updateColorPick","sent","waitingForRender","DataBounds","didBuffer","resolveContext","drawPicking","flushDebug","flags","clearFlags","COLOR","DEPTH","setRenderTarget","setScissor","clearColor","setViewport","STENCIL","gatherViewDrawDependencies","endi","sourceView","targetView","getViewSize","viewId","getViewWorldBounds","topLeft","bottomRight","init","initGL","initMouseManager","initResources","initIOExpanders","hasContext","WebGLRenderer","alpha","antialias","preserveDrawingBuffer","premultipliedAlpha","onNoContext","setWebGLRenderer","generateMipMaps","DEPTH_COMPONENT16","setRendererSize","setPixelRatio","setClearColor","sceneViewDepth","sceneOptions","newScene","defaultSceneElement","generateDefaultScene","viewOptions","newView","ioExpansion","managerIOExpanders","surface","addLayerToScene","LayerInteractionHandler","filter","shaderMetrics","ShaderProcessor","generateLayerGeometry","generateLayerMaterial","printShader","eventManagers","LayerMouseEvents","MouseEventManager","handlesWheelEvents","ResourceManager","resourceManagers","setManager","_b","expandLayerChildren","initializers","updateLayer","sync","index_1","generateLayer","preventChildren","layerInitializers","existingLayer","fitContainer","_pixelRatio","parentElement","className","setAttribute","containerBox","box","resize","setSize","updateColorPickRange","texture_1","pack_node_1","sub_texture_1","createAtlas","__assign","isAtlasResource","Atlas","resourceReferences","validResources","Set","textureSettings","packing","createTexture","invalidateTexture","zero","premultiplyAlpha","_isValid","useResource","subtexture","count","stopUsingResource","resolveResources","toRemove","ref","base_io_expansion_1","emptyTexture","TextureIOExpansion","resourceType","atlasInstanceAttributes","requestedTextureInjections","isTextureAttribute","FRAGMENT","injections","VERTEX","instanceAttribute","foundError","declarations","setDeclaration","createCounterText","inlineListItemElement","_NodeContainer2","_TextContainer2","_Unicode","ancestorTypes","ROMAN_UPPER","wrapper","innerWidth","textAlign","MARGIN_TOP","styleImage","createTextNode","fromTextNode","integers","createAdditiveCounter","symbols","fallback","suffix","reduce","string","integer","createCounterStyleWithSymbolResolver","codePointRangeLength","isNumeric","resolver","createCounterStyleFromRange","codePointRangeStart","codePointRangeEnd","codePoint","fromCodePoint","createCounterStyleFromSymbols","createCJKCounter","numbers","multipliers","negativeSign","tmp","digit","coefficient","appendSuffix","defaultSuffix","cjkSuffix","koreanSuffix","CJK_TEN_COEFFICIENTS","CJK_ZEROS","toCodePoints","str","codePoints","charCodeAt","extra","String","codeUnits","fromCharCode","chars","lookup","decode","base64","bufferLength","len","encoded1","encoded2","encoded3","encoded4","ArrayBuffer","bytes","polyUint16Array","polyUint32Array","_i2","BORDER_SIDES","BORDER_STYLE","SOLID","SIDES","side","borderColor","borderStyle","parseBorderStyle","TEXT_DECORATION_LINE","TEXT_DECORATION","TEXT_DECORATION_STYLE","DOUBLE","DOTTED","DASHED","WAVY","UNDERLINE","OVERLINE","LINE_THROUGH","BLINK","parseLine","line","textDecorationLine","parseTextDecorationLine","textDecorationColor","textDecorationStyle","parseTextDecorationStyle","EdgeScaleType","EdgeType","EdgeBroadphase","base_diff_processor_1","EMPTY","UniformDiffProcessor","addInstance","_propIds","uniformCluster","changeInstance","updateInstance","removeInstance","uniformRangeStart","instanceUniform","activeAttribute","BaseDiffProcessor","DiffMode","InstanceAttributeDiffProcessor","diffMode","PARTIAL","bufferAttributeUpdateRange","bufferAttributeWillUpdate","updateInstancePartial","newBufferLocations","propIds","location","updateValue","updateRange","childLocations","attributeChangeUID","propertyToLocation","packUID","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","updateInstanceFull","updates","FULL","activeAttributeName","models","LINES","LINE_LOOP","LINE_STRIP","POINTS","TRIANGLES","TRIANGLE_FAN","texelFormat","format","Alpha","ALPHA","DepthComponent","DEPTH_COMPONENT","DepthStencil","DEPTH_STENCIL","Luminance","LUMINANCE","LuminanceAlpha","LUMINANCE_ALPHA","inputImageFormat","Byte","BYTE","Float","HalfFloat","Int","INT","Short","SHORT","UNSIGNED_BYTE","UnsignedInt","UNSIGNED_INT","UnsignedShort","UNSIGNED_SHORT","UnsignedShort_4_4_4_4","UNSIGNED_SHORT_4_4_4_4","UnsignedShort_5_5_5_1","UNSIGNED_SHORT_5_5_5_1","UnsignedShort_5_6_5","UNSIGNED_SHORT_5_6_5","magFilter","isPowerOf2","LINEAR","Nearest","NEAREST","minFilter","hasMipMaps","LINEAR_MIPMAP_LINEAR","LinearMipMapNearest","LINEAR_MIPMAP_NEAREST","NearestMipMapLinear","NEAREST_MIPMAP_LINEAR","NearestMipMapNearest","NEAREST_MIPMAP_NEAREST","colorBufferFormat","RGB565","RGB5_A1","RGBA4","depthBufferFormat","stencilBufferFormat","STENCIL_INDEX8","wrapMode","MIRRORED_REPEAT","indexToColorAttachment","extensions","isSingleBuffer","COLOR_ATTACHMENT0","glExt","drawBuffers","WebGL2RenderingContext","COLOR_ATTACHMENT1","COLOR_ATTACHMENT2","COLOR_ATTACHMENT3","COLOR_ATTACHMENT4","COLOR_ATTACHMENT5","COLOR_ATTACHMENT6","COLOR_ATTACHMENT7","COLOR_ATTACHMENT8","COLOR_ATTACHMENT9","COLOR_ATTACHMENT10","COLOR_ATTACHMENT11","COLOR_ATTACHMENT12","COLOR_ATTACHMENT13","COLOR_ATTACHMENT14","COLOR_ATTACHMENT15","COLOR_ATTACHMENT0_WEBGL","COLOR_ATTACHMENT1_WEBGL","COLOR_ATTACHMENT2_WEBGL","COLOR_ATTACHMENT3_WEBGL","COLOR_ATTACHMENT4_WEBGL","COLOR_ATTACHMENT5_WEBGL","COLOR_ATTACHMENT6_WEBGL","COLOR_ATTACHMENT7_WEBGL","COLOR_ATTACHMENT8_WEBGL","COLOR_ATTACHMENT9_WEBGL","COLOR_ATTACHMENT10_WEBGL","COLOR_ATTACHMENT11_WEBGL","COLOR_ATTACHMENT12_WEBGL","COLOR_ATTACHMENT13_WEBGL","COLOR_ATTACHMENT14_WEBGL","COLOR_ATTACHMENT15_WEBGL","indexToTextureUnit","TEXTURE0","textureUnitToIndex","ViewCamera","chartCameraUID","applyArray","ChartCamera","_offset","_scale","_needsViewDrawn","setId","setOffset","setScale","EventManager","getProjection","getView","getViewScreenBounds","setMouseManager","instance_provider_1","layer_1","GlyphLayer","glyphRequests","animate","animateAnchor","anchor","animateColor","animateOffset","animateOrigin","origin","vertexInfo","0","1","2","3","4","5","glyphTextureAttr","char","character","fontRequest","fontMap","onReady","FontResourceRequestFetch","TEXCOORDS","glyphSizeAttr","parentAttribute","IMAGE_SIZE","childAttributes","scaleMode","ALWAYS","BOUND_MAX","NEVER","attributeNames","fontScale","vertex","CommonMaterialOptions","transparentImageBlending","depthTest","InstanceProvider","GlyphInstance","glyph","mouse_1","quad_tree_1","isDefined","controllers","eventCleanup","_waitingForRender","getViewsUnderMouse","hitViews","query","setViews","setControllers","addContextListeners","QuadTree","addAll","startView","element","startPosition","wheelHandler","event","eventElementPosition","interaction","makeInteraction","wheel","makeWheel","controller","handleWheel","stopPropagation","preventDefault","onwheel","onmouseleave","handleMouseOut","onmousemove","handleMouseMove","onmousedown","downViews","canClick","clickStartTime","currentPosition","handleMouseDown","button","delta","drag","makeDrag","handleDrag","onmouseup","_event","onmouseover","handleMouseOver","handleMouseUp","handleClick","experiemental","onselectstart","addTouchContextListeners","ontouchstart","ontouchend","ontouchmove","ontouchcancel","previous","current","viewsUnderMouse","normalizeWheel","pixelX","pixelY","experimental","onmousewheel","removeEventListener","UNIFORM_SIZE_TO_MATERIAL_TYPE","MATRIX3","MATRIX4","DEFAULT_UNIFORM_VALUE","toMaterialUniform","layerUniforms","instancingUniforms","materialParams","materialOptions","vertexShader","fragmentShader","generatedUniform","isNumberCluster","vertexBuffers","attribute_1","formatError","instanceSize","endk_1","copyWithin","instancingBuffer","instanceStartIndex","attribute_3","matrix_1","isPerspective","PERSPECTIVE","Camera","_projection","identity4","_view","_needsUpdate","_rotation","_projectionOptions","force","updateProjection","updateTransform","orthographic4x4","perspective4x4","fov","multiply4x4","scale4x4by3","translation4x4by3","chart_camera_1","viewSize","defaultCamera","defaultChartCamera","defaultViewport","defaultScene","LOCKED_MODULE_UNIT_MESSAGE","ShaderModuleUnit","_dependents","_content","_isLocked","_moduleId","_compatibility","isLocked","applyAnalyzedContent","content","dependents","lock","shader_module_unit_1","debugModuleVS","debugModuleFS","isUnitCompatible","compatibility","ShaderModule","register","out_1","output","isFSCompatible","isVSCompatible","isFinal","analyzeDependents","dependentSet","templateResults","token","trimmedToken","afterToken","moduleContentFound_1","moduleIds","mod","has","additionalModules","shaderModuleUnits","included","debugTarget","modifedShader","imports_1","tempShaderModuleUnit","join","queueIndex","unshift","circularPath","shift","checkCircularDependency","includedModuleContent","moduleContent","pack_attributes_1","isInstanceAttribute","isVertexAttribute","isUniform","toVertexAttributeInternal","toUniformInternal","injectShaderIO","sortIO","importResults","moduleInstanceAttributes","moduleUniforms","moduleVertexAttributes","uniformNames","instanceAttributeNames","vertexAttributeNames","gatherIOFromShaderModules","expansion","extraIO","validateInstanceAttributes","allInstanceAttributes","allVertexAttributes","allUniforms","sortInstanceAttributes","sortUniforms","sortVertexAttributes","packAttributes","atlasRequest","base_resource_manager_1","atlas_1","atlas_manager_1","texture_io_expansion_1","targetAtlas","requestQueue","requestLookup","atlasManager","AtlasManager","didDequeue","resourceRequestsWithKey","requests","allRequests","this_1","updateAtlas","atlasRequests_1","requesters","disposeResource","nextFrame","triggered","resourceRequestsWithKey_1","getAtlasTexture","atlas","resourceContext","atlasRequests","existingRequests","ImageRasterizer","awaitContext","calculateImageSize","resizeImage","ImageData","putImageData","image_rasterizer_1","ZERO_IMAGE","allAtlas","destroyAtlas","atlasName","setDefaultImage","atlasReferenceID","loadedImage","isValidImage","rect","dimensions","insertedNode","repackResources","resourceId","subTexture","HTMLImageElement","rasterizationScale","HTMLVideoElement","dataURL_1","_atlas","promises","all","debugMessageCtx","renderGlyph","clearRect","fillText","imageData","found","minY","minX","maxX","maxY","measureBlackWhiteCanvasContents","glyphWidth","glyphHeight","Proxy","_Feature2","xhr","XDomainRequest","status","response","reader","FileReader","readAsDataURL","responseText","open","imageTimeout","timeout","ontimeout","send","FontMetrics","_document","span","fontFamily","verticalAlign","baseline","offsetTop","lineHeight","middle","_parseMetrics","breakWords","_cssLineBreak","breaker","LineBreaker","OVERFLOW_WRAP","BREAK_WORD","words","bk","ForeignObjectRenderer","logger","windowWidth","windowHeight","xmlns","createElementNS","foreignObject","setAttributeNS","TextBounds","getWrapperBounds","textList","parentNode","textBounds","getRangeBounds","replacementNode","splitText","cloneNode","replaceChild","firstChild","setStart","setEnd","inlineSelectElement","inlineTextAreaElement","inlineInputElement","_Circle2","INPUT_BORDER_COLOR","INPUT_BACKGROUND_COLOR","INPUT_BORDER","RADIO_BORDER_RADIUS","RADIO_BORDER_RADIUS_TUPLE","INPUT_RADIO_BORDER_RADIUS","CHECKBOX_BORDER_RADIUS","CHECKBOX_BORDER_RADIUS_TUPLE","INPUT_CHECKBOX_BORDER_RADIUS","inlineFormElement","checked","getInputValue","selectedIndex","allowLinebreak","whiteSpace","placeholder","ABSOLUTE","FIXED","STICKY","NORMAL","Logger","_len","_len2","_key2","addColorStops","gradient","canvasGradient","maxStop","colorStops","colorStop","stop","f","addColorStop","CanvasRenderer","translate","textBaseline","clipPaths","callback","restore","destination","fill","_path","_this2","beginPath","moveTo","lineTo","bezierCurveTo","startControl","endControl","arc","radius","PI","closePath","linearGradient","createLinearGradient","direction","x1","y1","x0","y0","_this3","center","radialGradient","createRadialGradient","midX","midY","invF","imageSize","offsetX","offsetY","createPattern","textShadows","_this4","fontStyle","fontVariant","fontWeight","shadowColor","shadowOffsetX","shadowOffsetY","shadowBlur","blur","fontMetrics","getMetrics","rectangle","globalAlpha","matrix","html2canvas","glyph_renderer_1","stringToPairs","existing","pairs","neighbors","spaceWidth","FontRenderer","makeBitmapGlyphs","glyphs","fontString","uniqueGlyphs","glyphIndex","estimateKerning","includeSpace","pairInfo","calculateSpace","contextWidth","maxColumns","cellWidth","cellHeight","tableLayout","innerHeight","currentPair","columnIndex","remainingSpace","tr","currentRow","remaining","td","pair","leftStr","rightStr","leftSpan","rightSpan","innerText","rowSpacer","mins","testSpaceCharacterWidth","doSpaceCheck","testChar","innerHTML","getElementsByTagName","config","logging","pixel","canvasHeight","canvasWidth","min_1","exact","min_2","rightLetters","renderEachPair","FontMapGlyphType","FontMap","dynamic","glyphMap","kerning","fontSource","characters","doRegisterGlyph","fontMapSize","_1024","makeGlyphTypeTextureSettings","glyphType","addCachedKerning","family","getKerningCacheName","localKerningCache","cachedKerningStr","getItem","cachedKerning","parse","totalKernsLoaded","rights","rightKerning","addKerning","hasNew","kerningCache","setItem","tex","oneChar","findMissingCharacters","newCharacters","missing","allMissing","getGlyphTexture","getGlyphKerning","leftChar","rightChar","getGlyphWidth","stringLayout","startOffset","endOffset","getTruncatedLayout","layout","truncation","maxWidth","fontRenderer","truncatedText","truncationWidth","cursor","charIndex","char_1","lastChar","firstTruncChar","getStringLayout","getStringWidth","param1","param2","firstChar","endOfFirst","endOfLast","lastGlyph","kern","currentWidth","whiteSpacing","whiteSpaceCount","BITMAP","SDF","MSDF","registerGlyph","supportsKerning","primitives_1","font_map_1","font_renderer_1","FontGlyphRenderSize","isFontResource","createFont","FontManager","fontMaps","calculateMetrics","metrics","characterFilterToCharacters","createFontMap","resourceOptions","characterFilter","isSimpleFontMetrics","updateFontMapCharacters","updateFontMap","allPairs","allCharacters","req","kerningPairs","i_1","iMax_1","uniqueCharacters","updateKerningPairs","toAdd","packBounds","getPrerenderedImageData","glyphSize","glyphData","errorGlyph","promise","scaleRatio","num","reference","top_1","toEmit","emitOnce","emit","clearTimeout","flushEmitOnce","delay","isManualStart","isTimeSet","setAutomatic","setTiming","duration","cleanObservation","instanceChanges","allowChanges","disposer","observableDisposer","INSERT","CHANGE","REMOVE","emptyPropertyChanges","gl_proxy_1","gl_state_1","state","clearMask","currentRenderTarget","displaySize","renderSize","glProxy","debugContext","glState","stencil","GLProxy","GLState","setProxy","syncState","getDisplaySize","getPixelRatio","getRenderSize","getFullViewport","prepareAttribute","updateAttribute","useAttribute","renderModel","useMaterial","geometryIsValid_1","applyVertexAttributeArrays","canRead","validFramebuffer","_height","ratio","useRenderTarget","getTextures","willUseTextureUnit","applyUsedTextures","compileRenderTarget","drawInstances","blending","blendDst","OneMinusSrcAlpha","blendEquation","Add","blendSrc","SrcAlpha","colorWrite","culling","CCW","depthFunc","LESS_OR_EQUAL","depthWrite","dithering","polygonOffset","name_1","newLocations_1","disposeMaterial","_validFramebuffer","_splitRenderBuffers","_buffers","_width","getDimensions","disposeRenderTarget","textures","width_1","height_1","checkWidth","checkHeight","removeTextureFromBuffer","setAsValid","gl_decode_1","render_target_1","_textureUnitToTexture","_freeUnits","_blendingEnabled","_blendDstFactor","One","_blendSrcFactor","_blendEquation","_cullFace","_colorMask","_clearColor","_depthFunc","_depthTestEnabled","_depthMask","_ditheringEnabled","_boundFBO","_boundRBO","_boundVBO","_boundTexture","_currentProgram","_scissorTestEnabled","_scissorBounds","_activeTextureUnit","_textureWillBeUsed","_viewport","_enabledVertexAttributeArray","_willUseVertexAttributeArray","_vertexAttributeArrayDivisor","totalUnits","MAX_COMBINED_TEXTURE_IMAGE_UNITS","_currentUniforms","bindVBO","bindBuffer","ARRAY_BUFFER","bindRBO","bindRenderbuffer","RENDERBUFFER","bindFBO","bindFramebuffer","FRAMEBUFFER","bindTexture","textureId","TEXTURE_2D","TEXTURE_CUBE_MAP","textureUnit","willUseVertexAttributeArray","enableVertexAttribArray","disableVertexAttribArray","setVertexAttributeArrayDivisor","divisor","instancing","vertexAttribDivisor","vertexAttribDivisorANGLE","freeTextureUnit","setActiveTextureUnit","activeTexture","applyClearColor","SCISSOR_TEST","applyScissorBounds","disable","applyViewport","useProgram","compileMaterial","programId","syncMaterial","fboId","depthMask","DEPTH_TEST","applyDepthFunc","BLEND","applyBlendFactors","applyCullFace","applyColorMask","DITHER","success","entries","glSettings","location_1","getUniformLocation","uploadUniform","uniform1f","uniform2f","uniform3f","uniform4f","uniform4fv","uniformMatrix3fv","uniformMatrix4fv","failedTextures","assignTextureUnits","textureToUniforms","renderTargets","targets","some","updateTexture","uploadTextureToUniform","uniform1i","needsUnit","hasUnit","freeUnit","inUse","canGiveUpUnit","isUsed","applyBlendEquation","EQUAL","GREATER","GREATER_OR_EQUAL","GEQUAL","LESS","LEQUAL","NOTEQUAL","scissor","colorMask","FUNC_ADD","Subtract","FUNC_SUBTRACT","ReverseSubtract","FUNC_REVERSE_SUBTRACT","dst","DstAlpha","BLEND_DST_ALPHA","DstColor","BLEND_DST_RGB","OneMinusDstAlpha","ONE_MINUS_DST_ALPHA","OneMinusDstColor","ONE_MINUS_DST_COLOR","ONE_MINUS_SRC_ALPHA","OneMinusSrcColor","ONE_MINUS_SRC_COLOR","SRC_ALPHA","SrcColor","SRC_COLOR","Zero","ZERO","SrcAlphaSaturate","SRC_ALPHA_SATURATE","blendFunc","CULL_FACE","CW","frontFace","cullFace","FRONT","BOTH","FRONT_AND_BACK","isDataBuffer","byteOffset","byteLength","isTextureReady","fragmentShaders","vertexShaders","programs","addExtensions","anisotropicFiltering","anisotropicStats","maxAnistropicFilter","MAX_TEXTURE_MAX_ANISOTROPY_EXT","ext","stat","mask","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","compileAttribute","createBuffer","bufferData","isDynamic","DYNAMIC_DRAW","STATIC_DRAW","bufferId","printError","compileGeometry","createShader","FRAGMENT_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","lineFormatShader","getShaderInfoLog","deleteShader","VERTEX_SHADER","vertexPrograms","useMetrics","useCount","program_1","createProgram","attachShader","linkProgram","validateProgram","LINK_STATUS","VALIDATE_STATUS","info","getProgramInfoLog","deleteProgram","fsId","vsId","currentProgram","totalProgramUniforms","usedUniforms","uniformInfo","uniformToRemove","fbo","createFramebuffer","glContext","buffers_1","isReady_1","colorBufferId","framebufferTexture2D","rboId","compileColorBuffer","framebufferRenderbuffer","depthBufferId","DEPTH_ATTACHMENT","compileDepthBuffer","stencilBufferId","STENCIL_ATTACHMENT","compileStencilBuffer","frameBufferCheckResult","checkFramebufferStatus","unidentifiedResult","stillUnidentifiedResult","FRAMEBUFFER_COMPLETE","FRAMEBUFFER_INCOMPLETE_ATTACHMENT","FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT","FRAMEBUFFER_INCOMPLETE_DIMENSIONS","FRAMEBUFFER_UNSUPPORTED","FRAMEBUFFER_INCOMPLETE_MULTISAMPLE","RENDERBUFFER_SAMPLES","rbo","createRenderbuffer","renderbufferStorage","compileTexture","updateTextureData","updateTextureSettings","drawRange","drawArraysInstanced","drawArraysInstancedANGLE","drawArrays","fsId_1","fsLookup","found_1","disposeRenderBuffer","deleteRenderbuffer","WebGLRenderbuffer","deleteTexture","names","glError","getError","NO_ERROR","INVALID_ENUM","INVALID_VALUE","INVALID_OPERATION","INVALID_FRAMEBUFFER_OPERATION","OUT_OF_MEMORY","CONTEXT_LOST_WEBGL","lines","lineChars","updateTexturePartialData","texImage2D","generateMipmap","updateRegions","texSubImage2D","isPower2","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","wrapHorizontal","TEXTURE_WRAP_T","wrapVertical","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_FLIP_Y_WEBGL","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","anisotropy","fullUpdate","needsUpdate","bufferSubData","subarray","locations","getAttribLocation","vertexAttribPointer","normalize","isInstanced","_attributes","maxInstancedCount","removeAttribute","_isInstanced","_fullUpdate","_updateRange","_isDynamic","setDynamic","isDynmaic","queuedCommands","nextFrameCommands","requestAnimationFrame","loop","command","determinant2x2","mat","determinant3x3","determinant4x4","m0","m1","m2","m3","scale4x4","z","translation4x4","affineInverse2x2","determinant","affineInverse3x3","determiant","m4","m5","affineInverse4x4","s0","s1","s2","s3","s4","s5","c5","c4","c3","c2","c1","c0","scale2x2","scale3x3","multiplyScalar4x4","identity2","identity3","multiply2x2","multiply3x3","add2x2","add3x3","add4x4","subtract2x2","subtract3x3","subtract4x4","Hadamard2x2","Hadamard3x3","Hadamard4x4","transpose2x2","transpose3x3","transpose4x4","toString4x4","fovRadians","rangeInv","normalize_wheel_1","relative","mouseX","mouseY","eventX","eventY","nativeEvent","pageX","pageY","clientX","clientY","scrollLeft","scrollTop","offsetParent","offsetLeft","templateVars","easingMethod","extend","extendHeader","T","shader_templating_1","template_vars_1","extendShader","baseVS","baseFS","extendedVS","extendedFS","header","AutoEasingLoopStyle","pow","sin","GPU_PI","clamp","minVal","maxVal","easeOutElasticGPU","easeBackInGPU","continuousSinusoidalGPU","AutoEasingMethod","cpu","gpu","methodName","immediate","_start","_t","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeOutElastic","easeBackIn","easeBackOut","t1","easeBackInOut","a1","t2","continuousSinusoidal","CONTINUOUS","amplitude","validation","ignoreEndValueCheck","ignoreOverTimeCheck","transparentShapeBlending","processing_1","constants","allConstants","methods","projection","RingLayer","ring","scaleFactor","animations","animateCenter","animateRadius","vertexToNormal","vertexToSide","thickness","_","instance_1","RingInstance","anchorCalculator","TopLeft","_rectangle","TopMiddle","TopRight","MiddleLeft","Middle","MiddleRight","BottomLeft","BottomMiddle","BottomRight","Custom","RectangleInstance","maxScale","scaling","_anchor","setAnchor","newAnchor","RectangleLayer","anchorEffect","minScale","screenPoint","_u","LabelInstance","preload","paddingDirection","subTextGlyphs","layer_surface_1","glyph_instance_1","glyph_layer_1","_label","label","directions","dir","mag","paddingCalculator","LabelLayer","glyphProvider","labelToGlyphs","labelToKerningRequest","labelWaitingOnGlyph","handleGlyphReady","parentLabel","waiting","customGlyphLayer","textId","activeId","anchorId","colorId","originId","fontSizeId","maxWidthId","diffType","changed","invalidateRequest","layoutGlyphs","showGlyphs","hideGlyphs","updateAnchor","updateGlyphColors","updateGlyphOrigins","updateKerning","kerningRequest","requestMetrics","updateGlyphs","currentGlyphs","sourceIndex","labelKerningRequest","checkText","_image","ImageInstance","tint","sourceWidth","sourceHeight","aspect","atlas_resource_request_1","common_options_1","ImageRenderLayer","animateTint","animateLocation","animateSize","filterQuery","queryValues","filtered","Quadrants","mid","TL","Node","TR","BL","BR","nodes","doAdd","cover","childrenProps","MAX_VALUE","allChildren","gatherChildren","area","visit","queryBounds","queryPoint","cb","finished","auto_easing_method_1","debugCtx","BLANK_EASING_PROPS","startTime","sizeToType","9","16","99","isEasingAttribute","baseAttributeName","usedInstanceAttributes","easingAttributes","newAttributes","instanceAttributes_1","easingIds","providedUID","easingUID","attributeDelay","attributeDuration","easingValues","timeValue","vecMethods","attributeDataShare","REFLECT","timePassed","startAttr","_o","startTimeAttr","durationAttr","baseName","pingPong","methodSizes","sizeType","VECTOR_COMPONENTS","generateUniformAttributePacking","totalInstanceUniformBlocks","orderedAttributes","processDestructuringInstanceAttribute","processDestructuringInstanceAttributePacking","processDestructuringUniformBuffer","blocksPerInstance","_orderedAttributes","processDestructureBlocks","makeVectorSwizzle","attributeDeclarations","processAttributeHeader","uniformDeclaration","processUniformHeader","materialChanges","processVertexAttributes","processInstanceAttributeBufferStrategy","processInstanceAttributePackingBufferStrategy","instanceMaxBlock","injectionType","maxBlock","isOver","getSceneViewsUnderMouse","sceneViewByViewId","viewItem","getMouseByViewId","viewMouseByViewId","handleInteraction","handleMouseClick","_drag","handleMouseDrag","sceneViews_1","handleSceneView","_flag","allSceneViews","currentSceneViews","allColors","colorData","dataHeight","dataWidth","nearestColor","nearestColorBytes","uniqueColors","pixelIndex","row","dx","dy","testDistance","isMouseOver","isMouseDown","getColorPickInstance","isColorProcessor","_mouse","onMouseDown","hitTest_1","query_1","world_1","querySpace","instances","instanceForColor","onMouseOut","hitTest_2","query_2","world_2","onMouseUp","hitTest_3","query_3","world_3","onMouseOver","onMouseMove","hitTest_4","query_4","world_4","notOverInstances","isCurrentlyOver_1","noLongerOver","onMouseClick","hitTest_5","query_5","world_5","MetricsProcessing","calculateUniformBlockUseage","maxUniforms","maxUniformsForInstancing","maxInstancesPerUniformBuffer","Block","available","ensureSizes","newBlock","inject_shader_io_1","metrics_processing_1","shader_module_1","metricsProcessing","shadersWithImports","processImports","vsHeader","fsHeader","destructuring","vsHeaderDeclarations","fsHeaderDeclarations","destructureDeclarations","vsHeaderInfo","fsHeaderInfo","declarations_1","declaration","fullShaderVS","fullShaderFS","processedShaderVS","shaders","baseModules","moduleUnit","quadModel","geometry_1","material_1","model_1","drawQuadVS","drawQuadFS","quadProgram","positionData","texCoordData","quadGeometry","texCoord","debugScene","debugViewHeight","debugQueue","getContainer","getElementById","parent_1","debugTexture","defer","screenSize","empty","marginLeft","parentBox","emptyBox","makePlaceholder","debugReadPixels","debugId","HTMLCanvasElement","Uint8ClampedArray","debugRenderTarget","colorBuffer","foundTexture_1","font_manager_1","font_resource_request_1","resourceLookup","fontManager","fontResource","glyphRequests_1","i_2","iMax_2","resourceContex","currentAttribute","fontRequests","parseContent","resolvePseudoContent","popCounters","parseCounterReset","TOKEN_TYPE","PSEUDO_CONTENT_ITEM_TYPE","TEXT","IMAGE","STRING","ATTRIBUTE","URL","COUNTER","COUNTERS","OPENQUOTE","CLOSEQUOTE","counterReset","counterNames","counterResets","lenCounterResets","_counterResets$i$spli","_counterResets$i$spli2","counterName","initialValue","counter","counters","lenCounters","tokens","contentItems","counterIncrement","_counterIncrement$spl","_counterIncrement$spl2","incrementValue","HTMLElement","_counter","formatCounterValue","_counters","glue","getQuote","quoteDepth","cache","isString","isEscaped","isFunction","functionName","charAt","_counters2","addOtherToken","identifier","isOpening","quotes","idx","ResourceStore","_Proxy","ResourceLoader","_window","getOrigin","href","_index","hasResourceInCache","isSVG","allowTaint","isInlineImage","isSameOrigin","addImage","_loadImage","useCORS","xhrImage","onreadystatechange","readyState","imageLoadHandler","supportsDataImages","isInlineBase64Image","url","link","_link","protocol","hostname","port","_this5","images","_keys","_resources","INLINE_SVG","INLINE_BASE64","INLINE_IMG","cloneWindow","DocumentCloner","_ResourceLoader2","_CanvasRenderer2","_PseudoNodeContent","copyInline","referenceElement","scrolledElements","copyStyles","inlineImages","pseudoContentData","inlineImage","backgroundImages","clonedChild","styleSheets","sheet","res","createStyleSheetFontsFromText","getSheetFonts","fonts","acc","formats","blob","dataUri","fontFace","cssText","fontCss","textContent","HTMLIFrameElement","tempIframe","generateIframeKey","_parseBounds","getIframeDocumentElement","async","removeContainer","foreignObjectRendering","iframeCanvas","nodeType","TEXT_NODE","nodeValue","createElementClone","styleBefore","styleAfter","clonedReferenceElement","HTMLBodyElement","createPseudoHideStyles","contentBefore","nextSibling","ELEMENT_NODE","nodeName","contentAfter","inlineAllImages","inlinePseudoElement","PSEUDO_BEFORE","PSEUDO_AFTER","cloneCanvasContents","cssRules","rule","CSSRule","FONT_FACE_RULE","baseHref","doc","implementation","createHTMLDocument","base","head","clonedCanvas","clonedCtx","pseudoElt","anonymousReplacedElement","PSEUDO_HIDE_ELEMENT_CLASS_BEFORE","PSEUDO_HIDE_ELEMENT_CLASS_AFTER","insertBefore","createStyles","styles","initNode","random","DATA_URI_REGEXP","contentWindow","html","atob","decodeURIComponent","createIframeContainer","cloneIframeContainer","documentClone","write","iframeLoad","iframeLoader","close","scrolling","interval","setInterval","clearInterval","serializeDoctype","cloner","scrollTo","doctype","restoreOwnerScroll","adoptNode","internalSubset","publicId","systemId","ANGLE","parseAngle","angle","transformWebkitRadialGradientArgs","parseGradient","RadialGradient","LinearGradient","RADIAL_GRADIENT_SHAPE","GRADIENT_TYPE","_Angle","_Length","SIDE_OR_CORNER","PERCENTAGE_ANGLES","ENDS_WITH_LENGTH","FROM_TO_COLORSTOP","RADIAL_SHAPE_DEFINITION","LINEAR_GRADIENT","RADIAL_GRADIENT","ELLIPSE","LENGTH_FOR_POSITION","shape","parseColorStops","parseLinearGradient","transformObsoleteColorStops","parseRadialGradient","firstColorStopIndex","lineLength","HAS_LENGTH","lastSpaceIndex","lastIndexOf","_color","_stop","absoluteValuedColorStops","previousColorStop","_stop2","steps","stepSize","hasPrefix","HAS_SIDE_OR_CORNER","HAS_DIRECTION","calculateGradientDirection","parseSideOrCorner","parsePercentageAngle","gradientCenter","gradientRadius","calculateRadius","radian","HALF_LINE_LENGTH","cos","parseTopRight","acos","_angle$split$map","_angle$split$map2","atan","findCorner","closest","corner","optimumDistance","optimumCorner","Infinity","extent","rx","ry","_c","_corner","RADIUS","matchStartPosition","matchShapeExtent","matchStartRadius","matchEndPosition","matchEndRadius","matchPosition","matchRadius","_Gradient","isVisible","renderNodeBackgroundAndBorders","renderNodeContent","renderTextNode","drawShape","imageStore","contentBox","paths","HAS_BACKGROUND","isTransparent","hasRenderableBorders","backgroundPaintingArea","renderBackgroundImage","renderBorder","renderBackgroundRepeat","renderBackgroundGradient","backgroundImageSize","_offsetX","_offsetY","renderRepeat","gradientBounds","renderLinearGradient","renderRadialGradient","curvePoints","_opacity","getOpacity","setOpacity","transformOrigin","renderStackContent","_splitStackingContext","splitStackingContexts","_splitStackingContext2","negativeZIndex","zeroOrAutoZIndexOrTransformedOrOpacity","positiveZIndex","nonPositionedFloats","nonPositionedInlineLevel","_splitDescendants","splitDescendants","_splitDescendants2","inlineLevel","nonInlineLevel","sortByZIndex","renderStack","renderNode","getTarget","isInlineLevel","contexts","order","Circle","Trie","createTrieFromBase64","UTRIE2_INDEX_2_MASK","UTRIE2_INDEX_2_BLOCK_LENGTH","UTRIE2_OMITTED_BMP_INDEX_1_LENGTH","UTRIE2_INDEX_1_OFFSET","UTRIE2_UTF8_2B_INDEX_2_LENGTH","UTRIE2_UTF8_2B_INDEX_2_OFFSET","UTRIE2_INDEX_2_BMP_LENGTH","UTRIE2_LSCP_INDEX_2_LENGTH","UTRIE2_DATA_MASK","UTRIE2_DATA_BLOCK_LENGTH","UTRIE2_LSCP_INDEX_2_OFFSET","UTRIE2_SHIFT_1_2","UTRIE2_INDEX_SHIFT","UTRIE2_SHIFT_1","UTRIE2_SHIFT_2","view32","Uint32Array","view16","Uint16Array","headerLength","errorValue","highStart","highValueIndex","ix","inlineBreakOpportunities","lineBreakAtIndex","codePointsToCharacterClasses","UnicodeTrie","BREAK_ALLOWED","BREAK_NOT_ALLOWED","BREAK_MANDATORY","classes","LETTER_NUMBER_MODIFIER","_Trie","_linebreakTrie2","SP","BA","HY","CL","CP","EX","IN","NS","OP","IS","NU","PO","PR","SY","AL","EB","EM","H2","H3","ID","JL","JV","JT","SA","BK","CR","LF","CM","NL","SG","WJ","ZW","GL","ZWJ","B2","BB","CB","QU","AI","CJ","HL","RI","XX","ALPHABETICS","HARD_LINE_BREAKS","SPACE","PREFIX_POSTFIX","LINE_BREAKS","KOREAN_SYLLABLE_BLOCK","HYPHEN","types","indicies","categories","classType","prev","isAdjacentWithSpaceIgnored","currentIndex","classTypes","_next","previousNonSpaceClassType","_lineBreakAtIndex","forbiddenBreaks","beforeIndex","afterIndex","before","prevIndex","_prevIndex","cssFormattedClasses","_codePointsToCharacte","_codePointsToCharacte2","_codePointsToCharacte3","_codePointsToCharacte4","isLetterNumber","Break","_cssFormattedClasses","_cssFormattedClasses2","forbiddenBreakpoints","_codePoints","arr2","_toConsumableArray","_cssFormattedClasses3","_cssFormattedClasses4","lastEnd","nextIndex","_LineBreak","WORD_BREAK","BREAK_ALL","KEEP_ALL","COLLAPSE","toFloat","MATRIX","parseTransformOrigin","parseTransformMatrix","webkitTransform","mozTransform","msTransform","oTransform","webkitTransformOrigin","mozTransformOrigin","msTransformOrigin","oTransformOrigin","create","matrix3d","NUMBER","currentValue","isLength","shadows","numParens","appendValue","appendShadow","SCROLL","LINE_BREAK","STRICT","weight","parseFontWeight","INLINE_START","INLINE_END","BLOCK","RUN_IN","FLOW","FLOW_ROOT","TABLE","FLEX","GRID","RUBY","SUBGRID","TABLE_ROW_GROUP","TABLE_HEADER_GROUP","TABLE_FOOTER_GROUP","TABLE_ROW","TABLE_CELL","TABLE_COLUMN_GROUP","TABLE_COLUMN","TABLE_CAPTION","RUBY_BASE","RUBY_TEXT","RUBY_BASE_CONTAINER","RUBY_TEXT_CONTAINER","CONTENTS","setDisplayBit","parseDisplayValue","_value$split$map","_value$split$map2","horizontal","vertical","lerp","BezierCurve","firstHalf","ab","bc","cd","abbc","bccd","dest","Size","StackingContext","treatAsRealStackingContext","getRealParentStackingContext","NodeParser","_StackingContext2","parseNodeTree","IGNORED_NODE_NAMES","nextNode","childNode","Text","SHOULD_TRAVERSE_CHILDREN","createsRealStackingContext","createsStackingContext","parentStack","childStack","_container","_treatAsRealStackingContext","_parentStack","_childStack","isPositionedWithZIndex","isBodyWithTransparentRoot","renderElement","_NodeParser","_Renderer2","_ForeignObjectRenderer2","_Clone","_Font","_Color","windowBounds","documentBackgroundColor","bodyBackgroundColor","supportForeignObject","inlineFonts","ready","clonedElement","clonedDocument","renderOptions","_extends","_typeof","constructor","_Logger2","_Window","conf","defaultOptions","log2","NO_DATA","normalizedDistanceField","noData","negate","sign","distanceBuffer","maxDistance","xMax","col","yMax","mapToDistanceField","toSeedBuffer","fromSeedBuffer","outBuffer","outColor","toSeedDistance","fromSeedDistance","outputDistance","toSeedCol","fromSeedCol","toSeed","fromSeed","redIndex","jfaPasses","seedBuffer","passes","samples","nearestValue","nearestIndex","readBuffer","newBuffer","makeEmptyBuffer","pass","temp","convertToSDF","mapMethod","maxDimension","seed","getSeed","positionBuffer","inversePositionBuffer","outImageData","makeFontSDF","_canvas","managers","didUpdate","getManager","webGLRenderer","image_render_layer_1","ImageLayer","childProvider","imageToResource","sourceToRequest","sourceId","EdgeInstance","colorStart","colorEnd","control","widthStart","widthEnd","setEdgeWidth","setColor","interpolation","LINE","_c1","_c2","BEZIER","BEZIER2","TEST_RESOLUTION","edgePicking","broadphase","minPickDistance","scaleType","interpolate","edge","edgeWidthStart","edgeWidthEnd","PASS_X","PASS_Y","SCREEN_CURVE","closestIndex","closestDistance","secondClosestIndex","secondClosestDistance","control1","control2","startPoint","endPoint","linePoint","lineWidth","startSegment","endSegment","vector","lineDirection","lineNormal","distanceTo","edge_picking_1","pickVS","screenVS","edgeFS","EdgeLayer","_f","animateEnd","animateStart","animateColorStart","animateColorEnd","animateControl","MAX_SEGMENTS","vertexInterpolation","toInstanceIOValue","_uniform","CircleInstance","squareDistance","Point","total","getClosest","testPoint","points","closestPoint","getClosestIndex","amount","magnitude","getDistance","squared","getMidpoint","make","CircleLayer","circle","circleScreenCenter","mouseScreen","fadeOutOversized","ArcInstance","UniformQuadDiffProcessor","quadPicking","UniformColorDiffProcessor","InstanceAttributeQuadDiffProcessor","InstanceAttributeColorDiffProcessor","emit_once_1","allBufferLocations","availableLocations","currentInstancedCount","instanceToBufferLocation","blockSubAttributesLookup","attributeToPropertyIds","updateAllPropertyIdList","activePropertyId","doAddWithRegistration","propertyIdsForAttribute","makeUpdateAllPropertyIdList","locationInfo","resizeBuffer","gatherLocationsIntoGroups","newLocations","growth","ids","attributeToNewBufferLocations","previousInstanceAmount","blockAttributes","newAttribute","blockSubAttributes","blockSize","kMax","subAttribute","allLocations","internalAttribute","startAttributeIndex","attributeSize","jMax","newLocation","blockSizes","blockAttributeUID","totalNewInstances","attributesBufferLocations","bufferLocationsForAttribute","childBufferLocations","bufferIndex","group","bufferLocation","childAttribute","bufferLocationsForChildAttribute","childBufferLocation","isInstanceAttributeBufferLocation","_g","instance_attribute_color_diff_processor_1","instance_attribute_diff_processor_1","instance_attribute_quad_diff_processor_1","uniform_color_diff_processor_1","uniform_diff_processor_1","uniform_quad_diff_processor_1","BasicInstance","plural","ms","exec","long","fmtLong","fmtShort","createDebug","prevTime","self","curr","coerce","formatter","hash","selectColor","skips","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","queue","draining","cleanUpNextTick","drainQueue","run","marker","runClearTimeout","Item","noop","nextTick","title","browser","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","prependListener","prependOnceListener","listeners","binding","cwd","chdir","umask","ArcScaleType","ArcLayer","animateAngle","animateThickness","next_frame_1","EasingUtil","wait","layerAttributes","adjust","finishedTime","_checkNextFrame","getBounds","childToNode","childToBounds","nullBounded","fromSplit","doRemove","ReferenceCamera","offsetFilter","scaleFilter","_val","canUseDOM","ExecutionEnvironment","canUseWorkers","Worker","canUseEventListeners","attachEvent","canUseViewport","isInWorker","useHasFeature","hasFeature","eventNameSuffix","capture","eventName","isSupported","_ie","_firefox","_opera","_webkit","_chrome","_ie_real_version","_osx","_windows","_linux","_android","_win64","_iphone","_ipad","_native","_mobile","_populated","_populate","uas","agent","os","NaN","documentMode","trident","ver","UserAgent_DEPRECATED","ie","ieCompatibilityMode","ie64","firefox","opera","webkit","safari","windows","osx","linux","iphone","mobile","nativeApp","android","ipad","isEventSupported","PIXEL_STEP","LINE_HEIGHT","PAGE_HEIGHT","sX","sY","pX","pY","detail","wheelDelta","wheelDeltaY","wheelDeltaX","axis","HORIZONTAL_AXIS","deltaY","deltaX","deltaMode","spinX","spinY","getEventType","normalizeWheel_1","extend_shader_1","extendShaderInitialization","extendedShaders","isNumber","AnimationHelper","groupAnimation","groupCount","baseDelay","delayGap","modifyInstances","startFrameTime","gap","CameraBoundsAnchor","event_manager_1","BasicCameraController","isPanning","panFilter","_allViews","startViews","optimizedViews","onRangeChanged","_camera","_targetView","startViewDidStart","applyBounds","applyScaleBounds","boundsHorizontalOffset","boundsVerticalOffset","scaleMin","scaleMax","setBounds","ignoreCoverViews","wheelShouldScroll","anchoredByBoundsHorizontal","MIDDLE_LEFT","worldBounds","screenPadding","TOP_MIDDLE","MIDDLE","BOTTOM_MIDDLE","MIDDLE_RIGHT","anchoredByBoundsVertical","worldTLinScreenSpace","worldBRinScreenSpace","canStart","findCoveredStartView","under","coveredStartView","getTargetView","_button","doPan","pan","wheelMetrics","deltaPosition","beforeZoom","currentZoomX","currentZoomY","deltaScale","afterZoom","deltaZoom","getRange","setRange","newWorld","deltaPan"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"network-bubble-chart\"] = factory();\n\telse\n\t\troot[\"network-bubble-chart\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 258);\n","import {\n  Attribute,\n  GLSettings,\n  IMaterialUniform,\n  MaterialOptions,\n  MaterialUniformType,\n  Texture\n} from \"./gl\";\nimport { Instance } from \"./instance-provider/instance\";\nimport { Bounds } from \"./primitives/bounds\";\nimport {\n  ChartCamera,\n  Mat3x3,\n  Mat4x4,\n  Vec,\n  Vec1,\n  Vec2,\n  Vec3,\n  Vec4\n} from \"./util\";\nimport { IAutoEasingMethod } from \"./util/auto-easing-method\";\nimport { IVisitFunction, TrackedQuadTree } from \"./util/tracked-quad-tree\";\n\nexport type Diff<T extends string, U extends string> = ({ [P in T]: P } &\n  { [P in U]: never } & { [x: string]: never })[T];\nexport type Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>;\nexport type ShaderIOValue = Vec1 | Vec2 | Vec3 | Vec4 | Vec4[] | Float32Array;\nexport type InstanceIOValue = Vec1 | Vec2 | Vec3 | Vec4;\nexport type UniformIOValue =\n  | number\n  | InstanceIOValue\n  | Mat3x3\n  | Mat4x4\n  | Float32Array\n  | Texture\n  | number[];\n\nexport enum InstanceBlockIndex {\n  ONE = 1,\n  TWO = 2,\n  THREE = 3,\n  FOUR = 4\n}\n\nexport enum InstanceAttributeSize {\n  ONE = 1,\n  TWO = 2,\n  THREE = 3,\n  FOUR = 4,\n  /** Special case for making instance attributes that can target Atlas resources */\n  ATLAS = 99\n}\n\nexport const instanceAttributeSizeFloatCount: { [key: number]: number } = {\n  [InstanceAttributeSize.ONE]: 1,\n  [InstanceAttributeSize.TWO]: 2,\n  [InstanceAttributeSize.THREE]: 3,\n  [InstanceAttributeSize.FOUR]: 4,\n  [InstanceAttributeSize.ATLAS]: 4\n};\n\nexport enum UniformSize {\n  ONE = 1,\n  TWO = 2,\n  THREE = 3,\n  FOUR = 4,\n  MATRIX3 = 9,\n  MATRIX4 = 16,\n  VEC4_ARRAY = 98,\n  ATLAS = 99\n}\n\nexport enum VertexAttributeSize {\n  ONE = 1,\n  TWO = 2,\n  THREE = 3,\n  FOUR = 4\n}\n\n/**\n * These are valid atlas sizes available. We force a power of 2 to be utilized.\n * We do not allow crazy large sizes as browsers have very real caps on resources.\n * This helps implementations be a little smarter about what they are using. Future\n * versions may increase this number as GPUs improve and standards allow greater\n * flexibility.\n */\nexport enum TextureSize {\n  _2 = 0x01 << 1,\n  _4 = 0x01 << 2,\n  _8 = 0x01 << 3,\n  _16 = 0x01 << 4,\n  _32 = 0x01 << 5,\n  _64 = 0x01 << 6,\n  _128 = 0x01 << 7,\n  _256 = 0x01 << 8,\n  _512 = 0x01 << 9,\n  _1024 = 0x01 << 10,\n  _2048 = 0x01 << 11,\n  _4096 = 0x01 << 12\n}\n\n/**\n * Types of reesources that can be generated and provided via the resource manager\n */\nexport enum ResourceType {\n  ATLAS = 0,\n  FONT = 1\n}\n\n/**\n * Base options needed for a resource to be considered a viable resource\n */\nexport interface IResourceType {\n  type: number;\n}\n\n/**\n * This represents a color in the VoidGL system. Ranges are [0 - 1, 0 - 1, 0 - 1, 0 - 1]\n */\nexport type Color = [number, number, number, number];\n\n/**\n * Represents something with a unique id\n */\nexport interface Identifiable {\n  /** A unique identifier */\n  id: string;\n}\n\n/**\n * Information provided in mouse events interacting with instances and\n * layers.\n */\nexport interface IPickInfo<T extends Instance> {\n  /** If a mouse button is involved in the pick, this will be populated */\n  button?: number;\n  /** This is the parent layer id of the instances interacted with */\n  layer: string;\n  /** This is the list of instances that were detected in the interaction */\n  instances: T[];\n  /** If picking is set to ALL then this will be provided which can be used to make additional spatial queries */\n  querySpace?(bounds: Bounds | Vec2, visit?: IVisitFunction<T>): T[];\n  /** This is the screen coordinates of the mouse point that interacted with the instances */\n  screen: [number, number];\n  /** This is the world coordinates of the mouse point that interacted with the instances */\n  world: [number, number];\n  /** Projection methods to easily go between coordinate spaces */\n  projection: IProjection;\n}\n\nexport interface IVertexAttribute {\n  /**\n   * When initWithBuffer and customFill are not specified, this is was the system will initially\n   * load each vertex attribute with.\n   */\n  defaults?: number[];\n  /**\n   * When this is specified it will initialize the model's attribute with the data in this buffer.\n   */\n  initWithBuffer?: Float32Array;\n  /**\n   * When generating this attribute in the shader this will be the prefix to the attribute:\n   * For instance, if you specify 'highp' as the modifier, then the attribute that appears\n   * in the shader will be:\n   * attribute highp vec3 position;\n   */\n  qualifier?: string;\n  /**\n   * This is the name the attribute will be for the model.\n   */\n  name: string;\n  /**\n   * This is the number of floats the attribute will consume. For now, we only allow for up\n   * to four floats per attribute.\n   */\n  size: VertexAttributeSize;\n  /**\n   * This lets you populate the buffer with an automatically called method. This will fire when\n   * necessary updates are detected or on initialization.\n   */\n  update(vertex: number): ShaderIOValue;\n}\n\nexport interface IVertexAttributeInternal extends IVertexAttribute {\n  /** This is the actual attribute generated internally for the ThreeJS interfacing */\n  materialAttribute: Attribute | null;\n}\n\nexport interface IInstanceAttribute<T extends Instance> {\n  /**\n   * If this is specified, this attribute becomes a size of 4 and will have a block index of\n   * 0. This makes this attribute and layer become compatible with reading atlas resources.\n   * The value provided for this property should be the name of the atlas that is created.\n   */\n  resource?: {\n    /** This is the resource type that the attribute will be requesting (ie ResourceType.ATLAS, ResourceType.FONT, or custom resource type values) */\n    type: number;\n    /** Specify which generated resource to target for the resource */\n    key: string;\n    /** Specify the name that will be injected that will be the sampler2D in the shader */\n    name: string;\n    /**\n     * This specifies which of the shaders the sampler2D will be injected into.\n     * Defaults to the Fragment shader only.\n     */\n    shaderInjection?: ShaderInjectionTarget;\n  };\n  /**\n   * This is a block index helping describe the instancing process. It can be any number as\n   * the system will sort and organize them for you. This only helps the system detect when\n   * you cram too much info into a single block. The tighter you pack your blocks the better\n   * your program will perform.\n   *\n   * Note: It's best to leave this blank as the system now packs your attributes for you and\n   * will determine this number for you.\n   */\n  block?: number;\n  /**\n   * This is the index within the block this attribute will be available.\n   */\n  blockIndex?: InstanceBlockIndex;\n  /**\n   * Child attributes are attributes that are guaranteed to update when the parent attribute\n   * is updated. This is useful for attributes with special properties that get expanded to\n   * other types of attributes such as easing attributes which gain start, duration, and other values\n   * to make the attribute work.\n   *\n   * If the settings on this attrubute spawns additional attributes, those attributes shall\n   * be populated here. Otherwise this remains undefined.\n   */\n  childAttributes?: IInstanceAttribute<T>[];\n  /**\n   * When this is set, the system will automatically inject necessary Shader IO to facilitate\n   * performing the easing on the GPU, which saves enormous amounts of CPU processing time\n   * trying to calcuate animations and tweens for properties.\n   *\n   * NOTE: Setting this increases the amount of data per instance by: size * 2 + ;\n   * as it injects in a start value, start time, and duration\n   */\n  easing?: IAutoEasingMethod<Vec>;\n  /**\n   * This is the name that will be available in your shader for use. This will only be\n   * available after the ${attributes} declaration.\n   */\n  name: string;\n  /**\n   * If this attribute is created automatically by the system based on the settings of another\n   * attribute, that parent attribute will be set here. Otherwise this remains undefined.\n   */\n  parentAttribute?: IInstanceAttribute<T>;\n  /**\n   * When generating this attribute in the shader this will be the prefix to the attribute:\n   * For instance, if you specify 'highp' as the modifier, then the attribute that appears\n   * in the shader will be:\n   * attribute highp vec3 position;\n   */\n  qualifier?: string;\n  /**\n   * This is how many floats the instance attribute takes up. Due to how instancing is\n   * implemented, we can only take up to 4 floats per variable right now.\n   */\n  size?: InstanceAttributeSize;\n  /**\n   * This is the accessor that executes when the instance needs updating. Simply return the\n   * value that should be populated for this attribute.\n   */\n  update(instance: T): InstanceIOValue;\n}\n\n/**\n * Internal Instance Attributes are ones that actually map to an attribute in the shader and use\n * hardware instancing.\n */\nexport interface IInstanceAttributeInternal<T extends Instance>\n  extends IInstanceAttribute<T> {\n  /** We will keep an internal uid for the  */\n  uid: number;\n  /**\n   * Sometimes an attribute is actually a sub attribute to another attribute, such as in the cases of\n   * attribute packing (in uniforms or in attribute packing). This UID indicates the parental attribute\n   * UID. This parent identifier may be an actual InstanceAttribute or not. It could just indicate this\n   * attribute is packed into SOMETHING.\n   */\n  packUID?: number;\n  /** This is the actual attribute mapped to a buffer */\n  bufferAttribute: Attribute;\n}\n\n/**\n * This is an attribute where the resource is definitely declared.\n */\nexport interface IResourceInstanceAttribute<T extends Instance>\n  extends IInstanceAttribute<T> {\n  /**\n   * If this is specified, this attribute becomes a size of 4 and will have a block index of\n   * 0. This makes this attribute and layer become compatible with reading atlas resources.\n   * The value provided for this property should be the name of the atlas that is created.\n   */\n  resource: {\n    /** This is the resource type targeted which can be provided by managers */\n    type: number;\n    /** Specify which generated resource to target */\n    key: string;\n    /** Specify the name that will be injected that will be the sampler2D in the shader */\n    name: string;\n    /**\n     * This specifies which of the shaders the sampler2D will be injected into.\n     * Defaults to the Fragment shader only.\n     */\n    shaderInjection?: ShaderInjectionTarget;\n  };\n}\n\n/**\n * This represents the minimum information to target a specific resource.\n */\nexport interface IResourceContext {\n  /** Indicates a resource is specified */\n  resource: {\n    /** The resource type. This is the type a manager is registered with when setting up a surface. */\n    type: number;\n    /** This is the identifier of the specific resource within the manager */\n    key: string;\n  };\n}\n\n/**\n * Type guard for resource instance attributes\n */\nexport function isResourceAttribute<T extends Instance>(\n  val: IInstanceAttribute<T>\n): val is IResourceInstanceAttribute<T> {\n  return Boolean(val && val.resource);\n}\n\n/**\n * This is an attribute that is simply a value\n */\nexport interface IEasingInstanceAttribute<T extends Instance>\n  extends IInstanceAttribute<T> {\n  /**\n   * This MUST be defined to be an Easing attribute\n   */\n  easing: IAutoEasingMethod<Vec> & { uid?: number };\n  /**\n   * Easing attributes requires size to be present\n   */\n  size: InstanceAttributeSize;\n}\n\n/**\n * This is an attribute that is simply a value\n */\nexport interface IValueInstanceAttribute<T extends Instance>\n  extends IInstanceAttribute<T> {\n  /**\n   * If this is specified, this attribute becomes a size of 4 and will have a block index of\n   * 0. This makes this attribute and layer become compatible with reading atlas resources.\n   * The value provided for this property should be the name of the atlas that is created.\n   */\n  atlas: undefined;\n}\n\n/** These are flags for indicating which shaders receive certain injection elements */\nexport enum ShaderInjectionTarget {\n  /** ONLY the vertex shader will receive the injection */\n  VERTEX = 1,\n  /** ONLY the fragment shader will receive the injection */\n  FRAGMENT = 2,\n  /** Both the fragment and vertex shader will receive the injection */\n  ALL = 3\n}\n\nexport interface IUniform {\n  /**\n   * This lets you specify which of the shaders will receive this uniform as available.\n   * This defaults to only injecting into the vertex shader.\n   */\n  shaderInjection?: ShaderInjectionTarget;\n  /** Name of the uniform as will be available in the shaders */\n  name: string;\n  /** How many floats the uniform shall encompass */\n  size: UniformSize;\n  /**\n   * When generating this uniform in the shader this will be the prefix to the uniform:\n   * For instance, if you specify 'highp' as the modifier, then the uniform that appears\n   * in the shader will be:\n   * uniform highp vec3 position;\n   */\n  qualifier?: string;\n  /**\n   * This is the accessor that executes every frame before this layer is drawn. It gives\n   * opportunity to update the uniform's value before every draw.\n   */\n  update(uniform: IUniform): UniformIOValue;\n}\n\nexport interface IUniformInternal extends IUniform {\n  /**\n   * All layers will have many many ShaderMaterials generated per each instance buffer as a single buffer\n   * can only render so many instances. This tracks across all generated ShaderMaterials for each buffer\n   * the material uniforms that need to be updated as a Uniform for a layer is dictated as uniform across\n   * all instances.\n   */\n  materialUniforms: IMaterialUniform<MaterialUniformType>[];\n}\n\n/**\n * This is the structure of a uniform generated for the sake of instancing\n */\nexport interface IInstancingUniform {\n  name: string;\n  type:\n    | MaterialUniformType.FLOAT\n    | MaterialUniformType.VEC2\n    | MaterialUniformType.VEC3\n    | MaterialUniformType.VEC4\n    | MaterialUniformType.VEC4_ARRAY;\n  value: ShaderIOValue;\n}\n\n/**\n * Represents a complete shader object set.\n */\nexport interface IShaders {\n  fs: string;\n  vs: string;\n}\n\n/**\n * Represents an element that has a full list of projection methods\n */\nexport interface IProjection {\n  /** This is the chart camera utilized in the projection of elements */\n  camera: ChartCamera;\n  /** Converts from the pixel density layer to the screen space */\n  pixelSpaceToScreen(point: Vec2, out?: Vec2): Vec2;\n  /** Converts from the screen coordinates to the pixel density layer */\n  screenToPixelSpace(point: Vec2, out?: Vec2): Vec2;\n  /** Converts from screen space to the view's relative coordinates */\n  screenToView(point: Vec2, out?: Vec2): Vec2;\n  /** Converts from screen space to the world space of a scene */\n  screenToWorld(point: Vec2, out?: Vec2): Vec2;\n  /** Converts from a view's space to the screen */\n  viewToScreen(point: Vec2, out?: Vec2): Vec2;\n  /** Converts from a views space to the world coordinates */\n  viewToWorld(point: Vec2, out?: Vec2): Vec2;\n  /** Converts from world coordinate space of a scene to the screen */\n  worldToScreen(point: Vec2, out?: Vec2): Vec2;\n  /** Converts from world coordinate space of a scene to the view's space */\n  worldToView(point: Vec2, out?: Vec2): Vec2;\n}\n\n/**\n * The empty, do-nothing, method we devs find ourselves using too much.\n */\nexport function NOOP() {\n  /** No-op */\n}\n\n/**\n * White space character test\n */\nexport const whiteSpaceRegEx = /\\s/g;\nexport const whiteSpaceCharRegEx = /\\s/;\nexport const isWhiteSpace = whiteSpaceCharRegEx.test.bind(whiteSpaceCharRegEx);\n\n/**\n * Newline character test\n */\nexport const newLineRegEx = /(\\r\\n|\\n|\\r)/g;\nexport const newLineCharRegEx = /(\\r\\n|\\n|\\r)/;\nexport const isNewline = newLineCharRegEx.test.bind(newLineCharRegEx);\n\n/**\n * Options a layer can provide for a material\n */\nexport type ILayerMaterialOptions = Partial<\n  Omit<MaterialOptions, \"uniforms\" | \"vertexShader\" | \"fragmentShader\">\n>;\n\n/**\n * A wrapper to make declaring layer material options easier and clearer\n */\nexport function createMaterialOptions(options: ILayerMaterialOptions) {\n  return options;\n}\n\n/** This is the method signature for determining whether or not a point hits an instance */\nexport type InstanceHitTest<T> = (o: T, p: Vec2, v: IProjection) => boolean;\n\n/**\n * This is the type of picking assigned to a layer. Each mode has performance and functionality\n * tradeoffs.\n */\nexport enum PickType {\n  /** Disable any picking methodology */\n  NONE,\n  /** Pick all instances found underneath the mouse. The Layer must explicitly support this feature. */\n  ALL,\n  /**\n   * NOTE: NOT IMPLEMENTED YET\n   *\n   * Uses highly efficient color rendering method to detect an instance on a pixel by pixel check. Since it is\n   * based on rendering, it will only select the 'visually' top most rendered instance. This means instances can be occluded\n   * by other instances is an instance renders behind another.\n   *\n   * This is vastly more efficient and accurate than ALL. This also will be more readily supported than ALL.\n   */\n  SINGLE\n}\n\n/**\n * This represents the settings and objects used to facilitate picking in a layer.\n */\nexport interface IPickingMetrics {\n  /** This is the current pick mode that is active during the draw pass of the layer */\n  currentPickMode: PickType;\n  /** This is the picking style to be used */\n  type: PickType;\n}\n\n/**\n * This is the picking settings and objects to facilitate PickType.ALL so we can get\n * all instances underneath the mouse.\n */\nexport interface IQuadTreePickingMetrics<T extends Instance>\n  extends IPickingMetrics {\n  /** This handles the ALL type only */\n  type: PickType.ALL;\n  /** This stores all of our instances in a quad tree to spatially track our instances */\n  quadTree: TrackedQuadTree<T>;\n  /** This is the method for performing a hit test with the provided instance */\n  hitTest: InstanceHitTest<T>;\n}\n\n/**\n * This is the picking settings and objects to facilitate PickType.SINGLE so we can get\n * a single instance underneath the mouse.\n */\nexport interface ISinglePickingMetrics<T extends Instance>\n  extends IPickingMetrics {\n  /** Set the enum for the type */\n  type: PickType.SINGLE;\n  /**\n   * This is a lookup of the instance by it's UID which is all that is needed to decode a color to an instance\n   * The color UINT8 components composited into a single UINT32 IS the UID of the instance\n   */\n  uidToInstance: Map<number, T>;\n}\n\n/**\n * This is the picking settings and objects to facilitate PickType.NONE where no information\n * is retrieved for mouse interactions.\n */\nexport interface INonePickingMetrics extends IPickingMetrics {\n  // Single Picking does not require any special helper information\n  type: PickType.NONE;\n}\n\nexport interface IColorPickingData {\n  /** The mouse target position where the data is rendered */\n  mouse: Vec2;\n  /** The color data loaded for last picking rendering */\n  colorData: Uint8Array;\n  /** The height of the data array */\n  dataHeight: number;\n  /** The width of the data array */\n  dataWidth: number;\n  /** The nearest found color */\n  nearestColor: number;\n  /** The nearest found color in byte form */\n  nearestColorBytes: Vec4;\n  /** All colors in the data */\n  allColors: number[];\n}\n\n/**\n * Diff types that an instance can go through. Used to help the system consume the diff\n * and apply it to the GL framework.\n */\nexport enum InstanceDiffType {\n  CHANGE = 0,\n  INSERT = 1,\n  REMOVE = 2\n}\n\n/**\n * This is the metrics associated with a frame. Mostly dealing with timing values.\n */\nexport type FrameMetrics = {\n  /** The frame number rendered. Increases by 1 every surface draw */\n  currentFrame: number;\n  /** The start time of the current frame */\n  currentTime: number;\n  /** This is the duration of the previous frame */\n  frameDuration: number;\n  /** The start time of the previous frame */\n  previousTime: number;\n};\n\n/**\n * This represents controls that can be utilized when adjustig easing\n */\nexport interface IEasingControl {\n  /** A value in ms that expresses how long the system should wait before beginning the animation */\n  readonly delay?: number;\n  /** Indicates how long the easing should take to complete in ms */\n  readonly duration: number;\n  /** The end value the easing should approach */\n  readonly end: Vec;\n  /** The starting value of the easing object */\n  readonly start: Vec;\n  /** The start time in ms the easing object utilizes */\n  readonly startTime: number;\n\n  /**\n   * If you manually set values for the easing properties, then you use this to return\n   * the easing object back to an automated state which is where the start value is\n   * the calculated current position of the output and the delay and duration is determined\n   * by the easing set to the layer's IAutomatedEasingMethod value set to the layer.\n   */\n  setAutomatic(): void;\n\n  /**\n   * This controls the start value of the easing. This should be used to force a starting\n   * value of the animation.\n   *\n   * Use setAutomatic() to return to default easing behavior.\n   */\n  setStart(start?: Vec): void;\n\n  /**\n   * This controls of the timing of the easing equation. This should be used to adjust\n   * when a value is to be adjusted\n   *\n   * Use setAutomatic() to return to default easing behavior.\n   */\n  setTiming(delay?: number, duration?: number): void;\n}\n\n/**\n * This is the minimum properties required to make all easing functions operate.\n */\nexport interface IEasingProps {\n  /** A value in ms that expresses how long the system should wait before beginning the animation */\n  delay?: number;\n  /** Indicates how long the easing should take to complete in ms */\n  duration: number;\n  /** The end value the easing should approach */\n  end: Vec;\n  /** A flag indicating if the easing start value is manually set, thus prioritizing the values already set in this object */\n  isManualStart?: boolean;\n  /** A flag indicating if the easing timing is manually set, thus prioritizing the values already set in this object */\n  isTimeSet?: boolean;\n  /** The starting value of the easing object */\n  start: Vec;\n  /** The start time in ms the easing object utilizes */\n  startTime: number;\n}\n\n/**\n * This is the Shader IO information a layer will provide.\n */\nexport interface IShaderInputs<T extends Instance> {\n  /** Specifies how the vertices are laid out in the model. This defaults to Triangle Strip if not specified */\n  drawMode?: GLSettings.Model.DrawMode;\n  /** These are very frequently changing attributes and are uniform across all vertices in the model */\n  instanceAttributes?: (IInstanceAttribute<T> | null)[];\n  /** These are attributes that should be static on a vertex. These are considered unique per vertex. */\n  vertexAttributes?: (IVertexAttribute | null)[];\n  /** Specify how many vertices there are per instance */\n  vertexCount: number;\n  /** These are uniforms in the shader. These are uniform across all vertices and all instances for this layer. */\n  uniforms?: (IUniform | null)[];\n}\n\n/**\n * This is the initialization of the shader.\n */\nexport type IShaderInitialization<T extends Instance> = IShaderInputs<T> &\n  IShaders;\n\nexport interface IShaderExtension {\n  header?: string;\n  body?: string;\n}\n\nexport type IShaderIOExtension<T extends Instance> = Partial<\n  IShaderInputs<T>\n> & {\n  vs?: IShaderExtension;\n  fs?: IShaderExtension;\n};\n\n/**\n * A convenience for making short lists of items that are of the same type, such as the\n * common scenario of [boolean, boolean, boolean, boolean]\n */\nexport type TypeVec<T> = [T] | [T, T] | [T, T, T] | [T, T, T, T];\n\n/**\n * Depicts a two or three dimensional size:\n * [width, height, depth]\n */\nexport type Size = Vec2 | Vec3;\n","export * from \"./common-options\";\nexport * from \"./animation-helper\";\nexport * from \"./auto-easing-method\";\nexport * from \"./chart-camera\";\nexport * from \"./extend-shader-io\";\nexport * from \"./mouse\";\nexport * from \"./reference-camera\";\nexport * from \"./shader-templating\";\nexport * from \"./tracked-quad-tree\";\nexport * from \"./uid\";\nexport * from \"./vector\";\nexport * from \"./matrix\";\nexport * from \"./view-camera\";\nexport * from \"./next-frame\";\nexport * from \"./easing-util\";\n","export * from \"./observable\";\nexport * from \"./instance-provider\";\nexport * from \"./instance\";\nexport * from \"./basic-instance\";\n","/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  '#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC',\n  '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF',\n  '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC',\n  '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF',\n  '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC',\n  '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033',\n  '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366',\n  '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933',\n  '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC',\n  '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF',\n  '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && window.process.type === 'renderer') {\n    return true;\n  }\n\n  // Internet Explorer and Edge do not support colors.\n  if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n    return false;\n  }\n\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n  return (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n    // double check webkit in userAgent just in case we are in a worker\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  try {\n    return JSON.stringify(v);\n  } catch (err) {\n    return '[UnexpectedJSONParseError]: ' + err.message;\n  }\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return;\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit')\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n","const { sqrt, max, min, floor, ceil } = Math;\n\n/** Explicit Vec1 */\nexport interface IVec1 extends Array<number> {\n  0: number;\n  length: 1;\n}\n\n/** Explicit Vec2 */\nexport interface IVec2 extends Array<number> {\n  0: number;\n  1: number;\n  length: 2;\n}\n\n/** Explicit Vec3 */\nexport interface IVec3 extends Array<number> {\n  0: number;\n  1: number;\n  2: number;\n  length: 3;\n}\n\n/** Explicit Vec4 */\nexport interface IVec4 extends Array<number> {\n  0: number;\n  1: number;\n  2: number;\n  3: number;\n  length: 4;\n}\n\n/** Vector of 1 components */\nexport type Vec1 = [number];\n/** Vector of 2 components */\nexport type Vec2 = [number, number];\n/** Vector of 3 components */\nexport type Vec3 = [number, number, number];\n/** Vector of 4 components */\nexport type Vec4 = [number, number, number, number];\n\n/** Compatible types with Vec1 for operations (just not iterating) */\nexport type Vec1Compat = Vec1 | Vec2 | Vec3 | Vec4;\n/** Compatible types with Vec2 for operations (just not iterating) */\nexport type Vec2Compat = Vec2 | Vec3 | Vec4;\n/** Compatible types with Vec3 for operations (just not iterating) */\nexport type Vec3Compat = Vec3 | Vec4;\n/** Compatible types with Vec4 for operations (just not iterating) */\nexport type Vec4Compat = Vec4;\n\n/** This type defines any possible explicit vector */\nexport type IVec = IVec1 | IVec2 | IVec3 | IVec4;\n/** This type defines any possible vector */\nexport type Vec = Vec1 | Vec2 | Vec3 | Vec4;\n\n// Type guards for Vecs\n\nexport function isVec1(val: any): val is Vec1 {\n  return val && Array.isArray(val) && val.length === 1;\n}\n\nexport function isVec2(val: any): val is Vec2 {\n  return val && Array.isArray(val) && val.length === 2;\n}\n\nexport function isVec3(val: any): val is Vec3 {\n  return val && Array.isArray(val) && val.length === 3;\n}\n\nexport function isVec4(val: any): val is Vec4 {\n  return val && Array.isArray(val) && val.length === 4;\n}\n\n// Vec1 methods\n\nexport function add1(left: Vec1Compat, right: Vec1Compat): Vec1 {\n  return [left[0] + right[0]];\n}\n\nexport function ceil1(vec: Vec1Compat): Vec1 {\n  return [ceil(vec[0])];\n}\n\nexport function compare1(left: Vec1Compat, right: Vec1Compat): boolean {\n  return left[0] === right[0];\n}\n\nexport function copy1(vec: Vec1Compat): Vec1 {\n  return [vec[0]];\n}\n\nexport function divide1(top: Vec1Compat, bottom: Vec1Compat): Vec1 {\n  return [top[0] / bottom[0]];\n}\n\nexport function flatten1(list: Vec1Compat[]): number[] {\n  const out: number[] = [];\n\n  for (let i = 0, iMax = list.length; i < iMax; ++i) {\n    out.push(list[i][0]);\n  }\n\n  return out;\n}\n\nexport function floor1(vec: Vec1Compat): Vec1 {\n  return [floor(vec[0])];\n}\n\nexport function inverse1(vec: Vec1Compat): Vec1 {\n  return [1 / vec[0]];\n}\n\nexport function scale1(vec: Vec1Compat, scale: number): Vec1 {\n  return [vec[0] * scale];\n}\n\nexport function subtract1(left: Vec1Compat, right: Vec1Compat): Vec1 {\n  return [left[0] - right[0]];\n}\n\nexport function max1(left: Vec1Compat, right: Vec1Compat): Vec1 {\n  return [max(left[0], right[0])];\n}\n\nexport function min1(left: Vec1Compat, right: Vec1Compat): Vec1 {\n  return [min(left[0], right[0])];\n}\n\nexport function multiply1(left: Vec1Compat, right: Vec1Compat): Vec1 {\n  return [left[0] * right[0]];\n}\n\nexport function dot1(left: Vec1Compat, right: Vec1Compat): number {\n  return left[0] * right[0];\n}\n\nexport function linear1(start: Vec1Compat, end: Vec1Compat, t: number): Vec1 {\n  return scale1(add1(subtract1(end, start), start), t);\n}\n\nexport function length1(start: Vec1Compat): number {\n  return sqrt(dot1(start, start));\n}\n\nexport function vec1(\n  values: number[] | number,\n  ...args: (number | number[])[]\n): Vec1 {\n  let out: number[];\n  args = args || [];\n\n  if (Array.isArray(values)) {\n    out = values.slice(0, 1) as Vec1;\n  } else {\n    out = [values];\n  }\n\n  if (out.length < 1) {\n    for (let i = 0, iMax = args.length; i < iMax && out.length < 1; ++i) {\n      const next = args[i];\n      if (Array.isArray(next)) {\n        out.push(...next.slice(0, 1 - out.length));\n      } else {\n        out.push(next);\n      }\n    }\n  }\n\n  while (out.length < 1) out.push(0);\n\n  return out as Vec1;\n}\n\n// Vec2 methods\n\nexport function add2(left: Vec2Compat, right: Vec2Compat): Vec2 {\n  return [left[0] + right[0], left[1] + right[1]];\n}\n\nexport function ceil2(vec: Vec2Compat): Vec2 {\n  return [ceil(vec[0]), ceil(vec[1])];\n}\n\nexport function copy2(vec: Vec2Compat): Vec2 {\n  return [vec[0], vec[1]];\n}\n\nexport function compare2(left: Vec2Compat, right: Vec2Compat): boolean {\n  return left[0] === right[0] && left[1] === right[1];\n}\n\nexport function divide2(top: Vec2Compat, bottom: Vec2Compat): Vec2 {\n  return [top[0] / bottom[0], top[1] / bottom[1]];\n}\n\nexport function flatten2(list: Vec2Compat[]): number[] {\n  const out: number[] = [];\n\n  for (let i = 0, iMax = list.length; i < iMax; ++i) {\n    const v = list[i];\n    out.push(v[0]);\n    out.push(v[1]);\n  }\n\n  return out;\n}\n\nexport function floor2(vec: Vec2Compat): Vec2 {\n  return [floor(vec[0]), floor(vec[1])];\n}\n\nexport function inverse2(vec: Vec2Compat): Vec2 {\n  return [1 / vec[0], 1 / vec[1]];\n}\n\nexport function max2(left: Vec2Compat, right: Vec2Compat): Vec2 {\n  return [max(left[0], right[0]), max(left[1], right[1])];\n}\n\nexport function min2(left: Vec2Compat, right: Vec2Compat): Vec2 {\n  return [min(left[0], right[0]), min(left[1], right[1])];\n}\n\nexport function scale2(left: Vec2Compat, scale: number): Vec2 {\n  return [left[0] * scale, left[1] * scale];\n}\n\nexport function subtract2(left: Vec2Compat, right: Vec2Compat): Vec2 {\n  return [left[0] - right[0], left[1] - right[1]];\n}\n\nexport function multiply2(left: Vec2Compat, right: Vec2Compat): Vec2 {\n  return [left[0] * right[0], left[1] * right[1]];\n}\n\nexport function dot2(left: Vec2Compat, right: Vec2Compat): number {\n  return left[0] * right[0] + left[1] * right[1];\n}\n\nexport function linear2(start: Vec2Compat, end: Vec2Compat, t: number): Vec2 {\n  return scale2(add2(subtract2(end, start), start), t);\n}\n\nexport function length2(start: Vec2Compat): number {\n  return sqrt(dot2(start, start));\n}\n\nexport function vec2(\n  values: number[] | number,\n  ...args: (number | number[])[]\n): Vec2 {\n  let out: number[];\n  args = args || [];\n\n  if (Array.isArray(values)) {\n    out = values.slice(0, 2) as Vec2;\n  } else {\n    out = [values];\n  }\n\n  if (out.length < 2) {\n    for (let i = 0, iMax = args.length; i < iMax && out.length < 2; ++i) {\n      const next = args[i];\n      if (Array.isArray(next)) {\n        out.push(...next.slice(0, 2 - out.length));\n      } else {\n        out.push(next);\n      }\n    }\n  }\n\n  while (out.length < 2) out.push(0);\n\n  return out as Vec2;\n}\n\n// Vec3 methods\n\nexport function add3(left: Vec3Compat, right: Vec3Compat): Vec3 {\n  return [left[0] + right[0], left[1] + right[1], left[2] + right[2]];\n}\n\nexport function ceil3(vec: Vec3Compat): Vec3 {\n  return [ceil(vec[0]), ceil(vec[1]), ceil(vec[2])];\n}\n\nexport function copy3(vec: Vec3Compat): Vec3 {\n  return [vec[0], vec[1], vec[2]];\n}\n\nexport function compare3(left: Vec3Compat, right: Vec3Compat): boolean {\n  return left[0] === right[0] && left[1] === right[1] && left[2] === right[2];\n}\n\nexport function divide3(top: Vec3Compat, bottom: Vec3Compat): Vec3 {\n  return [top[0] / bottom[0], top[1] / bottom[1], top[2] / bottom[2]];\n}\n\nexport function flatten3(list: Vec3Compat[]): number[] {\n  const out: number[] = [];\n\n  for (let i = 0, iMax = list.length; i < iMax; ++i) {\n    const v = list[i];\n    out.push(v[0]);\n    out.push(v[1]);\n    out.push(v[2]);\n  }\n\n  return out;\n}\n\nexport function floor3(vec: Vec3Compat): Vec3 {\n  return [floor(vec[0]), floor(vec[1]), floor(vec[2])];\n}\n\nexport function inverse3(vec: Vec3Compat): Vec3 {\n  return [1 / vec[0], 1 / vec[1], 1 / vec[2]];\n}\n\nexport function scale3(left: Vec3Compat, scale: number): Vec3 {\n  return [left[0] * scale, left[1] * scale, left[2] * scale];\n}\n\nexport function subtract3(left: Vec3Compat, right: Vec3Compat): Vec3 {\n  return [left[0] - right[0], left[1] - right[1], left[2] - right[2]];\n}\n\nexport function multiply3(left: Vec3Compat, right: Vec3Compat): Vec3 {\n  return [left[0] * right[0], left[1] * right[1], left[2] * right[2]];\n}\n\nexport function linear3(start: Vec3Compat, end: Vec3Compat, t: number): Vec3 {\n  return scale3(add3(subtract3(end, start), start), t);\n}\n\nexport function length3(start: Vec3Compat): number {\n  return sqrt(dot3(start, start));\n}\n\nexport function max3(left: Vec3Compat, right: Vec3Compat): Vec3 {\n  return [\n    max(left[0], right[0]),\n    max(left[1], right[1]),\n    max(left[2], right[2])\n  ];\n}\n\nexport function min3(left: Vec3Compat, right: Vec3Compat): Vec3 {\n  return [\n    min(left[0], right[0]),\n    min(left[1], right[1]),\n    min(left[2], right[2])\n  ];\n}\n\nexport function dot3(left: Vec3Compat, right: Vec3Compat): number {\n  return left[0] * right[0] + left[1] * right[1] + left[2] * right[2];\n}\n\nexport function vec3(\n  values: number[] | number,\n  ...args: (number | number[])[]\n): Vec3 {\n  let out: number[];\n  args = args || [];\n\n  if (Array.isArray(values)) {\n    out = values.slice(0, 3) as Vec3;\n  } else {\n    out = [values];\n  }\n\n  if (out.length < 3) {\n    for (let i = 0, iMax = args.length; i < iMax && out.length < 3; ++i) {\n      const next = args[i];\n      if (Array.isArray(next)) {\n        out.push(...next.slice(0, 3 - out.length));\n      } else {\n        out.push(next);\n      }\n    }\n  }\n\n  while (out.length < 3) out.push(0);\n\n  return out as Vec3;\n}\n\n// Vec4 methods\n\nexport function add4(left: Vec4, right: Vec4): Vec4 {\n  return [\n    left[0] + right[0],\n    left[1] + right[1],\n    left[2] + right[2],\n    left[3] + right[3]\n  ];\n}\n\nexport function ceil4(vec: Vec4Compat): Vec4 {\n  return [ceil(vec[0]), ceil(vec[1]), ceil(vec[2]), ceil(vec[3])];\n}\n\nexport function copy4(vec: Vec4): Vec4 {\n  return [vec[0], vec[1], vec[2], vec[3]];\n}\n\nexport function compare4(left: Vec4Compat, right: Vec4Compat): boolean {\n  return (\n    left[0] === right[0] &&\n    left[1] === right[1] &&\n    left[2] === right[2] &&\n    left[3] === right[3]\n  );\n}\n\nexport function divide4(top: Vec4Compat, bottom: Vec4Compat): Vec4 {\n  return [\n    top[0] / bottom[0],\n    top[1] / bottom[1],\n    top[2] / bottom[2],\n    top[3] / bottom[3]\n  ];\n}\n\nexport function flatten4(list: Vec4Compat[]): number[] {\n  const out: number[] = [];\n\n  for (let i = 0, iMax = list.length; i < iMax; ++i) {\n    const v = list[i];\n    out.push(v[0]);\n    out.push(v[1]);\n    out.push(v[2]);\n    out.push(v[3]);\n  }\n\n  return out;\n}\n\nexport function floor4(vec: Vec4Compat): Vec4 {\n  return [floor(vec[0]), floor(vec[1]), floor(vec[2]), floor(vec[3])];\n}\n\nexport function inverse4(vec: Vec4): Vec4 {\n  return [1 / vec[0], 1 / vec[1], 1 / vec[2], 1 / vec[3]];\n}\n\nexport function scale4(left: Vec4, scale: number): Vec4 {\n  return [left[0] * scale, left[1] * scale, left[2] * scale, left[3] * scale];\n}\n\nexport function subtract4(left: Vec4, right: Vec4): Vec4 {\n  return [\n    left[0] - right[0],\n    left[1] - right[1],\n    left[2] - right[2],\n    left[3] - right[3]\n  ];\n}\n\nexport function multiply4(left: Vec4, right: Vec4): Vec4 {\n  return [\n    left[0] * right[0],\n    left[1] * right[1],\n    left[2] * right[2],\n    left[3] * right[3]\n  ];\n}\n\nexport function dot4(left: Vec4, right: Vec4): number {\n  return (\n    left[0] * right[0] +\n    left[1] * right[1] +\n    left[2] * right[2] +\n    left[3] * right[3]\n  );\n}\n\nexport function linear4(start: Vec4, end: Vec4, t: number): Vec4 {\n  return scale4(add4(subtract4(end, start), start), t);\n}\n\nexport function length4(start: Vec4): number {\n  return sqrt(dot4(start, start));\n}\n\nexport function max4(left: Vec4Compat, right: Vec4Compat): Vec4 {\n  return [\n    max(left[0], right[0]),\n    max(left[1], right[1]),\n    max(left[2], right[2]),\n    max(left[3], right[3])\n  ];\n}\n\nexport function min4(left: Vec4Compat, right: Vec4Compat): Vec4 {\n  return [\n    min(left[0], right[0]),\n    min(left[1], right[1]),\n    min(left[2], right[2]),\n    min(left[3], right[3])\n  ];\n}\n\nexport function vec4(\n  values: number[] | number,\n  ...args: (number | number[])[]\n): Vec4 {\n  let out: number[];\n  args = args || [];\n\n  if (Array.isArray(values)) {\n    out = values.slice(0, 4) as Vec4;\n  } else {\n    out = [values];\n  }\n\n  if (out.length < 4) {\n    for (let i = 0, iMax = args.length; i < iMax && out.length < 4; ++i) {\n      const next = args[i];\n      if (Array.isArray(next)) {\n        out.push(...next.slice(0, 4 - out.length));\n      } else {\n        out.push(next);\n      }\n    }\n  }\n\n  while (out.length < 4) out.push(0);\n\n  return out as Vec4;\n}\n\n// Vec method aggregations\n\nexport type VecMethods<T extends Vec> = {\n  add(left: T, right: T): T;\n  ceil(vec: T): T;\n  copy(vec: T): T;\n  compare(left: T, right: T): boolean;\n  divide(top: T, bottom: T): T;\n  dot(left: T, right: T): number;\n  flatten(list: T[]): number[];\n  floor(vec: T): T;\n  inverse(vec: T): T;\n  length(vec: T): number;\n  linear(start: T, end: T, t: number): T;\n  max(left: T, right: T): T;\n  min(left: T, right: T): T;\n  multiply(left: T, right: T): T;\n  scale(vec: T, scale: number): T;\n  subtract(left: T, right: T): T;\n};\n\nexport const vec1Methods: VecMethods<Vec1> = {\n  add: add1,\n  ceil: ceil1,\n  copy: copy1,\n  compare: compare1,\n  divide: divide1,\n  dot: dot1,\n  flatten: flatten1,\n  floor: floor1,\n  inverse: inverse1,\n  length: length1,\n  linear: linear1,\n  max: max1,\n  min: min1,\n  multiply: multiply1,\n  scale: scale1,\n  subtract: subtract1\n};\n\nexport const vec2Methods: VecMethods<Vec2> = {\n  add: add2,\n  ceil: ceil2,\n  copy: copy2,\n  compare: compare2,\n  divide: divide2,\n  dot: dot2,\n  flatten: flatten2,\n  floor: floor2,\n  inverse: inverse2,\n  length: length2,\n  linear: linear2,\n  max: max2,\n  min: min2,\n  multiply: multiply2,\n  scale: scale2,\n  subtract: subtract2\n};\n\nexport const vec3Methods: VecMethods<Vec3> = {\n  add: add3,\n  ceil: ceil3,\n  copy: copy3,\n  compare: compare3,\n  divide: divide3,\n  dot: dot3,\n  flatten: flatten3,\n  floor: floor3,\n  inverse: inverse3,\n  length: length3,\n  linear: linear3,\n  max: max3,\n  min: min3,\n  multiply: multiply3,\n  scale: scale3,\n  subtract: subtract3\n};\n\nexport const vec4Methods: VecMethods<Vec4> = {\n  add: add4,\n  ceil: ceil4,\n  copy: copy4,\n  compare: compare4,\n  divide: divide4,\n  dot: dot4,\n  flatten: flatten4,\n  floor: floor4,\n  inverse: inverse4,\n  length: length4,\n  linear: linear4,\n  max: max4,\n  min: min4,\n  multiply: multiply4,\n  scale: scale4,\n  subtract: subtract4\n};\n\nexport function VecMath<T extends IVec>(vec: T): VecMethods<T> {\n  let methods: VecMethods<T>;\n\n  if (vec.length === 1) {\n    methods = vec1Methods as VecMethods<T>;\n    return methods;\n  } else if (vec.length === 2) {\n    methods = vec2Methods as VecMethods<T>;\n    return methods;\n  } else if (vec.length === 3) {\n    methods = vec3Methods as VecMethods<T>;\n    return methods;\n  }\n\n  methods = vec4Methods as VecMethods<T>;\n\n  return methods;\n}\n","import { Vec2 } from \"../util\";\n\nexport interface IBoundsOptions {\n  /** Top left x position */\n  x?: number;\n  /** Top left y position */\n  y?: number;\n  /** Width covered */\n  width?: number;\n  /** height covered */\n  height?: number;\n\n  /** Specify the left */\n  left?: number;\n  /** Specify the right */\n  right?: number;\n  /** Specify the top */\n  top?: number;\n  /** Specify the bottom */\n  bottom?: number;\n}\n\n/**\n * Class to manage the x, y, width, and height of an object\n *\n * @template T This specifies the data type associated with this shape and is accessible\n *             via the property 'd'\n */\nexport class Bounds {\n  x: number = 0;\n  y: number = 0;\n  width: number = 0;\n  height: number = 0;\n\n  get area() {\n    return this.width * this.height;\n  }\n\n  get bottom() {\n    return this.y + this.height;\n  }\n\n  get left() {\n    return this.x;\n  }\n\n  get mid(): Vec2 {\n    return [this.x + this.width / 2.0, this.y + this.height / 2.0];\n  }\n\n  get right() {\n    return this.x + this.width;\n  }\n\n  get top() {\n    return this.y;\n  }\n\n  static emptyBounds() {\n    return new Bounds({\n      height: 0,\n      width: 0,\n      x: 0,\n      y: 0\n    });\n  }\n\n  /**\n   * Create a new instance\n   *\n   * @param left  The left side (x coordinate) of the instance\n   * @param right The right side of the instance\n   * @param top The top (y coordinate) of the instance\n   * @param bottom The bottom of the instance\n   */\n  constructor(options: IBoundsOptions) {\n    this.x = options.x || options.left || 0;\n    this.y = options.y || options.top || 0;\n    this.height = options.height || (options.bottom || 0) - this.y || 0;\n    this.width = options.width || (options.right || 0) - this.x || 0;\n  }\n\n  /**\n   * Checks to see if a point is within this bounds object.\n   *\n   * @param point\n   */\n  containsPoint(point: Vec2) {\n    return !(\n      point[0] < this.x ||\n      point[1] < this.y ||\n      point[0] > this.right ||\n      point[1] > this.bottom\n    );\n  }\n\n  /**\n   * Grows this bounds object to cover the space of the provided bounds object\n   *\n   * @param item\n   */\n  encapsulate(item: Bounds | Vec2) {\n    if (item instanceof Bounds) {\n      if (item.x < this.x) {\n        this.width += Math.abs(item.x - this.x);\n        this.x = item.x;\n      }\n\n      if (item.y < this.y) {\n        this.height += Math.abs(item.y - this.y);\n        this.y = item.y;\n      }\n\n      if (this.right < item.right) {\n        this.width += item.right - this.right;\n      }\n\n      if (this.bottom < item.bottom) {\n        this.height += item.bottom - this.bottom;\n      }\n\n      return true;\n    } else {\n      if (item[0] < this.x) {\n        this.width += this.x - item[0];\n        this.x = item[0];\n      }\n\n      if (item[0] > this.right) {\n        this.width += item[0] - this.x;\n      }\n\n      if (item[1] < this.y) {\n        this.height += this.y - item[1];\n        this.y = item[1];\n      }\n\n      if (item[1] > this.bottom) {\n        this.height += item[1] - this.y;\n      }\n\n      return true;\n    }\n  }\n\n  /**\n   * Checks to see if the provided bounds object could fit within the dimensions of this bounds object\n   * This ignores position and just checks width and height.\n   *\n   * @param bounds\n   *\n   * @return {number} 0 if it doesn't fit. 1 if it fits perfectly. 2 if it just fits.\n   */\n  fits(bounds: Bounds): 0 | 1 | 2 {\n    // If the same, the bounds fits exactly into this bounds\n    if (this.width === bounds.width && this.height === bounds.height) {\n      return 1;\n    }\n\n    // The bounds can fit within this, then it just fits\n    if (this.width >= bounds.width && this.height >= bounds.height) {\n      return 2;\n    }\n\n    // Otherwise, the bounds does not fit within this bounds\n    return 0;\n  }\n\n  /**\n   * Checks if a bounds object intersects another bounds object.\n   *\n   * @param bounds\n   */\n  hitBounds(bounds: Bounds) {\n    return !(\n      this.right < bounds.x ||\n      this.x > bounds.right ||\n      this.bottom < bounds.y ||\n      this.y > bounds.height\n    );\n  }\n\n  /**\n   * Sees if the provided bounds is completely within this bounds object. Unlike fits() this takes\n   * position into account.\n   *\n   * @param bounds\n   */\n  isInside(bounds: Bounds): boolean {\n    return (\n      this.x >= bounds.x &&\n      this.right <= bounds.right &&\n      this.y >= bounds.y &&\n      this.bottom <= bounds.bottom\n    );\n  }\n\n  /**\n   * Top left position of the bounds\n   */\n  get location(): Vec2 {\n    return [this.x, this.y];\n  }\n\n  /**\n   * Easy readout of this Bounds object.\n   */\n  toString() {\n    return `{x: ${this.x} y:${this.y} w:${this.width} h:${this.height}}`;\n  }\n}\n","import { Geometry } from \"../gl/geometry\";\nimport { Material } from \"../gl/material\";\nimport { Model } from \"../gl/model\";\nimport { Instance } from \"../instance-provider/instance\";\nimport { InstanceDiff } from \"../instance-provider/instance-provider\";\nimport { ObservableMonitoring } from \"../instance-provider/observable\";\nimport { ResourceManager } from \"../resources\";\nimport {\n  IInstanceAttribute,\n  ILayerMaterialOptions,\n  INonePickingMetrics,\n  InstanceAttributeSize,\n  InstanceBlockIndex,\n  InstanceDiffType,\n  InstanceHitTest,\n  InstanceIOValue,\n  IPickInfo,\n  IQuadTreePickingMetrics,\n  IShaderInitialization,\n  ISinglePickingMetrics,\n  IUniform,\n  IUniformInternal,\n  IVertexAttributeInternal,\n  PickType,\n  ShaderInjectionTarget,\n  UniformIOValue,\n  UniformSize\n} from \"../types\";\nimport { BoundsAccessor, TrackedQuadTree, uid } from \"../util\";\nimport { IdentifyByKey, IdentifyByKeyOptions } from \"../util/identify-by-key\";\nimport {\n  BufferManagerBase,\n  IBufferLocation\n} from \"./buffer-management/buffer-manager-base\";\nimport { InstanceDiffManager } from \"./buffer-management/instance-diff-manager\";\nimport { LayerInteractionHandler } from \"./layer-interaction-handler\";\nimport { LayerBufferType } from \"./layer-processing/layer-buffer-type\";\nimport { LayerInitializer, LayerSurface } from \"./layer-surface\";\nimport { View } from \"./view\";\n\n/**\n * Bare minimum required features a provider must provide to be the data for the layer.\n */\nexport interface IInstanceProvider<T extends Instance> {\n  /**\n   * This indicates the context this provider was handled within. Currently, only one context is allowed per provider,\n   * so we use this to detect when multiple contexts have attempted use of this provider.\n   */\n  resolveContext: string;\n  /** A unique number making it easier to identify this object */\n  uid: number;\n\n  /** A list of changes to instances */\n  changeList: InstanceDiff<T>[];\n  /** Removes an instance from the list */\n  remove(instance: T): void;\n  /** Resolves the changes as consumed */\n  resolve(context: string): void;\n  /** Forces the provider to make a change list that ensures all elements are added */\n  sync(): void;\n}\n\n/**\n * Constructor options when generating a layer.\n */\nexport interface ILayerProps<T extends Instance> extends IdentifyByKeyOptions {\n  /** This is the data provider where the instancing data is injected and modified. */\n  data: IInstanceProvider<T>;\n  /**\n   * Any pipeline declaring a layer cn manipulate a layer's default material settings as every pipeline\n   * can have some specific and significant needs the layer does not provide as a default.\n   */\n  materialOptions?: ILayerMaterialOptions;\n  /**\n   * This sets how instances can be picked via the mouse. This activates the mouse events for the layer IFF\n   * the value is not NONE.\n   */\n  picking?: PickType;\n  /**\n   * Used for debugging. Logs the generated shader for the layer in the console.\n   */\n  printShader?: boolean;\n  /**\n   * This identifies the scene we want the layer to be a part of.\n   * Layer's with the same identifiers will render their buffers in the same scene.\n   * This only applies to the layer when the layer is initialized in a layer surface. You shouldn't\n   * be swapping layers from scene to scene.\n   *\n   * The scene identifier must be an identifier used when constructing the layer surface that this layer\n   * is added to.\n   */\n  scene: string;\n\n  // ---- EVENTS ----\n  /** Executes when the mouse is down on instances and a picking type is set */\n  onMouseDown?(info: IPickInfo<T>): void;\n  /** Executes when the mouse moves on instances and a picking type is set */\n  onMouseMove?(info: IPickInfo<T>): void;\n  /** Executes when the mouse no longer over instances and a picking type is set */\n  onMouseOut?(info: IPickInfo<T>): void;\n  /** Executes when the mouse is newly over instances and a picking type is set */\n  onMouseOver?(info: IPickInfo<T>): void;\n  /** Executes when the mouse button is release when over instances and a picking type is set */\n  onMouseUp?(info: IPickInfo<T>): void;\n  /** Executes when the mouse click gesture is executed over instances and a picking type is set */\n  onMouseClick?(info: IPickInfo<T>): void;\n}\n\n/**\n * Layer properties that contains internal system values\n */\nexport interface ILayerPropsInternal<T extends Instance>\n  extends ILayerProps<T> {\n  /** The system provides this for the layer when the layer is being produced as a child of another layer */\n  parent?: Layer<Instance, ILayerProps<Instance>>;\n}\n\nexport interface IPickingMethods<T extends Instance> {\n  /** This provides a way to calculate bounds of an Instance */\n  boundsAccessor: BoundsAccessor<T>;\n  /** This is the way the system tests hitting an intsance */\n  hitTest: InstanceHitTest<T>;\n}\n\n/**\n * A base class for generating drawable content\n */\nexport class Layer<\n  T extends Instance,\n  U extends ILayerProps<T>\n> extends IdentifyByKey {\n  /** This MUST be implemented by sublayers in order for proper code hinting to happen */\n  static defaultProps: any = {};\n\n  /** This is the attribute that specifies the _active flag for an instance */\n  activeAttribute: IInstanceAttribute<T>;\n  /**\n   * Calculated end time of all animations that will take place. This will cause the system to keep rendering\n   * and not go into an idle state until the time of the last rendered frame has exceeded the time flagged\n   * here.\n   */\n  animationEndTime: number = 0;\n  /** This matches an instance to the list of Three uniforms that the instance is responsible for updating */\n  private _bufferManager: BufferManagerBase<T, IBufferLocation>;\n  /** Buffer manager is read only. Must use setBufferManager */\n  get bufferManager() {\n    return this._bufferManager;\n  }\n  /** This is the determined buffering strategy of the layer */\n  private _bufferType: LayerBufferType;\n  /** Buffer type is private and should not be directly modified */\n  get bufferType() {\n    return this._bufferType;\n  }\n  /** When a layer creates children, this is populated with those children */\n  children?: Layer<Instance, ILayerProps<Instance>>[];\n  /** This determines the drawing order of the layer within it's scene */\n  depth: number = 0;\n  /** This contains the methods and controls for handling diffs for the layer */\n  diffManager: InstanceDiffManager<T>;\n  /**\n   * This gets populated when there are attributes that have easing applied to them. This\n   * subsequently gets applied to instances when they get added to the layer.\n   */\n  easingId: { [key: string]: number };\n  /** This is the threejs geometry filled with the vertex information */\n  geometry: Geometry;\n  /** This is the initializer used when making this layer. */\n  initializer: LayerInitializer;\n  /** This is all of the instance attributes generated for the layer */\n  instanceAttributes: IInstanceAttribute<T>[] = [];\n  /** Provides the number of vertices a single instance spans */\n  instanceVertexCount: number = 0;\n  /** This is the handler that manages interactions for the layer */\n  interactions: LayerInteractionHandler<T, U>;\n  /** The last time stamp this layer had its contents rendered */\n  lastFrameTime: number = 0;\n  /** The official shader material generated for the layer */\n  material: Material;\n  /** INTERNAL: For the given shader IO provided this is how many instances can be present per buffer. */\n  maxInstancesPerBuffer: number;\n  /** Default model configuration for rendering in the gl layer */\n  model: Model;\n  /** This indicates whether this layer needs to draw */\n  needsViewDrawn: boolean = false;\n  /** If this is populated, then this layer is the product of a parent producing this layer. */\n  parent?: Layer<Instance, ILayerProps<Instance>>;\n  /** This is all of the picking metrics kept for handling picking scenarios */\n  picking:\n    | IQuadTreePickingMetrics<T>\n    | ISinglePickingMetrics<T>\n    | INonePickingMetrics;\n  /** Properties handed to the Layer during a LayerSurface render */\n  props: U;\n  /** This is the system provided resource manager that lets a layer request Atlas resources */\n  resource: ResourceManager;\n  /** This is the surface this layer is generated under */\n  surface: LayerSurface;\n  /** This is all of the uniforms generated for the layer */\n  uniforms: IUniformInternal[] = [];\n  /** A uid provided to the layer to give it some uniqueness as an object */\n  get uid() {\n    return this._uid;\n  }\n  private _uid: number = uid();\n  /** This is all of the vertex attributes generated for the layer */\n  vertexAttributes: IVertexAttributeInternal[] = [];\n  /** This is the view the layer is applied to. The system sets this, modifying will only cause sorrow. */\n  view: View;\n  /** This flag indicates if the layer will be reconstructed from scratch next layer rendering cycle */\n  willRebuildLayer: boolean = false;\n\n  constructor(props: ILayerProps<T>) {\n    // We do not establish bounds in the layer. The surface manager will take care of that for us\n    // After associating the layer with the view it is a part of.\n    super(props);\n    // Keep our props within the layer\n    this.props = Object.assign({}, Layer.defaultProps || {}, props as U);\n    // Set up the pick type for the layer\n    const { picking = PickType.NONE } = this.props;\n\n    // If ALL is specified we set up QUAD tree picking for our instances\n    if (picking === PickType.ALL) {\n      const pickingMethods = this.getInstancePickingMethods();\n\n      this.picking = {\n        currentPickMode: PickType.NONE,\n        hitTest: pickingMethods.hitTest,\n        quadTree: new TrackedQuadTree<T>(\n          0,\n          1,\n          0,\n          1,\n          pickingMethods.boundsAccessor\n        ),\n        type: PickType.ALL\n      };\n    } else if (picking === PickType.SINGLE) {\n      this.picking = {\n        currentPickMode: PickType.NONE,\n        type: PickType.SINGLE,\n        uidToInstance: new Map<number, T>()\n      };\n    } else {\n      this.picking = {\n        currentPickMode: PickType.NONE,\n        type: PickType.NONE\n      };\n    }\n  }\n\n  /**\n   * This establishes basic modules required by the layer for the shaders. At it's core functionality, it will\n   * support the basic properties a layer has to provide, such as Picking modes\n   */\n  baseShaderModules(\n    shaderIO: IShaderInitialization<T>\n  ): { fs: string[]; vs: string[] } {\n    const additionalImportsVS = [];\n    const additionalImportsFS = [];\n\n    // All layers need the basic instancing functionality\n    additionalImportsVS.push(\"instancing\");\n\n    // See if the layer needs picking modules\n    if (this.picking.type === PickType.SINGLE) {\n      additionalImportsVS.push(\"picking\");\n      additionalImportsFS.push(\"picking\");\n    } else {\n      additionalImportsVS.push(\"no-picking\");\n      additionalImportsFS.push(\"no-picking\");\n    }\n\n    // See if there are any attributes that have  auto easing involved\n    const easing = (shaderIO.instanceAttributes || []).find(check =>\n      Boolean(check && check.easing)\n    );\n\n    // If easing is involved then we need to make sure that frame metrics are imported for our animations\n    if (easing) {\n      additionalImportsVS.push(\"frame\");\n    }\n\n    return {\n      fs: additionalImportsFS,\n      vs: additionalImportsVS\n    };\n  }\n\n  /**\n   * This provides a means for a layer to have child layers that are injected immediately after this layer.\n   *\n   * This essentially lets composite layer management occur allowing the compositer to behave as a layer does\n   * but have layers managed by it. This has the advantage of allowing a composition layer able to handle a\n   * data provider but split it's processing across it's own internal data providers which is thus picked up\n   * by it's child layers and output by the layers.\n   */\n  childLayers(): LayerInitializer[] {\n    return [];\n  }\n\n  /**\n   * Invalidate and free all resources assocated with this layer.\n   */\n  destroy() {\n    if (this.bufferManager) {\n      if (this.bufferManager.scene) this.bufferManager.scene.removeLayer(this);\n      this.bufferManager.removeFromScene();\n      this.bufferManager.destroy();\n    }\n  }\n\n  /**\n   * Lifecycle method for layers to inherit that executes after the props for the layer have been updated\n   */\n  didUpdateProps() {\n    /** LIFECYCLE */\n  }\n\n  /**\n   * This is where global uniforms should update their values. Executes every frame.\n   */\n  draw() {\n    // Consume the diffs for the instances to update each element\n    const changeList = this.props.data.changeList;\n    // Set needsViewDrawn to be true if there is any change\n    if (changeList.length > 0) this.needsViewDrawn = true;\n    // Make some holder variables to prevent declaration within the loop\n    let change, instance, bufferLocations;\n    // Fast ref to the processor and manager\n    const diffManager = this.diffManager;\n    const processing = diffManager.processing;\n    const processor = diffManager.processor;\n\n    // Forewarn the processor how many instances are flagged for a change.\n    processor.incomingChangeList(changeList);\n    // Forewarn the buffer manager of changes so it can optimize it's handling of changes as well\n    this.bufferManager.incomingChangeList(changeList);\n\n    for (let i = 0, end = changeList.length; i < end; ++i) {\n      change = changeList[i];\n      instance = change[0];\n      bufferLocations = this.bufferManager.getBufferLocations(instance);\n      // The diff type is change[1] which we use to find the diff processing method to use\n      processing[change[1]](\n        processor,\n        instance,\n        Object.values(change[2]),\n        bufferLocations\n      );\n      // Clear the changes for the instance\n      instance.changes = {};\n    }\n\n    // Tell the diff processor that it has completed it's task set\n    processor.commit();\n    // Tell the manager changes are processed to allow it to free up resources\n    this.bufferManager.changesProcessed();\n    // Flag the changes as resolved\n    this.props.data.resolve(this.id);\n    // Trigger uniform updates\n    this.updateUniforms();\n  }\n\n  /**\n   * This retrieves the observable IDs for instance observable properties. This triggers a\n   * getter of the indicated property.\n   *\n   * Do NOT use this in intensive loops, try to cache these results where possible.\n   */\n  getInstanceObservableIds<K extends keyof T>(\n    instance: T,\n    properties: Extract<K, string>[]\n  ): { [key: string]: number } {\n    const out: { [key: string]: number } = {};\n\n    // Loop through all of the requested properties to see if they are observable and have\n    // an id associated with them.\n    for (let i = 0, iMax = properties.length; i < iMax; ++i) {\n      // Activate monitoring of ids, this also resets the monitor's list\n      ObservableMonitoring.setObservableMonitor(true);\n      // Trigger the getter of the property\n      instance[properties[i]];\n      // We now can see if the property triggered an identifier thus indicating it's observable\n      // and has an ID\n      const propertyIds = ObservableMonitoring.getObservableMonitorIds(true);\n\n      // If an id is found, then the property was observable.\n      if (propertyIds[0] !== undefined) {\n        out[properties[i]] = propertyIds[0];\n      }\n    }\n\n    // SUPER IMPORTANT to deactivate this here. Leaving this turned on causes memory to be chewed up\n    // for every property getter.\n    ObservableMonitoring.setObservableMonitor(false);\n\n    return out;\n  }\n\n  /**\n   * This method is for layers to implement to specify how the bounds for an instance are retrieved or\n   * calculated and how the Instance interacts with a point. This is REQUIRED to support PickType.ALL on the layer.\n   */\n  getInstancePickingMethods(): IPickingMethods<T> {\n    throw new Error(\n      \"When picking is set to PickType.ALL, the layer MUST have this method implemented; otherwise, the layer is incompatible with this picking mode.\"\n    );\n  }\n\n  /**\n   * The options for a three material without uniforms.\n   */\n  getMaterialOptions(): ILayerMaterialOptions {\n    return {};\n  }\n\n  /**\n   * This sets up all of the data bindings that will transport data from the CPU\n   * to the Shader on the GPU.\n   *\n   * Instance Attributes: These are very frequently changing attributes\n   * Vertex Attributes: These are attributes that should be static on a vertex. Conisder it very costly to update.\n   *                    The only time making these modifieable is in the event of GL_POINTS.\n   * Uniforms: These set up the uniforms for the layer, thus having all normal implications of a uniform. Global\n   *           across the fragment and vertex shaders and can be modified with little consequence.\n   *\n   * NOTE: Return null to indicate this layer is not going to render anything. This is typical for parent\n   * layers that manage child layers who themselves do not cause rendering of any sort.\n   */\n  initShader(): IShaderInitialization<T> | null {\n    return {\n      fs: \"${import: no-op}\",\n      instanceAttributes: [],\n      uniforms: [],\n      vertexAttributes: [],\n      vertexCount: 0,\n      vs: \"${import: no-op}\"\n    };\n  }\n\n  /**\n   * Helper method for making an instance attribute. Depending on set up, this makes creating elements\n   * have better documentation when typing out the elements.\n   */\n  makeInstanceAttribute(\n    block: number,\n    blockIndex: InstanceBlockIndex,\n    name: string,\n    size: InstanceAttributeSize,\n    update: (o: T) => InstanceIOValue,\n    resource?: {\n      type: number;\n      key: string;\n      name: string;\n      shaderInjection?: ShaderInjectionTarget;\n    }\n  ): IInstanceAttribute<T> {\n    return {\n      resource,\n      block,\n      blockIndex,\n      name,\n      size,\n      update\n    };\n  }\n\n  /**\n   * Helper method for making a uniform type. Depending on set up, this makes creating elements\n   * have better documentation when typing out the elements.\n   */\n  makeUniform(\n    name: string,\n    size: UniformSize,\n    update: (o: IUniform) => UniformIOValue,\n    shaderInjection?: ShaderInjectionTarget,\n    qualifier?: string\n  ): IUniform {\n    return {\n      name,\n      qualifier,\n      shaderInjection,\n      size,\n      update\n    };\n  }\n\n  /**\n   * Indicates if this layer is managing an instance or not. This is normally done by determining\n   * if this layer's buffer manager has assigned buffer space to the instance. In special layer cases\n   * this may be overridden here to make the assertion in some other way.\n   */\n  managesInstance(instance: T): boolean {\n    return this.bufferManager && this.bufferManager.managesInstance(instance);\n  }\n\n  /**\n   * This tells the framework to rebuild the layer from scratch, thus reconstructing the shaders and geometries\n   * of the layer.\n   */\n  rebuildLayer() {\n    this.willRebuildLayer = true;\n\n    // Children will be rebuilt as well\n    if (this.children) {\n      for (let i = 0, iMax = this.children.length; i < iMax; ++i) {\n        const child = this.children[i];\n        child.rebuildLayer();\n      }\n    }\n  }\n\n  /**\n   * Retrieves the changes from the data provider and resolves the provider. This should be\n   * used by sub Layer classes that wish to create their own custom draw handlers.\n   *\n   * Set preserverProvider to true to let the system know the provider's changes are still\n   * required.\n   */\n  resolveChanges(preserveProvider?: boolean) {\n    // Consume the diffs for the instances to update each element\n    const changeList = this.props.data.changeList;\n    // Set needsViewDrawn to be true if there is any change\n    if (changeList.length > 0) this.needsViewDrawn = true;\n\n    // See if we should make the provider not consume it's changes yet\n    if (!preserveProvider) {\n      // Resolve the changes from the provider so it can start collecting\n      // a new list of changes to apply\n      this.props.data.resolve(this.id);\n    }\n\n    // Clear the changes from all instances to be ready for next frame\n    for (let i = 0, iMax = changeList.length; i < iMax; ++i) {\n      changeList[i][0].changes = {};\n    }\n\n    // Return the list of changes so the changes can be handled in some fashion\n    return changeList;\n  }\n\n  /**\n   * Applies a buffer manager to the layer which handles instance changes and applies those changes\n   * to an appropriate buffer at the appropriate location.\n   */\n  setBufferManager(bufferManager: BufferManagerBase<T, IBufferLocation>) {\n    if (!this._bufferManager) {\n      this._bufferManager = bufferManager;\n      this.diffManager = new InstanceDiffManager<T>(this, bufferManager);\n      this.diffManager.makeProcessor();\n    } else {\n      console.warn(\n        \"You can not change a layer's buffer strategy once it has been instantiated.\"\n      );\n    }\n  }\n\n  /**\n   * Only allows the buffer type to be set once\n   */\n  setBufferType(val: LayerBufferType) {\n    if (this._bufferType === undefined) {\n      this._bufferType = val;\n    } else {\n      console.warn(\n        \"You can not change a layers buffer strategy once it has been instantiated.\"\n      );\n    }\n  }\n\n  /**\n   * This method returns a flag indicating whether or not the layer should trigger it's view to redraw.\n   * By default, a redraw is triggered (this returns true) when a shallow comparison of the current props\n   * and the incoming props are different.\n   * This method can be overridden to place custom logic at this point to indicate when redraws should happen.\n   *\n   * NOTE: This should be considered for redraw logic centered around changes in the layer itself.\n   * There ARE additional triggers in the system that causes redraws. This method just aids in ensuring\n   * necessary redraws take place for layer level logic and props.\n   */\n  shouldDrawView(oldProps: U, newProps: U) {\n    for (const key in newProps) {\n      if (newProps[key] !== oldProps[key]) return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * This triggers the layer to update the material uniforms that have been created for the layer.\n   * This is primarily used internally.\n   */\n  updateUniforms() {\n    let uniform: IUniformInternal;\n    let value: UniformIOValue;\n\n    // Loop through the uniforms that are across all instances\n    for (let i = 0, end = this.uniforms.length; i < end; ++i) {\n      uniform = this.uniforms[i];\n      value = uniform.update(uniform);\n      uniform.materialUniforms.forEach(\n        materialUniform => (materialUniform.value = value)\n      );\n    }\n  }\n\n  willUpdateInstances(_changes: [T, InstanceDiffType]) {\n    // HOOK: Simple hook so a class can review all of it's changed instances before\n    //       Getting applied to the Shader IO\n  }\n\n  willUpdateProps(_newProps: ILayerProps<T>) {\n    /** LIFECYCLE */\n  }\n}\n","import { Identifiable, IEasingControl, IEasingProps } from \"../types\";\nimport { EasingProps } from \"../util/easing-props\";\nimport { InstanceProvider } from \"./instance-provider\";\nimport { observable } from \"./observable\";\n\nlet instanceUID = 0;\n\nexport interface IInstanceOptions {\n  /** The instance can be declared with an initial active state */\n  active?: boolean;\n  /** An instance must be declared with an identifier */\n  id?: string;\n}\n\nexport class Instance implements Identifiable {\n  static get newUID() {\n    return (instanceUID = ++instanceUID % 0xffffff);\n  }\n\n  /** This indicates when the instance is active / rendering */\n  @observable active: boolean;\n  /** The property changes on the instance */\n  changes: { [key: number]: number } = {};\n  /**\n   * This is a lookup that provides a means to retrieve the id of an easing type currently available to the instance.\n   * This is populated when the instance becomes a part of a layer with easing attributes.\n   *\n   * This property is to NOT be mutated except by the system.\n   */\n  easingId: { [key: string]: number } | undefined;\n  /** This is an internal easing object to track properties for automated easing */\n  private _easing = new Map<number, IEasingProps>();\n  /** Internal, non-changeable id */\n  private _id: string;\n  /** This is the observer of the Instance's observable properties */\n  private _observer: InstanceProvider<this> | null;\n  /** This is where observables store their data for the instance */\n  observableStorage: any[] = [];\n  /** A numerical look up for the instance. Numerical identifiers run faster than objects or strings */\n  @observable private _uid = Instance.newUID;\n\n  /**\n   * Retrieves a method for disposing the link between observables and observer.\n   */\n  get observableDisposer(): () => void {\n    return () => delete this._observer;\n  }\n\n  /**\n   * Retrieves the observer of the observables.\n   */\n  get observer(): InstanceProvider<this> | null {\n    return this._observer || null;\n  }\n\n  /**\n   * Applies an observer for changes to the observables.\n   */\n  set observer(val: InstanceProvider<this> | null) {\n    // If an observer already is present, we should inform it, that it is being removed\n    // in favor of a new observer\n    const oldObserver = this._observer;\n\n    // If we're switching observers, then we have to dump out assumptions made within other observers\n    if (oldObserver && oldObserver !== val) {\n      this._easing.clear();\n      oldObserver.remove(this);\n    }\n\n    // Apply the new observer as the current observer\n    this._observer = val;\n  }\n\n  /**\n   * This clears any lingering easing information that may have been registered with the instance.\n   */\n  clearEasing() {\n    this._easing.clear();\n    delete this.easingId;\n  }\n\n  /**\n   * Retrieves easing properties for the observables that are associated with easing.\n   */\n  get easing() {\n    return this._easing;\n  }\n\n  /**\n   * This attempts to get the easing object for this instance for a given attribute that it MIGHT be associated with.\n   *\n   * When an instance is added to a layer and the layer has attributes with easing applied to them, the instance gains easing values\n   * for the attributes in the layer with applied easing.\n   *\n   * You can access the easing values by requesting the attribute's \"name\" property value using this method.\n   *\n   * There is NO WAY TO GUARANTEE this value is set or available, so this method WILL return undefined if you did\n   * not use the correct name, or no such value exists, or the layer decided to not make the attribute animateable.\n   *\n   * Thus ALWAYS check the returned value to ensure it is defined before attempting to use it's results.\n   *\n   * PERFORMANCE: You can probably get much better performance NOT using this to manipulate the easing object directly.\n   * The system is designed to automatically animate an item from it's current rendered location to the next location\n   * seamlessly thus accounting for most situations. This method is provided to commit much more complex start, duration,\n   * and delay animations within a given frame to prevent the need for complicated setTimeout patterns.\n   *\n   * This CAN be faster than the default behavior if it avoids causing complicated easing computations to determine where\n   * the rendering should be at the moment (complicated cpu methods within the IAutoEasingMethod used).\n   */\n  getEasing(attributeName: string): IEasingControl | undefined {\n    if (this.easingId) {\n      // If easing has been applied to an attribute, the attribute that will have it is the name mangled\n      // _{base name}_end format.\n      const easingId = this.easingId[`_${attributeName}_end`];\n\n      if (easingId) {\n        const easing = this._easing.get(easingId);\n\n        if (easing instanceof EasingProps) {\n          return easing;\n        }\n      }\n    }\n\n    return;\n  }\n\n  /**\n   * Get the applied id of this instance\n   */\n  get id() {\n    return this._id;\n  }\n\n  /**\n   * Get the auto generated ID of this instance\n   */\n  get uid() {\n    return this._uid;\n  }\n\n  /**\n   * This method is utilized internally to indicate when requested resources are ready.\n   * If you have a property that will be requesting a resource, you should implement this method\n   * to cause a trigger for the property to activate such that the property will update it's buffer.\n   */\n  resourceTrigger() {\n    // No default behavior, subclasses must override and provide behavior.\n    console.warn(\n      \"resourceTrigger called on an instance that did not override resourceTrigger. resourceTrigger MUST be overridden for instances\",\n      \"that utilize a resource. The observable that is tied to committing the resource should be 'triggered' in this method.\"\n    );\n  }\n\n  constructor(options: IInstanceOptions) {\n    this._id = options.id || \"\";\n    this.active = options.active || this.active;\n  }\n}\n","export * from \"./attribute\";\nexport * from \"./geometry\";\nexport * from \"./gl-decode\";\nexport * from \"./gl-proxy\";\nexport * from \"./gl-settings\";\nexport * from \"./gl-state\";\nexport * from \"./material\";\nexport * from \"./model\";\nexport * from \"./render-target\";\nexport * from \"./scene\";\nexport * from \"./texture\";\nexport * from \"./types\";\nexport * from \"./webgl-renderer\";\nexport * from \"./webgl-stat\";\n","/**\n * These are all of the settings that can be used to configure the GL state of the system\n */\nexport namespace GLSettings {\n  /**\n   * Settings used when defining render target parameters\n   */\n  export namespace RenderTarget {\n    /**\n     * Specifies the internal format of the color buffer for a render target\n     * when not using a Texture. See:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/renderbufferStorage\n     */\n    export enum ColorBufferFormat {\n      RGBA4,\n      RGB565,\n      RGB5_A1\n    }\n\n    /**\n     * Specifies the internal format of the depth buffer for a render target\n     * when not using a Texture. See:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/renderbufferStorage\n     */\n    export enum DepthBufferFormat {\n      DEPTH_COMPONENT16,\n      DEPTH_STENCIL\n    }\n\n    /**\n     * Specifies the internal format of the stencil buffer for a render target\n     * when not using a Texture. See:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/renderbufferStorage\n     */\n    export enum StencilBufferFormat {\n      STENCIL_INDEX8\n    }\n  }\n\n  export namespace Material {\n    /**\n     * Sets the blending function to be either a preset blending function or enables the\n     * use of a Custom blending equation. WHen custom is set, the Dst, Src factors, and blending\n     * equation settings come into play\n     */\n    export enum Blending {\n      NoBlending = 0,\n      NormalBlending = 1,\n      AdditiveBlending = 2,\n      SubtractiveBlending = 3,\n      MultiplyBlending = 4\n    }\n\n    /**\n     * Specifies the Destination factor for the blending equation see:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/blendFunc\n     */\n    export enum BlendingDstFactor {\n      Zero = 0,\n      One = 1,\n      SrcColor = 2,\n      OneMinusSrcColor = 3,\n      SrcAlpha = 4,\n      OneMinusSrcAlpha = 5,\n      DstAlpha = 6,\n      OneMinusDstAlpha = 7,\n      DstColor = 8,\n      OneMinusDstColor = 9\n    }\n\n    /**\n     * Specifies the Source factor for the blending equation see:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/blendFunc\n     */\n    export enum BlendingSrcFactor {\n      Zero = 0,\n      One = 1,\n      SrcColor = 2,\n      OneMinusSrcColor = 3,\n      SrcAlpha = 4,\n      OneMinusSrcAlpha = 5,\n      DstAlpha = 6,\n      OneMinusDstAlpha = 7,\n      DstColor = 8,\n      OneMinusDstColor = 9,\n      SrcAlphaSaturate = 10\n    }\n\n    /**\n     * Specifies the blending equation see:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/blendEquation\n     */\n    export enum BlendingEquations {\n      Add = 0,\n      Subtract = 1,\n      ReverseSubtract = 2\n      /** Requires extension for Webgl 1.0 */\n      // Min = 3,\n      // Max = 4\n    }\n\n    /**\n     * Specifies the Depth comparison function for determining if a fragment should be drawn when it's\n     * depth is compared against the depth buffer see:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/depthFunc\n     */\n    export enum DepthFunctions {\n      NEVER = 0,\n      LESS = 1,\n      EQUAL = 2,\n      LESS_OR_EQUAL = 3,\n      GREATER = 4,\n      NOTEQUAL = 5,\n      GREATER_OR_EQUAL = 6,\n      ALWAYS = 7\n    }\n\n    /**\n     * Specifies which side of the polygon should be culled or not. See:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/cullFace\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/frontFace\n     */\n    export enum CullSide {\n      NONE = 0,\n      CW = 1,\n      CCW = 2,\n      BOTH = 3\n    }\n  }\n\n  /**\n   * These are settings applied to a model\n   */\n  export namespace Model {\n    export enum DrawMode {\n      LINE_LOOP,\n      LINE_STRIP,\n      LINES,\n      POINTS,\n      TRIANGLE_FAN,\n      TRIANGLE_STRIP,\n      TRIANGLES\n    }\n  }\n\n  /**\n   * Settings that are applied to textures\n   */\n  export namespace Texture {\n    /**\n     * Specifies which target to bind the texture to. 2D or a cubemap.\n     */\n    export enum TextureBindingTarget {\n      TEXTURE_2D,\n      CUBE_MAP\n    }\n\n    /**\n     * The wrap mode when reading values outside of 0 - 1 when sampling the texture. See:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texParameter\n     */\n    export enum Wrapping {\n      REPEAT = 0,\n      CLAMP_TO_EDGE = 1,\n      MIRRORED_REPEAT = 2\n    }\n\n    /**\n     * The interpolation method to use when sampling between texels when the render space is smaller than the texture. See:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texParameter\n     */\n    export enum TextureMinFilter {\n      Nearest = 0,\n      NearestMipMapNearest = 1,\n      NearestMipMapLinear = 2,\n      Linear = 3,\n      LinearMipMapNearest = 4,\n      LinearMipMapLinear = 5\n    }\n\n    /**\n     * The interpolation method to use when sampling between texels when the render space is larger than the texture. See:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texParameter\n     */\n    export enum TextureMagFilter {\n      Nearest = 0,\n      Linear = 1\n    }\n\n    /**\n     * This is the format of the input texture. See:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texImage2D\n     */\n    export enum SourcePixelFormat {\n      /**\n       * Highly supported webgl 1\n       * Pairs with: TexelDataType.RGBA, RGB, LuminanceAlpha, Luminance, Alpha\n       */\n      UnsignedByte = 0,\n      /**\n       * Highly supported webgl 1\n       * Pairs with: TexelDataType.RGB\n       */\n      UnsignedShort_5_6_5 = 1,\n      /**\n       * Highly supported webgl 1\n       * Pairs with: TexelDataType.RGBA\n       */\n      UnsignedShort_4_4_4_4 = 2,\n      /**\n       * Highly supported webgl 1\n       * Pairs with: TexelDataType.RGBA\n       */\n      UnsignedShort_5_5_5_1 = 3,\n      /** Depth texture or Webgl 2 */\n      UnsignedShort = 4,\n      /** Depth texture or Webgl 2 */\n      UnsignedInt = 5,\n      /** Depth texture extension or Webgl 2 */\n      UnsignedInt_24_8 = 6,\n      /** Webgl 2 */\n      Byte = 7,\n      /** Webgl 2 */\n      Short = 8,\n      /** Webgl 2 */\n      Int = 9,\n      /** Webgl 2 */\n      Float = 10,\n      /** Webgl 2 */\n      HalfFloat = 11,\n      /** Webgl 2 */\n      UnsignedInt_2_10_10_10_REV = 12,\n      /** Webgl 2 */\n      UnsignedInt_10F_11F_11F_REV = 13,\n      /** Webgl 2 */\n      UnsignedInt_5_9_9_9_REV = 14,\n      /** Webgl 2 */\n      Float32UnsignedInt_24_8_REV = 15\n    }\n\n    /**\n     * This is the data format the texels in the texture will take on. See:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texImage2D\n     */\n    export enum TexelDataType {\n      /**\n       * Discards the red, green and blue components and reads the alpha component.\n       * Pairs with: UNSIGNED_BYTE\n       */\n      Alpha = 0,\n      /**\n       * Requires Depth extension or webgl2\n       */\n      DepthComponent = 1,\n      /**\n       * Requires Depth extension or webgl2\n       */\n      DepthStencil = 2,\n      /**\n       * Each color component is a luminance component, alpha is 1.0.\n       * Pairs with:\n       */\n      Luminance = 3,\n      /**\n       * Each component is a luminance/alpha component.\n       */\n      LuminanceAlpha = 4,\n      /**\n       * Discards the alpha components and reads the red, green and blue components.\n       * Pairs with:\n       */\n      RGB = 5,\n      /**\n       * Red, green, blue and alpha components are read from the color buffer.\n       */\n      RGBA = 6,\n      RGBE = 7\n    }\n\n    /**\n     * This specifies hwo the texture data is unpacked when using gl.readPixels. See:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/pixelStorei\n     * https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glPixelStorei.xml\n     */\n    export enum PackAlignment {\n      /** Byte-alignment */\n      ONE = 1,\n      /** Rows aligned to even-numbered bytes */\n      TWO = 2,\n      /** Word-alignment */\n      FOUR = 4,\n      /** Rows start on double-word boundaries */\n      EIGHT = 8\n    }\n\n    /**\n     * This specifies how the texture data is packed into memory (for gl.texImage2D and gl.texSubImage2D) See:\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/pixelStorei\n     * https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glPixelStorei.xml\n     */\n    export enum UnpackAlignment {\n      /** Byte-alignment */\n      ONE = 1,\n      /** Rows aligned to even-numbered bytes */\n      TWO = 2,\n      /** Word-alignment */\n      FOUR = 4,\n      /** Rows start on double-word boundaries */\n      EIGHT = 8\n    }\n  }\n\n  /**\n   * Settings associated with the Renderer\n   */\n  export namespace Renderer {\n    /**\n     * This specifies what data is read out and how\n     */\n    export enum ReadFilter {\n      ALPHA,\n      RGB,\n      RGBA\n    }\n\n    /**\n     * Specifies the data format of the array buffer the data is read into\n     */\n    export enum ReadTargetArrayFormat {\n      UNSIGNED_BYTE,\n      UNSIGNED_SHORT_5_6_5,\n      UNSIGNED_SHORT_4_4_4_4,\n      UNSIGNED_SHORT_5_5_5_1,\n      FLOAT\n    }\n  }\n}\n","import { Vec2 } from \"../util/vector\";\n\nexport enum AnchorType {\n  BottomLeft,\n  BottomMiddle,\n  BottomRight,\n  Custom,\n  Middle,\n  MiddleLeft,\n  MiddleRight,\n  TopLeft,\n  TopMiddle,\n  TopRight\n}\n\nexport type Anchor = {\n  /** When the anchor gets calculated on the image, this allows the anchor to go beyond the borders of the image by this amount */\n  padding: number;\n  /**\n   * A padding must contain dimensions for all axis involved. Padding as a scalar is too ambiguous. This holds the calculated\n   * direction the padding applies. The padding value you would provide is just a magnitude that is used to inevitably calculate\n   * this value.\n   */\n  paddingDirection?: Vec2;\n  /** This is the location of the anchor. If a custom anchor is specified, then the x and y are not automatically populated */\n  type: AnchorType;\n  /** This is populated with the anchor's location relative to the image's surface */\n  x?: number;\n  /** This is populated with the anchor's location relative to the image's surface */\n  y?: number;\n};\n\nexport enum ScaleMode {\n  /** The size of the image will be tied to world space */\n  ALWAYS = 1,\n  /** The image will scale to it's font size then stop growing */\n  BOUND_MAX = 2,\n  /** The image will alwyas retain it's font size on screen */\n  NEVER = 3\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.parseBoundCurves = exports.calculatePaddingBoxPath = exports.calculateBorderBoxPath = exports.parsePathForBorder = exports.parseDocumentSize = exports.calculateContentBox = exports.calculatePaddingBox = exports.parseBounds = exports.Bounds = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Vector = require('./drawing/Vector');\n\nvar _Vector2 = _interopRequireDefault(_Vector);\n\nvar _BezierCurve = require('./drawing/BezierCurve');\n\nvar _BezierCurve2 = _interopRequireDefault(_BezierCurve);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TOP = 0;\nvar RIGHT = 1;\nvar BOTTOM = 2;\nvar LEFT = 3;\n\nvar H = 0;\nvar V = 1;\n\nvar Bounds = exports.Bounds = function () {\n    function Bounds(x, y, w, h) {\n        _classCallCheck(this, Bounds);\n\n        this.left = x;\n        this.top = y;\n        this.width = w;\n        this.height = h;\n    }\n\n    _createClass(Bounds, null, [{\n        key: 'fromClientRect',\n        value: function fromClientRect(clientRect, scrollX, scrollY) {\n            return new Bounds(clientRect.left + scrollX, clientRect.top + scrollY, clientRect.width, clientRect.height);\n        }\n    }]);\n\n    return Bounds;\n}();\n\nvar parseBounds = exports.parseBounds = function parseBounds(node, scrollX, scrollY) {\n    return Bounds.fromClientRect(node.getBoundingClientRect(), scrollX, scrollY);\n};\n\nvar calculatePaddingBox = exports.calculatePaddingBox = function calculatePaddingBox(bounds, borders) {\n    return new Bounds(bounds.left + borders[LEFT].borderWidth, bounds.top + borders[TOP].borderWidth, bounds.width - (borders[RIGHT].borderWidth + borders[LEFT].borderWidth), bounds.height - (borders[TOP].borderWidth + borders[BOTTOM].borderWidth));\n};\n\nvar calculateContentBox = exports.calculateContentBox = function calculateContentBox(bounds, padding, borders) {\n    // TODO support percentage paddings\n    var paddingTop = padding[TOP].value;\n    var paddingRight = padding[RIGHT].value;\n    var paddingBottom = padding[BOTTOM].value;\n    var paddingLeft = padding[LEFT].value;\n\n    return new Bounds(bounds.left + paddingLeft + borders[LEFT].borderWidth, bounds.top + paddingTop + borders[TOP].borderWidth, bounds.width - (borders[RIGHT].borderWidth + borders[LEFT].borderWidth + paddingLeft + paddingRight), bounds.height - (borders[TOP].borderWidth + borders[BOTTOM].borderWidth + paddingTop + paddingBottom));\n};\n\nvar parseDocumentSize = exports.parseDocumentSize = function parseDocumentSize(document) {\n    var body = document.body;\n    var documentElement = document.documentElement;\n\n    if (!body || !documentElement) {\n        throw new Error(process.env.NODE_ENV !== 'production' ? 'Unable to get document size' : '');\n    }\n    var width = Math.max(Math.max(body.scrollWidth, documentElement.scrollWidth), Math.max(body.offsetWidth, documentElement.offsetWidth), Math.max(body.clientWidth, documentElement.clientWidth));\n\n    var height = Math.max(Math.max(body.scrollHeight, documentElement.scrollHeight), Math.max(body.offsetHeight, documentElement.offsetHeight), Math.max(body.clientHeight, documentElement.clientHeight));\n\n    return new Bounds(0, 0, width, height);\n};\n\nvar parsePathForBorder = exports.parsePathForBorder = function parsePathForBorder(curves, borderSide) {\n    switch (borderSide) {\n        case TOP:\n            return createPathFromCurves(curves.topLeftOuter, curves.topLeftInner, curves.topRightOuter, curves.topRightInner);\n        case RIGHT:\n            return createPathFromCurves(curves.topRightOuter, curves.topRightInner, curves.bottomRightOuter, curves.bottomRightInner);\n        case BOTTOM:\n            return createPathFromCurves(curves.bottomRightOuter, curves.bottomRightInner, curves.bottomLeftOuter, curves.bottomLeftInner);\n        case LEFT:\n        default:\n            return createPathFromCurves(curves.bottomLeftOuter, curves.bottomLeftInner, curves.topLeftOuter, curves.topLeftInner);\n    }\n};\n\nvar createPathFromCurves = function createPathFromCurves(outer1, inner1, outer2, inner2) {\n    var path = [];\n    if (outer1 instanceof _BezierCurve2.default) {\n        path.push(outer1.subdivide(0.5, false));\n    } else {\n        path.push(outer1);\n    }\n\n    if (outer2 instanceof _BezierCurve2.default) {\n        path.push(outer2.subdivide(0.5, true));\n    } else {\n        path.push(outer2);\n    }\n\n    if (inner2 instanceof _BezierCurve2.default) {\n        path.push(inner2.subdivide(0.5, true).reverse());\n    } else {\n        path.push(inner2);\n    }\n\n    if (inner1 instanceof _BezierCurve2.default) {\n        path.push(inner1.subdivide(0.5, false).reverse());\n    } else {\n        path.push(inner1);\n    }\n\n    return path;\n};\n\nvar calculateBorderBoxPath = exports.calculateBorderBoxPath = function calculateBorderBoxPath(curves) {\n    return [curves.topLeftOuter, curves.topRightOuter, curves.bottomRightOuter, curves.bottomLeftOuter];\n};\n\nvar calculatePaddingBoxPath = exports.calculatePaddingBoxPath = function calculatePaddingBoxPath(curves) {\n    return [curves.topLeftInner, curves.topRightInner, curves.bottomRightInner, curves.bottomLeftInner];\n};\n\nvar parseBoundCurves = exports.parseBoundCurves = function parseBoundCurves(bounds, borders, borderRadius) {\n    var HALF_WIDTH = bounds.width / 2;\n    var HALF_HEIGHT = bounds.height / 2;\n    var tlh = borderRadius[CORNER.TOP_LEFT][H].getAbsoluteValue(bounds.width) < HALF_WIDTH ? borderRadius[CORNER.TOP_LEFT][H].getAbsoluteValue(bounds.width) : HALF_WIDTH;\n    var tlv = borderRadius[CORNER.TOP_LEFT][V].getAbsoluteValue(bounds.height) < HALF_HEIGHT ? borderRadius[CORNER.TOP_LEFT][V].getAbsoluteValue(bounds.height) : HALF_HEIGHT;\n    var trh = borderRadius[CORNER.TOP_RIGHT][H].getAbsoluteValue(bounds.width) < HALF_WIDTH ? borderRadius[CORNER.TOP_RIGHT][H].getAbsoluteValue(bounds.width) : HALF_WIDTH;\n    var trv = borderRadius[CORNER.TOP_RIGHT][V].getAbsoluteValue(bounds.height) < HALF_HEIGHT ? borderRadius[CORNER.TOP_RIGHT][V].getAbsoluteValue(bounds.height) : HALF_HEIGHT;\n    var brh = borderRadius[CORNER.BOTTOM_RIGHT][H].getAbsoluteValue(bounds.width) < HALF_WIDTH ? borderRadius[CORNER.BOTTOM_RIGHT][H].getAbsoluteValue(bounds.width) : HALF_WIDTH;\n    var brv = borderRadius[CORNER.BOTTOM_RIGHT][V].getAbsoluteValue(bounds.height) < HALF_HEIGHT ? borderRadius[CORNER.BOTTOM_RIGHT][V].getAbsoluteValue(bounds.height) : HALF_HEIGHT;\n    var blh = borderRadius[CORNER.BOTTOM_LEFT][H].getAbsoluteValue(bounds.width) < HALF_WIDTH ? borderRadius[CORNER.BOTTOM_LEFT][H].getAbsoluteValue(bounds.width) : HALF_WIDTH;\n    var blv = borderRadius[CORNER.BOTTOM_LEFT][V].getAbsoluteValue(bounds.height) < HALF_HEIGHT ? borderRadius[CORNER.BOTTOM_LEFT][V].getAbsoluteValue(bounds.height) : HALF_HEIGHT;\n\n    var topWidth = bounds.width - trh;\n    var rightHeight = bounds.height - brv;\n    var bottomWidth = bounds.width - brh;\n    var leftHeight = bounds.height - blv;\n\n    return {\n        topLeftOuter: tlh > 0 || tlv > 0 ? getCurvePoints(bounds.left, bounds.top, tlh, tlv, CORNER.TOP_LEFT) : new _Vector2.default(bounds.left, bounds.top),\n        topLeftInner: tlh > 0 || tlv > 0 ? getCurvePoints(bounds.left + borders[LEFT].borderWidth, bounds.top + borders[TOP].borderWidth, Math.max(0, tlh - borders[LEFT].borderWidth), Math.max(0, tlv - borders[TOP].borderWidth), CORNER.TOP_LEFT) : new _Vector2.default(bounds.left + borders[LEFT].borderWidth, bounds.top + borders[TOP].borderWidth),\n        topRightOuter: trh > 0 || trv > 0 ? getCurvePoints(bounds.left + topWidth, bounds.top, trh, trv, CORNER.TOP_RIGHT) : new _Vector2.default(bounds.left + bounds.width, bounds.top),\n        topRightInner: trh > 0 || trv > 0 ? getCurvePoints(bounds.left + Math.min(topWidth, bounds.width + borders[LEFT].borderWidth), bounds.top + borders[TOP].borderWidth, topWidth > bounds.width + borders[LEFT].borderWidth ? 0 : trh - borders[LEFT].borderWidth, trv - borders[TOP].borderWidth, CORNER.TOP_RIGHT) : new _Vector2.default(bounds.left + bounds.width - borders[RIGHT].borderWidth, bounds.top + borders[TOP].borderWidth),\n        bottomRightOuter: brh > 0 || brv > 0 ? getCurvePoints(bounds.left + bottomWidth, bounds.top + rightHeight, brh, brv, CORNER.BOTTOM_RIGHT) : new _Vector2.default(bounds.left + bounds.width, bounds.top + bounds.height),\n        bottomRightInner: brh > 0 || brv > 0 ? getCurvePoints(bounds.left + Math.min(bottomWidth, bounds.width - borders[LEFT].borderWidth), bounds.top + Math.min(rightHeight, bounds.height + borders[TOP].borderWidth), Math.max(0, brh - borders[RIGHT].borderWidth), brv - borders[BOTTOM].borderWidth, CORNER.BOTTOM_RIGHT) : new _Vector2.default(bounds.left + bounds.width - borders[RIGHT].borderWidth, bounds.top + bounds.height - borders[BOTTOM].borderWidth),\n        bottomLeftOuter: blh > 0 || blv > 0 ? getCurvePoints(bounds.left, bounds.top + leftHeight, blh, blv, CORNER.BOTTOM_LEFT) : new _Vector2.default(bounds.left, bounds.top + bounds.height),\n        bottomLeftInner: blh > 0 || blv > 0 ? getCurvePoints(bounds.left + borders[LEFT].borderWidth, bounds.top + leftHeight, Math.max(0, blh - borders[LEFT].borderWidth), blv - borders[BOTTOM].borderWidth, CORNER.BOTTOM_LEFT) : new _Vector2.default(bounds.left + borders[LEFT].borderWidth, bounds.top + bounds.height - borders[BOTTOM].borderWidth)\n    };\n};\n\nvar CORNER = {\n    TOP_LEFT: 0,\n    TOP_RIGHT: 1,\n    BOTTOM_RIGHT: 2,\n    BOTTOM_LEFT: 3\n};\n\nvar getCurvePoints = function getCurvePoints(x, y, r1, r2, position) {\n    var kappa = 4 * ((Math.sqrt(2) - 1) / 3);\n    var ox = r1 * kappa; // control point offset horizontal\n    var oy = r2 * kappa; // control point offset vertical\n    var xm = x + r1; // x-middle\n    var ym = y + r2; // y-middle\n\n    switch (position) {\n        case CORNER.TOP_LEFT:\n            return new _BezierCurve2.default(new _Vector2.default(x, ym), new _Vector2.default(x, ym - oy), new _Vector2.default(xm - ox, y), new _Vector2.default(xm, y));\n        case CORNER.TOP_RIGHT:\n            return new _BezierCurve2.default(new _Vector2.default(x, y), new _Vector2.default(x + ox, y), new _Vector2.default(xm, ym - oy), new _Vector2.default(xm, ym));\n        case CORNER.BOTTOM_RIGHT:\n            return new _BezierCurve2.default(new _Vector2.default(xm, y), new _Vector2.default(xm, y + oy), new _Vector2.default(x + ox, ym), new _Vector2.default(x, ym));\n        case CORNER.BOTTOM_LEFT:\n        default:\n            return new _BezierCurve2.default(new _Vector2.default(xm, ym), new _Vector2.default(xm - ox, ym), new _Vector2.default(x, y + oy), new _Vector2.default(x, y));\n    }\n};","'use strict';\n\n// http://dev.w3.org/csswg/css-color/\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar HEX3 = /^#([a-f0-9]{3})$/i;\nvar hex3 = function hex3(value) {\n    var match = value.match(HEX3);\n    if (match) {\n        return [parseInt(match[1][0] + match[1][0], 16), parseInt(match[1][1] + match[1][1], 16), parseInt(match[1][2] + match[1][2], 16), null];\n    }\n    return false;\n};\n\nvar HEX6 = /^#([a-f0-9]{6})$/i;\nvar hex6 = function hex6(value) {\n    var match = value.match(HEX6);\n    if (match) {\n        return [parseInt(match[1].substring(0, 2), 16), parseInt(match[1].substring(2, 4), 16), parseInt(match[1].substring(4, 6), 16), null];\n    }\n    return false;\n};\n\nvar RGB = /^rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)$/;\nvar rgb = function rgb(value) {\n    var match = value.match(RGB);\n    if (match) {\n        return [Number(match[1]), Number(match[2]), Number(match[3]), null];\n    }\n    return false;\n};\n\nvar RGBA = /^rgba\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d?\\.?\\d+)\\s*\\)$/;\nvar rgba = function rgba(value) {\n    var match = value.match(RGBA);\n    if (match && match.length > 4) {\n        return [Number(match[1]), Number(match[2]), Number(match[3]), Number(match[4])];\n    }\n    return false;\n};\n\nvar fromArray = function fromArray(array) {\n    return [Math.min(array[0], 255), Math.min(array[1], 255), Math.min(array[2], 255), array.length > 3 ? array[3] : null];\n};\n\nvar namedColor = function namedColor(name) {\n    var color = NAMED_COLORS[name.toLowerCase()];\n    return color ? color : false;\n};\n\nvar Color = function () {\n    function Color(value) {\n        _classCallCheck(this, Color);\n\n        var _ref = Array.isArray(value) ? fromArray(value) : hex3(value) || rgb(value) || rgba(value) || namedColor(value) || hex6(value) || [0, 0, 0, null],\n            _ref2 = _slicedToArray(_ref, 4),\n            r = _ref2[0],\n            g = _ref2[1],\n            b = _ref2[2],\n            a = _ref2[3];\n\n        this.r = r;\n        this.g = g;\n        this.b = b;\n        this.a = a;\n    }\n\n    _createClass(Color, [{\n        key: 'isTransparent',\n        value: function isTransparent() {\n            return this.a === 0;\n        }\n    }, {\n        key: 'toString',\n        value: function toString() {\n            return this.a !== null && this.a !== 1 ? 'rgba(' + this.r + ',' + this.g + ',' + this.b + ',' + this.a + ')' : 'rgb(' + this.r + ',' + this.g + ',' + this.b + ')';\n        }\n    }]);\n\n    return Color;\n}();\n\nexports.default = Color;\n\n\nvar NAMED_COLORS = {\n    transparent: [0, 0, 0, 0],\n    aliceblue: [240, 248, 255, null],\n    antiquewhite: [250, 235, 215, null],\n    aqua: [0, 255, 255, null],\n    aquamarine: [127, 255, 212, null],\n    azure: [240, 255, 255, null],\n    beige: [245, 245, 220, null],\n    bisque: [255, 228, 196, null],\n    black: [0, 0, 0, null],\n    blanchedalmond: [255, 235, 205, null],\n    blue: [0, 0, 255, null],\n    blueviolet: [138, 43, 226, null],\n    brown: [165, 42, 42, null],\n    burlywood: [222, 184, 135, null],\n    cadetblue: [95, 158, 160, null],\n    chartreuse: [127, 255, 0, null],\n    chocolate: [210, 105, 30, null],\n    coral: [255, 127, 80, null],\n    cornflowerblue: [100, 149, 237, null],\n    cornsilk: [255, 248, 220, null],\n    crimson: [220, 20, 60, null],\n    cyan: [0, 255, 255, null],\n    darkblue: [0, 0, 139, null],\n    darkcyan: [0, 139, 139, null],\n    darkgoldenrod: [184, 134, 11, null],\n    darkgray: [169, 169, 169, null],\n    darkgreen: [0, 100, 0, null],\n    darkgrey: [169, 169, 169, null],\n    darkkhaki: [189, 183, 107, null],\n    darkmagenta: [139, 0, 139, null],\n    darkolivegreen: [85, 107, 47, null],\n    darkorange: [255, 140, 0, null],\n    darkorchid: [153, 50, 204, null],\n    darkred: [139, 0, 0, null],\n    darksalmon: [233, 150, 122, null],\n    darkseagreen: [143, 188, 143, null],\n    darkslateblue: [72, 61, 139, null],\n    darkslategray: [47, 79, 79, null],\n    darkslategrey: [47, 79, 79, null],\n    darkturquoise: [0, 206, 209, null],\n    darkviolet: [148, 0, 211, null],\n    deeppink: [255, 20, 147, null],\n    deepskyblue: [0, 191, 255, null],\n    dimgray: [105, 105, 105, null],\n    dimgrey: [105, 105, 105, null],\n    dodgerblue: [30, 144, 255, null],\n    firebrick: [178, 34, 34, null],\n    floralwhite: [255, 250, 240, null],\n    forestgreen: [34, 139, 34, null],\n    fuchsia: [255, 0, 255, null],\n    gainsboro: [220, 220, 220, null],\n    ghostwhite: [248, 248, 255, null],\n    gold: [255, 215, 0, null],\n    goldenrod: [218, 165, 32, null],\n    gray: [128, 128, 128, null],\n    green: [0, 128, 0, null],\n    greenyellow: [173, 255, 47, null],\n    grey: [128, 128, 128, null],\n    honeydew: [240, 255, 240, null],\n    hotpink: [255, 105, 180, null],\n    indianred: [205, 92, 92, null],\n    indigo: [75, 0, 130, null],\n    ivory: [255, 255, 240, null],\n    khaki: [240, 230, 140, null],\n    lavender: [230, 230, 250, null],\n    lavenderblush: [255, 240, 245, null],\n    lawngreen: [124, 252, 0, null],\n    lemonchiffon: [255, 250, 205, null],\n    lightblue: [173, 216, 230, null],\n    lightcoral: [240, 128, 128, null],\n    lightcyan: [224, 255, 255, null],\n    lightgoldenrodyellow: [250, 250, 210, null],\n    lightgray: [211, 211, 211, null],\n    lightgreen: [144, 238, 144, null],\n    lightgrey: [211, 211, 211, null],\n    lightpink: [255, 182, 193, null],\n    lightsalmon: [255, 160, 122, null],\n    lightseagreen: [32, 178, 170, null],\n    lightskyblue: [135, 206, 250, null],\n    lightslategray: [119, 136, 153, null],\n    lightslategrey: [119, 136, 153, null],\n    lightsteelblue: [176, 196, 222, null],\n    lightyellow: [255, 255, 224, null],\n    lime: [0, 255, 0, null],\n    limegreen: [50, 205, 50, null],\n    linen: [250, 240, 230, null],\n    magenta: [255, 0, 255, null],\n    maroon: [128, 0, 0, null],\n    mediumaquamarine: [102, 205, 170, null],\n    mediumblue: [0, 0, 205, null],\n    mediumorchid: [186, 85, 211, null],\n    mediumpurple: [147, 112, 219, null],\n    mediumseagreen: [60, 179, 113, null],\n    mediumslateblue: [123, 104, 238, null],\n    mediumspringgreen: [0, 250, 154, null],\n    mediumturquoise: [72, 209, 204, null],\n    mediumvioletred: [199, 21, 133, null],\n    midnightblue: [25, 25, 112, null],\n    mintcream: [245, 255, 250, null],\n    mistyrose: [255, 228, 225, null],\n    moccasin: [255, 228, 181, null],\n    navajowhite: [255, 222, 173, null],\n    navy: [0, 0, 128, null],\n    oldlace: [253, 245, 230, null],\n    olive: [128, 128, 0, null],\n    olivedrab: [107, 142, 35, null],\n    orange: [255, 165, 0, null],\n    orangered: [255, 69, 0, null],\n    orchid: [218, 112, 214, null],\n    palegoldenrod: [238, 232, 170, null],\n    palegreen: [152, 251, 152, null],\n    paleturquoise: [175, 238, 238, null],\n    palevioletred: [219, 112, 147, null],\n    papayawhip: [255, 239, 213, null],\n    peachpuff: [255, 218, 185, null],\n    peru: [205, 133, 63, null],\n    pink: [255, 192, 203, null],\n    plum: [221, 160, 221, null],\n    powderblue: [176, 224, 230, null],\n    purple: [128, 0, 128, null],\n    rebeccapurple: [102, 51, 153, null],\n    red: [255, 0, 0, null],\n    rosybrown: [188, 143, 143, null],\n    royalblue: [65, 105, 225, null],\n    saddlebrown: [139, 69, 19, null],\n    salmon: [250, 128, 114, null],\n    sandybrown: [244, 164, 96, null],\n    seagreen: [46, 139, 87, null],\n    seashell: [255, 245, 238, null],\n    sienna: [160, 82, 45, null],\n    silver: [192, 192, 192, null],\n    skyblue: [135, 206, 235, null],\n    slateblue: [106, 90, 205, null],\n    slategray: [112, 128, 144, null],\n    slategrey: [112, 128, 144, null],\n    snow: [255, 250, 250, null],\n    springgreen: [0, 255, 127, null],\n    steelblue: [70, 130, 180, null],\n    tan: [210, 180, 140, null],\n    teal: [0, 128, 128, null],\n    thistle: [216, 191, 216, null],\n    tomato: [255, 99, 71, null],\n    turquoise: [64, 224, 208, null],\n    violet: [238, 130, 238, null],\n    wheat: [245, 222, 179, null],\n    white: [255, 255, 255, null],\n    whitesmoke: [245, 245, 245, null],\n    yellow: [255, 255, 0, null],\n    yellowgreen: [154, 205, 50, null]\n};\n\nvar TRANSPARENT = exports.TRANSPARENT = new Color([0, 0, 0, 0]);","export * from \"./base-shader-io-injection\";\nexport * from \"./shader-module-unit\";\nexport * from \"./shader-module\";\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.calculateLengthFromValueWithUnit = exports.LENGTH_TYPE = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _NodeContainer = require('./NodeContainer');\n\nvar _NodeContainer2 = _interopRequireDefault(_NodeContainer);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LENGTH_WITH_UNIT = /([\\d.]+)(px|r?em|%)/i;\n\nvar LENGTH_TYPE = exports.LENGTH_TYPE = {\n    PX: 0,\n    PERCENTAGE: 1\n};\n\nvar Length = function () {\n    function Length(value) {\n        _classCallCheck(this, Length);\n\n        this.type = value.substr(value.length - 1) === '%' ? LENGTH_TYPE.PERCENTAGE : LENGTH_TYPE.PX;\n        var parsedValue = parseFloat(value);\n        if (process.env.NODE_ENV !== 'production' && isNaN(parsedValue)) {\n            console.error('Invalid value given for Length: \"' + value + '\"');\n        }\n        this.value = isNaN(parsedValue) ? 0 : parsedValue;\n    }\n\n    _createClass(Length, [{\n        key: 'isPercentage',\n        value: function isPercentage() {\n            return this.type === LENGTH_TYPE.PERCENTAGE;\n        }\n    }, {\n        key: 'getAbsoluteValue',\n        value: function getAbsoluteValue(parentLength) {\n            return this.isPercentage() ? parentLength * (this.value / 100) : this.value;\n        }\n    }], [{\n        key: 'create',\n        value: function create(v) {\n            return new Length(v);\n        }\n    }]);\n\n    return Length;\n}();\n\nexports.default = Length;\n\n\nvar getRootFontSize = function getRootFontSize(container) {\n    var parent = container.parent;\n    return parent ? getRootFontSize(parent) : parseFloat(container.style.font.fontSize);\n};\n\nvar calculateLengthFromValueWithUnit = exports.calculateLengthFromValueWithUnit = function calculateLengthFromValueWithUnit(container, value, unit) {\n    switch (unit) {\n        case 'px':\n        case '%':\n            return new Length(value + unit);\n        case 'em':\n        case 'rem':\n            var length = new Length(value);\n            length.value *= unit === 'em' ? parseFloat(container.style.font.fontSize) : getRootFontSize(container);\n            return length;\n        default:\n            // TODO: handle correctly if unknown unit is used\n            return new Length('0');\n    }\n};","export * from \"./absolute-position\";\nexport * from \"./bounds\";\nexport * from \"./box\";\nexport * from \"./image\";\nexport * from \"./label\";\nexport * from \"./point\";\n","import { WebGLStat } from \"../../gl/webgl-stat\";\nimport { Instance } from \"../../instance-provider/instance\";\nimport {\n  IInstanceAttribute,\n  instanceAttributeSizeFloatCount,\n  IVertexAttribute\n} from \"../../types\";\nimport { InstanceAttributeBufferManager } from \"../buffer-management/instance-attribute-buffering/instance-attribute-buffer-manager\";\nimport { InstanceAttributePackingBufferManager } from \"../buffer-management/instance-attribute-packed-buffering/instance-attribute-packing-buffer-manager\";\nimport { UniformBufferManager } from \"../buffer-management/uniform-buffering/uniform-buffer-manager\";\nimport { Layer } from \"../layer\";\nimport { LayerScene } from \"../layer-scene\";\n\nconst debug = require(\"debug\")(\"performance\");\n\nexport enum LayerBufferType {\n  // This is a compatibility mode for instance attributes. This is used when:\n  // 1. It would perform better\n  // 2. When instance attributes are not available for the gl context (ANGLE draw instanced arrays)\n  // 3. When the instance attributes + vertex attributes exceeds the max Vertex Attributes for the hardware and Attribute\n  //    packing still can not fit all of the attributes for the item.\n  UNIFORM,\n  // This is a fast and zippy buffering strategy used when the hardware supports it for a provided layer!\n  INSTANCE_ATTRIBUTE,\n  // This is a slight degradation from the normal INSTANCE_ATTRIBUTE buffering strategy. If provided attributes do\n  // not fit the limited amount of vertex attributes supported by the hardware, then we have one last strategy\n  // to utilize the highly optimized hardware instancing, which is to cram multiple attributes within single\n  // attribute blocks. An attribute block is considered to be 4 32 bit floats. These packed attributes will then\n  // get dereferenced in the shader.\n  INSTANCE_ATTRIBUTE_PACKING\n}\n\n/**\n * This analyzes a layer and determines if it should use a compatibility instancing mode or use hardware\n * instancing.\n */\nexport function getLayerBufferType<T extends Instance>(\n  _gl: WebGLRenderingContext,\n  layer: Layer<T, any>,\n  vertexAttributes: IVertexAttribute[],\n  instanceAttributes: IInstanceAttribute<T>[]\n) {\n  let type = LayerBufferType.UNIFORM;\n  let attributesUsed = 0;\n\n  // The layer only gets it's buffer type calculated once\n  if (layer.bufferType !== undefined) {\n    return layer.bufferType;\n  }\n\n  // Uncomment this to force the uniform buffer strategy\n  // layer.setBufferType(LayerBufferType.UNIFORM);\n  // return LayerBufferType.UNIFORM;\n\n  if (WebGLStat.HARDWARE_INSTANCING) {\n    for (let i = 0, end = vertexAttributes.length; i < end; ++i) {\n      const attribute = vertexAttributes[i];\n      attributesUsed += Math.ceil(attribute.size / 4);\n    }\n\n    for (let i = 0, end = instanceAttributes.length; i < end; ++i) {\n      const attribute = instanceAttributes[i];\n      attributesUsed += Math.ceil(\n        instanceAttributeSizeFloatCount[attribute.size || 1] / 4\n      );\n    }\n\n    // Too many attempted single attributes. We will next attempt to see if we can pack the vertex\n    // attributes down into blocks.\n    if (attributesUsed > WebGLStat.MAX_VERTEX_ATTRIBUTES) {\n      attributesUsed = 0;\n\n      for (let i = 0, end = instanceAttributes.length; i < end; ++i) {\n        const attribute = instanceAttributes[i];\n        attributesUsed = Math.max(attributesUsed, attribute.block || 0);\n      }\n\n      for (let i = 0, end = vertexAttributes.length; i < end; ++i) {\n        const attribute = vertexAttributes[i];\n        attributesUsed += Math.ceil(attribute.size / 4);\n      }\n\n      // If we can fit now, then we are good to go with using attribute packing\n      if (attributesUsed < WebGLStat.MAX_VERTEX_ATTRIBUTES) {\n        type = LayerBufferType.INSTANCE_ATTRIBUTE_PACKING;\n\n        debug(\n          `Performance Issue (Moderate):\n          Layer %o is utilizing too many vertex attributes and is now using vertex packing.\n          Max Vertex units %o\n          Used Vertex units %o\n          Instance Attributes %o\n          Vertex Attributes %o`,\n          layer.id,\n          WebGLStat.MAX_VERTEX_ATTRIBUTES,\n          attributesUsed,\n          instanceAttributes,\n          vertexAttributes\n        );\n      }\n    } else {\n      // If we make it here, we are good to go using hardware instancing! Hooray performance!\n      type = LayerBufferType.INSTANCE_ATTRIBUTE;\n    }\n  }\n\n  // No other faster mode supported: use uniform instancing\n  if (type === LayerBufferType.UNIFORM) {\n    debug(\n      `Performance Issue (High):\n      Layer %o is utilizing too many vertex attributes and is now using a uniform buffer.\n      Max Vertex units %o\n      Used Vertex units %o\n      Instance Attributes %o\n      Vertex Attributes %o`,\n      layer.id,\n      WebGLStat.MAX_VERTEX_ATTRIBUTES,\n      attributesUsed,\n      instanceAttributes,\n      vertexAttributes\n    );\n    type = LayerBufferType.UNIFORM;\n  }\n\n  // Apply the type to the layer\n  layer.setBufferType(type);\n\n  return type;\n}\n\n/**\n * Builds the proper buffer manager for the provided layer\n */\nexport function makeLayerBufferManager<T extends Instance>(\n  gl: WebGLRenderingContext,\n  layer: Layer<T, any>,\n  scene: LayerScene\n) {\n  // Esnure the buffering type has been calculated for the layer\n  const type = getLayerBufferType(\n    gl,\n    layer,\n    layer.vertexAttributes,\n    layer.instanceAttributes\n  );\n\n  switch (type) {\n    // This is the Instance Attribute buffering strategy, which means the system\n    case LayerBufferType.INSTANCE_ATTRIBUTE: {\n      layer.setBufferManager(new InstanceAttributeBufferManager(layer, scene));\n      break;\n    }\n\n    // This is the Instance Attribute buffering strategy, which means the system\n    case LayerBufferType.INSTANCE_ATTRIBUTE_PACKING: {\n      layer.setBufferManager(\n        new InstanceAttributePackingBufferManager(layer, scene)\n      );\n      break;\n    }\n\n    // Anything not utiliziing a specialized buffering strategy will use the uniform compatibility mode\n    default: {\n      layer.setBufferManager(new UniformBufferManager(layer, scene));\n      break;\n    }\n  }\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar contains = exports.contains = function contains(bit, value) {\n    return (bit & value) !== 0;\n};\n\nvar distance = exports.distance = function distance(a, b) {\n    return Math.sqrt(a * a + b * b);\n};\n\nvar copyCSSStyles = exports.copyCSSStyles = function copyCSSStyles(style, target) {\n    // Edge does not provide value for cssText\n    for (var i = style.length - 1; i >= 0; i--) {\n        var property = style.item(i);\n        // Safari shows pseudoelements if content is set\n        if (property !== 'content') {\n            target.style.setProperty(property, style.getPropertyValue(property));\n        }\n    }\n    return target;\n};\n\nvar SMALL_IMAGE = exports.SMALL_IMAGE = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Color = require('./Color');\n\nvar _Color2 = _interopRequireDefault(_Color);\n\nvar _Util = require('./Util');\n\nvar _background = require('./parsing/background');\n\nvar _border = require('./parsing/border');\n\nvar _borderRadius = require('./parsing/borderRadius');\n\nvar _display = require('./parsing/display');\n\nvar _float = require('./parsing/float');\n\nvar _font = require('./parsing/font');\n\nvar _letterSpacing = require('./parsing/letterSpacing');\n\nvar _lineBreak = require('./parsing/lineBreak');\n\nvar _listStyle = require('./parsing/listStyle');\n\nvar _margin = require('./parsing/margin');\n\nvar _overflow = require('./parsing/overflow');\n\nvar _overflowWrap = require('./parsing/overflowWrap');\n\nvar _padding = require('./parsing/padding');\n\nvar _position = require('./parsing/position');\n\nvar _textDecoration = require('./parsing/textDecoration');\n\nvar _textShadow = require('./parsing/textShadow');\n\nvar _textTransform = require('./parsing/textTransform');\n\nvar _transform = require('./parsing/transform');\n\nvar _visibility = require('./parsing/visibility');\n\nvar _wordBreak = require('./parsing/word-break');\n\nvar _zIndex = require('./parsing/zIndex');\n\nvar _Bounds = require('./Bounds');\n\nvar _Input = require('./Input');\n\nvar _ListItem = require('./ListItem');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar INPUT_TAGS = ['INPUT', 'TEXTAREA', 'SELECT'];\n\nvar NodeContainer = function () {\n    function NodeContainer(node, parent, resourceLoader, index) {\n        var _this = this;\n\n        _classCallCheck(this, NodeContainer);\n\n        this.parent = parent;\n        this.tagName = node.tagName;\n        this.index = index;\n        this.childNodes = [];\n        this.listItems = [];\n        if (typeof node.start === 'number') {\n            this.listStart = node.start;\n        }\n        var defaultView = node.ownerDocument.defaultView;\n        var scrollX = defaultView.pageXOffset;\n        var scrollY = defaultView.pageYOffset;\n        var style = defaultView.getComputedStyle(node, null);\n        var display = (0, _display.parseDisplay)(style.display);\n\n        var IS_INPUT = node.type === 'radio' || node.type === 'checkbox';\n\n        var position = (0, _position.parsePosition)(style.position);\n\n        this.style = {\n            background: IS_INPUT ? _Input.INPUT_BACKGROUND : (0, _background.parseBackground)(style, resourceLoader),\n            border: IS_INPUT ? _Input.INPUT_BORDERS : (0, _border.parseBorder)(style),\n            borderRadius: (node instanceof defaultView.HTMLInputElement || node instanceof HTMLInputElement) && IS_INPUT ? (0, _Input.getInputBorderRadius)(node) : (0, _borderRadius.parseBorderRadius)(style),\n            color: IS_INPUT ? _Input.INPUT_COLOR : new _Color2.default(style.color),\n            display: display,\n            float: (0, _float.parseCSSFloat)(style.float),\n            font: (0, _font.parseFont)(style),\n            letterSpacing: (0, _letterSpacing.parseLetterSpacing)(style.letterSpacing),\n            listStyle: display === _display.DISPLAY.LIST_ITEM ? (0, _listStyle.parseListStyle)(style) : null,\n            lineBreak: (0, _lineBreak.parseLineBreak)(style.lineBreak),\n            margin: (0, _margin.parseMargin)(style),\n            opacity: parseFloat(style.opacity),\n            overflow: INPUT_TAGS.indexOf(node.tagName) === -1 ? (0, _overflow.parseOverflow)(style.overflow) : _overflow.OVERFLOW.HIDDEN,\n            overflowWrap: (0, _overflowWrap.parseOverflowWrap)(style.overflowWrap ? style.overflowWrap : style.wordWrap),\n            padding: (0, _padding.parsePadding)(style),\n            position: position,\n            textDecoration: (0, _textDecoration.parseTextDecoration)(style),\n            textShadow: (0, _textShadow.parseTextShadow)(style.textShadow),\n            textTransform: (0, _textTransform.parseTextTransform)(style.textTransform),\n            transform: (0, _transform.parseTransform)(style),\n            visibility: (0, _visibility.parseVisibility)(style.visibility),\n            wordBreak: (0, _wordBreak.parseWordBreak)(style.wordBreak),\n            zIndex: (0, _zIndex.parseZIndex)(position !== _position.POSITION.STATIC ? style.zIndex : 'auto')\n        };\n\n        if (this.isTransformed()) {\n            // getBoundingClientRect provides values post-transform, we want them without the transformation\n            node.style.transform = 'matrix(1,0,0,1,0,0)';\n        }\n\n        if (display === _display.DISPLAY.LIST_ITEM) {\n            var listOwner = (0, _ListItem.getListOwner)(this);\n            if (listOwner) {\n                var listIndex = listOwner.listItems.length;\n                listOwner.listItems.push(this);\n                this.listIndex = node.hasAttribute('value') && typeof node.value === 'number' ? node.value : listIndex === 0 ? typeof listOwner.listStart === 'number' ? listOwner.listStart : 1 : listOwner.listItems[listIndex - 1].listIndex + 1;\n            }\n        }\n\n        // TODO move bound retrieval for all nodes to a later stage?\n        if (node.tagName === 'IMG') {\n            node.addEventListener('load', function () {\n                _this.bounds = (0, _Bounds.parseBounds)(node, scrollX, scrollY);\n                _this.curvedBounds = (0, _Bounds.parseBoundCurves)(_this.bounds, _this.style.border, _this.style.borderRadius);\n            });\n        }\n        this.image = getImage(node, resourceLoader);\n        this.bounds = IS_INPUT ? (0, _Input.reformatInputBounds)((0, _Bounds.parseBounds)(node, scrollX, scrollY)) : (0, _Bounds.parseBounds)(node, scrollX, scrollY);\n        this.curvedBounds = (0, _Bounds.parseBoundCurves)(this.bounds, this.style.border, this.style.borderRadius);\n\n        if (process.env.NODE_ENV !== 'production') {\n            this.name = '' + node.tagName.toLowerCase() + (node.id ? '#' + node.id : '') + node.className.toString().split(' ').map(function (s) {\n                return s.length ? '.' + s : '';\n            }).join('');\n        }\n    }\n\n    _createClass(NodeContainer, [{\n        key: 'getClipPaths',\n        value: function getClipPaths() {\n            var parentClips = this.parent ? this.parent.getClipPaths() : [];\n            var isClipped = this.style.overflow !== _overflow.OVERFLOW.VISIBLE;\n\n            return isClipped ? parentClips.concat([(0, _Bounds.calculatePaddingBoxPath)(this.curvedBounds)]) : parentClips;\n        }\n    }, {\n        key: 'isInFlow',\n        value: function isInFlow() {\n            return this.isRootElement() && !this.isFloating() && !this.isAbsolutelyPositioned();\n        }\n    }, {\n        key: 'isVisible',\n        value: function isVisible() {\n            return !(0, _Util.contains)(this.style.display, _display.DISPLAY.NONE) && this.style.opacity > 0 && this.style.visibility === _visibility.VISIBILITY.VISIBLE;\n        }\n    }, {\n        key: 'isAbsolutelyPositioned',\n        value: function isAbsolutelyPositioned() {\n            return this.style.position !== _position.POSITION.STATIC && this.style.position !== _position.POSITION.RELATIVE;\n        }\n    }, {\n        key: 'isPositioned',\n        value: function isPositioned() {\n            return this.style.position !== _position.POSITION.STATIC;\n        }\n    }, {\n        key: 'isFloating',\n        value: function isFloating() {\n            return this.style.float !== _float.FLOAT.NONE;\n        }\n    }, {\n        key: 'isRootElement',\n        value: function isRootElement() {\n            return this.parent === null;\n        }\n    }, {\n        key: 'isTransformed',\n        value: function isTransformed() {\n            return this.style.transform !== null;\n        }\n    }, {\n        key: 'isPositionedWithZIndex',\n        value: function isPositionedWithZIndex() {\n            return this.isPositioned() && !this.style.zIndex.auto;\n        }\n    }, {\n        key: 'isInlineLevel',\n        value: function isInlineLevel() {\n            return (0, _Util.contains)(this.style.display, _display.DISPLAY.INLINE) || (0, _Util.contains)(this.style.display, _display.DISPLAY.INLINE_BLOCK) || (0, _Util.contains)(this.style.display, _display.DISPLAY.INLINE_FLEX) || (0, _Util.contains)(this.style.display, _display.DISPLAY.INLINE_GRID) || (0, _Util.contains)(this.style.display, _display.DISPLAY.INLINE_LIST_ITEM) || (0, _Util.contains)(this.style.display, _display.DISPLAY.INLINE_TABLE);\n        }\n    }, {\n        key: 'isInlineBlockOrInlineTable',\n        value: function isInlineBlockOrInlineTable() {\n            return (0, _Util.contains)(this.style.display, _display.DISPLAY.INLINE_BLOCK) || (0, _Util.contains)(this.style.display, _display.DISPLAY.INLINE_TABLE);\n        }\n    }]);\n\n    return NodeContainer;\n}();\n\nexports.default = NodeContainer;\n\n\nvar getImage = function getImage(node, resourceLoader) {\n    if (node instanceof node.ownerDocument.defaultView.SVGSVGElement || node instanceof SVGSVGElement) {\n        var s = new XMLSerializer();\n        return resourceLoader.loadImage('data:image/svg+xml,' + encodeURIComponent(s.serializeToString(node)));\n    }\n    switch (node.tagName) {\n        case 'IMG':\n            // $FlowFixMe\n            var img = node;\n            return resourceLoader.loadImage(img.currentSrc || img.src);\n        case 'CANVAS':\n            // $FlowFixMe\n            var canvas = node;\n            return resourceLoader.loadCanvas(canvas);\n        case 'IFRAME':\n            var iframeKey = node.getAttribute('data-html2canvas-internal-iframe-key');\n            if (iframeKey) {\n                return iframeKey;\n            }\n            break;\n    }\n\n    return null;\n};","import { Texture } from \"../../gl/texture\";\nimport { Bounds } from \"../../primitives/bounds\";\nimport { InstanceIOValue } from \"../../types\";\nimport { Vec2 } from \"../../util/vector\";\n\n/**\n * Converts a SubTexture reference to a valid Instance IO value where:\n * [top left x, top left y, bottom right x, bottom right y]\n *\n * This also handles falsey texture values where invalid is a zero vector\n */\nexport function subTextureIOValue(\n  texture?: SubTexture | null\n): InstanceIOValue {\n  // If the texture is not defined we just output an empty reference\n  if (!texture) {\n    return [0, 0, 0, 0];\n  }\n\n  // Otherwise, we return the atlas information of the texture\n  return [\n    texture.atlasTL[0],\n    texture.atlasTL[1],\n    texture.atlasBR[0],\n    texture.atlasBR[1]\n  ];\n}\n\n/**\n * Defines a texture that is located on an atlas\n */\nexport class SubTexture {\n  /** Stores the aspect ratio of the image for quick reference */\n  aspectRatio: number = 1.0;\n  /** This is the top left UV coordinate of the sub texture on the atlas */\n  atlasTL: Vec2 = [0, 0];\n  /** This is the top right UV coordinate of the sub texture on the atlas */\n  atlasTR: Vec2 = [0, 0];\n  /** This is the bottom left UV coordinate of the sub texture on the atlas */\n  atlasBL: Vec2 = [0, 0];\n  /** This is the bottom right UV coordinate of the sub texture on the atlas */\n  atlasBR: Vec2 = [0, 0];\n  /** This is the normalized height of the sub texture on the atlas */\n  heightOnAtlas: number = 0;\n  /** This flag is set to false when the underlying texture is no longer valid */\n  isValid: boolean = false;\n  /** Width in pixels of the image on the atlas */\n  pixelWidth: number = 0;\n  /** Height in pixels of the image on the atlas */\n  pixelHeight: number = 0;\n  /** The id of the texture this resource is located within */\n  textureReferenceID: string = \"\";\n  /** This is the actual texture this resource is located within */\n  texture: Texture | null = null;\n  /** This is the normalized width of the sub texture on the atlas */\n  widthOnAtlas: number = 0;\n\n  /**\n   * Generates a SubTexture object based on the texture and region provided.\n   */\n  static fromRegion(source: Texture, region: Bounds) {\n    if (!source.data) return null;\n\n    const ux = region.x / source.data.width;\n    const uy = region.y / source.data.height;\n    const uw = region.width / source.data.width;\n    const uh = region.height / source.data.height;\n\n    const atlasDimensions: Bounds = new Bounds({\n      bottom: uy + uh,\n      left: ux,\n      right: ux + uw,\n      top: uy\n    });\n\n    const bottom = atlasDimensions.bottom;\n    const top = atlasDimensions.y;\n    const left = atlasDimensions.x;\n    const right = atlasDimensions.x + atlasDimensions.width;\n\n    const sub = new SubTexture();\n    sub.atlasTL = [left, top];\n    sub.atlasBR = [right, bottom];\n    sub.atlasBL = [left, bottom];\n    sub.atlasTR = [right, top];\n\n    return sub;\n  }\n}\n","import { Instance } from \"../../instance-provider/instance\";\nimport { InstanceDiff } from \"../../instance-provider/instance-provider\";\nimport { IInstanceAttributeInternal } from \"../../types\";\nimport { Vec2, Vec4 } from \"../../util\";\nimport { Layer } from \"../layer\";\nimport { LayerScene } from \"../layer-scene\";\n\nexport function isBufferLocation(val: any): val is IBufferLocation {\n  return val && val.buffer && val.buffer.value;\n}\n\nexport function isBufferLocationGroup(\n  val: any\n): val is IBufferLocationGroup<IBufferLocation> {\n  return val && val.propertyToBufferLocation;\n}\n\n/**\n * This defines a base information object that explains where in a buffer a value\n * is represented.\n */\nexport interface IBufferLocation {\n  /** This is the parent attribute of this location */\n  attribute: IInstanceAttributeInternal<Instance>;\n  /** For some buffer strategies, there is a concept of block that is used to tightly pack attributes together. */\n  block?: number;\n  /**\n   * This is the generic buffer object interface for accessing the actual buffer.\n   */\n  buffer: {\n    value: Float32Array | Uint8Array | Vec4[];\n  };\n  /**\n   * If the attribute has child attributes (attributes auto generated as a consequence of the attributes settings)\n   * then the children's buffer locations can be found here.\n   */\n  childLocations?: IBufferLocation[];\n  /**\n   * This is the instance index indicative of the instance positioning within the buffer.\n   * Keep in mind: This does NOT correlate to a lookup for an Instance object but rather for\n   * the instancing concept designed for GL Buffers.\n   */\n  instanceIndex: number;\n  /**\n   * This is the range within the buffer values should be injected for this location.\n   */\n  range: Vec2;\n}\n\n/**\n * Each instance that comes in can be associated with a group of buffer locations. A buffer location for each\n * instance attribute used in updates. So a grouping is several buffer locations that are keyed by\n * the instance's property's UIDs.\n */\nexport interface IBufferLocationGroup<T extends IBufferLocation> {\n  /** This is the instance index WITHIN THE BUFFERS. This does NOT have relevance to Instance type objects */\n  instanceIndex: number;\n  /** This is a map of property UIDs to an associated buffer location */\n  propertyToBufferLocation: { [key: number]: T };\n}\n\n/**\n * Layers manage instances and those instances require a form of binding to their associated buffers.\n * The buffers have to be intelligently created and managed in this tieing to maximize performance.\n * One can not have a buffer for every instance in most cases, so the buffer manager has to get instances\n * to cooperate sharing a buffer in whatever strategy possible that best suits the hardware and it's limitations.\n *\n * This provides a uniform interface between instances and their corresponding buffer.\n */\nexport abstract class BufferManagerBase<\n  T extends Instance,\n  U extends IBufferLocation\n> {\n  /** This is the list of changes in effect while this manager is processing requests */\n  changeListContext: InstanceDiff<T>[];\n  /** The layer this manager glues Instances to Buffers */\n  layer: Layer<T, any>;\n  /** The scene the layer is injecting elements into */\n  scene: LayerScene;\n\n  /**\n   * Base constructor. A manager always needs to be associated with it's layer and it's scene.\n   */\n  constructor(layer: Layer<T, any>, scene: LayerScene) {\n    this.layer = layer;\n    this.scene = scene;\n  }\n\n  /**\n   * This adds an instance to the manager and thus ties the instance to an IBuffer location\n   */\n  add: (instance: T) => U | IBufferLocationGroup<U> | undefined;\n\n  /**\n   * This allows a manager to clean up any contextual information it may have stored while processing changes.\n   */\n  changesProcessed() {\n    delete this.changeListContext;\n  }\n\n  /**\n   * Destroy all elements that consume GPU resources or consumes otherwise unreleaseable resources.\n   */\n  abstract destroy(): void;\n\n  /**\n   * Retrieves the buffer locations for the instance provided\n   */\n  abstract getBufferLocations(\n    instance: T\n  ): U | IBufferLocationGroup<U> | undefined;\n\n  /**\n   * This retrieves the property ID for the active attribute. This is necessary to prevent\n   * the need for lookups to find the active attribute.\n   */\n  abstract getActiveAttributePropertyId(): number;\n\n  /**\n   * This returns how many instances this buffer manager has grown to accommodate.\n   */\n  abstract getInstanceCount(): number;\n\n  /**\n   * This should provide a minimum property id list that represents a set of properties that if triggered\n   * for update, would cause all of the attributes to be updated for the layer.\n   */\n  abstract getUpdateAllPropertyIdList(): number[];\n\n  /**\n   * This will be called with the changes that WILL be processed. This allows this manager to make extra judgement calls on\n   * how it will process the changes and let's it optimize itself before changes are actually processed. An example optimization:\n   *\n   * The manager is receiving add requests. The manager receives an add request that triggers a resize of the buffer. Ideally,\n   * the buffer should perform a single resize operation to accommodate ALL add requests getting ready to stream in plus the\n   * current size of of the buffer. With this method, the changes will be available to the manager and let the manager make this\n   * important decision instead of reflexively grow the buffer as requests stream in, which can cause a large number of costly\n   * resize operations.\n   */\n  incomingChangeList(changes: InstanceDiff<T>[]) {\n    this.changeListContext = changes;\n  }\n\n  /**\n   * This method checks to see if this buffer manager has linked an instance to a buffer\n   * location managed by this object.\n   */\n  abstract managesInstance(instance: T): boolean;\n\n  /**\n   * Disassociates an instance with it's buffer location and makes the instance\n   * in the buffer no longer drawable.\n   */\n  remove: (instance: T) => T;\n\n  /**\n   * Removes the manager from the scene it applied itself to.\n   */\n  abstract removeFromScene(): void;\n}\n","import { Omit } from \"../types\";\nimport { GLProxy } from \"./gl-proxy\";\nimport { GLSettings } from \"./gl-settings\";\n\n/**\n * This is the options to apply to a texture\n */\nexport type TextureOptions = Omit<\n  Partial<Texture>,\n  \"dispose\" | \"update\" | \"updateRegions\"\n>;\n\n/**\n * This represents a texture that is loaded into the GPU.\n */\nexport class Texture {\n  /**\n   * Anisotropic filtering level. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texParameter\n   * https://blog.tojicode.com/2012/03/anisotropic-filtering-in-webgl.html\n   */\n  get anisotropy() {\n    return this._anisotropy;\n  }\n  set anisotropy(val: Texture[\"_anisotropy\"]) {\n    this.needsSettingsUpdate = true;\n    this._anisotropy = val;\n  }\n  private _anisotropy: number;\n\n  /**\n   * The data to apply to the GPU for the image. If no data is to be uploaded to the texture,\n   * use width and height object. You would do this for render target textures such as depth textures\n   * or color buffer textures where the GPU writes the initial data into the texture. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texImage2D\n   */\n  get data() {\n    return this._data;\n  }\n  set data(val: Texture[\"_data\"]) {\n    this.needsDataUpload = true;\n    this._data = val;\n  }\n  private _data?:\n    | TexImageSource\n    | {\n        width: number;\n        height: number;\n        buffer: ArrayBufferView | null;\n      };\n\n  /**\n   * Indicates the data gets flipped vertically when uploaded to the GPU.\n   */\n  get flipY() {\n    return this._flipY;\n  }\n  set flipY(val: boolean) {\n    this.needsDataUpload = true;\n    this._flipY = val;\n  }\n  private _flipY: boolean = false;\n\n  /**\n   * Source format of the input. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texImage2D\n   */\n  get format() {\n    return this._format;\n  }\n  set format(val: Texture[\"_format\"]) {\n    this.needsDataUpload = true;\n    this._format = val;\n  }\n  private _format: GLSettings.Texture.TexelDataType = GLSettings.Texture\n    .TexelDataType.RGBA;\n\n  /**\n   * Auto generates mipmaps. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/generateMipmap\n   */\n  get generateMipMaps() {\n    return this._generateMipmaps;\n  }\n  set generateMipMaps(val: Texture[\"_generateMipmaps\"]) {\n    this.needsSettingsUpdate = true;\n    this._generateMipmaps = val;\n  }\n  private _generateMipmaps: boolean = false;\n\n  /**\n   * This stores any gl state associated with this object. Modifying this object will cause the system to get out\n   * of sync with the GPU; however, the values inside this object can be read and used for custom WebGL calls as needed.\n   */\n  gl?: {\n    /** The identifier used by gl to target this texture. */\n    textureId: WebGLTexture | null;\n    /** The texture unit this texture is assocviated with. This is -1 if no unit is currently associated */\n    textureUnit: number;\n    /** This is the proxy communicator with the context that generates and destroys Textures */\n    proxy: GLProxy;\n  };\n\n  /**\n   * Filter used when sampling has to magnify the image see:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texParameter\n   */\n  get magFilter() {\n    return this._magFilter;\n  }\n  set magFilter(val: Texture[\"_magFilter\"]) {\n    this.needsSettingsUpdate = true;\n    this._magFilter = val;\n  }\n  private _magFilter: GLSettings.Texture.TextureMagFilter = GLSettings.Texture\n    .TextureMagFilter.Linear;\n\n  /**\n   * Filter used when sampling has to shrink the image. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texParameter\n   */\n  get minFilter() {\n    return this._minFilter;\n  }\n  set minFilter(val: Texture[\"_minFilter\"]) {\n    this.needsSettingsUpdate = true;\n    this._minFilter = val;\n  }\n  private _minFilter: GLSettings.Texture.TextureMinFilter = GLSettings.Texture\n    .TextureMinFilter.LinearMipMapLinear;\n\n  /** Flag indicates if the texture object needs to have it's data modified */\n  needsDataUpload: boolean = false;\n  /** Flag indicates if the texture object has sub texture updates needed to be applied to it */\n  needsPartialDataUpload: boolean = false;\n  /** Flag indicates if the texture object needs it's settings modified */\n  needsSettingsUpdate: boolean = false;\n\n  /**\n   * Sets the readPixels data alignment. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/pixelStorei\n   * https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glPixelStorei.xml\n   */\n  get packAlignment() {\n    return this._packAlignment;\n  }\n  set packAlignment(val: Texture[\"_packAlignment\"]) {\n    this.needsSettingsUpdate = true;\n    this._packAlignment = val;\n  }\n  private _packAlignment: GLSettings.Texture.PackAlignment = GLSettings.Texture\n    .PackAlignment.FOUR;\n\n  /**\n   * Tells the input packing to premultiply the alpha values with the other channels as the texture is generated. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/pixelStorei\n   */\n  get premultiplyAlpha() {\n    return this._premultiplyAlpha;\n  }\n  set premultiplyAlpha(val: Texture[\"_premultiplyAlpha\"]) {\n    this.needsSettingsUpdate = true;\n    this._premultiplyAlpha = val;\n  }\n  private _premultiplyAlpha: boolean = false;\n\n  /**\n   * The source pixel data type.\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texImage2D\n   */\n  get type() {\n    return this._type;\n  }\n  set type(val: Texture[\"_type\"]) {\n    this.needsDataUpload = true;\n    this._type = val;\n  }\n  private _type = GLSettings.Texture.SourcePixelFormat.UnsignedByte;\n\n  /**\n   * Sets the data alignment for packing the pixels. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/pixelStorei\n   * https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glPixelStorei.xml\n   */\n  get unpackAlignment() {\n    return this._unpackAlignment;\n  }\n  set unpackAlignment(val: Texture[\"_unpackAlignment\"]) {\n    this.needsSettingsUpdate = true;\n    this._unpackAlignment = val;\n  }\n  private _unpackAlignment: GLSettings.Texture.UnpackAlignment = GLSettings\n    .Texture.UnpackAlignment.FOUR;\n\n  /**\n   * These are the regions that have been requested to be applied to the Texture along\n   * with the data that should be buffered into that region.\n   */\n  get updateRegions() {\n    return this._updateRegions;\n  }\n  private _updateRegions: [\n    Texture[\"data\"],\n    { x: number; y: number; width: number; height: number }\n  ][] = [];\n\n  /**\n   * Specifies sample wrapping for when samples fall outside the 0 - 1 range See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texParameter\n   */\n  get wrapHorizontal() {\n    return this._wrapHorizontal;\n  }\n  set wrapHorizontal(val: Texture[\"_wrapHorizontal\"]) {\n    this.needsSettingsUpdate = true;\n    this._wrapHorizontal = val;\n  }\n  private _wrapHorizontal: GLSettings.Texture.Wrapping = GLSettings.Texture\n    .Wrapping.CLAMP_TO_EDGE;\n\n  /**\n   * Specifies sample wrapping for when samples fall outside the 0 - 1 range. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texParameter\n   */\n  get wrapVertical() {\n    return this._wrapVertical;\n  }\n  set wrapVertical(val: Texture[\"_wrapVertical\"]) {\n    this.needsSettingsUpdate = true;\n    this._wrapVertical = val;\n  }\n  private _wrapVertical: GLSettings.Texture.Wrapping = GLSettings.Texture\n    .Wrapping.CLAMP_TO_EDGE;\n\n  constructor(options: TextureOptions) {\n    Object.assign(this, options);\n  }\n\n  /**\n   * Frees resources associated with this texture.\n   */\n  dispose() {\n    // Clear the gl context\n    if (this.gl) {\n      this.gl.proxy.disposeTexture(this);\n    }\n\n    // Ensure the large data object for the texture is cleared\n    delete this._data;\n  }\n\n  /**\n   * Clears all update flags and clears out requested updates to the texture object.\n   *\n   * NOTE: Calling this does not perform any actions, but instead prevents actions from\n   * being taken again. The system uses this to clear up any changes requested for the texture\n   * after the texture has been updated with the GPU.\n   */\n  resolve() {\n    this.needsDataUpload = false;\n    this.needsPartialDataUpload = false;\n    this.needsSettingsUpdate = false;\n    this._updateRegions = [];\n  }\n\n  /**\n   * This updates a portion of the texture object.\n   */\n  update(\n    data: Texture[\"data\"],\n    region: { x: number; y: number; width: number; height: number }\n  ) {\n    this.needsPartialDataUpload = true;\n    this._updateRegions.push([data, region]);\n  }\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.parseBackgroundImage = exports.parseBackground = exports.calculateBackgroundRepeatPath = exports.calculateBackgroundPosition = exports.calculateBackgroungPositioningArea = exports.calculateBackgroungPaintingArea = exports.calculateGradientBackgroundSize = exports.calculateBackgroundSize = exports.BACKGROUND_ORIGIN = exports.BACKGROUND_CLIP = exports.BACKGROUND_SIZE = exports.BACKGROUND_REPEAT = undefined;\n\nvar _Color = require('../Color');\n\nvar _Color2 = _interopRequireDefault(_Color);\n\nvar _Length = require('../Length');\n\nvar _Length2 = _interopRequireDefault(_Length);\n\nvar _Size = require('../drawing/Size');\n\nvar _Size2 = _interopRequireDefault(_Size);\n\nvar _Vector = require('../drawing/Vector');\n\nvar _Vector2 = _interopRequireDefault(_Vector);\n\nvar _Bounds = require('../Bounds');\n\nvar _padding = require('./padding');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar BACKGROUND_REPEAT = exports.BACKGROUND_REPEAT = {\n    REPEAT: 0,\n    NO_REPEAT: 1,\n    REPEAT_X: 2,\n    REPEAT_Y: 3\n};\n\nvar BACKGROUND_SIZE = exports.BACKGROUND_SIZE = {\n    AUTO: 0,\n    CONTAIN: 1,\n    COVER: 2,\n    LENGTH: 3\n};\n\nvar BACKGROUND_CLIP = exports.BACKGROUND_CLIP = {\n    BORDER_BOX: 0,\n    PADDING_BOX: 1,\n    CONTENT_BOX: 2\n};\n\nvar BACKGROUND_ORIGIN = exports.BACKGROUND_ORIGIN = BACKGROUND_CLIP;\n\nvar AUTO = 'auto';\n\nvar BackgroundSize = function BackgroundSize(size) {\n    _classCallCheck(this, BackgroundSize);\n\n    switch (size) {\n        case 'contain':\n            this.size = BACKGROUND_SIZE.CONTAIN;\n            break;\n        case 'cover':\n            this.size = BACKGROUND_SIZE.COVER;\n            break;\n        case 'auto':\n            this.size = BACKGROUND_SIZE.AUTO;\n            break;\n        default:\n            this.value = new _Length2.default(size);\n    }\n};\n\nvar calculateBackgroundSize = exports.calculateBackgroundSize = function calculateBackgroundSize(backgroundImage, image, bounds) {\n    var width = 0;\n    var height = 0;\n    var size = backgroundImage.size;\n    if (size[0].size === BACKGROUND_SIZE.CONTAIN || size[0].size === BACKGROUND_SIZE.COVER) {\n        var targetRatio = bounds.width / bounds.height;\n        var currentRatio = image.width / image.height;\n        return targetRatio < currentRatio !== (size[0].size === BACKGROUND_SIZE.COVER) ? new _Size2.default(bounds.width, bounds.width / currentRatio) : new _Size2.default(bounds.height * currentRatio, bounds.height);\n    }\n\n    if (size[0].value) {\n        width = size[0].value.getAbsoluteValue(bounds.width);\n    }\n\n    if (size[0].size === BACKGROUND_SIZE.AUTO && size[1].size === BACKGROUND_SIZE.AUTO) {\n        height = image.height;\n    } else if (size[1].size === BACKGROUND_SIZE.AUTO) {\n        height = width / image.width * image.height;\n    } else if (size[1].value) {\n        height = size[1].value.getAbsoluteValue(bounds.height);\n    }\n\n    if (size[0].size === BACKGROUND_SIZE.AUTO) {\n        width = height / image.height * image.width;\n    }\n\n    return new _Size2.default(width, height);\n};\n\nvar calculateGradientBackgroundSize = exports.calculateGradientBackgroundSize = function calculateGradientBackgroundSize(backgroundImage, bounds) {\n    var size = backgroundImage.size;\n    var width = size[0].value ? size[0].value.getAbsoluteValue(bounds.width) : bounds.width;\n    var height = size[1].value ? size[1].value.getAbsoluteValue(bounds.height) : size[0].value ? width : bounds.height;\n\n    return new _Size2.default(width, height);\n};\n\nvar AUTO_SIZE = new BackgroundSize(AUTO);\n\nvar calculateBackgroungPaintingArea = exports.calculateBackgroungPaintingArea = function calculateBackgroungPaintingArea(curves, clip) {\n    switch (clip) {\n        case BACKGROUND_CLIP.BORDER_BOX:\n            return (0, _Bounds.calculateBorderBoxPath)(curves);\n        case BACKGROUND_CLIP.PADDING_BOX:\n        default:\n            return (0, _Bounds.calculatePaddingBoxPath)(curves);\n    }\n};\n\nvar calculateBackgroungPositioningArea = exports.calculateBackgroungPositioningArea = function calculateBackgroungPositioningArea(backgroundOrigin, bounds, padding, border) {\n    var paddingBox = (0, _Bounds.calculatePaddingBox)(bounds, border);\n\n    switch (backgroundOrigin) {\n        case BACKGROUND_ORIGIN.BORDER_BOX:\n            return bounds;\n        case BACKGROUND_ORIGIN.CONTENT_BOX:\n            var paddingLeft = padding[_padding.PADDING_SIDES.LEFT].getAbsoluteValue(bounds.width);\n            var paddingRight = padding[_padding.PADDING_SIDES.RIGHT].getAbsoluteValue(bounds.width);\n            var paddingTop = padding[_padding.PADDING_SIDES.TOP].getAbsoluteValue(bounds.width);\n            var paddingBottom = padding[_padding.PADDING_SIDES.BOTTOM].getAbsoluteValue(bounds.width);\n            return new _Bounds.Bounds(paddingBox.left + paddingLeft, paddingBox.top + paddingTop, paddingBox.width - paddingLeft - paddingRight, paddingBox.height - paddingTop - paddingBottom);\n        case BACKGROUND_ORIGIN.PADDING_BOX:\n        default:\n            return paddingBox;\n    }\n};\n\nvar calculateBackgroundPosition = exports.calculateBackgroundPosition = function calculateBackgroundPosition(position, size, bounds) {\n    return new _Vector2.default(position[0].getAbsoluteValue(bounds.width - size.width), position[1].getAbsoluteValue(bounds.height - size.height));\n};\n\nvar calculateBackgroundRepeatPath = exports.calculateBackgroundRepeatPath = function calculateBackgroundRepeatPath(background, position, size, backgroundPositioningArea, bounds) {\n    var repeat = background.repeat;\n    switch (repeat) {\n        case BACKGROUND_REPEAT.REPEAT_X:\n            return [new _Vector2.default(Math.round(bounds.left), Math.round(backgroundPositioningArea.top + position.y)), new _Vector2.default(Math.round(bounds.left + bounds.width), Math.round(backgroundPositioningArea.top + position.y)), new _Vector2.default(Math.round(bounds.left + bounds.width), Math.round(size.height + backgroundPositioningArea.top + position.y)), new _Vector2.default(Math.round(bounds.left), Math.round(size.height + backgroundPositioningArea.top + position.y))];\n        case BACKGROUND_REPEAT.REPEAT_Y:\n            return [new _Vector2.default(Math.round(backgroundPositioningArea.left + position.x), Math.round(bounds.top)), new _Vector2.default(Math.round(backgroundPositioningArea.left + position.x + size.width), Math.round(bounds.top)), new _Vector2.default(Math.round(backgroundPositioningArea.left + position.x + size.width), Math.round(bounds.height + bounds.top)), new _Vector2.default(Math.round(backgroundPositioningArea.left + position.x), Math.round(bounds.height + bounds.top))];\n        case BACKGROUND_REPEAT.NO_REPEAT:\n            return [new _Vector2.default(Math.round(backgroundPositioningArea.left + position.x), Math.round(backgroundPositioningArea.top + position.y)), new _Vector2.default(Math.round(backgroundPositioningArea.left + position.x + size.width), Math.round(backgroundPositioningArea.top + position.y)), new _Vector2.default(Math.round(backgroundPositioningArea.left + position.x + size.width), Math.round(backgroundPositioningArea.top + position.y + size.height)), new _Vector2.default(Math.round(backgroundPositioningArea.left + position.x), Math.round(backgroundPositioningArea.top + position.y + size.height))];\n        default:\n            return [new _Vector2.default(Math.round(bounds.left), Math.round(bounds.top)), new _Vector2.default(Math.round(bounds.left + bounds.width), Math.round(bounds.top)), new _Vector2.default(Math.round(bounds.left + bounds.width), Math.round(bounds.height + bounds.top)), new _Vector2.default(Math.round(bounds.left), Math.round(bounds.height + bounds.top))];\n    }\n};\n\nvar parseBackground = exports.parseBackground = function parseBackground(style, resourceLoader) {\n    return {\n        backgroundColor: new _Color2.default(style.backgroundColor),\n        backgroundImage: parseBackgroundImages(style, resourceLoader),\n        backgroundClip: parseBackgroundClip(style.backgroundClip),\n        backgroundOrigin: parseBackgroundOrigin(style.backgroundOrigin)\n    };\n};\n\nvar parseBackgroundClip = function parseBackgroundClip(backgroundClip) {\n    switch (backgroundClip) {\n        case 'padding-box':\n            return BACKGROUND_CLIP.PADDING_BOX;\n        case 'content-box':\n            return BACKGROUND_CLIP.CONTENT_BOX;\n    }\n    return BACKGROUND_CLIP.BORDER_BOX;\n};\n\nvar parseBackgroundOrigin = function parseBackgroundOrigin(backgroundOrigin) {\n    switch (backgroundOrigin) {\n        case 'padding-box':\n            return BACKGROUND_ORIGIN.PADDING_BOX;\n        case 'content-box':\n            return BACKGROUND_ORIGIN.CONTENT_BOX;\n    }\n    return BACKGROUND_ORIGIN.BORDER_BOX;\n};\n\nvar parseBackgroundRepeat = function parseBackgroundRepeat(backgroundRepeat) {\n    switch (backgroundRepeat.trim()) {\n        case 'no-repeat':\n            return BACKGROUND_REPEAT.NO_REPEAT;\n        case 'repeat-x':\n        case 'repeat no-repeat':\n            return BACKGROUND_REPEAT.REPEAT_X;\n        case 'repeat-y':\n        case 'no-repeat repeat':\n            return BACKGROUND_REPEAT.REPEAT_Y;\n        case 'repeat':\n            return BACKGROUND_REPEAT.REPEAT;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n        console.error('Invalid background-repeat value \"' + backgroundRepeat + '\"');\n    }\n\n    return BACKGROUND_REPEAT.REPEAT;\n};\n\nvar parseBackgroundImages = function parseBackgroundImages(style, resourceLoader) {\n    var sources = parseBackgroundImage(style.backgroundImage).map(function (backgroundImage) {\n        if (backgroundImage.method === 'url') {\n            var key = resourceLoader.loadImage(backgroundImage.args[0]);\n            backgroundImage.args = key ? [key] : [];\n        }\n        return backgroundImage;\n    });\n    var positions = style.backgroundPosition.split(',');\n    var repeats = style.backgroundRepeat.split(',');\n    var sizes = style.backgroundSize.split(',');\n\n    return sources.map(function (source, index) {\n        var size = (sizes[index] || AUTO).trim().split(' ').map(parseBackgroundSize);\n        var position = (positions[index] || AUTO).trim().split(' ').map(parseBackgoundPosition);\n\n        return {\n            source: source,\n            repeat: parseBackgroundRepeat(typeof repeats[index] === 'string' ? repeats[index] : repeats[0]),\n            size: size.length < 2 ? [size[0], AUTO_SIZE] : [size[0], size[1]],\n            position: position.length < 2 ? [position[0], position[0]] : [position[0], position[1]]\n        };\n    });\n};\n\nvar parseBackgroundSize = function parseBackgroundSize(size) {\n    return size === 'auto' ? AUTO_SIZE : new BackgroundSize(size);\n};\n\nvar parseBackgoundPosition = function parseBackgoundPosition(position) {\n    switch (position) {\n        case 'bottom':\n        case 'right':\n            return new _Length2.default('100%');\n        case 'left':\n        case 'top':\n            return new _Length2.default('0%');\n        case 'auto':\n            return new _Length2.default('0');\n    }\n    return new _Length2.default(position);\n};\n\nvar parseBackgroundImage = exports.parseBackgroundImage = function parseBackgroundImage(image) {\n    var whitespace = /^\\s$/;\n    var results = [];\n\n    var args = [];\n    var method = '';\n    var quote = null;\n    var definition = '';\n    var mode = 0;\n    var numParen = 0;\n\n    var appendResult = function appendResult() {\n        var prefix = '';\n        if (method) {\n            if (definition.substr(0, 1) === '\"') {\n                definition = definition.substr(1, definition.length - 2);\n            }\n\n            if (definition) {\n                args.push(definition.trim());\n            }\n\n            var prefix_i = method.indexOf('-', 1) + 1;\n            if (method.substr(0, 1) === '-' && prefix_i > 0) {\n                prefix = method.substr(0, prefix_i).toLowerCase();\n                method = method.substr(prefix_i);\n            }\n            method = method.toLowerCase();\n            if (method !== 'none') {\n                results.push({\n                    prefix: prefix,\n                    method: method,\n                    args: args\n                });\n            }\n        }\n        args = [];\n        method = definition = '';\n    };\n\n    image.split('').forEach(function (c) {\n        if (mode === 0 && whitespace.test(c)) {\n            return;\n        }\n        switch (c) {\n            case '\"':\n                if (!quote) {\n                    quote = c;\n                } else if (quote === c) {\n                    quote = null;\n                }\n                break;\n            case '(':\n                if (quote) {\n                    break;\n                } else if (mode === 0) {\n                    mode = 1;\n                    return;\n                } else {\n                    numParen++;\n                }\n                break;\n            case ')':\n                if (quote) {\n                    break;\n                } else if (mode === 1) {\n                    if (numParen === 0) {\n                        mode = 0;\n                        appendResult();\n                        return;\n                    } else {\n                        numParen--;\n                    }\n                }\n                break;\n\n            case ',':\n                if (quote) {\n                    break;\n                } else if (mode === 0) {\n                    appendResult();\n                    return;\n                } else if (mode === 1) {\n                    if (numParen === 0 && !method.match(/^url$/i)) {\n                        args.push(definition.trim());\n                        definition = '';\n                        return;\n                    }\n                }\n                break;\n        }\n\n        if (mode === 0) {\n            method += c;\n        } else {\n            definition += c;\n        }\n    });\n\n    appendResult();\n    return results;\n};","import { Bounds } from \"../../primitives/bounds\";\nimport { SubTexture } from \"./sub-texture\";\n\n/**\n * Helps us track the bounds of the image being loaded in tied in with the\n * texture it represents\n */\nexport interface IPackNodeDimensions<T> {\n  data: T;\n  bounds: Bounds;\n}\n\n/**\n * This is used specifically by the atlas manager to aid in packing\n * in textures within an area. This will guarantee boundaries of textures are\n * not violated and provide proper feedback for where to draw a given image\n */\nexport class PackNode<T> {\n  child: [PackNode<T> | null, PackNode<T> | null] = [null, null];\n  isLeaf: boolean = true;\n  bounds: Bounds;\n  data: T | null = null;\n\n  constructor(x: number, y: number, width: number, height: number) {\n    this.bounds = new Bounds({\n      height,\n      width,\n      x,\n      y\n    });\n  }\n\n  /**\n   * Deletes all of the sub nodes in this Mapping, thus clearing up memory usage\n   */\n  destroy() {\n    const child0 = this.child[0];\n    const child1 = this.child[1];\n    this.data = null;\n    if (child0) {\n      child0.destroy();\n    }\n    if (child1) {\n      child1.destroy();\n    }\n    this.child[0] = null;\n    this.child[1] = null;\n  }\n\n  /**\n   * Indicates if there is a child\n   */\n  hasChild(): boolean {\n    const child0 = this.child[0];\n    const child1 = this.child[1];\n    if (child0 && !child0.data) {\n      return !child0.isLeaf;\n    }\n    if (child1 && !child1.data) {\n      return !child1.isLeaf;\n    }\n    return false;\n  }\n\n  /**\n   * Inserts images into our mapping, fitting them appropriately\n   */\n  insert(image: IPackNodeDimensions<T>): PackNode<T> | null {\n    let child0 = this.child[0];\n    let child1 = this.child[1];\n\n    if (!this.isLeaf && child0 && child1) {\n      // Try inserting into first child\n      const newNode: PackNode<T> | null = child0.insert(image);\n      if (newNode !== null) return newNode;\n      // No room in first so insert into second\n      return child1.insert(image);\n    } else {\n      // If there's already an image here, return\n      if (this.data) return null;\n      // Check the fit status of the image in this nodes rectangle space\n      const fitFlag: number = this.bounds.fits(image.bounds);\n      // If we're too small, return null indicating can not fit\n      if (fitFlag === 0) return null;\n\n      // If we're just right, accept\n      if (fitFlag === 1) {\n        this.data = image.data;\n        return this;\n      }\n\n      // Otherwise, gotta split this node and create some leaves\n      this.isLeaf = false;\n      // Get the image width\n      const imgWidth: number = image.bounds.width;\n      const imgHeight: number = image.bounds.height;\n      // Decide which way to split\n      const dWidth: number = this.bounds.width - imgWidth;\n      const dHeight: number = this.bounds.height - image.bounds.height;\n\n      if (dWidth > dHeight) {\n        child0 = this.child[0] = new PackNode(\n          this.bounds.x,\n          this.bounds.y,\n          imgWidth,\n          this.bounds.height\n        );\n        child1 = this.child[1] = new PackNode(\n          this.bounds.x + imgWidth,\n          this.bounds.y,\n          dWidth,\n          this.bounds.height\n        );\n      } else {\n        child0 = this.child[0] = new PackNode(\n          this.bounds.x,\n          this.bounds.y,\n          this.bounds.width,\n          imgHeight\n        );\n        child1 = this.child[1] = new PackNode(\n          this.bounds.x,\n          this.bounds.y + imgHeight,\n          this.bounds.width,\n          dHeight\n        );\n      }\n    }\n\n    // Insert into first child we created\n    return child0.insert(image);\n  }\n\n  /**\n   * Removes the image from the mapping and tries to open up as much space as possible.\n   *\n   * @param {AtlasTexture} data The image to insert into the\n   */\n  remove(data: T): boolean {\n    const child0 = this.child[0];\n    const child1 = this.child[1];\n\n    if (child1 && child0 && !this.isLeaf) {\n      // Try removing from first child\n      let removed: boolean = child0.remove(data);\n      if (removed) return true;\n      // Try remove from second\n      removed = child1.remove(data);\n\n      if (!child0.hasChild()) {\n        if (!child1.hasChild()) {\n          this.child[0] = null;\n          this.child[1] = null;\n        }\n      }\n\n      return removed;\n    } else {\n      if (this.data === data) {\n        this.data = null;\n\n        return true;\n      } else {\n        return false;\n      }\n    }\n  }\n\n  /**\n   * Applies a node's bounds to SubTexture.\n   */\n  static applyToSubTexture<T>(\n    root: PackNode<T>,\n    node: PackNode<T>,\n    texture?: SubTexture,\n    padding?: { top: number; left: number; right: number; bottom: number },\n    flipY?: boolean\n  ) {\n    if (!texture) return;\n\n    padding = padding || {\n      top: 0,\n      left: 0,\n      bottom: 0,\n      right: 0\n    };\n\n    // Set our image's atlas properties\n    const ux = (node.bounds.x + padding.left) / root.bounds.width;\n    const uy = (node.bounds.y + padding.top) / root.bounds.height;\n    const uw =\n      (node.bounds.width - padding.left - padding.right) / root.bounds.width;\n    const uh =\n      (node.bounds.height - padding.top - padding.bottom) / root.bounds.height;\n\n    let atlasDimensions: Bounds;\n\n    if (flipY) {\n      atlasDimensions = new Bounds({\n        bottom: 1.0 - uy,\n        left: ux,\n        right: ux + uw,\n        top: 1.0 - (uy + uh)\n      });\n    } else {\n      atlasDimensions = new Bounds({\n        top: 1.0 - uy,\n        left: ux,\n        right: ux + uw,\n        bottom: 1.0 - (uy + uh)\n      });\n    }\n\n    const bottom = atlasDimensions.bottom;\n    const top = atlasDimensions.y;\n    const left = atlasDimensions.x;\n    const right = atlasDimensions.x + atlasDimensions.width;\n\n    texture.atlasTL = [left, top];\n    texture.atlasBR = [right, bottom];\n    texture.atlasBL = [left, bottom];\n    texture.atlasTR = [right, top];\n    texture.widthOnAtlas = Math.abs(texture.atlasTR[0] - texture.atlasTL[0]);\n    texture.heightOnAtlas = Math.abs(texture.atlasTR[1] - texture.atlasBR[1]);\n    texture.pixelWidth = uw * root.bounds.width;\n    texture.pixelHeight = uh * root.bounds.height;\n  }\n}\n","export * from \"./base-resource-manager\";\nexport * from \"./resource-manager\";\nexport * from \"./text\";\nexport * from \"./texture\";\n","import { Geometry, GLSettings, Material, Model } from \"../../gl\";\n\nexport function generateLayerModel(\n  geometry: Geometry,\n  material: Material,\n  drawMode?: GLSettings.Model.DrawMode\n): Model {\n  const model = new Model(geometry, material);\n  model.drawMode = drawMode || GLSettings.Model.DrawMode.TRIANGLE_STRIP;\n\n  return model;\n}\n","export interface IdentifyByKeyOptions {\n  /** The identifier of the object */\n  key: string;\n}\n\n/**\n * This is an object that specifically is generated with a 'key' option that can never\n * be modified on the object and is identified henceforth with the key applied as the\n * 'id' of the object.\n */\nexport class IdentifyByKey {\n  /** Internal key held by the object */\n  private _key: string;\n\n  /** READONLY id of the object. */\n  get id() {\n    return this._key;\n  }\n\n  /** READONLY key of the object */\n  get key() {\n    return this._key;\n  }\n\n  constructor(options: IdentifyByKeyOptions) {\n    this._key = options.key;\n  }\n}\n","import { uid } from \"../util/uid\";\nimport { Instance } from \"./instance\";\n\nexport class ObservableMonitoring {\n  static gatherIds: boolean = false;\n  static observableIds: number[] = [];\n  static observableNamesToUID = new Map<string, number>();\n\n  /**\n   * This activates all observables to gather their UIDs when they are retrieved via their getter.\n   * All of the ID's gathered can be accessed via getObservableMonitorIds. It is REQUIRED that this\n   * is disabled again to prevent a MASSIVE memory leak.\n   */\n  static setObservableMonitor(enabled: boolean) {\n    ObservableMonitoring.gatherIds = enabled;\n    ObservableMonitoring.observableIds = [];\n  }\n\n  /**\n   * This retrieves the observables montiored IDs that were gathered when setObservableMonitor was\n   * enabled.\n   */\n  static getObservableMonitorIds(clear?: boolean) {\n    const values = ObservableMonitoring.observableIds.slice(0);\n    if (clear) ObservableMonitoring.observableIds = [];\n\n    return values;\n  }\n}\n\n/**\n * This is a custom decorator intended for single properties on Instances only! It will\n * facilitate automatic updates and stream the updates through an InstanceProvider to properly\n * update the Instances values in the appropriate and corresponding buffers that will get committed\n * to the GPU.\n */\nexport function observable<T extends Instance>(target: T, key: string) {\n  // Here we store the name of the observable to a UID. This mapping allows us to have a UID\n  // per NAME of an observable. A UID for a name can produce MUCH faster lookups than the name itself.\n  // Matching against the name allows us to have instances with their own property sets but have matching\n  // name mappings to improve compatibility of Instances with varying Layers.\n  let propertyUID: number =\n    ObservableMonitoring.observableNamesToUID.get(key) || 0;\n\n  if (!propertyUID) {\n    propertyUID = uid();\n    ObservableMonitoring.observableNamesToUID.set(key, propertyUID);\n  }\n\n  /**\n   * New property getter to get the property's alternative storage since we overrode\n   * the initial storage with a custom getter and setter.\n   */\n  function getter(this: T) {\n    if (ObservableMonitoring.gatherIds) {\n      ObservableMonitoring.observableIds.push(propertyUID);\n    }\n    return this.observableStorage[propertyUID];\n  }\n\n  /**\n   * New property setter to replace the property marked as observable. This allows\n   * us to broadcast a change to our current observer.\n   */\n  function setter(this: T, newVal: any) {\n    // Update the privatized value\n    this.observableStorage[propertyUID] = newVal;\n    // Broadcast change\n    this.changes[propertyUID] = propertyUID;\n    this.observer && this.observer.instanceUpdated(this);\n  }\n\n  /**\n   * Make sure the desired property is declared on the class with our custom getter and\n   * setter.\n   */\n  Object.defineProperty(target, key, {\n    configurable: true,\n    enumerable: true,\n    get: getter,\n    set: setter\n  });\n}\n","export function getProgramInfo(gl: WebGLRenderingContext, program: any) {\n  const result = {\n      attributeCount: 0,\n      attributes: new Array(),\n      uniformCount: 0,\n      uniforms: new Array()\n    },\n    activeUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS),\n    activeAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n\n  // Taken from the WebGl spec:\n  // Http://www.khronos.org/registry/webgl/specs/latest/1.0/#5.14\n  const enums: { [key: number]: string } = {\n    0x8b50: \"FLOAT_VEC2\",\n    0x8b51: \"FLOAT_VEC3\",\n    0x8b52: \"FLOAT_VEC4\",\n    0x8b53: \"INT_VEC2\",\n    0x8b54: \"INT_VEC3\",\n    0x8b55: \"INT_VEC4\",\n    0x8b56: \"BOOL\",\n    0x8b57: \"BOOL_VEC2\",\n    0x8b58: \"BOOL_VEC3\",\n    0x8b59: \"BOOL_VEC4\",\n    0x8b5a: \"FLOAT_MAT2\",\n    0x8b5b: \"FLOAT_MAT3\",\n    0x8b5c: \"FLOAT_MAT4\",\n    0x8b5e: \"SAMPLER_2D\",\n    0x8b60: \"SAMPLER_CUBE\",\n    0x1400: \"BYTE\",\n    0x1401: \"UNSIGNED_BYTE\",\n    0x1402: \"SHORT\",\n    0x1403: \"UNSIGNED_SHORT\",\n    0x1404: \"INT\",\n    0x1405: \"UNSIGNED_INT\",\n    0x1406: \"FLOAT\"\n  };\n\n  const blocks: { [key: number]: number } = {\n    0x8b50: 1,\n    0x8b51: 1,\n    0x8b52: 1,\n    0x8b53: 1,\n    0x8b54: 1,\n    0x8b55: 1,\n    0x8b56: 1,\n    0x8b57: 1,\n    0x8b58: 1,\n    0x8b59: 1,\n    0x8b5a: 1,\n    0x8b5b: 3,\n    0x8b5c: 4,\n    0x8b5e: 1,\n    0x8b60: 1,\n    0x1400: 1,\n    0x1401: 1,\n    0x1402: 1,\n    0x1403: 1,\n    0x1404: 1,\n    0x1405: 1,\n    0x1406: 1\n  };\n\n  // Loop through active uniforms\n  for (let i = 0; i < activeUniforms; ++i) {\n    const uniform: any = gl.getActiveUniform(program, i);\n    uniform.typeName = enums[uniform.type];\n    result.uniforms.push(uniform);\n    result.uniformCount += uniform.size;\n    uniform.size = uniform.size * blocks[uniform.type];\n  }\n\n  // Loop through active attributes\n  for (let i = 0; i < activeAttributes; i++) {\n    const attribute: any = gl.getActiveAttrib(program, i);\n    attribute.typeName = enums[attribute.type];\n    result.attributes.push(attribute);\n    result.attributeCount += attribute.size;\n  }\n\n  return result;\n}\n\nexport class WebGLStat {\n  static MAX_VERTEX_UNIFORMS = 0;\n  static MAX_FRAGMENT_UNIFORMS = 0;\n  static MAX_VERTEX_ATTRIBUTES = 0;\n  static WEBGL_SUPPORTED: boolean = false;\n  static MAX_TEXTURE_SIZE = 0;\n  static HARDWARE_INSTANCING = false;\n  static HARDWARE_INSTANCING_ANGLE = false;\n}\n\nfunction initStats() {\n  // Let's perform some immediate operations to do some gl querying for useful information\n  function getAContext() {\n    try {\n      const canvas = document.createElement(\"canvas\");\n      return (\n        (window as any).WebGLRenderingContext &&\n        (canvas.getContext(\"webgl\") || canvas.getContext(\"experimental-webgl\"))\n      );\n    } catch (e) {\n      return false;\n    }\n  }\n\n  // Attempt to retrieve a context for webgl\n  const gl = getAContext();\n\n  // If the context exists, then we know gl is supported and we can fill in some metrics\n  if (gl) {\n    WebGLStat.WEBGL_SUPPORTED = true;\n    WebGLStat.MAX_VERTEX_UNIFORMS = gl.getParameter(\n      gl.MAX_VERTEX_UNIFORM_VECTORS\n    );\n    WebGLStat.MAX_FRAGMENT_UNIFORMS = gl.getParameter(\n      gl.MAX_FRAGMENT_UNIFORM_VECTORS\n    );\n    WebGLStat.MAX_VERTEX_ATTRIBUTES = gl.getParameter(gl.MAX_VERTEX_ATTRIBS);\n    WebGLStat.MAX_TEXTURE_SIZE = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n    WebGLStat.HARDWARE_INSTANCING_ANGLE = Boolean(\n      gl.getExtension(\"ANGLE_instanced_arrays\")\n    );\n    WebGLStat.HARDWARE_INSTANCING = WebGLStat.HARDWARE_INSTANCING_ANGLE;\n  }\n}\n\ninitStats();\n","import { Mat3x3, Mat4x4, Vec2, Vec3, Vec4 } from \"../util\";\nimport { Texture } from \"./texture\";\n\nexport enum MaterialUniformType {\n  /** A single float */\n  FLOAT,\n  /** A single vec2 */\n  VEC2,\n  /** A single vec3 */\n  VEC3,\n  /** A single vec4 */\n  VEC4,\n  /** An array of vec4s (uniform vec4 name[count] in the shader) */\n  VEC4_ARRAY,\n  /** An array of floats */\n  FLOAT_ARRAY,\n  /** A single 3x3 matrix of floats */\n  MATRIX3x3,\n  /** A single 4x4 matrix of floats */\n  MATRIX4x4,\n  /** The uniform refers to a texture that should be bound to an active texture unit */\n  TEXTURE\n}\n\n// Uniform type guards\n\nexport function isUniformVec2(\n  val: IMaterialUniform<MaterialUniformType>\n): val is IMaterialUniform<MaterialUniformType.VEC2> {\n  return val.type === MaterialUniformType.VEC2;\n}\n\nexport function isUniformVec3(\n  val: IMaterialUniform<MaterialUniformType>\n): val is IMaterialUniform<MaterialUniformType.VEC3> {\n  return val.type === MaterialUniformType.VEC3;\n}\n\nexport function isUniformVec4(\n  val: IMaterialUniform<MaterialUniformType>\n): val is IMaterialUniform<MaterialUniformType.VEC4> {\n  return val.type === MaterialUniformType.VEC4;\n}\n\nexport function isUniformVec4Array(\n  val: IMaterialUniform<MaterialUniformType>\n): val is IMaterialUniform<MaterialUniformType.VEC4_ARRAY> {\n  return val.type === MaterialUniformType.VEC4_ARRAY;\n}\n\nexport function isUniformMat3(\n  val: IMaterialUniform<MaterialUniformType>\n): val is IMaterialUniform<MaterialUniformType.MATRIX3x3> {\n  return val.type === MaterialUniformType.MATRIX3x3;\n}\n\nexport function isUniformMat4(\n  val: IMaterialUniform<MaterialUniformType>\n): val is IMaterialUniform<MaterialUniformType.MATRIX4x4> {\n  return val.type === MaterialUniformType.MATRIX4x4;\n}\n\nexport function isUniformTexture(\n  val: IMaterialUniform<MaterialUniformType>\n): val is IMaterialUniform<MaterialUniformType.TEXTURE> {\n  return val.type === MaterialUniformType.TEXTURE;\n}\n\nexport function isUniformFloat(\n  val: IMaterialUniform<MaterialUniformType>\n): val is IMaterialUniform<MaterialUniformType.FLOAT> {\n  return val.type === MaterialUniformType.FLOAT;\n}\n\n/**\n * Special enum analyzing material uniforms\n */\nexport type MaterialUniformValue<T> = T extends MaterialUniformType.FLOAT\n  ? number\n  : T extends MaterialUniformType.VEC2\n    ? Vec2\n    : T extends MaterialUniformType.VEC3\n      ? Vec3\n      : T extends MaterialUniformType.VEC4\n        ? Vec4\n        : T extends MaterialUniformType.VEC4_ARRAY\n          ? Vec4[]\n          : T extends MaterialUniformType.MATRIX3x3\n            ? Mat3x3\n            : T extends MaterialUniformType.MATRIX4x4\n              ? Mat4x4\n              : T extends MaterialUniformType.TEXTURE\n                ? Texture\n                : T extends MaterialUniformType.FLOAT_ARRAY\n                  ? (number[] | Float32Array)\n                  : number;\n\n/**\n * Defines a uniform applied to a material\n */\nexport interface IMaterialUniform<T extends MaterialUniformType> {\n  /** Indictaes which uniform to utilize */\n  type: T;\n  /** Indicates the value to upload  */\n  value: MaterialUniformValue<T>;\n\n  /**\n   * State stored in the uniform defining gl specific state.\n   * Modifying this outside of the framework is bound to break something.\n   */\n  gl?: Map<\n    WebGLProgram,\n    {\n      location: WebGLUniformLocation;\n    }\n  >;\n}\n\nexport type GLContext = WebGLRenderingContext | WebGL2RenderingContext;\n\n/**\n * This defines the extensions the framework works with\n */\nexport interface IExtensions {\n  /** Extension for anisotropic filtering */\n  anisotropicFiltering?: {\n    ext: EXT_texture_filter_anisotropic;\n    stat: {\n      maxAnistropicFilter: number;\n    };\n  };\n  /** Extension for MRT (Multiple render targets) */\n  drawBuffers?: WebGL2RenderingContext | WEBGL_draw_buffers;\n  /** Extension for hardware instancing */\n  instancing?: WebGL2RenderingContext | ANGLE_instanced_arrays;\n}\n","/** Important to start UIDs at 1 so that falsey evaluations do not pass when examining UIDs */\nlet UID = 1;\n\n/**\n * Provides a 64 bit UID.\n *\n * Note: all uids generated with uid() are unique amongst uid() calls and NOT unique amongst\n * other types of uid calls.\n */\nexport function uid() {\n  return ++UID;\n}\n\nlet CUID = 0;\n\n/**\n * Provides a 24 bit UID (keeps the UID within non-alpha color ranges)\n *\n * Note: all uids generated with colorUID() are unique amongst colorUID() calls and NOT unique amongst\n * other types of uid calls.\n */\nexport function colorUID() {\n  return ++CUID % 0xffffff;\n}\n","import { Instance } from \"../../instance-provider/instance\";\nimport {\n  BaseShaderIOInjection,\n  ShaderIOHeaderInjectionResult\n} from \"../../shaders/processing/base-shader-io-injection\";\nimport { MetricsProcessing } from \"../../shaders/processing/metrics-processing\";\nimport {\n  IInstanceAttribute,\n  IUniform,\n  IVertexAttribute,\n  ShaderInjectionTarget\n} from \"../../types\";\nimport { ILayerProps, Layer } from \"../layer\";\n\nexport type ShaderIOExpansion<T extends Instance> = {\n  /** The additional instance attributes to add to the layer's Shader IO */\n  instanceAttributes: IInstanceAttribute<T>[];\n  /** The additional uniforms to add to the layer's Shader IO */\n  uniforms: IUniform[];\n  /** The additional vertex attributes to add to the layer's Shader IO */\n  vertexAttributes: IVertexAttribute[];\n};\n\n/**\n * When processing attributes, uniforms, etc, it is a common event that special ShaderIO types\n * can be declared that requires additional ShaderIO configuration to be added.\n *\n * This type of object can be added to the layer surface to provide a means to process special\n * attributes the current system or customized system will want to handle.\n */\nexport abstract class BaseIOExpansion extends BaseShaderIOInjection {\n  /**\n   * This is called with the Layer's currently declared Shader IO configuration.\n   * The returned IO configuration will be added to the existing IO.\n   * Each BaseIOExpansion object will receive the expanded IO configuration of other\n   * expansion objects if the object is processed after another expansion object.\n   *\n   * NOTE: The inputs should NOT be modified in any way\n   */\n  expand<T extends Instance, U extends ILayerProps<T>>(\n    _layer: Layer<T, U>,\n    _instanceAttributes: IInstanceAttribute<T>[],\n    _vertexAttributes: IVertexAttribute[],\n    _uniforms: IUniform[]\n  ): ShaderIOExpansion<T> {\n    return {\n      instanceAttributes: [],\n      uniforms: [],\n      vertexAttributes: []\n    };\n  }\n\n  /**\n   * Every expansion object will be given the opportunity to validate the IO presented to it\n   * here, thus allowing unique IO configuration types to be confirmed before getting  completely processed.\n   *\n   * It will be expected that a unique Expansion object will have special requirements centered around the\n   * configuration object, thus it is expected this be implemented in a meaningful way to make devlopment\n   * clearer by making mistakes clearer to the developer.\n   *\n   * Messages should be logged within this method as warnings or errors when validations fail and\n   * then this method should return false indicating the validation failed.\n   *\n   * NOTE: The inputs should NOT be modified in any way\n   */\n  validate<T extends Instance, U extends ILayerProps<T>>(\n    _layer: Layer<T, U>,\n    _instanceAttributes: IInstanceAttribute<T>[],\n    _vertexAttributes: IVertexAttribute[],\n    _uniforms: IUniform[]\n  ): boolean {\n    return true;\n  }\n\n  /**\n   * This allows for injection into the header of the shader.\n   *\n   * The order these controllers are injected\n   * into the system determines the order the contents are written to the header. So dependent injections\n   * must be sorted appropriately.\n   *\n   * @param target The targetted shader object to receive the header. This will be VERTEX or FRAGMENT but never ALL\n   * @param layer The layer that is currently being processed\n   * @param metrics Some metrics processed that are useful for making decisions about buffering strategies etc.\n   */\n  processHeaderInjection(\n    _target: ShaderInjectionTarget,\n    _declarations: Map<string, string>,\n    _layer: Layer<Instance, ILayerProps<Instance>>,\n    _metrics: MetricsProcessing,\n    _vertexAttributes: IVertexAttribute[],\n    _instanceAttributes: IInstanceAttribute<Instance>[],\n    _uniforms: IUniform[]\n  ): ShaderIOHeaderInjectionResult {\n    return {\n      injection: \"\"\n    };\n  }\n\n  /**\n   * This allows for injection into the shader AFTER attribute destructuring has taken place.\n   *\n   * The order these controllers are injected\n   * into the system determines the order the contents are written to the header. So dependent injections\n   * must be sorted appropriately.\n   *\n   * @param layer The layer that is currently being processed\n   * @param metrics Some metrics processed that are useful for making decisions about buffering strategies etc.\n   */\n  processAttributeDestructuring(\n    _layer: Layer<Instance, ILayerProps<Instance>>,\n    _declarations: Map<string, string>,\n    _metrics: MetricsProcessing,\n    _vertexAttributes: IVertexAttribute[],\n    _instanceAttributes: IInstanceAttribute<Instance>[],\n    _uniforms: IUniform[]\n  ): string {\n    return \"\";\n  }\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _ForeignObjectRenderer = require('./renderer/ForeignObjectRenderer');\n\nvar testRangeBounds = function testRangeBounds(document) {\n    var TEST_HEIGHT = 123;\n\n    if (document.createRange) {\n        var range = document.createRange();\n        if (range.getBoundingClientRect) {\n            var testElement = document.createElement('boundtest');\n            testElement.style.height = TEST_HEIGHT + 'px';\n            testElement.style.display = 'block';\n            document.body.appendChild(testElement);\n\n            range.selectNode(testElement);\n            var rangeBounds = range.getBoundingClientRect();\n            var rangeHeight = Math.round(rangeBounds.height);\n            document.body.removeChild(testElement);\n            if (rangeHeight === TEST_HEIGHT) {\n                return true;\n            }\n        }\n    }\n\n    return false;\n};\n\n// iOS 10.3 taints canvas with base64 images unless crossOrigin = 'anonymous'\nvar testBase64 = function testBase64(document, src) {\n    var img = new Image();\n    var canvas = document.createElement('canvas');\n    var ctx = canvas.getContext('2d');\n\n    return new Promise(function (resolve) {\n        // Single pixel base64 image renders fine on iOS 10.3???\n        img.src = src;\n\n        var onload = function onload() {\n            try {\n                ctx.drawImage(img, 0, 0);\n                canvas.toDataURL();\n            } catch (e) {\n                return resolve(false);\n            }\n\n            return resolve(true);\n        };\n\n        img.onload = onload;\n        img.onerror = function () {\n            return resolve(false);\n        };\n\n        if (img.complete === true) {\n            setTimeout(function () {\n                onload();\n            }, 500);\n        }\n    });\n};\n\nvar testCORS = function testCORS() {\n    return typeof new Image().crossOrigin !== 'undefined';\n};\n\nvar testResponseType = function testResponseType() {\n    return typeof new XMLHttpRequest().responseType === 'string';\n};\n\nvar testSVG = function testSVG(document) {\n    var img = new Image();\n    var canvas = document.createElement('canvas');\n    var ctx = canvas.getContext('2d');\n    img.src = 'data:image/svg+xml,<svg xmlns=\\'http://www.w3.org/2000/svg\\'></svg>';\n\n    try {\n        ctx.drawImage(img, 0, 0);\n        canvas.toDataURL();\n    } catch (e) {\n        return false;\n    }\n    return true;\n};\n\nvar isGreenPixel = function isGreenPixel(data) {\n    return data[0] === 0 && data[1] === 255 && data[2] === 0 && data[3] === 255;\n};\n\nvar testForeignObject = function testForeignObject(document) {\n    var canvas = document.createElement('canvas');\n    var size = 100;\n    canvas.width = size;\n    canvas.height = size;\n    var ctx = canvas.getContext('2d');\n    ctx.fillStyle = 'rgb(0, 255, 0)';\n    ctx.fillRect(0, 0, size, size);\n\n    var img = new Image();\n    var greenImageSrc = canvas.toDataURL();\n    img.src = greenImageSrc;\n    var svg = (0, _ForeignObjectRenderer.createForeignObjectSVG)(size, size, 0, 0, img);\n    ctx.fillStyle = 'red';\n    ctx.fillRect(0, 0, size, size);\n\n    return (0, _ForeignObjectRenderer.loadSerializedSVG)(svg).then(function (img) {\n        ctx.drawImage(img, 0, 0);\n        var data = ctx.getImageData(0, 0, size, size).data;\n        ctx.fillStyle = 'red';\n        ctx.fillRect(0, 0, size, size);\n\n        var node = document.createElement('div');\n        node.style.backgroundImage = 'url(' + greenImageSrc + ')';\n        node.style.height = size + 'px';\n        // Firefox 55 does not render inline <img /> tags\n        return isGreenPixel(data) ? (0, _ForeignObjectRenderer.loadSerializedSVG)((0, _ForeignObjectRenderer.createForeignObjectSVG)(size, size, 0, 0, node)) : Promise.reject(false);\n    }).then(function (img) {\n        ctx.drawImage(img, 0, 0);\n        // Edge does not render background-images\n        return isGreenPixel(ctx.getImageData(0, 0, size, size).data);\n    }).catch(function (e) {\n        return false;\n    });\n};\n\nvar FEATURES = {\n    // $FlowFixMe - get/set properties not yet supported\n    get SUPPORT_RANGE_BOUNDS() {\n        'use strict';\n\n        var value = testRangeBounds(document);\n        Object.defineProperty(FEATURES, 'SUPPORT_RANGE_BOUNDS', { value: value });\n        return value;\n    },\n    // $FlowFixMe - get/set properties not yet supported\n    get SUPPORT_SVG_DRAWING() {\n        'use strict';\n\n        var value = testSVG(document);\n        Object.defineProperty(FEATURES, 'SUPPORT_SVG_DRAWING', { value: value });\n        return value;\n    },\n    // $FlowFixMe - get/set properties not yet supported\n    get SUPPORT_BASE64_DRAWING() {\n        'use strict';\n\n        return function (src) {\n            var _value = testBase64(document, src);\n            Object.defineProperty(FEATURES, 'SUPPORT_BASE64_DRAWING', { value: function value() {\n                    return _value;\n                } });\n            return _value;\n        };\n    },\n    // $FlowFixMe - get/set properties not yet supported\n    get SUPPORT_FOREIGNOBJECT_DRAWING() {\n        'use strict';\n\n        var value = typeof Array.from === 'function' && typeof window.fetch === 'function' ? testForeignObject(document) : Promise.resolve(false);\n        Object.defineProperty(FEATURES, 'SUPPORT_FOREIGNOBJECT_DRAWING', { value: value });\n        return value;\n    },\n    // $FlowFixMe - get/set properties not yet supported\n    get SUPPORT_CORS_IMAGES() {\n        'use strict';\n\n        var value = testCORS();\n        Object.defineProperty(FEATURES, 'SUPPORT_CORS_IMAGES', { value: value });\n        return value;\n    },\n    // $FlowFixMe - get/set properties not yet supported\n    get SUPPORT_RESPONSE_TYPE() {\n        'use strict';\n\n        var value = testResponseType();\n        Object.defineProperty(FEATURES, 'SUPPORT_RESPONSE_TYPE', { value: value });\n        return value;\n    },\n    // $FlowFixMe - get/set properties not yet supported\n    get SUPPORT_CORS_XHR() {\n        'use strict';\n\n        var value = 'withCredentials' in new XMLHttpRequest();\n        Object.defineProperty(FEATURES, 'SUPPORT_CORS_XHR', { value: value });\n        return value;\n    }\n};\n\nexports.default = FEATURES;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _textTransform = require('./parsing/textTransform');\n\nvar _TextBounds = require('./TextBounds');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TextContainer = function () {\n    function TextContainer(text, parent, bounds) {\n        _classCallCheck(this, TextContainer);\n\n        this.text = text;\n        this.parent = parent;\n        this.bounds = bounds;\n    }\n\n    _createClass(TextContainer, null, [{\n        key: 'fromTextNode',\n        value: function fromTextNode(node, parent) {\n            var text = transform(node.data, parent.style.textTransform);\n            return new TextContainer(text, parent, (0, _TextBounds.parseTextBounds)(text, parent, node));\n        }\n    }]);\n\n    return TextContainer;\n}();\n\nexports.default = TextContainer;\n\n\nvar CAPITALIZE = /(^|\\s|:|-|\\(|\\))([a-z])/g;\n\nvar transform = function transform(text, _transform) {\n    switch (_transform) {\n        case _textTransform.TEXT_TRANSFORM.LOWERCASE:\n            return text.toLowerCase();\n        case _textTransform.TEXT_TRANSFORM.CAPITALIZE:\n            return text.replace(CAPITALIZE, capitalize);\n        case _textTransform.TEXT_TRANSFORM.UPPERCASE:\n            return text.toUpperCase();\n        default:\n            return text;\n    }\n};\n\nfunction capitalize(m, p1, p2) {\n    if (m.length > 0) {\n        return p1 + p2.toUpperCase();\n    }\n\n    return m;\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.parseListStyle = exports.parseListStyleType = exports.LIST_STYLE_TYPE = exports.LIST_STYLE_POSITION = undefined;\n\nvar _background = require('./background');\n\nvar LIST_STYLE_POSITION = exports.LIST_STYLE_POSITION = {\n    INSIDE: 0,\n    OUTSIDE: 1\n};\n\nvar LIST_STYLE_TYPE = exports.LIST_STYLE_TYPE = {\n    NONE: -1,\n    DISC: 0,\n    CIRCLE: 1,\n    SQUARE: 2,\n    DECIMAL: 3,\n    CJK_DECIMAL: 4,\n    DECIMAL_LEADING_ZERO: 5,\n    LOWER_ROMAN: 6,\n    UPPER_ROMAN: 7,\n    LOWER_GREEK: 8,\n    LOWER_ALPHA: 9,\n    UPPER_ALPHA: 10,\n    ARABIC_INDIC: 11,\n    ARMENIAN: 12,\n    BENGALI: 13,\n    CAMBODIAN: 14,\n    CJK_EARTHLY_BRANCH: 15,\n    CJK_HEAVENLY_STEM: 16,\n    CJK_IDEOGRAPHIC: 17,\n    DEVANAGARI: 18,\n    ETHIOPIC_NUMERIC: 19,\n    GEORGIAN: 20,\n    GUJARATI: 21,\n    GURMUKHI: 22,\n    HEBREW: 22,\n    HIRAGANA: 23,\n    HIRAGANA_IROHA: 24,\n    JAPANESE_FORMAL: 25,\n    JAPANESE_INFORMAL: 26,\n    KANNADA: 27,\n    KATAKANA: 28,\n    KATAKANA_IROHA: 29,\n    KHMER: 30,\n    KOREAN_HANGUL_FORMAL: 31,\n    KOREAN_HANJA_FORMAL: 32,\n    KOREAN_HANJA_INFORMAL: 33,\n    LAO: 34,\n    LOWER_ARMENIAN: 35,\n    MALAYALAM: 36,\n    MONGOLIAN: 37,\n    MYANMAR: 38,\n    ORIYA: 39,\n    PERSIAN: 40,\n    SIMP_CHINESE_FORMAL: 41,\n    SIMP_CHINESE_INFORMAL: 42,\n    TAMIL: 43,\n    TELUGU: 44,\n    THAI: 45,\n    TIBETAN: 46,\n    TRAD_CHINESE_FORMAL: 47,\n    TRAD_CHINESE_INFORMAL: 48,\n    UPPER_ARMENIAN: 49,\n    DISCLOSURE_OPEN: 50,\n    DISCLOSURE_CLOSED: 51\n};\n\nvar parseListStyleType = exports.parseListStyleType = function parseListStyleType(type) {\n    switch (type) {\n        case 'disc':\n            return LIST_STYLE_TYPE.DISC;\n        case 'circle':\n            return LIST_STYLE_TYPE.CIRCLE;\n        case 'square':\n            return LIST_STYLE_TYPE.SQUARE;\n        case 'decimal':\n            return LIST_STYLE_TYPE.DECIMAL;\n        case 'cjk-decimal':\n            return LIST_STYLE_TYPE.CJK_DECIMAL;\n        case 'decimal-leading-zero':\n            return LIST_STYLE_TYPE.DECIMAL_LEADING_ZERO;\n        case 'lower-roman':\n            return LIST_STYLE_TYPE.LOWER_ROMAN;\n        case 'upper-roman':\n            return LIST_STYLE_TYPE.UPPER_ROMAN;\n        case 'lower-greek':\n            return LIST_STYLE_TYPE.LOWER_GREEK;\n        case 'lower-alpha':\n            return LIST_STYLE_TYPE.LOWER_ALPHA;\n        case 'upper-alpha':\n            return LIST_STYLE_TYPE.UPPER_ALPHA;\n        case 'arabic-indic':\n            return LIST_STYLE_TYPE.ARABIC_INDIC;\n        case 'armenian':\n            return LIST_STYLE_TYPE.ARMENIAN;\n        case 'bengali':\n            return LIST_STYLE_TYPE.BENGALI;\n        case 'cambodian':\n            return LIST_STYLE_TYPE.CAMBODIAN;\n        case 'cjk-earthly-branch':\n            return LIST_STYLE_TYPE.CJK_EARTHLY_BRANCH;\n        case 'cjk-heavenly-stem':\n            return LIST_STYLE_TYPE.CJK_HEAVENLY_STEM;\n        case 'cjk-ideographic':\n            return LIST_STYLE_TYPE.CJK_IDEOGRAPHIC;\n        case 'devanagari':\n            return LIST_STYLE_TYPE.DEVANAGARI;\n        case 'ethiopic-numeric':\n            return LIST_STYLE_TYPE.ETHIOPIC_NUMERIC;\n        case 'georgian':\n            return LIST_STYLE_TYPE.GEORGIAN;\n        case 'gujarati':\n            return LIST_STYLE_TYPE.GUJARATI;\n        case 'gurmukhi':\n            return LIST_STYLE_TYPE.GURMUKHI;\n        case 'hebrew':\n            return LIST_STYLE_TYPE.HEBREW;\n        case 'hiragana':\n            return LIST_STYLE_TYPE.HIRAGANA;\n        case 'hiragana-iroha':\n            return LIST_STYLE_TYPE.HIRAGANA_IROHA;\n        case 'japanese-formal':\n            return LIST_STYLE_TYPE.JAPANESE_FORMAL;\n        case 'japanese-informal':\n            return LIST_STYLE_TYPE.JAPANESE_INFORMAL;\n        case 'kannada':\n            return LIST_STYLE_TYPE.KANNADA;\n        case 'katakana':\n            return LIST_STYLE_TYPE.KATAKANA;\n        case 'katakana-iroha':\n            return LIST_STYLE_TYPE.KATAKANA_IROHA;\n        case 'khmer':\n            return LIST_STYLE_TYPE.KHMER;\n        case 'korean-hangul-formal':\n            return LIST_STYLE_TYPE.KOREAN_HANGUL_FORMAL;\n        case 'korean-hanja-formal':\n            return LIST_STYLE_TYPE.KOREAN_HANJA_FORMAL;\n        case 'korean-hanja-informal':\n            return LIST_STYLE_TYPE.KOREAN_HANJA_INFORMAL;\n        case 'lao':\n            return LIST_STYLE_TYPE.LAO;\n        case 'lower-armenian':\n            return LIST_STYLE_TYPE.LOWER_ARMENIAN;\n        case 'malayalam':\n            return LIST_STYLE_TYPE.MALAYALAM;\n        case 'mongolian':\n            return LIST_STYLE_TYPE.MONGOLIAN;\n        case 'myanmar':\n            return LIST_STYLE_TYPE.MYANMAR;\n        case 'oriya':\n            return LIST_STYLE_TYPE.ORIYA;\n        case 'persian':\n            return LIST_STYLE_TYPE.PERSIAN;\n        case 'simp-chinese-formal':\n            return LIST_STYLE_TYPE.SIMP_CHINESE_FORMAL;\n        case 'simp-chinese-informal':\n            return LIST_STYLE_TYPE.SIMP_CHINESE_INFORMAL;\n        case 'tamil':\n            return LIST_STYLE_TYPE.TAMIL;\n        case 'telugu':\n            return LIST_STYLE_TYPE.TELUGU;\n        case 'thai':\n            return LIST_STYLE_TYPE.THAI;\n        case 'tibetan':\n            return LIST_STYLE_TYPE.TIBETAN;\n        case 'trad-chinese-formal':\n            return LIST_STYLE_TYPE.TRAD_CHINESE_FORMAL;\n        case 'trad-chinese-informal':\n            return LIST_STYLE_TYPE.TRAD_CHINESE_INFORMAL;\n        case 'upper-armenian':\n            return LIST_STYLE_TYPE.UPPER_ARMENIAN;\n        case 'disclosure-open':\n            return LIST_STYLE_TYPE.DISCLOSURE_OPEN;\n        case 'disclosure-closed':\n            return LIST_STYLE_TYPE.DISCLOSURE_CLOSED;\n        case 'none':\n        default:\n            return LIST_STYLE_TYPE.NONE;\n    }\n};\n\nvar parseListStyle = exports.parseListStyle = function parseListStyle(style) {\n    var listStyleImage = (0, _background.parseBackgroundImage)(style.getPropertyValue('list-style-image'));\n    return {\n        listStyleType: parseListStyleType(style.getPropertyValue('list-style-type')),\n        listStyleImage: listStyleImage.length ? listStyleImage[0] : null,\n        listStylePosition: parseListStylePosition(style.getPropertyValue('list-style-position'))\n    };\n};\n\nvar parseListStylePosition = function parseListStylePosition(position) {\n    switch (position) {\n        case 'inside':\n            return LIST_STYLE_POSITION.INSIDE;\n        case 'outside':\n        default:\n            return LIST_STYLE_POSITION.OUTSIDE;\n    }\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Path = require('./Path');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Vector = function Vector(x, y) {\n    _classCallCheck(this, Vector);\n\n    this.type = _Path.PATH.VECTOR;\n    this.x = x;\n    this.y = y;\n    if (process.env.NODE_ENV !== 'production') {\n        if (isNaN(x)) {\n            console.error('Invalid x value given for Vector');\n        }\n        if (isNaN(y)) {\n            console.error('Invalid y value given for Vector');\n        }\n    }\n};\n\nexports.default = Vector;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar PATH = exports.PATH = {\n    VECTOR: 0,\n    BEZIER_CURVE: 1,\n    CIRCLE: 2\n};","import { WebGLRenderer } from \"../gl\";\nimport { Instance } from \"../instance-provider/instance\";\nimport { ILayerProps, Layer } from \"../surface/layer\";\nimport { BaseIOExpansion } from \"../surface/layer-processing/base-io-expansion\";\nimport {\n  InstanceIOValue,\n  IResourceContext,\n  IResourceInstanceAttribute,\n  IResourceType\n} from \"../types\";\n\n/**\n * The Base Options for initializing a resource.\n */\nexport type BaseResourceOptions = IResourceType & { key: string };\n\n/**\n * The base needs for making a resource request.\n */\nexport type BaseResourceRequest = IResourceType;\n\n/**\n * This represents a manager that is capable of handling requests for resources that come from Layers\n * that needs the resaource for updating it's Shader IO.\n */\nexport abstract class BaseResourceManager<\n  T extends IResourceType,\n  S extends BaseResourceRequest\n> {\n  /** Every resource manager will receive the utilized renderer so the manager can perform basic GL tasks if needed */\n  webGLRenderer?: WebGLRenderer;\n\n  /**\n   * This is called to initialize a resource that the system has determined needs to be constructed.\n   */\n  abstract async initResource(resource: BaseResourceOptions): Promise<void>;\n\n  /**\n   * This is called by the system for the manager to dequeue it's requests in an asynchronous\n   * manner, thus allowing the system to have it's resources changed and dequeued without hanging up\n   * the system.\n   */\n  abstract async dequeueRequests(): Promise<boolean>;\n\n  /**\n   * This expects a resource manager to free all of it's resources it is hanging onto.\n   */\n  abstract destroy(): void;\n\n  /**\n   * Allows a resource manager to provide it's own IO Expansion to handle special attributes\n   * the layer may have for handling.\n   */\n  getIOExpansion(): BaseIOExpansion[] {\n    return [];\n  }\n\n  /**\n   * The method to access a resource initialized by this resource manager.\n   */\n  abstract getResource(resourceKey: string): T | null;\n\n  /**\n   * This will trigger a request of a resource to be generated. It will immediately return either a\n   * value refelecting the resource is in a Pending state (such as [0, 0, 0, 0]) or it will return\n   * metrics indicative of expected resource's metrics, but will always be in InstanceIOValue format.\n   */\n  abstract request<U extends Instance, V extends ILayerProps<U>>(\n    layer: Layer<U, V>,\n    instance: Instance,\n    resourceRequest: S,\n    context?: IResourceContext\n  ): InstanceIOValue;\n\n  /**\n   * This applies an attribute as the current context\n   */\n  setAttributeContext(_attribute: IResourceInstanceAttribute<Instance>) {\n    // Implemented by sub classes if needed\n  }\n}\n\n/**\n * This is a resource manager that implements all of the functionality but returns\n * invalid empty results. This allows the system to have requests for a manager but\n * prevent returning null or undefined states.\n */\nexport class InvalidResourceManager extends BaseResourceManager<\n  IResourceType,\n  IResourceType\n> {\n  resources = new Map<string, BaseResourceOptions>();\n\n  async initResource(resource: BaseResourceOptions) {\n    this.resources.set(resource.key, resource);\n  }\n\n  async dequeueRequests() {\n    return false;\n  }\n\n  destroy() {\n    return;\n  }\n\n  getResource(resourceKey: string) {\n    return this.resources.get(resourceKey) || { key: \"\", type: -1 };\n  }\n\n  request<U extends Instance, V extends ILayerProps<U>>(\n    _layer: Layer<U, V>,\n    _instance: Instance,\n    _resource: IResourceType\n  ): InstanceIOValue {\n    return [0, 0, 0, 0];\n  }\n}\n\nexport const INVALID_RESOURCE_MANAGER = new InvalidResourceManager();\n","import { uniformBufferInstanceBufferName } from \"../../../constants\";\nimport { Attribute, Geometry, Material, Model } from \"../../../gl\";\nimport {\n  IMaterialUniform,\n  isUniformVec4Array,\n  MaterialUniformType\n} from \"../../../gl/types\";\nimport { Instance } from \"../../../instance-provider\";\nimport { IInstanceAttribute } from \"../../../types\";\nimport { uid, Vec2, Vec4 } from \"../../../util\";\nimport { Layer } from \"../../layer\";\nimport { generateLayerModel } from \"../../layer-processing/generate-layer-model\";\nimport { LayerScene } from \"../../layer-scene\";\nimport { BufferManagerBase, IBufferLocation } from \"../buffer-manager-base\";\n\nexport interface IUniformBufferLocation extends IBufferLocation {\n  /** This is the index of the instance as it appears in the buffer */\n  instanceIndex: number;\n  /** This is the instance data uniform */\n  buffer: IMaterialUniform<MaterialUniformType.VEC4_ARRAY>;\n  /** This is the instance data range within the instanceData uniform */\n  range: Vec2;\n}\n\n/**\n * Typeguard for uniform buffer locations\n */\nexport function isUniformBufferLocation(\n  val: any\n): val is IUniformBufferLocation {\n  return (\n    val &&\n    val.buffer &&\n    val.buffer.value &&\n    val.type === MaterialUniformType.VEC4_ARRAY\n  );\n}\n\nexport interface InstanceUniformBuffer {\n  /** This tracks which instances are active. Helps optimize draw range */\n  activeInstances: boolean[];\n  /** This is all of the clusters within this buffer */\n  clusters: IUniformBufferLocation[];\n  /** The first instance in the draw range */\n  firstInstance: number;\n  /** The unique geometry object for the buffer: Used to set draw range */\n  geometry: Geometry;\n  /** The last instance in the draw range */\n  lastInstance: number;\n  /** The unique material for the buffer: Used to provide a new set of uniforms */\n  material: Material;\n  /** The unique model generated for the buffer: Used to allow the buffer to be rendered by adding to a scene */\n  model: Model;\n}\n\n/**\n * This is a Buffer Management system that performs instancing via the uniforms available to the hardware.\n * This improves compatibility with instancing for systems DRAMATICALLY as ALL systems WILL support uniforms.\n * This will NOT perform the best against true hardware instancing support, but it will have edge cases where it\n * is needed.\n *\n * When a layer has too many instance + vertex attributes for the hardware, the system will defer to this buffer methodology.\n *\n * This class does a whoooooole lot of making the magical instancing optimization controls possible.\n *\n * Our instancing hackyness comes from the idea that uniforms are fast, and you don't have to commit\n * ALL of them when you touch just a little piece, and you don't have worry about drivers not supporting\n * partial vertex buffer updates.\n *\n * This also is WebGL 1.0 compatible without any extensions that are poorly implemented. And again: does\n * NOT require entire attribute buffer commits.\n *\n * Uniforms are limited for any given draw call. So we have to create multiple materials to support\n * chunks of the instances that need to be drawn. We then have to associate an instance with the set\n * of uniforms that is related to the instance and keep them paired together. If we have too many instances\n * we must generate more buffers to accomodate them.\n *\n * If we remove instances, we must free up the uniform set so that others can use the uniforms. While the uniforms\n * are not in use, the instance should not be rendering.\n */\nexport class UniformBufferManager<T extends Instance> extends BufferManagerBase<\n  T,\n  IUniformBufferLocation\n> {\n  /** The number of uniform blocks an instance requires */\n  private uniformBlocksPerInstance: number;\n  /** The generated buffers by this manager */\n  private buffers: InstanceUniformBuffer[] = [];\n  /** The uniform clusters that are free and can be used by an instance */\n  private availableClusters: IUniformBufferLocation[] = [];\n  /** A lookup of an instance to a cluster of uniforms associated with it */\n  private instanceToCluster: { [key: number]: IUniformBufferLocation } = {};\n  /** A map of a cluster of uniforms to the buffer it comes from */\n  private clusterToBuffer = new Map<\n    IUniformBufferLocation,\n    InstanceUniformBuffer\n  >();\n\n  constructor(layer: Layer<T, any>, scene: LayerScene) {\n    super(layer, scene);\n\n    let maxUniformBlock: number = 0;\n    layer.instanceAttributes.forEach((attributes: IInstanceAttribute<T>) => {\n      maxUniformBlock = Math.max(attributes.block || 0, maxUniformBlock);\n    });\n\n    this.uniformBlocksPerInstance = maxUniformBlock + 1;\n  }\n\n  /**\n   * This adds an instance to the manager and gives the instance an associative\n   * block of uniforms to work with.\n   */\n  add = (instance: T) => {\n    // If there are no available buffers, we must add a buffer\n    if (this.availableClusters.length <= 0) {\n      this.makeNewBuffer();\n    }\n\n    const cluster = this.availableClusters.pop();\n\n    if (cluster) {\n      this.instanceToCluster[instance.uid] = cluster;\n    } else {\n      console.warn(\n        \"No valid cluster available for instance added to uniform manager.\"\n      );\n    }\n\n    return cluster;\n  };\n\n  /**\n   * Free all resources this manager may be holding onto\n   */\n  destroy() {\n    this.buffers.forEach(buffer => {\n      buffer.geometry.dispose();\n      buffer.material.dispose();\n    });\n  }\n\n  /**\n   * This retireves the uniforms associated with an instance, or returns nothing\n   * if the instance has not been associated yet.\n   */\n  getBufferLocations(instance: T) {\n    return this.instanceToCluster[instance.uid];\n  }\n\n  /**\n   * TODO: The uniform buffer does not need to utilize this yet. it will be more necessary\n   * when this manager updates only changed properties.\n   */\n  getActiveAttributePropertyId() {\n    return -1;\n  }\n\n  /**\n   * TODO: This is irrelevant tot his manager for now.\n   * Number of instances this buffer manages.\n   */\n  getInstanceCount() {\n    return -1;\n  }\n\n  /**\n   * TODO: The uniform buffer updates ALL attributes every change for any property so far.\n   * This should be fixed for performance improvements on the compatibility mode.\n   */\n  getUpdateAllPropertyIdList() {\n    return [];\n  }\n\n  /**\n   * Checks to see if the instance is managed by this manager.\n   */\n  managesInstance(instance: T) {\n    return this.instanceToCluster[instance.uid] === undefined;\n  }\n\n  /**\n   * Disassociates an instance with it's group of uniforms and makes the instance\n   * in the buffer no longer drawable.\n   */\n  remove = function(instance: T) {\n    const cluster = this.instanceToCluster[instance.uid];\n\n    // If the instance is associated with a cluster, we can add the cluster back to being available\n    // For another instance.\n    if (cluster) {\n      delete this.instanceToCluster[instance.uid];\n      this.availableClusters.push(cluster);\n    }\n\n    return instance;\n  };\n\n  /**\n   * Clears all elements of this manager from the current scene it was in.\n   */\n  removeFromScene() {\n    const scene = this.scene;\n\n    if (scene.container) {\n      for (let i = 0, end = this.buffers.length; i < end; ++i) {\n        const buffer = this.buffers[i];\n        scene.container.remove(buffer.model);\n      }\n\n      delete this.scene;\n    }\n  }\n\n  /**\n   * Applies the buffers to the provided scene for rendering.\n   */\n  setScene(scene: LayerScene) {\n    if (scene.container) {\n      for (let i = 0, end = this.buffers.length; i < end; ++i) {\n        const buffer = this.buffers[i];\n        scene.container.add(buffer.model);\n      }\n\n      this.scene = scene;\n    } else {\n      console.warn(\"Can not set a scene that has an undefined container.\");\n    }\n  }\n\n  /**\n   * This generates a new buffer of uniforms to associate instances with.\n   */\n  makeNewBuffer() {\n    // We generate a new geometry object for the buffer as the geometry\n    // Needs to have it's own unique draw range per buffer for optimal\n    // Performance\n    const newGeometry = new Geometry();\n    this.layer.vertexAttributes.forEach(attribute => {\n      if (attribute.materialAttribute) {\n        newGeometry.addAttribute(attribute.name, attribute.materialAttribute);\n      }\n    });\n\n    // This is the material that is generated for the layer that utilizes all of the generated and\n    // Injected shader IO and shader fragments\n    const newMaterial = this.layer.material.clone();\n    // Now make a Model for the buffer so it can be rendered withn the scene\n    const newModel = generateLayerModel(\n      newGeometry,\n      newMaterial,\n      this.layer.model.drawMode\n    );\n    // Ensure the draw range covers every instance in the geometry.\n    newModel.vertexDrawRange = [\n      0,\n      this.layer.maxInstancesPerBuffer * this.layer.instanceVertexCount\n    ];\n\n    // Make our new buffer which will manage the geometry and everything necessary\n    const buffer: InstanceUniformBuffer = {\n      activeInstances: [],\n      clusters: [],\n      firstInstance: 0,\n      geometry: newGeometry,\n      lastInstance: 0,\n      material: newMaterial,\n      model: newModel\n    };\n\n    this.buffers.push(buffer);\n\n    // Now that we have created a new buffer, we have all of it's uniforms\n    // To use to render more instances. We must take the instancing uniforms\n    // And divvy them up into clusters for our available buffer.\n    let uniformIndex = 0;\n    const uniformName = uniformBufferInstanceBufferName;\n    const instanceData = newMaterial.uniforms[uniformName];\n\n    // Type guard this uniform to ensure we're dealing with the correct type\n    if (isUniformVec4Array(instanceData)) {\n      // We must ensure the vector objects are TOTALLY unique otherwise they'll get shared across buffers\n      instanceData.value = instanceData.value.map<Vec4>(() => [\n        0.0,\n        0.0,\n        0.0,\n        0.0\n      ]);\n    } else {\n      console.warn(\n        \"Material is utilizing an invalid uniform type for Uniform Buffer Management. Buffering will not be possible.\"\n      );\n      return;\n    }\n\n    // A fake attribute to satisfy type requirements\n    const fakeAttribute = Object.assign({}, this.layer.instanceAttributes[0], {\n      bufferAttribute: new Attribute(new Float32Array(1), 1),\n      uid: uid()\n    });\n\n    for (let i = 0, end = this.layer.maxInstancesPerBuffer; i < end; ++i) {\n      const cluster: IUniformBufferLocation = {\n        attribute: fakeAttribute, // TODO: This is not needed for the uniform method yet. When we break down\n        // the uniform updates into attributes, this will be utilized.\n        buffer: instanceData,\n        instanceIndex: i,\n        range: [uniformIndex, 0]\n      };\n\n      uniformIndex += this.uniformBlocksPerInstance;\n      cluster.range[1] = uniformIndex;\n\n      buffer.clusters.push(cluster);\n      this.availableClusters.push(cluster);\n      this.clusterToBuffer.set(cluster, buffer);\n    }\n\n    // Grab the global uniforms from the material and add it to the uniform's materialUniform list so that\n    // We can keep uniforms consistent across all Instances\n    for (let i = 0, end = this.layer.uniforms.length; i < end; ++i) {\n      const uniform = this.layer.uniforms[i];\n      uniform.materialUniforms.push(newMaterial.uniforms[uniform.name]);\n    }\n\n    // Now that we are ready to utilize the buffer, let's add it to the scene so it may be rendered.\n    // Each new buffer equates to one draw call.\n    if (this.scene && this.scene.container) {\n      this.scene.container.add(buffer.model);\n    }\n  }\n}\n","export interface IShaderTemplateResults {\n  /** This is the resulting shader string generated from the templating */\n  shader: string;\n  /** This is the template options provided by the shader. {option: num occurrences} */\n  shaderProvidedOptions: Map<string, number>;\n  /**\n   * This is the template options provided by the shader that were not resolved by the options parameter\n   * {option: num occurrences}\n   */\n  unresolvedShaderOptions: Map<string, number>;\n  /** This is the options provided to the template that did not get resolved by the shader {option: 1} */\n  unresolvedProvidedOptions: Map<string, number>;\n  /** This is the list of options that DID get resolved by the options provided {option: num occurrences} */\n  resolvedShaderOptions: Map<string, number>;\n}\n\nexport interface IShaderTemplateRequirements {\n  /** A string identifier to make it easier to identify which shader template failed requirements */\n  name: string;\n  /** The options that must be present within both provided options AND within the template */\n  values: string[];\n}\n\nexport interface IShaderTemplateOptions {\n  /** Callback for 'required' errors being emitted */\n  onError?(msg: string): void;\n  /** Callback that allows overrides for token replacement. Provides the token found and the suggested replacement for it */\n  onToken?(token: string, replace: string): string;\n  /** This is a key value pair the template uses to match tokens found to replacement values */\n  options: { [key: string]: string };\n  /** This is used to indicate which tokens are required both within the shader AND within the 'options' */\n  required?: IShaderTemplateRequirements;\n  /** THis is the shader written with templating information */\n  shader: string;\n}\n\n/**\n * This is a method that aids in making shaders a bit more dynamic with simple string replacement based on tokens written\n * into the shader. Tokens in the shader will appear as ${token} and will either be ignored by this method and thus removed\n * or will be replaced with a provided value.\n *\n * This method will give feedback on the replacements taking place and simplify the process of detecting errors within the process.\n */\nexport function shaderTemplate(\n  templateOptions: IShaderTemplateOptions\n): IShaderTemplateResults {\n  const { shader, options, required, onError, onToken } = templateOptions;\n  const matched = new Map<string, number>();\n  const noValueProvided = new Map<string, number>();\n  const notFound = new Map<string, number>();\n  const shaderOptions = new Map<string, number>();\n\n  const shaderResults = shader.replace(\n    /\\$\\{([^\\}]*)\\}/g,\n    (_x: string, match: string) => {\n      let replace = \"\";\n      shaderOptions.set(match, (shaderOptions.get(match) || 0) + 1);\n\n      if (match in options) {\n        matched.set(match, (matched.get(match) || 0) + 1);\n        replace = options[match];\n      } else {\n        noValueProvided.set(match, (noValueProvided.get(match) || 0) + 1);\n      }\n\n      if (onToken) {\n        replace = onToken(match, replace);\n      }\n\n      return replace;\n    }\n  );\n\n  Object.keys(options).forEach(option => {\n    if (!matched.get(option)) {\n      notFound.set(option, (notFound.get(option) || 0) + 1);\n    }\n  });\n\n  // Provide metrics\n  const results = {\n    resolvedShaderOptions: matched,\n    shader: shaderResults,\n    shaderProvidedOptions: shaderOptions,\n    unresolvedProvidedOptions: notFound,\n    unresolvedShaderOptions: noValueProvided\n  };\n\n  if (required) {\n    // This will ensure that BOTH the parameter input AND the shader provided the required options.\n    required.values.forEach(require => {\n      if (results.unresolvedProvidedOptions.get(require)) {\n        const msg = `${\n          required.name\n        }: Could not resolve all the required inputs. Input: ${require}`;\n        if (onError) onError(msg);\n        else console.error(msg);\n      } else if (results.unresolvedShaderOptions.get(require)) {\n        const msg = `${\n          required.name\n        }: A required option was not provided in the options parameter. Option: ${require}`;\n        if (onError) onError(msg);\n        else console.error(msg);\n      } else if (!results.resolvedShaderOptions.get(require)) {\n        const msg = `${\n          required.name\n        }: A required option was not provided in the options parameter. Option: ${require}`;\n        if (onError) onError(msg);\n        else console.error(msg);\n      }\n    });\n  }\n\n  return results;\n}\n","import {\n  AbsolutePosition,\n  getAbsolutePositionBounds\n} from \"../primitives/absolute-position\";\nimport { Bounds } from \"../primitives/bounds\";\nimport { Color } from \"../types\";\nimport { Vec2 } from \"../util\";\nimport { Camera, CameraProjectionType } from \"../util/camera\";\nimport { ChartCamera } from \"../util/chart-camera\";\nimport { DataBounds } from \"../util/data-bounds\";\nimport { IdentifyByKey, IdentifyByKeyOptions } from \"../util/identify-by-key\";\nimport { ViewCamera, ViewCameraType } from \"../util/view-camera\";\n\nexport enum ClearFlags {\n  COLOR = 0b0001,\n  DEPTH = 0b0010,\n  STENCIL = 0b0100\n}\n\n/**\n * Defines the input metrics of a view for a scene.\n */\nexport interface IViewOptions extends IdentifyByKeyOptions {\n  /**\n   * The background color that gets cleared out for this view. Performance is\n   * better if this is left clear. Probably better to draw a colored quad instead.\n   * This is just convenient.\n   */\n  background?: Color;\n  /**\n   * This is the spatial charting camera that is concerned with offsets and scales.\n   * It is often easier to work with camera positioning and settings rather than working\n   * with the complex and nuanced viewCamera which works with special transformation matrices\n   * to express orientation.\n   *\n   * If not provided, then this camera will use a default ChartCamera for this camera slot. This\n   * will also cause a normal camera handler to be utilized.\n   */\n  camera?: ChartCamera;\n  /**\n   * This sets what buffers get cleared by webgl before the view is drawn in it's space.\n   */\n  clearFlags?: ClearFlags[];\n  /**\n   * If this is provided, the layer can be rendered with a traditional camera that utilizes\n   * matrix transforms to provide orientation/projection for the view.\n   *\n   * If this is NOT provided, the camera will be a special orthographic camera for 2d spaces\n   * with a y-axis of +y points down with (0, 0) at the top left of the viewport.\n   */\n  viewCamera?: ViewCamera;\n  /**\n   * This specifies the bounds on the canvas this camera will render to. This let's you render\n   * say a little square in the bottom right showing a minimap.\n   *\n   * If this is not specified, the entire canvas will be the viewport.\n   */\n  viewport: AbsolutePosition;\n}\n\n/**\n * Type guard to ensure the camera type is orthographic\n */\nfunction isOrthographic(val: Camera): val is Camera {\n  return val.projectionType === CameraProjectionType.ORTHOGRAPHIC;\n}\n\n/**\n * This defines a view of a scene\n */\nexport class View extends IdentifyByKey {\n  static DEFAULT_VIEW_ID = \"__default__\";\n\n  /** End time of animation */\n  animationEndTime: number = 0;\n  /** If present, is the cleared color before this view renders */\n  background: Color;\n  /** Camera that defines the individual components of each axis with simpler concepts */\n  camera: ChartCamera;\n  /** These are the clear flags set for this view */\n  clearFlags: ClearFlags[];\n  /**\n   * This is the depth of the view. The higher the depth represents which layer is on top.\n   * Zero always represents the default view.\n   */\n  depth: number = 0;\n  /** Last frame time this view was rendered under */\n  lastFrameTime: number = 0;\n  /** This is the flag to see if a view needs draw */\n  needsDraw: boolean = false;\n  /**\n   * This is a flag for various processes to indicate the view is demanding optimal rendering performance over other processes.\n   * This is merely a hinting device and does not guarantee better performance at any given moment.\n   */\n  optimizeRendering: boolean = false;\n  /** This is set to ensure the projections that happen properly translates the pixel ratio to normal Web coordinates */\n  pixelRatio: number = window.devicePixelRatio;\n  /** This is the rendering bounds within screen space */\n  screenBounds: Bounds;\n  /** Camera that defines the view projection matrix */\n  viewCamera: ViewCamera;\n  /** The size positioning of the view */\n  viewport: AbsolutePosition;\n  /** The bounds of the render space on the canvas this view will render on */\n  viewBounds: DataBounds<View>;\n\n  constructor(options: IViewOptions) {\n    super(options);\n    const toAssign = Object.assign({}, options);\n    delete toAssign.key;\n    Object.assign(this, toAssign);\n  }\n\n  screenToPixelSpace(point: Vec2, out?: Vec2) {\n    const p = out || [0, 0];\n\n    p[0] = point[0] * this.pixelRatio;\n    p[1] = point[1] * this.pixelRatio;\n\n    return p;\n  }\n\n  pixelSpaceToScreen(point: Vec2, out?: Vec2) {\n    const p = out || [0, 0];\n\n    p[0] = point[0] / this.pixelRatio;\n    p[1] = point[1] / this.pixelRatio;\n\n    return p;\n  }\n\n  screenToView(point: Vec2, out?: Vec2) {\n    const p = this.screenToPixelSpace(point, out);\n\n    p[0] = p[0] - this.viewBounds.x;\n    p[1] = p[1] - this.viewBounds.y;\n\n    return p;\n  }\n\n  viewToScreen(point: Vec2, out?: Vec2) {\n    const p: Vec2 = [0, 0];\n\n    p[0] = point[0] + this.viewBounds.x;\n    p[1] = point[1] + this.viewBounds.y;\n\n    return this.pixelSpaceToScreen(p, out);\n  }\n\n  screenToWorld(point: Vec2, out?: Vec2) {\n    const view = this.pixelSpaceToScreen(this.screenToView(point));\n\n    const world = out || [0, 0];\n    world[0] =\n      (view[0] - this.camera.offset[0] * this.camera.scale[0]) /\n      this.camera.scale[0];\n    world[1] =\n      (view[1] - this.camera.offset[1] * this.camera.scale[1]) /\n      this.camera.scale[1];\n\n    // If this is a custom camera, we must actually project our world point to the screen\n    if (this.viewCamera.type === ViewCameraType.CUSTOM) {\n      console.warn(\"Custom View Camera projections not supported yet\");\n    }\n\n    return world;\n  }\n\n  worldToScreen(point: Vec2, out?: Vec2) {\n    const screen: Vec2 = [0, 0];\n\n    // Calculate from the camera to view space\n    screen[0] =\n      (point[0] * this.camera.scale[0] +\n        this.camera.offset[0] * this.camera.scale[0]) *\n      this.pixelRatio;\n    screen[1] =\n      (point[1] * this.camera.scale[1] +\n        this.camera.offset[1] * this.camera.scale[1]) *\n      this.pixelRatio;\n\n    // If this is a custom camera, we must actually project our world point to the screen\n    if (this.viewCamera.type === ViewCameraType.CUSTOM) {\n      console.warn(\"Custom View Camera projections not supported yet\");\n    }\n\n    // Convert from view to screen space\n    return this.viewToScreen(screen, out);\n  }\n\n  viewToWorld(point: Vec2, out?: Vec2) {\n    const world = out || [0, 0];\n\n    const screen = this.pixelSpaceToScreen(point);\n    world[0] =\n      (screen[0] - this.camera.offset[0] * this.camera.scale[0]) /\n      this.camera.scale[0];\n    world[1] =\n      (screen[1] - this.camera.offset[1] * this.camera.scale[1]) /\n      this.camera.scale[1];\n\n    // If this is a custom camera, we must actually project our world point to the screen\n    if (this.viewCamera.type === ViewCameraType.CUSTOM) {\n      console.warn(\"Custom View Camera projections not supported yet\");\n    }\n\n    return world;\n  }\n\n  worldToView(point: Vec2, out?: Vec2) {\n    const screen = out || [0, 0];\n\n    // Calculate from the camera to view space\n    screen[0] =\n      point[0] * this.camera.scale[0] +\n      this.camera.offset[0] * this.camera.scale[0];\n    screen[1] =\n      point[1] * this.camera.scale[1] +\n      this.camera.offset[1] * this.camera.scale[1];\n\n    // If this is a custom camera, we must actually project our world point to the screen\n    if (this.viewCamera.type === ViewCameraType.CUSTOM) {\n      console.warn(\"Custom View Camera projections not supported yet\");\n    }\n\n    return screen;\n  }\n\n  /**\n   * This operation makes sure we have the view camera adjusted to the new viewport's needs.\n   * For default behavior this ensures that the coordinate system has no distortion, orthographic,\n   * top left as 0,0 with +y axis pointing down.\n   */\n  fitViewtoViewport(surfaceDimensions: Bounds) {\n    if (\n      this.viewCamera.type === ViewCameraType.CONTROLLED &&\n      isOrthographic(this.viewCamera.baseCamera)\n    ) {\n      const viewBounds = getAbsolutePositionBounds<View>(\n        this.viewport,\n        surfaceDimensions,\n        this.pixelRatio\n      );\n\n      const width = viewBounds.width;\n      const height = viewBounds.height;\n\n      const viewport = {\n        bottom: -height / 2,\n        far: 10000000,\n        left: -width / 2,\n        near: -100,\n        right: width / 2,\n        top: height / 2\n      };\n\n      const scaleX = 1;\n      const scaleY = 1;\n      const camera = this.viewCamera.baseCamera;\n\n      camera.projectionOptions = Object.assign(\n        camera.projectionOptions,\n        viewport\n      );\n      camera.position = [\n        -viewBounds.width / 2.0 * scaleX,\n        viewBounds.height / 2.0 * scaleY,\n        camera.position[2]\n      ];\n      camera.scale = [scaleX, -scaleY, 1.0];\n      camera.update();\n\n      this.viewBounds = viewBounds;\n      this.viewBounds.data = this;\n      this.screenBounds = new Bounds({\n        height: this.viewBounds.height / this.pixelRatio,\n        width: this.viewBounds.width / this.pixelRatio,\n        x: this.viewBounds.x / this.pixelRatio,\n        y: this.viewBounds.y / this.pixelRatio\n      });\n    } else if (!isOrthographic(this.viewCamera.baseCamera)) {\n      console.warn(\n        \"Fit to viewport does not support non-orthographic cameras as a default behavior.\"\n      );\n    }\n  }\n}\n","import { Scene } from \"../gl/scene\";\nimport { Instance } from \"../instance-provider/instance\";\nimport { IdentifyByKey, IdentifyByKeyOptions } from \"../util/identify-by-key\";\nimport { ILayerProps, Layer } from \"./layer\";\nimport { IViewOptions, View } from \"./view\";\n\n/**\n * Defines the input for an available scene layers can add themselves to. Each scene can be rendered with multiple\n * views.\n */\nexport interface ISceneOptions extends IdentifyByKeyOptions {\n  /**\n   * This indicates all of the views this scene can be rendered with. For instance: You have a\n   * world scene and you want to render it stereoscopically for VR. Then you can specify two\n   * views with two viewports to render the scene on both halves of the canvas.\n   *\n   * Or perhaps you want an aerial shot as a minimap in the bottom right corner while the rest\n   * of the canvas renders a first person view, then you would make two views for that as well.\n   */\n  views: IViewOptions[];\n}\n\nfunction sortByDepth(a: Layer<any, any>, b: Layer<any, any>) {\n  return a.depth - b.depth;\n}\n\n/**\n * This defines a scene to which layers are added to. It also tracks the views that this scene\n * is rendered with.\n */\nexport class LayerScene extends IdentifyByKey {\n  static DEFAULT_SCENE_ID = \"__default__\";\n\n  /** This is the three scene which actually sets up the rendering objects */\n  container: Scene | undefined = new Scene();\n  /** This is all of the layers tracked to the scene */\n  layers: Layer<any, any>[] = [];\n  /** This indicates the sort is dirty for a set of layers */\n  sortIsDirty = false;\n  /** This is the view */\n  viewById = new Map<string, View>();\n\n  constructor(options: ISceneOptions) {\n    super(options);\n  }\n\n  /**\n   * Adds a layer to the scene with the current view setting the layer contains.\n   * The layer can not jump between views or scenes. You must destroy and reconstruct\n   * the layer.\n   */\n  addLayer<T extends Instance, U extends ILayerProps<T>>(layer: Layer<T, U>) {\n    // Add the layer to the list of layers under the view\n    this.layers.push(layer);\n    this.sortIsDirty = true;\n  }\n\n  /**\n   * This adds a view to this scene to be used by the scene\n   */\n  addView(view: View) {\n    this.viewById.set(view.id, view);\n  }\n\n  /**\n   * Release any resources this may be hanging onto\n   */\n  destroy() {\n    delete this.container;\n  }\n\n  /**\n   * Removes a layer from the scene. No resort is needed as remove operations\n   * do not adjust the sorting order.\n   */\n  removeLayer(layer: Layer<any, any>) {\n    if (this.layers) {\n      const index = this.layers.indexOf(layer);\n\n      if (index >= 0) {\n        this.layers.splice(index, 1);\n        return;\n      }\n    }\n\n    console.warn(\n      \"Could not remove a layer from the scene as the layer was not a part of the scene to start. Scene:\",\n      this.id,\n      \"Layer:\",\n      layer.id\n    );\n  }\n\n  sortLayers() {\n    if (this.sortIsDirty) {\n      this.layers.sort(sortByDepth);\n    }\n  }\n}\n","import { GLSettings, RenderTarget, Scene, Texture } from \"../gl\";\nimport { flushDebug } from \"../gl/debug-resources\";\nimport { WebGLRenderer } from \"../gl/webgl-renderer\";\nimport { Instance } from \"../instance-provider/instance\";\nimport { Bounds } from \"../primitives/bounds\";\nimport {\n  BaseResourceManager,\n  BaseResourceOptions,\n  FontResourceManager,\n  ResourceManager\n} from \"../resources\";\nimport { AtlasResourceManager } from \"../resources/texture/atlas-resource-manager\";\nimport { ShaderProcessor } from \"../shaders/processing/shader-processor\";\nimport { LayerInteractionHandler } from \"../surface/layer-interaction-handler\";\nimport { ActiveIOExpansion } from \"../surface/layer-processing/base-io-expanders/active-io-expansion\";\nimport { IInstanceAttribute, IResourceType, PickType } from \"../types\";\nimport { FrameMetrics, ResourceType } from \"../types\";\nimport { analyzeColorPickingRendering } from \"../util/color-picking-analysis\";\nimport { DataBounds } from \"../util/data-bounds\";\nimport { copy4, Vec2, Vec4 } from \"../util/vector\";\nimport { BaseIOSorting } from \"./base-io-sorting\";\nimport { EventManager } from \"./event-manager\";\nimport { LayerMouseEvents } from \"./event-managers/layer-mouse-events\";\nimport { ILayerProps, ILayerPropsInternal, Layer } from \"./layer\";\nimport { BasicIOExpansion } from \"./layer-processing/base-io-expanders/basic-io-expansion\";\nimport { EasingIOExpansion } from \"./layer-processing/base-io-expanders/easing-io-expansion\";\nimport { BaseIOExpansion } from \"./layer-processing/base-io-expansion\";\nimport { generateDefaultScene } from \"./layer-processing/generate-default-scene\";\nimport { generateLayerGeometry } from \"./layer-processing/generate-layer-geometry\";\nimport { generateLayerMaterial } from \"./layer-processing/generate-layer-material\";\nimport { generateLayerModel } from \"./layer-processing/generate-layer-model\";\nimport { makeLayerBufferManager } from \"./layer-processing/layer-buffer-type\";\nimport { ISceneOptions, LayerScene } from \"./layer-scene\";\nimport { MouseEventManager, SceneView } from \"./mouse-event-manager\";\nimport { ClearFlags, View } from \"./view\";\n\n/**\n * Default IO expansion controllers applied to the system when explicit settings\n * are not provided.\n */\nexport const DEFAULT_IO_EXPANSION: BaseIOExpansion[] = [\n  // Basic expansion to handle writing attributes and uniforms to the shader\n  new BasicIOExpansion(),\n  // Expansion to write in the active attribute handler. Any expansion injected AFTER\n  // this expander will have it's processes canceled out for the destructuring portion\n  // of the expansion when an instance is not active (if the instance has an active\n  // attribute).\n  new ActiveIOExpansion(),\n  // Expansion to handle easing IO attributes and write AutoEasingMethods to the shaders\n  new EasingIOExpansion()\n];\n\n/**\n * Default resource managers the system will utilize to handle default / basic resources.\n */\nexport const DEFAULT_RESOURCE_MANAGEMENT: ILayerSurfaceOptions[\"resourceManagers\"] = [\n  {\n    type: ResourceType.ATLAS,\n    manager: new AtlasResourceManager({})\n  },\n  {\n    type: ResourceType.FONT,\n    manager: new FontResourceManager()\n  }\n];\n\n/**\n * Options for generating a new layer surface.\n */\nexport interface ILayerSurfaceOptions {\n  /**\n   * This is the color the canvas will be set to.\n   */\n  background: [number, number, number, number];\n  /**\n   * Provides the context the surface will use while rendering\n   */\n  context?: HTMLCanvasElement;\n  /**\n   * This is the event managers to respond to the mouse events.\n   */\n  eventManagers?: EventManager[];\n  /**\n   * Set to true to allow this surface to absorb and handle wheel events from the mouse.\n   */\n  handlesWheelEvents?: boolean;\n  /**\n   * Provides additional expansion controllers that will contribute to our Shader IO configuration\n   * for the layers. If this is not provided, this defaults to default system behaviors.\n   *\n   * To add additional Expansion controllers and keep default system controllers utilize a Function\n   * instead:\n   *\n   * ioExpansion: (defaultExpanders: BaseIOExpansion) => [...defaultExpanders, <your own expanders>]\n   *\n   * For instance: easing properties on attributes requires the attribute to be expanded to additional\n   * attributes + modified behavior of the base attribute. Thus the system by default adds in the\n   * EasinggIOExpansion controller when this is not provided to make those property types work.\n   */\n  ioExpansion?:\n    | BaseIOExpansion[]\n    | ((defaultExpanders: BaseIOExpansion[]) => BaseIOExpansion[]);\n  /**\n   * This specifies the density of rendering in the surface. The default value is window.devicePixelRatio to match the\n   * monitor for optimal clarity. Using a value of 1 will be acceptable, will not get high density renders, but will\n   * have better performance if needed.\n   */\n  pixelRatio?: number;\n  /**\n   * These are the resources we want available that our layers can be provided to utilize\n   * for their internal processes.\n   */\n  resources?: BaseResourceOptions[];\n  /**\n   * This specifies the resource managers that will be applied to the surface. If this is not\n   * provided, this will default to DEFAULT_RESOURCE_MANAGEMENT.\n   *\n   * To add additional managers to the default framework:\n   * [\n   *   ...DEFAULT_RESOURCE_MANAGEMENT,\n   *   <your own resource managers>\n   * ]\n   *\n   * Resource managers handle a layer's requests for a resource (this.resource.request(layer, instance, requestObject))\n   * during update cycles of the attributes.\n   */\n  resourceManagers?: {\n    type: number;\n    manager: BaseResourceManager<IResourceType, IResourceType>;\n  }[];\n  /**\n   * This sets up the available scenes the surface will have to work with. Layers then can\n   * reference the scene by it's scene property. The order of the scenes here is the drawing\n   * order of the scenes.\n   */\n  scenes: ISceneOptions[];\n}\n\nconst DEFAULT_BACKGROUND_COLOR: Vec4 = [1.0, 1.0, 1.0, 1.0];\n\n/**\n * A type to describe the constructor of a Layer class.\n */\nexport interface ILayerConstructable<T extends Instance> {\n  new (props: ILayerProps<T>): Layer<any, any>;\n}\n\n/**\n * This specifies a class type that can be used in creating a layer with createLayer\n */\nexport type ILayerConstructionClass<\n  T extends Instance,\n  U extends ILayerProps<T>\n> = ILayerConstructable<T> & { defaultProps: U };\n\n/**\n * This is a pair of a Class Type and the props to be applied to that class type.\n */\nexport type LayerInitializer = [\n  ILayerConstructionClass<Instance, ILayerProps<Instance>>,\n  ILayerProps<Instance>\n];\n\n/**\n * The internal system layer initializer that hides additional properties the front\n * facing API should not be concerned with.\n */\nexport type LayerInitializerInternal = [\n  ILayerConstructionClass<Instance, ILayerPropsInternal<Instance>>,\n  ILayerPropsInternal<Instance>\n];\n\n/**\n * Used for reactive layer generation and updates.\n */\nexport function createLayer<T extends Instance, U extends ILayerProps<T>>(\n  layerClass: ILayerConstructable<T> & { defaultProps: U },\n  props: U\n): LayerInitializer {\n  return [layerClass, props];\n}\n\n/**\n * This is a manager for layers. It will use voidgl layers to intelligently render resources\n * as efficiently as possible. Layers will be rendered in the order they are provided and this\n * surface will provide some basic camera controls by default.\n */\nexport class LayerSurface {\n  /** This is the gl context this surface is rendering to */\n  private context: WebGLRenderingContext;\n  /**\n   * This is the metrics of the current running frame\n   */\n  frameMetrics: FrameMetrics = {\n    currentFrame: 0,\n    currentTime: Date.now() | 0,\n    frameDuration: 1000 / 60,\n    previousTime: Date.now() | 0\n  };\n  /** This is used to help resolve concurrent draws and resolving resource request dequeue operations. */\n  private isBufferingResources = false;\n  /** These are the registered expanders of Shader IO configuration */\n  private ioExpanders: BaseIOExpansion[] = [];\n  /** This is the sorting controller for sorting attributes/uniforms of a layer after all the attributes have been generated that are needed */\n  ioSorting = new BaseIOSorting();\n  /** This is all of the layers in this manager by their id */\n  layers = new Map<string, Layer<Instance, ILayerProps<Instance>>>();\n  /** This manages the mouse events for the current canvas context */\n  private mouseManager: MouseEventManager;\n  /** This is a target used to perform rendering our picking pass */\n  pickingTarget: RenderTarget;\n  /** This is the density the rendering renders for the surface */\n  pixelRatio: number = window.devicePixelRatio;\n  /** This is the THREE render system we use to render scenes with views */\n  renderer: WebGLRenderer;\n  /** This is the resource manager that handles resource requests for instances */\n  resourceManager: ResourceManager;\n  /**\n   * This is all of the available scenes and their views for this surface. Layers reference the IDs\n   * of the scenes and the views to be a part of their rendering state.\n   */\n  scenes = new Map<string, LayerScene>();\n  /**\n   * This is all of the views currently generated for this surface paired with the scene they render.\n   */\n  sceneViews: SceneView[] = [];\n  /** When set to true, the next render will make sure color picking is updated for layer interactions */\n  updateColorPick?: {\n    mouse: Vec2;\n    views: View[];\n  };\n  /**\n   * This flags all layers by id for disposal at the end of every render. A Layer must be recreated\n   * after each render in order to clear it's disposal flag. This is the trick to making this a\n   * reactive system.\n   */\n  willDisposeLayer = new Map<string, boolean>();\n  /**\n   * This map is a quick look up for a view to determine other views that\n   * would need to be redrawn as a consequence of the key view needing a redraw.\n   */\n  private viewDrawDependencies = new Map<View, View[]>();\n  /** This is used to indicate whether the loading is completed */\n  private loadReadyResolve: () => void;\n  loadReady: Promise<void> = new Promise(\n    resolve => (this.loadReadyResolve = resolve)\n  );\n\n  /** Read only getter for the gl context */\n  get gl() {\n    return this.context;\n  }\n\n  /**\n   * This adds a layer to the manager which will manage all of the resource lifecycles of the layer\n   * as well as additional helper injections to aid in instancing and shader i/o.\n   */\n  private addLayer<T extends Instance, U extends ILayerProps<T>>(\n    layer: Layer<T, U>\n  ): Layer<T, U> | null {\n    if (!layer.id) {\n      console.warn(\"All layers must have an id\");\n      return layer;\n    }\n\n    if (this.layers.get(layer.id)) {\n      console.warn(\"All layer's ids must be unique per layer manager\");\n      return layer;\n    }\n\n    // We add the layer to our management\n    this.layers.set(layer.id, layer);\n    // Now we initialize the layer's gl components\n    const layerId = layer.id;\n\n    // Init the layer and see if the initialization is successful\n    if (!this.initLayer(layer)) {\n      this.layers.delete(layerId);\n      return null;\n    }\n\n    return layer;\n  }\n\n  /**\n   * The performs all of the needed updates that layers need to commit to the scene and buffers\n   * to be ready for a draw pass. This is callable outside of the draw loop to allow for specialized\n   * procedures or optimizations to take place, where incremental updates to the buffers would make\n   * the most sense.\n   *\n   * @param time The start time of the given frame\n   * @param frameIncrement When true, the frame count for the frame metrics will increment\n   * @param onViewReady Callback for when all of the layers of a scene view have been committed\n   *                    and are thus potentially ready to be rendered.\n   */\n  async commit(\n    time?: number,\n    frameIncrement?: boolean,\n    onViewReady?: (\n      needsDraw: boolean,\n      scene: LayerScene,\n      view: View,\n      pickingPass: Layer<any, any>[]\n    ) => void\n  ) {\n    if (!this.gl) return;\n\n    // For now, while certain mysteries remain, we will track only if any view needs to be redrawn.\n    // Any view that needs to be redrawn will trigger a redraw of the entire surface for now until\n    // we can optimize down to only drawing a single view without erasing views that were not redrawn.\n    let needsDraw = false;\n\n    // We are rendering a new frame so increment our frame count\n    if (frameIncrement) this.frameMetrics.currentFrame++;\n    this.frameMetrics.frameDuration =\n      this.frameMetrics.currentTime - this.frameMetrics.previousTime;\n    this.frameMetrics.previousTime = this.frameMetrics.currentTime;\n\n    // If no manual time was provided, we shall use Date.now in 32 bit format\n    if (time === undefined) {\n      this.frameMetrics.currentTime = Date.now() | 0;\n    } else {\n      // If this is our first frame and we have a manual time entry, then we first need to sync up\n      // The manual time as our previous timing.\n      if (this.frameMetrics.previousTime === this.frameMetrics.currentTime) {\n        this.frameMetrics.previousTime = time;\n      }\n\n      this.frameMetrics.currentTime = time;\n    }\n\n    // Now that we have established what the time should be, let's swap our input parameter to reflect\n    // the time we will be using for this frame\n    time = this.frameMetrics.currentTime;\n\n    // Get the scenes in their added order\n    const scenes = Array.from(this.scenes.values());\n    const validLayers: { [key: string]: Layer<any, any> } = {};\n    const erroredLayers: { [key: string]: [Layer<any, any>, Error] } = {};\n    const pickingPassByView = new Map<View, Layer<any, any>[]>();\n\n    // Loop through scenes\n    for (let i = 0, end = scenes.length; i < end; ++i) {\n      const scene = scenes[i];\n      const views = Array.from(scene.viewById.values());\n      const layers = scene.layers;\n\n      // Make sure the layers are depth sorted\n      scene.sortLayers();\n\n      // Loop through the views\n      for (let k = 0, endk = views.length; k < endk; ++k) {\n        const view = views[k];\n        // When this flags true, a picking pass will be rendered for the provided scene / view\n        const pickingPass: Layer<any, any>[] = [];\n\n        // We must perform any operations necessary to make the view camera fit the viewport\n        // Correctly\n        view.fitViewtoViewport(\n          new Bounds({\n            height: this.context.canvas.height,\n            width: this.context.canvas.width,\n            x: 0,\n            y: 0\n          })\n        );\n\n        // Let the layers update their uniforms before the draw\n        for (let j = 0, endj = layers.length; j < endj; ++j) {\n          // Get the layer to be rendered in the scene\n          const layer = layers[j];\n          // Update the layer with the view it is about to be rendered with\n          layer.view = view;\n\n          // Make sure the layer is given the opportunity to update all of it's uniforms\n          // To match the view state and update any unresolved diffs internally\n          try {\n            // Update uniforms, resolve diff changes\n            layer.draw();\n            // If any of the layers under the view need a redraw\n            // Then the view needs a redraw\n            if (layer.needsViewDrawn) view.needsDraw = true;\n            // Flag the layer as valid\n            validLayers[layer.id] = layer;\n            // The view's animationEndTime is the largest end time found on one of the view's child layers.\n            view.animationEndTime = Math.max(\n              view.animationEndTime,\n              layer.animationEndTime\n            );\n            // Indicate this layer is being rendered at the current time frame\n            layer.lastFrameTime = time;\n          } catch (err) {\n            if (!erroredLayers[layer.id]) {\n              erroredLayers[layer.id] = [layer, err];\n            }\n          }\n\n          // If this layer specifies a picking draw pass, then we shall store it in the current draw order\n          // For that next step\n          if (layer.picking.type === PickType.SINGLE) {\n            pickingPass.push(layer);\n          }\n        }\n\n        // Analyze the view's animation end timings and the camera to see if there are view changes\n        // that will trigger a redraw outside of our layer changes\n        if (\n          view.needsDraw ||\n          (time && time < view.lastFrameTime) ||\n          view.camera.needsViewDrawn ||\n          true\n        ) {\n          view.needsDraw = true;\n          needsDraw = true;\n\n          // Get all of the dependent views for that view\n          const overlapViews = this.viewDrawDependencies.get(view);\n\n          // And make all of them need a redraw.\n          if (overlapViews) {\n            overlapViews.forEach(view => {\n              view.needsDraw = true;\n            });\n          }\n        }\n\n        // Store the picking pass for the view to use when the view is ready to draw\n        pickingPassByView.set(view, pickingPass);\n      }\n    }\n\n    // If any draw need was detected, redraw the surface\n    for (let i = 0, end = scenes.length; i < end; ++i) {\n      const scene = scenes[i];\n      // Our scene must have a valid container to operate\n      if (!scene.container) continue;\n      const views = Array.from(scene.viewById.values());\n\n      for (let k = 0, endk = views.length; k < endk; ++k) {\n        const view = views[k];\n\n        // Now perform the rendering\n        if (onViewReady) {\n          onViewReady(\n            needsDraw,\n            scene,\n            view,\n            pickingPassByView.get(view) || []\n          );\n        }\n      }\n    }\n\n    // Get the layers with errors flagged for them\n    const errors = Object.values(erroredLayers);\n\n    if (errors.length > 0) {\n      const passed = Object.values(validLayers);\n\n      console.warn(\n        \"Some layers errored during their draw update. These layers will be removed. They can be re-added if render() is called again:\",\n        errors.map(err => err[0].id)\n      );\n\n      // Output each layer and why it errored\n      errors.forEach(err => {\n        console.warn(`Layer ${err[0].id} removed for the following error:`);\n\n        if (err[1]) {\n          const message = err[1].stack || err[1].message;\n          console.error(message);\n\n          // This is a specific error to instances updating an attribute but returning a value that is larger\n          // than the attribute size. The only way to debug this is to run every instance in the layer and\n          // retrieve it's update value and compare the return to the expected size.\n          if (\n            message.indexOf(\"RangeError\") > -1 ||\n            message.indexOf(\"Source is too large\") > -1\n          ) {\n            const layer = err[0];\n            const changes = layer.bufferManager.changeListContext;\n            let singleMessage:\n              | [string, Instance, IInstanceAttribute<Instance>]\n              | undefined;\n            let errorCount = 0;\n\n            for (let i = 0, iMax = changes.length; i < iMax; ++i) {\n              const [instance] = changes[i];\n              layer.instanceAttributes.forEach(attr => {\n                const check = attr.update(instance);\n                if (check.length !== attr.size) {\n                  if (!singleMessage) {\n                    singleMessage = [\n                      \"Example instance returned the wrong sized value for an attribute:\",\n                      instance,\n                      attr\n                    ];\n                  }\n\n                  errorCount++;\n                }\n              });\n            }\n\n            if (singleMessage) {\n              console.error(\n                \"The following output shows discovered issues related to the specified error\"\n              );\n              console.error(\n                \"Instances are returning too large IO for an attribute\\n\",\n                singleMessage[0],\n                singleMessage[1],\n                singleMessage[2],\n                \"Total errors for too large IO values\",\n                errorCount\n              );\n            }\n          }\n        }\n      });\n\n      // Re-render but only include non-errored layers\n      this.render(passed.map(layer => layer.initializer));\n    }\n  }\n\n  /**\n   * Free all resources consumed by this surface that gets applied to the GPU.\n   */\n  destroy() {\n    this.layers.forEach(layer => layer.destroy());\n    this.resourceManager.destroy();\n    this.mouseManager.destroy();\n    this.sceneViews.forEach(sceneView => sceneView.scene.destroy());\n    this.renderer.dispose();\n    this.pickingTarget.dispose();\n  }\n\n  private queuedPicking?: [LayerScene, View, Layer<any, any>[], Vec2][];\n\n  /**\n   * This processes what is rendered into the picking render target to see if the mouse interacted with\n   * any elements.\n   */\n  private analyzePickRendering() {\n    if (!this.queuedPicking) return;\n\n    for (let i = 0, iMax = this.queuedPicking.length; i < iMax; ++i) {\n      const [, view, pickingPass, mouse] = this.queuedPicking[i];\n\n      // Optimized rendering of the view will make the view discard picking rendering\n      if (view.optimizeRendering) {\n        continue;\n      }\n\n      // Make our metrics for how much of the image we wish to analyze\n      const pickWidth = 5;\n      const pickHeight = 5;\n      const numBytesPerColor = 4;\n      const out = new Uint8Array(pickWidth * pickHeight * numBytesPerColor);\n\n      // Read the pixels out\n      this.renderer.readPixels(\n        Math.floor(mouse[0] - pickWidth / 2),\n        Math.floor(mouse[1] - pickHeight / 2),\n        pickWidth,\n        pickHeight,\n        out\n      );\n\n      // Analyze the rendered color data for the picking routine\n      const pickingData = analyzeColorPickingRendering(\n        [mouse[0] - view.screenBounds.x, mouse[1] - view.screenBounds.y],\n        out,\n        pickWidth,\n        pickHeight\n      );\n\n      // We must redraw the layers so they will update their uniforms to adapt to a picking pass\n      for (let j = 0, endj = pickingPass.length; j < endj; ++j) {\n        const layer = pickingPass[j];\n\n        if (layer.picking.type === PickType.SINGLE) {\n          layer.interactions.colorPicking = pickingData;\n        }\n      }\n    }\n\n    delete this.queuedPicking;\n  }\n\n  /**\n   * This is the draw loop that must be called per frame for updates to take effect and display.\n   *\n   * @param time This is an optional time flag so one can manually control the time flag for the frame.\n   *             This will affect animations and other automated gpu processes.\n   */\n  async draw(time?: number) {\n    if (!this.gl) return;\n\n    // The theoretically least blocking moment for pixels to be read is the beginning of the next frame\n    // right before next frame is rendered. This will have given optimal time for the GPU to have finished\n    // flushing it's commands. If the GPU has not completed it's tasks by this time, then we're in a major\n    // GPU intensive operation.\n    this.analyzePickRendering();\n\n    // Gather all of our picking calls to call at the end to prevent readPixels from\n    // becoming a major blocking operation\n    const toPick: [LayerScene, View, Layer<any, any>[]][] = [];\n\n    // Make the layers commit their changes to the buffers then draw each scene view on\n    // Completion.\n    await this.commit(time, true, (needsDraw, scene, view, pickingPass) => {\n      // Our scene must have a valid container to operate\n      if (!scene.container) return;\n\n      if (needsDraw) {\n        // Now perform the rendering\n        this.drawSceneView(scene.container, view);\n      }\n\n      // If a layer needs a picking pass, then perform a picking draw pass only\n      // if a request for the color pick has been made, then we query the pixels rendered to our picking target\n      if (pickingPass.length > 0 && this.updateColorPick) {\n        toPick.push([scene, view, pickingPass]);\n      }\n    });\n\n    // After we have drawn our views of our scenes, we can now ensure all of the bounds\n    // Are updated in the interactions and flag our interactions ready for mouse input\n    if (this.mouseManager.waitingForRender) {\n      this.sceneViews.forEach(sceneView => {\n        sceneView.bounds = new DataBounds(sceneView.view.screenBounds);\n        sceneView.bounds.data = sceneView;\n      });\n\n      this.mouseManager.waitingForRender = false;\n    }\n\n    // Now that all of our layers have performed updates to everything, we can now dequeue\n    // All resource requests\n    // We create this gate in case multiple draw calls flow through before a buffer opertion is completed\n    if (!this.isBufferingResources) {\n      this.isBufferingResources = true;\n      const didBuffer = await this.resourceManager.dequeueRequests();\n      this.isBufferingResources = false;\n\n      // If buffering did occur and completed, then we should be performing a draw to ensure all of the\n      // Changes are committed and pushed out.\n      if (didBuffer) {\n        this.loadReadyResolve();\n        this.loadReady = new Promise(\n          resolve => (this.loadReadyResolve = resolve)\n        );\n        this.draw();\n      }\n    }\n\n    // Each frame needs to analyze if draws are needed or not. Thus we reset all draw needs so they will\n    // be considered resolved for the current set of changes.\n    // Set draw needs of cameras and views back to false\n    this.sceneViews.forEach(sceneView => {\n      sceneView.view.needsDraw = false;\n      sceneView.view.camera.resolve();\n    });\n\n    // Set all layers draw needs back to false, also, resolve all of the data providers\n    // so their changelists are considered consumed.\n    this.layers.forEach(layer => {\n      layer.needsViewDrawn = false;\n      layer.props.data.resolveContext = \"\";\n    });\n\n    // Run the picking operation as the final action to put the readPixels at the tail\n    for (let i = 0, iMax = toPick.length; i < iMax; ++i) {\n      const picking = toPick[i];\n      const didDraw = this.drawPicking(picking[0], picking[1], picking[2]);\n\n      if (\n        didDraw &&\n        picking.length > 0 &&\n        !picking[1].optimizeRendering &&\n        this.updateColorPick\n      ) {\n        if (!this.queuedPicking) this.queuedPicking = [];\n        this.queuedPicking.push([\n          picking[0],\n          picking[1],\n          picking[2],\n          this.updateColorPick.mouse\n        ]);\n      }\n    }\n\n    // Clear out the flag requesting a pick pass so we don't perform a pick render pass unless we have\n    // another requested from mouse interactions\n    delete this.updateColorPick;\n\n    // Dequeue rendering debugs\n    flushDebug();\n  }\n\n  /**\n   * NOTE: This is a temp way to handle picking. Picking will be handled with MRT once that pipeline is set up.\n   *\n   * This renders a selected scene/view into our picking target. Settings get adjusted\n   */\n  private drawPicking(\n    scene: LayerScene,\n    view: View,\n    pickingPass: Layer<any, any>[]\n  ) {\n    if (!this.updateColorPick) return false;\n    if (!scene.container) return false;\n    // Optimized rendering of the view will make the view discard picking rendering\n    if (view.optimizeRendering) return false;\n\n    // Get the requested metrics for the pick\n    const views = this.updateColorPick.views;\n\n    // Ensure the view provided is a view that is registered with this surface\n    if (views.indexOf(view) > -1) {\n      // Picking uses a pixel ratio of 1\n      view.pixelRatio = 1.0;\n      // Get the current flags for the view\n      const flags = view.clearFlags.slice(0);\n      // Store the current background of the view\n      const background = copy4(view.background);\n      // Set color rendering flag\n      view.clearFlags = [ClearFlags.COLOR, ClearFlags.DEPTH];\n      // Set the view's background to a solid black so we don't interfere with color encoding\n      view.background = [0, 0, 0, 0];\n\n      // We must perform any operations necessary to make the view camera fit the viewport\n      // Correctly with the possibly adjusted pixel ratio\n      view.fitViewtoViewport(\n        new Bounds({\n          height: this.pickingTarget.height,\n          width: this.pickingTarget.width,\n          x: 0,\n          y: 0\n        })\n      );\n\n      // We must redraw the layers so they will update their uniforms to adapt to a picking pass\n      for (let j = 0, endj = pickingPass.length; j < endj; ++j) {\n        const layer = pickingPass[j];\n        // Adjust the layer to utilize the proper pick mode, thus causing the layer to properly\n        // Set it's uniforms into a pick mode.\n        layer.picking.currentPickMode = PickType.SINGLE;\n\n        // Update the layer's material uniforms and avoid causing the changelist to attempt updates again\n        try {\n          layer.updateUniforms();\n        } catch (err) {\n          /** No-op, the first draw should have output an error for bad draw calls */\n          console.warn(err);\n        }\n\n        layer.picking.currentPickMode = PickType.NONE;\n      }\n\n      // Draw the scene with our picking target as the target\n      this.drawSceneView(\n        scene.container,\n        view,\n        this.renderer,\n        this.pickingTarget\n      );\n\n      // Return the pixel ratio back to the rendered ratio\n      view.pixelRatio = this.pixelRatio;\n      // Return the view's clear flags\n      view.clearFlags = flags;\n      // Return the view's background color\n      view.background = background;\n\n      // After reverting the pixel ratio, we must return to the state we came from so that mouse interactions\n      // will work properly\n      view.fitViewtoViewport(\n        new Bounds({\n          height: this.context.canvas.height,\n          width: this.context.canvas.width,\n          x: 0,\n          y: 0\n        })\n      );\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * This finalizes everything and sets up viewports and clears colors and performs the actual render step\n   */\n  private drawSceneView(\n    scene: Scene,\n    view: View,\n    renderer?: WebGLRenderer,\n    target?: RenderTarget\n  ) {\n    renderer = renderer || this.renderer;\n    const offset = { x: view.viewBounds.left, y: view.viewBounds.top };\n    const size = view.viewBounds;\n    const pixelRatio = view.pixelRatio;\n    const background = view.background;\n\n    // Make sure the correct render target is applied\n    renderer.setRenderTarget(target || null);\n\n    // Set the scissor rectangle.\n    renderer.setScissor(\n      {\n        x: offset.x / pixelRatio,\n        y: offset.y / pixelRatio,\n        width: size.width / pixelRatio,\n        height: size.height / pixelRatio\n      },\n      target\n    );\n    // If a background is established, we should clear the background color\n    // Specified for this context\n    if (view.background) {\n      // Clear the rect of color and depth so the region is totally it's own\n      renderer.clearColor([\n        background[0],\n        background[1],\n        background[2],\n        background[3]\n      ]);\n    }\n\n    // Make sure the viewport is set properly for the next render\n    renderer.setViewport({\n      x: offset.x / pixelRatio,\n      y: offset.y / pixelRatio,\n      width: size.width,\n      height: size.height\n    });\n\n    // Get the view's clearing preferences\n    if (view.clearFlags) {\n      renderer.clear(\n        view.clearFlags.indexOf(ClearFlags.COLOR) > -1,\n        view.clearFlags.indexOf(ClearFlags.DEPTH) > -1,\n        view.clearFlags.indexOf(ClearFlags.STENCIL) > -1\n      );\n    } else {\n      renderer.clear(true, true);\n    }\n\n    // Render the scene with the provided view metrics\n    renderer.render(scene, target);\n    // Indicate this view has been rendered for the given time allottment\n    view.lastFrameTime = this.frameMetrics.currentTime;\n  }\n\n  /**\n   * This gathers all the overlap views of every view\n   */\n  private gatherViewDrawDependencies() {\n    this.viewDrawDependencies.clear();\n\n    // Fit all views to viewport\n    for (let i = 0, endi = this.sceneViews.length; i < endi; i++) {\n      this.sceneViews[i].view.fitViewtoViewport(\n        new Bounds({\n          height: this.context.canvas.height,\n          width: this.context.canvas.width,\n          x: 0,\n          y: 0\n        })\n      );\n    }\n\n    // Set viewDrawDependencies\n    for (let i = 0, endi = this.sceneViews.length; i < endi; i++) {\n      const sourceView = this.sceneViews[i].view;\n      const overlapViews: View[] = [];\n\n      for (let j = 0, endj = this.sceneViews.length; j < endj; j++) {\n        if (j !== i) {\n          const targetView = this.sceneViews[j].view;\n\n          if (sourceView.viewBounds.hitBounds(targetView.viewBounds)) {\n            overlapViews.push(targetView);\n          }\n        }\n      }\n\n      this.viewDrawDependencies.set(sourceView, overlapViews);\n    }\n  }\n\n  /**\n   * This allows for querying a view's screen bounds. Null is returned if the view id\n   * specified does not exist.\n   */\n  getViewSize(viewId: string): Bounds | null {\n    for (const sceneView of this.sceneViews) {\n      if (sceneView.view.id === viewId) {\n        return sceneView.view.screenBounds;\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * This queries a view's window into a world's space.\n   */\n  getViewWorldBounds(viewId: string): Bounds | null {\n    for (const sceneView of this.sceneViews) {\n      if (sceneView.view.id === viewId) {\n        const view = sceneView.view;\n\n        if (view.screenBounds) {\n          const topLeft = view.viewToWorld([0, 0]);\n          const bottomRight = view.screenToWorld([\n            view.screenBounds.right,\n            view.screenBounds.bottom\n          ]);\n\n          return new Bounds({\n            bottom: bottomRight[1],\n            left: topLeft[0],\n            right: bottomRight[0],\n            top: topLeft[1]\n          });\n        } else {\n          return null;\n        }\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * This is the beginning of the system. This should be called immediately after the surface is constructed.\n   * We make this mandatory outside of the constructor so we can make it follow an async pattern.\n   */\n  async init(options: ILayerSurfaceOptions) {\n    // Make sure our desired pixel ratio is set up\n    this.pixelRatio = options.pixelRatio || this.pixelRatio;\n\n    if (this.pixelRatio < 1.0) {\n      this.pixelRatio = 1.0;\n    }\n\n    // Initialize our GL needs that set the basis for rendering\n    const context = this.initGL(options);\n    if (!context) return;\n    this.context = context;\n\n    if (this.gl) {\n      // Initialize our event manager that handles mouse interactions/gestures with the canvas\n      this.initMouseManager(options);\n      // Initialize any resources requested or needed, such as textures or rendering surfaces\n      await this.initResources(options);\n      // Initialize any io expanders requested or needed. This must happen after resource initialization\n      // as resource managers can produce their own expanders.\n      await this.initIOExpanders(options);\n    } else {\n      console.warn(\n        \"Could not establish a GL context. Layer Surface will be unable to render\"\n      );\n    }\n\n    return this;\n  }\n\n  /**\n   * This initializes the Canvas GL contexts needed for rendering.\n   */\n  private initGL(options: ILayerSurfaceOptions) {\n    // Get the canvas of our context to set up our Three settings\n    const canvas = options.context;\n    if (!canvas) return null;\n\n    // Get the starting width and height so adjustments don't affect it\n    const width = canvas.width;\n    const height = canvas.height;\n    let hasContext = true;\n\n    // Generate the renderer along with it's properties\n    this.renderer = new WebGLRenderer({\n      // Context supports rendering to an alpha canvas only if the background color has a transparent\n      // Alpha value.\n      alpha: options.background && options.background[3] < 1.0,\n      // Yes to antialias! Make it preeeeetty!\n      antialias: false,\n      // Make three use an existing canvas rather than generate another\n      canvas,\n      // TODO: This should be toggleable. If it's true it allows us to snapshot the rendering in the canvas\n      //       But we dont' always want it as it makes performance drop a bit.\n      preserveDrawingBuffer: false,\n      // This indicates if the information written to the canvas is going to be written as premultiplied values\n      // or if they will be standard rgba values. Helps with compositing with the DOM.\n      premultipliedAlpha: false,\n\n      // Let's us know if there is no valid webgl context to work with or not\n      onNoContext: () => {\n        hasContext = false;\n      }\n    });\n\n    if (!hasContext || !this.renderer.gl) return null;\n    this.context = this.renderer.gl;\n\n    if (this.resourceManager) {\n      this.resourceManager.setWebGLRenderer(this.renderer);\n    }\n\n    // Generate a target for the picking pass\n    this.pickingTarget = new RenderTarget({\n      buffers: {\n        color: new Texture({\n          generateMipMaps: false,\n          data: {\n            width,\n            height,\n            buffer: null\n          }\n        }),\n        depth: GLSettings.RenderTarget.DepthBufferFormat.DEPTH_COMPONENT16\n      },\n      // We want a target with a pixel ratio of just 1, which will be more than enough accuracy for mouse picking\n      width,\n      height\n    });\n\n    // This sets the pixel ratio to handle differing pixel densities in screens\n    this.setRendererSize(width, height);\n    // Set the pixel ratio to match the pixel density of the monitor in use\n    this.renderer.setPixelRatio(this.pixelRatio);\n\n    // Applies the background color and establishes whether or not the context supports\n    // Alpha or not\n    if (options.background) {\n      this.renderer.setClearColor([\n        options.background[0],\n        options.background[1],\n        options.background[2],\n        options.background[3]\n      ]);\n    } else {\n      // If a background color was not established, then we set a default background color\n      this.renderer.setClearColor(DEFAULT_BACKGROUND_COLOR);\n    }\n\n    // Make a scene view depth tracker so we can track the order each scene view combo is drawn\n    let sceneViewDepth = 0;\n\n    // Add the requested scenes to the surface and apply the necessary defaults\n    if (options.scenes) {\n      options.scenes.forEach(sceneOptions => {\n        // Make us a new scene based on the requested options\n        const newScene = new LayerScene(sceneOptions);\n        // Use defaultSceneElement to set cameras\n        const defaultSceneElement = generateDefaultScene(this.context);\n        // Generate the views requested for the scene\n        sceneOptions.views.forEach(viewOptions => {\n          const newView = new View(viewOptions);\n          newView.camera = newView.camera || defaultSceneElement.camera;\n          newView.viewCamera =\n            newView.viewCamera || defaultSceneElement.viewCamera;\n          newView.pixelRatio = this.pixelRatio;\n          newScene.addView(newView);\n\n          for (const sceneView of this.sceneViews) {\n            if (sceneView.view.id === newView.id) {\n              console.warn(\n                \"You can NOT have two views with the same id. Please use unique identifiers for every view generated.\"\n              );\n            }\n          }\n\n          this.sceneViews.push({\n            depth: ++sceneViewDepth,\n            scene: newScene,\n            view: newView\n          });\n        });\n\n        this.scenes.set(sceneOptions.key, newScene);\n      });\n\n      this.gatherViewDrawDependencies();\n    }\n\n    return this.renderer.gl;\n  }\n\n  /**\n   * Initializes the expanders that should be applied to the surface for layer processing.\n   */\n  private initIOExpanders(options: ILayerSurfaceOptions) {\n    // Handle expanders passed in as an array or blank\n    if (\n      Array.isArray(options.ioExpansion) ||\n      options.ioExpansion === undefined\n    ) {\n      // Initialize the Shader IO expansion objects\n      this.ioExpanders =\n        (options.ioExpansion && options.ioExpansion.slice(0)) ||\n        (DEFAULT_IO_EXPANSION && DEFAULT_IO_EXPANSION.slice(0)) ||\n        [];\n    }\n\n    // Handle expanders passed in as a method\n    else if (options.ioExpansion instanceof Function) {\n      this.ioExpanders = options.ioExpansion(DEFAULT_IO_EXPANSION);\n    }\n\n    // Retrieve any expansion objects the resource managers may provide\n    const managerIOExpanders = this.resourceManager.getIOExpansion();\n    // Add the expanders to our current handled list.\n    this.ioExpanders = this.ioExpanders.concat(managerIOExpanders);\n  }\n\n  /**\n   * This does special initialization by gathering the layers shader IO, generates a material\n   * and injects special automated uniforms and attributes to make instancing work for the\n   * shader.\n   */\n  private initLayer<T extends Instance, U extends ILayerProps<T>>(\n    layer: Layer<T, U>\n  ): Layer<T, U> | null {\n    // Set the layer's parent surface here\n    layer.surface = this;\n    // Set the resource manager this surface utilizes to the layer\n    layer.resource = this.resourceManager;\n    // Get the shader metrics the layer desires\n    const shaderIO = layer.initShader();\n    // For the sake of initializing uniforms to the correct values, we must first add the layer to it's appropriate\n    // Scene so that the necessary values will be in place for the sahder IO\n    const scene = this.addLayerToScene(layer);\n    if (!scene) return null;\n    // Ensure the layer has interaction handling applied to it\n    layer.interactions = new LayerInteractionHandler(layer);\n\n    // If no metrics are provided, this layer is merely a shell layer and will not\n    // receive any GPU handling objects.\n    if (!shaderIO) {\n      layer.picking.type = PickType.NONE;\n      return layer;\n    }\n\n    if (!shaderIO.fs || !shaderIO.vs) {\n      console.warn(\n        \"Layer needs to specify the fragment and vertex shaders:\",\n        layer.id\n      );\n      return null;\n    }\n\n    // Clean out nulls provided as a convenience to the layer\n    shaderIO.instanceAttributes = (shaderIO.instanceAttributes || []).filter(\n      Boolean\n    );\n    shaderIO.vertexAttributes = (shaderIO.vertexAttributes || []).filter(\n      Boolean\n    );\n    shaderIO.uniforms = (shaderIO.uniforms || []).filter(Boolean);\n\n    // Generate the actual shaders to be used by injecting all of the necessary fragments and injecting\n    // Instancing fragments\n    const shaderMetrics = new ShaderProcessor().process(\n      layer,\n      shaderIO,\n      this.ioExpanders,\n      this.ioSorting\n    );\n\n    // Check to see if the Shader Processing failed. If so, return null as a failure flag.\n    if (!shaderMetrics) return null;\n    // Retrieve all of the attributes created as a result of layer input and module processing.\n    const { vertexAttributes, instanceAttributes, uniforms } = shaderMetrics;\n\n    // Generate the geometry this layer will be utilizing\n    const geometry = generateLayerGeometry(\n      layer,\n      shaderMetrics.maxInstancesPerBuffer,\n      vertexAttributes,\n      shaderIO.vertexCount\n    );\n    // This is the material that is generated for the layer that utilizes all of the generated and\n    // Injected shader IO and shader fragments\n    const material = generateLayerMaterial(\n      layer,\n      shaderMetrics.vs,\n      shaderMetrics.fs,\n      uniforms,\n      shaderMetrics.materialUniforms\n    );\n    // And now we can now generate the mesh that will be added to the scene\n    const model = generateLayerModel(geometry, material, shaderIO.drawMode);\n\n    // Now that all of the elements of the layer are complete, let us apply them to the layer\n    layer.geometry = geometry;\n    layer.instanceAttributes = instanceAttributes;\n    layer.instanceVertexCount = shaderIO.vertexCount;\n    layer.material = material;\n    layer.maxInstancesPerBuffer = shaderMetrics.maxInstancesPerBuffer;\n    layer.model = model;\n    layer.uniforms = uniforms;\n    layer.vertexAttributes = vertexAttributes;\n\n    // Generate the correct buffering strategy for the layer\n    makeLayerBufferManager(this.gl, layer, scene);\n\n    if (layer.props.printShader) {\n      console.warn(\n        \"A Layer requested its shader be debugged. Do not leave this active for production:\",\n        \"Layer:\",\n        layer.props.key,\n        \"Shader Metrics\",\n        shaderMetrics\n      );\n      console.warn(\"\\n\\nVERTEX SHADER\\n--------------\\n\\n\", shaderMetrics.vs);\n      console.warn(\"\\n\\nFRAGMENT SHADER\\n--------------\\n\\n\", shaderMetrics.fs);\n    }\n\n    return layer;\n  }\n\n  /**\n   * Initializes elements for handling mouse interactions with the canvas.\n   */\n  private initMouseManager(options: ILayerSurfaceOptions) {\n    // We must inject an event manager to broadcast events through the layers themselves\n    const eventManagers: EventManager[] = ([\n      new LayerMouseEvents(this)\n    ] as EventManager[]).concat(options.eventManagers || []);\n\n    // Generate the mouse manager for the layer\n    this.mouseManager = new MouseEventManager(\n      this.context.canvas,\n      this.sceneViews,\n      eventManagers,\n      options.handlesWheelEvents\n    );\n  }\n\n  /**\n   * This initializes resources needed or requested such as textures or render surfaces.\n   */\n  private async initResources(options: ILayerSurfaceOptions) {\n    // Create the controller for handling all resource managers\n    this.resourceManager = new ResourceManager();\n    // Set the GL renderer to the\n    this.resourceManager.setWebGLRenderer(this.renderer);\n\n    // Get the managers requested by the configuration\n    const managers =\n      (options.resourceManagers && options.resourceManagers.slice(0)) ||\n      (DEFAULT_RESOURCE_MANAGEMENT && DEFAULT_RESOURCE_MANAGEMENT.slice(0)) ||\n      [];\n\n    // Register all of the managers for use by their type.\n    managers.forEach(manager => {\n      this.resourceManager.setManager(manager.type, manager.manager);\n    });\n\n    // Tell our managers to handle all of the requested resources injected into the\n    // configuration\n    if (options.resources) {\n      for (const resource of options.resources) {\n        await this.resourceManager.initResource(resource);\n      }\n    }\n  }\n\n  /**\n   * This finds the scene and view the layer belongs to based on the layer's props. For invalid or not provided\n   * props, the layer gets added to default scenes and views.\n   */\n  private addLayerToScene<T extends Instance, U extends ILayerProps<T>>(\n    layer: Layer<T, U>\n  ): LayerScene | undefined {\n    // Get the scene the layer will add itself to\n    const scene = this.scenes.get(layer.props.scene || \"\");\n\n    if (!scene) {\n      console.warn(\n        \"No scene is specified by the layer, or the scene identifier is invalid\"\n      );\n    } else {\n      // Add the layer to the scene for rendering\n      scene.addLayer(layer);\n    }\n\n    return scene;\n  }\n\n  /**\n   * Discontinues a layer's management by this surface. This will invalidate any resources\n   * the layer was using in association with the context. If the layer is re-insertted, it will\n   * be revaluated as though it were a new layer.\n   */\n  private removeLayer<T extends Instance, U extends ILayerProps<T>>(\n    layer: Layer<T, U> | null\n  ): Layer<T, U> | null {\n    // Make sure we are removing a layer that exists in the system\n    if (!layer) {\n      return null;\n    }\n\n    if (!this.layers.get(layer && layer.id)) {\n      console.warn(\n        \"Tried to remove a layer that is not in the manager.\",\n        layer\n      );\n      return layer;\n    }\n\n    layer.destroy();\n    this.layers.delete(layer.id);\n    this.willDisposeLayer.delete(layer.id);\n    const scene = this.scenes.get(layer.props.scene);\n\n    if (scene) {\n      scene.removeLayer(layer);\n    }\n\n    if (layer.children && layer.children.length > 0) {\n      for (let i = 0, iMax = layer.children.length; i < iMax; ++i) {\n        const child = layer.children[i];\n        this.removeLayer(child);\n      }\n    }\n\n    return layer;\n  }\n\n  /**\n   * This expands a layer's children within the initializer list\n   */\n  private expandLayerChildren(\n    initializers: LayerInitializerInternal[],\n    layer: Layer<Instance, ILayerProps<Instance>>,\n    index: number\n  ) {\n    // Merge in the child layers this layer may request as the immediate next layers in the sequence\n    const childLayers: LayerInitializerInternal[] = layer.childLayers();\n    // No children, no need to do anything\n    if (childLayers.length <= 0) return;\n\n    // Make sure each child layer knows their parent\n    for (let i = 0, iMax = childLayers.length; i < iMax; ++i) {\n      const init = childLayers[i];\n      init[1].parent = layer;\n    }\n\n    // Add in the initializers of the children to be immediately updated or generated\n    initializers.splice(index + 1, 0, ...childLayers);\n  }\n\n  /**\n   * This handles a layer's update lifecycle during the layer rendering phase.\n   */\n  private updateLayer(\n    initializers: LayerInitializerInternal[],\n    layer: Layer<Instance, ILayerPropsInternal<Instance>>,\n    props: ILayerPropsInternal<Instance>,\n    index: number\n  ) {\n    // Execute lifecycle method\n    layer.willUpdateProps(props);\n\n    // If we have a provider that is about to be newly set to the layer, then the provider\n    // needs to do a full sync in order to have existing elements in the provider\n    if (props.data !== layer.props.data) {\n      props.data.sync();\n    }\n\n    // Check to see if the layer is going to require it's view to be redrawn based on the props for the Layer changing,\n    // or by custom logic of the layer.\n    if (layer.shouldDrawView(layer.props, props)) {\n      layer.needsViewDrawn = true;\n    }\n\n    // Make sure the layer has the current props applied to it\n    Object.assign(layer.props, props);\n    // Keep the initializer up to date with the injected props\n    layer.initializer[1] = layer.props;\n    // Lifecycle hook\n    layer.didUpdateProps();\n\n    // If we are having a parent swap, we need to make sure the previous parent does not\n    // register this layer as a child anymore\n    if (props.parent) {\n      if (layer.parent && layer.parent !== props.parent) {\n        // RESUME: We're making sure deleted layers or regenerated layers properly have parent child relationships\n        // updated properly.\n        const children = layer.parent.children || [];\n        const index = children.indexOf(layer) || -1;\n\n        if (index > -1) {\n          children.splice(index, 1);\n        }\n      }\n    }\n\n    // Always make sure the layer's parent is set properly by the props\n    layer.parent = props.parent;\n\n    // A layer may flag itself as needing to be rebuilt. This is handled here and is completed by deleting\n    // the layer completely then generating the layer anew.\n    if (layer.willRebuildLayer) {\n      this.removeLayer(layer);\n      this.generateLayer(initializers, layer.initializer, index);\n    }\n\n    // If the layer is not regenerated, then during this render phase we add in the child layers of this layer.\n    else {\n      this.expandLayerChildren(initializers, layer, index);\n    }\n  }\n\n  /**\n   * This handles a layer's creation during the rendering of layers.\n   */\n  private generateLayer(\n    initializers: LayerInitializerInternal[],\n    init: LayerInitializerInternal,\n    index: number,\n    preventChildren?: boolean\n  ) {\n    const layerClass = init[0];\n    const props = init[1];\n    // Generate the new layer and provide it it's initial props\n    const layer = new layerClass(\n      Object.assign({}, layerClass.defaultProps, props)\n    );\n    // Keep the initializer object that generated the layer for reference and debugging\n    layer.initializer = init;\n    // Sync the data provider applied to the layer in case the provider has existing data\n    // before being applied tot he layer\n    layer.props.data.sync();\n    // Look in the props of the layer for the parent of the layer\n    layer.parent = props.parent;\n\n    // If the parent is present, the parent should have the child added\n    if (props.parent) {\n      if (props.parent.children) props.parent.children.push(layer);\n      else props.parent.children = [layer];\n    }\n\n    // Add the layer to this surface\n    if (!this.addLayer(layer)) {\n      console.warn(\n        \"Error initializing layer:\",\n        props.key,\n        \"A layer was unable to be added to the surface. See previous warnings (if any) to determine why they could not be instantiated\"\n      );\n\n      return;\n    }\n\n    // Add in the children of the layer\n    if (!preventChildren) {\n      this.expandLayerChildren(initializers, layer, index);\n    }\n  }\n\n  /**\n   * Used for reactive rendering and diffs out the layers for changed layers.\n   */\n  render(layerInitializers: LayerInitializer[]) {\n    if (!this.gl) return;\n\n    // Prevent mutations of the input\n    const initializers: LayerInitializerInternal[] = layerInitializers.slice(0);\n\n    // Loop through all of the initializers and properly add and remove layers as needed\n    if (initializers && initializers.length > 0) {\n      // This loop is VERY specifically putting the length check in the conditional of the loop\n      // The list CAN add additional initializers to account for the children being added\n      for (let i = 0; i < initializers.length; ++i) {\n        const init = initializers[i];\n        const props = init[1];\n        const existingLayer = this.layers.get(props.key);\n\n        if (existingLayer) {\n          this.updateLayer(initializers, existingLayer, props, i);\n        } else {\n          this.generateLayer(initializers, init, i);\n        }\n\n        this.willDisposeLayer.set(props.key, false);\n      }\n    }\n\n    // Take any layer that retained it's disposal flag and trash it\n    this.willDisposeLayer.forEach((dispose, layerId) => {\n      if (dispose) {\n        const layer = this.layers.get(layerId);\n        if (layer) {\n          this.removeLayer(layer);\n        } else {\n          console.warn(\n            \"this.willDisposeLayer applied to a layer that does not exist in the existing layer check.\"\n          );\n        }\n      }\n    });\n\n    // Resolve that all disposals occurred\n    this.willDisposeLayer.clear();\n\n    // Reflag every layer for removal again so creation of layers will determine\n    // Which layers remain for a reactive pattern\n    this.layers.forEach((_layer, id) => {\n      this.willDisposeLayer.set(id, true);\n    });\n  }\n\n  /**\n   * This must be executed when the canvas changes size so that we can re-calculate the scenes and views\n   * dimensions for handling all of our rendered elements.\n   */\n  fitContainer(_pixelRatio?: number) {\n    const container = this.context.canvas.parentElement;\n\n    if (container) {\n      const canvas = this.context.canvas;\n      canvas.className = \"\";\n      canvas.setAttribute(\"style\", \"\");\n      container.style.position = \"relative\";\n      canvas.style.position = \"absolute\";\n      canvas.style.left = \"0xp\";\n      canvas.style.top = \"0xp\";\n      canvas.style.width = \"100%\";\n      canvas.style.height = \"100%\";\n      canvas.setAttribute(\"width\", \"\");\n      canvas.setAttribute(\"height\", \"\");\n      const containerBox = container.getBoundingClientRect();\n      const box = canvas.getBoundingClientRect();\n\n      this.resize(box.width || 100, containerBox.height || 100);\n    }\n  }\n\n  /**\n   * This resizes the canvas and retains pixel ratios amongst all of the resources involved.\n   */\n  resize(width: number, height: number, pixelRatio?: number) {\n    this.pixelRatio = pixelRatio || this.pixelRatio;\n\n    if (this.pixelRatio < 1.0) {\n      this.pixelRatio = 1.0;\n    }\n\n    this.sceneViews.forEach(\n      sceneView => (sceneView.view.pixelRatio = this.pixelRatio)\n    );\n    this.setRendererSize(width, height);\n    this.renderer.setPixelRatio(this.pixelRatio);\n    this.mouseManager.resize();\n    this.gatherViewDrawDependencies();\n  }\n\n  /**\n   * This applies a new size to the renderer and resizes any additional resources that requires being\n   * sized along with the renderer.\n   */\n  private setRendererSize(width: number, height: number) {\n    width = width || 100;\n    height = height || 100;\n\n    // Set the canvas size for the renderer\n    this.renderer.setSize(width, height);\n    // Set the picking target size to be the dimensions of our renderer as well\n    this.pickingTarget.setSize(width, height);\n  }\n\n  /**\n   * This triggers an update to all of the layers that perform picking, the pixel data\n   * within the specified mouse range.\n   */\n  updateColorPickRange(mouse: Vec2, views: View[]) {\n    // We will flag the color range as needing an update\n    this.updateColorPick = {\n      mouse,\n      views\n    };\n  }\n}\n","import { Texture, TextureOptions } from \"../../gl/texture\";\nimport { Omit, ResourceType, TextureSize } from \"../../types\";\nimport { IdentifyByKey } from \"../../util/identify-by-key\";\nimport { Vec2 } from \"../../util/vector\";\nimport { BaseResourceOptions } from \"../base-resource-manager\";\nimport { IAtlasResourceRequest } from \"./atlas-resource-request\";\nimport { PackNode } from \"./pack-node\";\nimport { SubTexture } from \"./sub-texture\";\n\nconst debug = require(\"debug\")(\"performance\");\n\n/**\n * Options required for generating an atlas.\n */\nexport interface IAtlasResource extends BaseResourceOptions {\n  /** Set the type of the resource to explicitally be an atlas resource */\n  type: ResourceType.ATLAS;\n  /** This is the height of the texture */\n  height: TextureSize;\n  /** This is the width of the atlas */\n  width: TextureSize;\n  /**\n   * This applies any desired settings to the Texture.\n   * Some noteable defaults this system sets:\n   *  - generateMipMaps is true and\n   *  - premultiply alpha is true.\n   */\n  textureSettings?: TextureOptions;\n}\n\n/**\n * Use this in the property creation of atlas'.\n */\nexport function createAtlas(\n  options: Omit<IAtlasResource, \"type\">\n): IAtlasResource {\n  return {\n    type: ResourceType.ATLAS,\n    ...options\n  };\n}\n\n/**\n * Type guard for the atlas resource type.\n */\nexport function isAtlasResource(val: BaseResourceOptions): val is Atlas {\n  return val && val.type === ResourceType.ATLAS;\n}\n\ntype ResourceReference = { subtexture: SubTexture; count: number };\n\n/**\n * This represents a single Texture on the gpu that is composed of several smaller textures\n * as a 'look up'.\n */\nexport class Atlas extends IdentifyByKey implements IAtlasResource {\n  /** Stores the size of the atlas texture */\n  height: TextureSize;\n  /** This is the packing of the atlas with images */\n  packing: PackNode<SubTexture>;\n  /**\n   * This is storage for handling resource reference counting. When a resource's reference drops below\n   * a count of 1, then the resource is disposed and it's space on the atlas is flagged for freeing up\n   * should the atlas need to consolidate resources.\n   */\n  resourceReferences = new Map<\n    IAtlasResourceRequest[\"source\"],\n    ResourceReference\n  >();\n  /** This is the actual texture object that represents the atlas on the GPU */\n  texture: Texture;\n  /** These are the applied settings to our texture */\n  textureSettings?: TextureOptions;\n  /** The resource type for resource management */\n  type: number = ResourceType.ATLAS;\n  /**\n   * This is all of the resources associated with this atlas. The boolean flag indicates if the resource\n   * is flagged for removal. When set to false, the resource is no longer valid and can be removed from\n   * the atlas at any given moment.\n   */\n  validResources = new Set<IAtlasResourceRequest>();\n  /** Stores the size of the atlas texture */\n  width: TextureSize;\n\n  constructor(options: IAtlasResource) {\n    super(options);\n    const canvas = document.createElement(\"canvas\");\n    this.width = canvas.width = options.width;\n    this.height = canvas.height = options.height;\n    this.textureSettings = options.textureSettings;\n\n    // Set up the packing for this atlas\n    this.packing = new PackNode(0, 0, options.width, options.height);\n    // Make sure the texture is started and updated\n    this.createTexture(canvas);\n  }\n\n  /**\n   * This invalidates the SubTexture of an atlas resource.\n   */\n  private invalidateTexture(texture: SubTexture) {\n    const zero: Vec2 = [0, 0];\n    texture.aspectRatio = 1;\n\n    // Make anything trying to render with the image not render much anything useful\n    texture.atlasBL = zero;\n    texture.atlasBR = zero;\n    texture.atlasTL = zero;\n    texture.atlasTR = zero;\n    texture.textureReferenceID = \"\";\n    texture.isValid = false;\n    texture.texture = null;\n    texture.pixelHeight = 0;\n    texture.pixelWidth = 0;\n  }\n\n  /**\n   * This generates the texture object needed for this atlas.\n   */\n  private createTexture(canvas?: HTMLCanvasElement) {\n    if (this.texture) return;\n\n    // Establish the settings to be applied to the Texture\n    let textureSettings;\n\n    if (this.textureSettings) {\n      textureSettings = {\n        generateMipMaps: true,\n        premultiplyAlpha: true,\n        ...this.textureSettings\n      };\n    } else {\n      textureSettings = {\n        generateMipMaps: true,\n        premultiplyAlpha: true\n      };\n    }\n\n    // Generate the texture\n    this.texture = new Texture({\n      data: canvas,\n      ...textureSettings\n    });\n\n    // Update resources referencing the texture\n    this.validResources.forEach(resource => {\n      if (resource.texture) {\n        resource.texture.texture = this.texture;\n      }\n    });\n  }\n\n  /**\n   * This frees up all the resources down to the GPU related to this atlas. It also\n   * loops through every resource and invalidates the texturing information within\n   * them so subsequent accidental renders will appear as a single color rather than\n   * an artifacted element.\n   */\n  destroy() {\n    // Delete the GPU's texture object\n    this.texture.dispose();\n\n    // Invalidate the Sub textures so they don't start rendering wild colors. Instead\n    // should render a single color at the 0, 0 mark of the texture.\n    this.validResources.forEach((_isValid, resource) => {\n      if (resource.texture) this.invalidateTexture(resource.texture);\n    });\n  }\n\n  /**\n   * This flags a resource for use and increments it's reference count.\n   */\n  useResource(request: IAtlasResourceRequest) {\n    const reference = this.resourceReferences.get(request.source) || {\n      subtexture: request.texture,\n      count: 0\n    };\n\n    reference.count++;\n  }\n\n  /**\n   * This flags a resource no longeer used and decrements it's reference count.\n   * If the use of the resource drops low enough, this will clear out the resurce\n   * completely.\n   */\n  stopUsingResource(request: IAtlasResourceRequest) {\n    const reference: ResourceReference = this.resourceReferences.get(\n      request.source\n    ) || {\n      subtexture: request.texture || new SubTexture(),\n      count: 0\n    };\n\n    reference.count--;\n  }\n\n  /**\n   * This will look through all resources in this atlas and will determine if the resource\n   * should be removed or not.\n   */\n  resolveResources() {\n    const toRemove: IAtlasResourceRequest[\"source\"][] = [];\n\n    this.resourceReferences.forEach((ref, source) => {\n      if (ref.count <= 0 && ref.subtexture) {\n        debug(\n          \"A subtexture on an atlas has been invalidated as it is deemed no longer used: %o\",\n          ref.subtexture\n        );\n        this.invalidateTexture(ref.subtexture);\n        toRemove.push(source);\n      }\n    });\n\n    for (let i = 0, iMax = toRemove.length; i < iMax; ++i) {\n      this.resourceReferences.delete(toRemove[i]);\n    }\n  }\n}\n","import { Texture } from \"../../gl/texture\";\nimport { Instance } from \"../../instance-provider/instance\";\nimport {\n  ShaderDeclarationStatements,\n  ShaderIOHeaderInjectionResult\n} from \"../../shaders/processing/base-shader-io-injection\";\nimport { MetricsProcessing } from \"../../shaders/processing/metrics-processing\";\nimport { ILayerProps, Layer } from \"../../surface/layer\";\nimport {\n  BaseIOExpansion,\n  ShaderIOExpansion\n} from \"../../surface/layer-processing/base-io-expansion\";\nimport {\n  IInstanceAttribute,\n  InstanceAttributeSize,\n  IResourceInstanceAttribute,\n  IResourceType,\n  IUniform,\n  IValueInstanceAttribute,\n  IVertexAttribute,\n  ShaderInjectionTarget,\n  UniformSize\n} from \"../../types\";\n\nconst debugCtx = \"TextureIOExpansion\";\n\n/** Empty texture that will default to the zero texture and unit */\nconst emptyTexture = new Texture({\n  data: {\n    width: 2,\n    height: 2,\n    buffer: new Uint8Array(16)\n  }\n});\n\n/** Resource Attribute typeguard */\nfunction isTextureAttribute<T extends Instance>(\n  attr: any,\n  resourceType: number\n): attr is IResourceInstanceAttribute<T> {\n  return (\n    attr &&\n    attr.resource &&\n    attr.resource.type === resourceType &&\n    attr.resource.name !== undefined &&\n    attr.resource.key !== undefined\n  );\n}\n\n/**\n * Minimal information a resource is required to have to operate for this expander.\n */\ninterface ITextureIOExpansionResource extends IResourceType {\n  texture: Texture;\n}\n\n/**\n * Minimal manager requirements for being applied to this expanded.\n */\ninterface ITextureResourceManager {\n  getResource(key: string): ITextureIOExpansionResource | null;\n}\n\n/**\n * This is an expansion handler for resource attributes that requires a texture to be\n * included as a uniform on behalf of the attribute.\n */\nexport class TextureIOExpansion extends BaseIOExpansion {\n  /** The manager which will contain the texture object to be used */\n  manager: ITextureResourceManager;\n  /** The resource type this expansion filters on */\n  resourceType: number;\n\n  constructor(resourceType: number, manager: ITextureResourceManager) {\n    super();\n    this.manager = manager;\n    this.resourceType = resourceType;\n  }\n\n  /**\n   * Provides expanded IO for attributes with resource properties.\n   */\n  expand<T extends Instance, U extends ILayerProps<T>>(\n    _layer: Layer<T, U>,\n    instanceAttributes: IInstanceAttribute<T>[],\n    _vertexAttributes: IVertexAttribute[],\n    _uniforms: IUniform[]\n  ): ShaderIOExpansion<T> {\n    // Pull down the manager to this method's context\n    const manager = this.manager;\n    // Retrieve all of the instance attributes that are atlas references\n    const atlasInstanceAttributes: IResourceInstanceAttribute<T>[] = [];\n    // Key: The atlas uniform name requested\n    const requestedTextureInjections = new Map<string, [boolean, boolean]>();\n\n    // Get the atlas requests that have unique names. We only need one uniform\n    // For a single unique provided name. We also must merge the requests for\n    // Vertex and fragment injections\n    instanceAttributes.forEach(\n      (\n        attribute: IValueInstanceAttribute<T> | IResourceInstanceAttribute<T>\n      ) => {\n        if (isTextureAttribute(attribute, this.resourceType)) {\n          // Auto set the size of the attribute. Attribute's that are a resource automatically\n          // Consume a size of four unless otherwise stated by the attribute\n          if (attribute.size === undefined) {\n            attribute.size = InstanceAttributeSize.FOUR;\n          }\n\n          // Get the atlas resource uniform (sampler2D) injection targets. We default to only the\n          // Fragment shader as it's the most commonly used location for sampler2Ds\n          const injection: number =\n            attribute.resource.shaderInjection ||\n            ShaderInjectionTarget.FRAGMENT;\n          // See if we already have an injection for the given injected uniform name for an atlas resource.\n          const injections = requestedTextureInjections.get(\n            attribute.resource.name\n          );\n\n          if (injections) {\n            requestedTextureInjections.set(attribute.resource.name, [\n              injections[0] ||\n                injection === ShaderInjectionTarget.VERTEX ||\n                injection === ShaderInjectionTarget.ALL,\n              injections[1] ||\n                injection === ShaderInjectionTarget.FRAGMENT ||\n                injection === ShaderInjectionTarget.ALL\n            ]);\n          } else {\n            atlasInstanceAttributes.push(attribute);\n            requestedTextureInjections.set(attribute.resource.name, [\n              injection === ShaderInjectionTarget.VERTEX ||\n                injection === ShaderInjectionTarget.ALL,\n              injection === ShaderInjectionTarget.FRAGMENT ||\n                injection === ShaderInjectionTarget.ALL\n            ]);\n          }\n        }\n      }\n    );\n\n    // Make uniforms for all of the unique atlas requests.\n    const uniforms = atlasInstanceAttributes.map(\n      (instanceAttribute): IUniform[] => {\n        let injection: ShaderInjectionTarget = ShaderInjectionTarget.FRAGMENT;\n\n        if (instanceAttribute.resource) {\n          const injections = requestedTextureInjections.get(\n            instanceAttribute.resource.name\n          );\n\n          if (injections) {\n            injection =\n              (injections[0] && injections[1] && ShaderInjectionTarget.ALL) ||\n              (injections[0] &&\n                !injections[1] &&\n                ShaderInjectionTarget.VERTEX) ||\n              (!injections[0] &&\n                injections[1] &&\n                ShaderInjectionTarget.FRAGMENT) ||\n              injection;\n          }\n        }\n\n        return [\n          {\n            name: instanceAttribute.resource.name,\n            shaderInjection: injection,\n            size: UniformSize.ATLAS,\n            update: () => {\n              const resource = manager.getResource(\n                instanceAttribute.resource.key\n              );\n\n              if (resource) {\n                return resource.texture || emptyTexture;\n              }\n\n              return emptyTexture;\n            }\n          },\n          {\n            name: `${instanceAttribute.resource.name}_size`,\n            shaderInjection: injection,\n            size: UniformSize.TWO,\n            update: () => {\n              const resource = manager.getResource(\n                instanceAttribute.resource.key\n              );\n\n              if (resource) {\n                const texture = resource.texture;\n\n                if (texture && texture.data) {\n                  const { width, height } = texture.data;\n                  return [width || 1, height || 1];\n                }\n              }\n\n              return [1, 1];\n            }\n          }\n        ];\n      }\n    );\n\n    const flatten: IUniform[] = [];\n    uniforms.forEach(list => list.forEach(uniform => flatten.push(uniform)));\n\n    return {\n      instanceAttributes: [],\n      vertexAttributes: [],\n      uniforms: flatten\n    };\n  }\n\n  /**\n   * Validates the IO about to be expanded.\n   */\n  validate<T extends Instance, U extends ILayerProps<T>>(\n    _layer: Layer<T, U>,\n    instanceAttributes: IInstanceAttribute<T>[],\n    _vertexAttributes: IVertexAttribute[],\n    _uniforms: IUniform[]\n  ): boolean {\n    let foundError = false;\n\n    instanceAttributes.forEach(attribute => {\n      if (attribute.easing && attribute.resource) {\n        console.warn(\n          \"An instance attribute can not have both easing and resource properties. Undefined behavior will occur.\"\n        );\n        console.warn(attribute);\n\n        foundError = true;\n      }\n    });\n\n    return !foundError;\n  }\n\n  /**\n   * For texture resources, we need the uniforms with a size of ATLAS to be injected as a sampler2D instead\n   * of a vector sizing which the basic io expansion can only provide.\n   */\n  processHeaderInjection(\n    target: ShaderInjectionTarget,\n    declarations: ShaderDeclarationStatements,\n    _layer: Layer<Instance, ILayerProps<Instance>>,\n    _metrics: MetricsProcessing,\n    _vertexAttributes: IVertexAttribute[],\n    _instanceAttributes: IInstanceAttribute<Instance>[],\n    uniforms: IUniform[]\n  ): ShaderIOHeaderInjectionResult {\n    const out = {\n      injection: \"\"\n    };\n\n    for (let i = 0, iMax = uniforms.length; i < iMax; ++i) {\n      const uniform = uniforms[i];\n      const injection = uniform.shaderInjection || ShaderInjectionTarget.VERTEX;\n\n      if (uniform.size === UniformSize.ATLAS && injection === target) {\n        this.setDeclaration(\n          declarations,\n          uniform.name,\n          `uniform sampler2D ${uniform.name};\\n`,\n          debugCtx\n        );\n      }\n    }\n\n    return out;\n  }\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.createCounterText = exports.inlineListItemElement = exports.getListOwner = undefined;\n\nvar _Util = require('./Util');\n\nvar _NodeContainer = require('./NodeContainer');\n\nvar _NodeContainer2 = _interopRequireDefault(_NodeContainer);\n\nvar _TextContainer = require('./TextContainer');\n\nvar _TextContainer2 = _interopRequireDefault(_TextContainer);\n\nvar _listStyle = require('./parsing/listStyle');\n\nvar _Unicode = require('./Unicode');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Margin between the enumeration and the list item content\nvar MARGIN_RIGHT = 7;\n\nvar ancestorTypes = ['OL', 'UL', 'MENU'];\n\nvar getListOwner = exports.getListOwner = function getListOwner(container) {\n    var parent = container.parent;\n    if (!parent) {\n        return null;\n    }\n\n    do {\n        var isAncestor = ancestorTypes.indexOf(parent.tagName) !== -1;\n        if (isAncestor) {\n            return parent;\n        }\n        parent = parent.parent;\n    } while (parent);\n\n    return container.parent;\n};\n\nvar inlineListItemElement = exports.inlineListItemElement = function inlineListItemElement(node, container, resourceLoader) {\n    var listStyle = container.style.listStyle;\n\n    if (!listStyle) {\n        return;\n    }\n\n    var style = node.ownerDocument.defaultView.getComputedStyle(node, null);\n    var wrapper = node.ownerDocument.createElement('html2canvaswrapper');\n    (0, _Util.copyCSSStyles)(style, wrapper);\n\n    wrapper.style.position = 'absolute';\n    wrapper.style.bottom = 'auto';\n    wrapper.style.display = 'block';\n    wrapper.style.letterSpacing = 'normal';\n\n    switch (listStyle.listStylePosition) {\n        case _listStyle.LIST_STYLE_POSITION.OUTSIDE:\n            wrapper.style.left = 'auto';\n            wrapper.style.right = node.ownerDocument.defaultView.innerWidth - container.bounds.left - container.style.margin[1].getAbsoluteValue(container.bounds.width) + MARGIN_RIGHT + 'px';\n            wrapper.style.textAlign = 'right';\n            break;\n        case _listStyle.LIST_STYLE_POSITION.INSIDE:\n            wrapper.style.left = container.bounds.left - container.style.margin[3].getAbsoluteValue(container.bounds.width) + 'px';\n            wrapper.style.right = 'auto';\n            wrapper.style.textAlign = 'left';\n            break;\n    }\n\n    var text = void 0;\n    var MARGIN_TOP = container.style.margin[0].getAbsoluteValue(container.bounds.width);\n    var styleImage = listStyle.listStyleImage;\n    if (styleImage) {\n        if (styleImage.method === 'url') {\n            var image = node.ownerDocument.createElement('img');\n            image.src = styleImage.args[0];\n            wrapper.style.top = container.bounds.top - MARGIN_TOP + 'px';\n            wrapper.style.width = 'auto';\n            wrapper.style.height = 'auto';\n            wrapper.appendChild(image);\n        } else {\n            var size = parseFloat(container.style.font.fontSize) * 0.5;\n            wrapper.style.top = container.bounds.top - MARGIN_TOP + container.bounds.height - 1.5 * size + 'px';\n            wrapper.style.width = size + 'px';\n            wrapper.style.height = size + 'px';\n            wrapper.style.backgroundImage = style.listStyleImage;\n        }\n    } else if (typeof container.listIndex === 'number') {\n        text = node.ownerDocument.createTextNode(createCounterText(container.listIndex, listStyle.listStyleType, true));\n        wrapper.appendChild(text);\n        wrapper.style.top = container.bounds.top - MARGIN_TOP + 'px';\n    }\n\n    // $FlowFixMe\n    var body = node.ownerDocument.body;\n    body.appendChild(wrapper);\n\n    if (text) {\n        container.childNodes.push(_TextContainer2.default.fromTextNode(text, container));\n        body.removeChild(wrapper);\n    } else {\n        // $FlowFixMe\n        container.childNodes.push(new _NodeContainer2.default(wrapper, container, resourceLoader, 0));\n    }\n};\n\nvar ROMAN_UPPER = {\n    integers: [1000, 900, 500, 400, 100, 90, 50, 40, 10, 9, 5, 4, 1],\n    values: ['M', 'CM', 'D', 'CD', 'C', 'XC', 'L', 'XL', 'X', 'IX', 'V', 'IV', 'I']\n};\n\nvar ARMENIAN = {\n    integers: [9000, 8000, 7000, 6000, 5000, 4000, 3000, 2000, 1000, 900, 800, 700, 600, 500, 400, 300, 200, 100, 90, 80, 70, 60, 50, 40, 30, 20, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1],\n    values: ['Ք', 'Փ', 'Ւ', 'Ց', 'Ր', 'Տ', 'Վ', 'Ս', 'Ռ', 'Ջ', 'Պ', 'Չ', 'Ո', 'Շ', 'Ն', 'Յ', 'Մ', 'Ճ', 'Ղ', 'Ձ', 'Հ', 'Կ', 'Ծ', 'Խ', 'Լ', 'Ի', 'Ժ', 'Թ', 'Ը', 'Է', 'Զ', 'Ե', 'Դ', 'Գ', 'Բ', 'Ա']\n};\n\nvar HEBREW = {\n    integers: [10000, 9000, 8000, 7000, 6000, 5000, 4000, 3000, 2000, 1000, 400, 300, 200, 100, 90, 80, 70, 60, 50, 40, 30, 20, 19, 18, 17, 16, 15, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1],\n    values: ['י׳', 'ט׳', 'ח׳', 'ז׳', 'ו׳', 'ה׳', 'ד׳', 'ג׳', 'ב׳', 'א׳', 'ת', 'ש', 'ר', 'ק', 'צ', 'פ', 'ע', 'ס', 'נ', 'מ', 'ל', 'כ', 'יט', 'יח', 'יז', 'טז', 'טו', 'י', 'ט', 'ח', 'ז', 'ו', 'ה', 'ד', 'ג', 'ב', 'א']\n};\n\nvar GEORGIAN = {\n    integers: [10000, 9000, 8000, 7000, 6000, 5000, 4000, 3000, 2000, 1000, 900, 800, 700, 600, 500, 400, 300, 200, 100, 90, 80, 70, 60, 50, 40, 30, 20, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1],\n    values: ['ჵ', 'ჰ', 'ჯ', 'ჴ', 'ხ', 'ჭ', 'წ', 'ძ', 'ც', 'ჩ', 'შ', 'ყ', 'ღ', 'ქ', 'ფ', 'ჳ', 'ტ', 'ს', 'რ', 'ჟ', 'პ', 'ო', 'ჲ', 'ნ', 'მ', 'ლ', 'კ', 'ი', 'თ', 'ჱ', 'ზ', 'ვ', 'ე', 'დ', 'გ', 'ბ', 'ა']\n};\n\nvar createAdditiveCounter = function createAdditiveCounter(value, min, max, symbols, fallback, suffix) {\n    if (value < min || value > max) {\n        return createCounterText(value, fallback, suffix.length > 0);\n    }\n\n    return symbols.integers.reduce(function (string, integer, index) {\n        while (value >= integer) {\n            value -= integer;\n            string += symbols.values[index];\n        }\n        return string;\n    }, '') + suffix;\n};\n\nvar createCounterStyleWithSymbolResolver = function createCounterStyleWithSymbolResolver(value, codePointRangeLength, isNumeric, resolver) {\n    var string = '';\n\n    do {\n        if (!isNumeric) {\n            value--;\n        }\n        string = resolver(value) + string;\n        value /= codePointRangeLength;\n    } while (value * codePointRangeLength >= codePointRangeLength);\n\n    return string;\n};\n\nvar createCounterStyleFromRange = function createCounterStyleFromRange(value, codePointRangeStart, codePointRangeEnd, isNumeric, suffix) {\n    var codePointRangeLength = codePointRangeEnd - codePointRangeStart + 1;\n\n    return (value < 0 ? '-' : '') + (createCounterStyleWithSymbolResolver(Math.abs(value), codePointRangeLength, isNumeric, function (codePoint) {\n        return (0, _Unicode.fromCodePoint)(Math.floor(codePoint % codePointRangeLength) + codePointRangeStart);\n    }) + suffix);\n};\n\nvar createCounterStyleFromSymbols = function createCounterStyleFromSymbols(value, symbols) {\n    var suffix = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '. ';\n\n    var codePointRangeLength = symbols.length;\n    return createCounterStyleWithSymbolResolver(Math.abs(value), codePointRangeLength, false, function (codePoint) {\n        return symbols[Math.floor(codePoint % codePointRangeLength)];\n    }) + suffix;\n};\n\nvar CJK_ZEROS = 1 << 0;\nvar CJK_TEN_COEFFICIENTS = 1 << 1;\nvar CJK_TEN_HIGH_COEFFICIENTS = 1 << 2;\nvar CJK_HUNDRED_COEFFICIENTS = 1 << 3;\n\nvar createCJKCounter = function createCJKCounter(value, numbers, multipliers, negativeSign, suffix, flags) {\n    if (value < -9999 || value > 9999) {\n        return createCounterText(value, _listStyle.LIST_STYLE_TYPE.CJK_DECIMAL, suffix.length > 0);\n    }\n    var tmp = Math.abs(value);\n    var string = suffix;\n\n    if (tmp === 0) {\n        return numbers[0] + string;\n    }\n\n    for (var digit = 0; tmp > 0 && digit <= 4; digit++) {\n        var coefficient = tmp % 10;\n\n        if (coefficient === 0 && (0, _Util.contains)(flags, CJK_ZEROS) && string !== '') {\n            string = numbers[coefficient] + string;\n        } else if (coefficient > 1 || coefficient === 1 && digit === 0 || coefficient === 1 && digit === 1 && (0, _Util.contains)(flags, CJK_TEN_COEFFICIENTS) || coefficient === 1 && digit === 1 && (0, _Util.contains)(flags, CJK_TEN_HIGH_COEFFICIENTS) && value > 100 || coefficient === 1 && digit > 1 && (0, _Util.contains)(flags, CJK_HUNDRED_COEFFICIENTS)) {\n            string = numbers[coefficient] + (digit > 0 ? multipliers[digit - 1] : '') + string;\n        } else if (coefficient === 1 && digit > 0) {\n            string = multipliers[digit - 1] + string;\n        }\n        tmp = Math.floor(tmp / 10);\n    }\n\n    return (value < 0 ? negativeSign : '') + string;\n};\n\nvar CHINESE_INFORMAL_MULTIPLIERS = '十百千萬';\nvar CHINESE_FORMAL_MULTIPLIERS = '拾佰仟萬';\nvar JAPANESE_NEGATIVE = 'マイナス';\nvar KOREAN_NEGATIVE = '마이너스 ';\n\nvar createCounterText = exports.createCounterText = function createCounterText(value, type, appendSuffix) {\n    var defaultSuffix = appendSuffix ? '. ' : '';\n    var cjkSuffix = appendSuffix ? '、' : '';\n    var koreanSuffix = appendSuffix ? ', ' : '';\n    switch (type) {\n        case _listStyle.LIST_STYLE_TYPE.DISC:\n            return '•';\n        case _listStyle.LIST_STYLE_TYPE.CIRCLE:\n            return '◦';\n        case _listStyle.LIST_STYLE_TYPE.SQUARE:\n            return '◾';\n        case _listStyle.LIST_STYLE_TYPE.DECIMAL_LEADING_ZERO:\n            var string = createCounterStyleFromRange(value, 48, 57, true, defaultSuffix);\n            return string.length < 4 ? '0' + string : string;\n        case _listStyle.LIST_STYLE_TYPE.CJK_DECIMAL:\n            return createCounterStyleFromSymbols(value, '〇一二三四五六七八九', cjkSuffix);\n        case _listStyle.LIST_STYLE_TYPE.LOWER_ROMAN:\n            return createAdditiveCounter(value, 1, 3999, ROMAN_UPPER, _listStyle.LIST_STYLE_TYPE.DECIMAL, defaultSuffix).toLowerCase();\n        case _listStyle.LIST_STYLE_TYPE.UPPER_ROMAN:\n            return createAdditiveCounter(value, 1, 3999, ROMAN_UPPER, _listStyle.LIST_STYLE_TYPE.DECIMAL, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.LOWER_GREEK:\n            return createCounterStyleFromRange(value, 945, 969, false, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.LOWER_ALPHA:\n            return createCounterStyleFromRange(value, 97, 122, false, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.UPPER_ALPHA:\n            return createCounterStyleFromRange(value, 65, 90, false, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.ARABIC_INDIC:\n            return createCounterStyleFromRange(value, 1632, 1641, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.ARMENIAN:\n        case _listStyle.LIST_STYLE_TYPE.UPPER_ARMENIAN:\n            return createAdditiveCounter(value, 1, 9999, ARMENIAN, _listStyle.LIST_STYLE_TYPE.DECIMAL, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.LOWER_ARMENIAN:\n            return createAdditiveCounter(value, 1, 9999, ARMENIAN, _listStyle.LIST_STYLE_TYPE.DECIMAL, defaultSuffix).toLowerCase();\n        case _listStyle.LIST_STYLE_TYPE.BENGALI:\n            return createCounterStyleFromRange(value, 2534, 2543, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.CAMBODIAN:\n        case _listStyle.LIST_STYLE_TYPE.KHMER:\n            return createCounterStyleFromRange(value, 6112, 6121, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.CJK_EARTHLY_BRANCH:\n            return createCounterStyleFromSymbols(value, '子丑寅卯辰巳午未申酉戌亥', cjkSuffix);\n        case _listStyle.LIST_STYLE_TYPE.CJK_HEAVENLY_STEM:\n            return createCounterStyleFromSymbols(value, '甲乙丙丁戊己庚辛壬癸', cjkSuffix);\n        case _listStyle.LIST_STYLE_TYPE.CJK_IDEOGRAPHIC:\n        case _listStyle.LIST_STYLE_TYPE.TRAD_CHINESE_INFORMAL:\n            return createCJKCounter(value, '零一二三四五六七八九', CHINESE_INFORMAL_MULTIPLIERS, '負', cjkSuffix, CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS | CJK_HUNDRED_COEFFICIENTS);\n        case _listStyle.LIST_STYLE_TYPE.TRAD_CHINESE_FORMAL:\n            return createCJKCounter(value, '零壹貳參肆伍陸柒捌玖', CHINESE_FORMAL_MULTIPLIERS, '負', cjkSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS | CJK_HUNDRED_COEFFICIENTS);\n        case _listStyle.LIST_STYLE_TYPE.SIMP_CHINESE_INFORMAL:\n            return createCJKCounter(value, '零一二三四五六七八九', CHINESE_INFORMAL_MULTIPLIERS, '负', cjkSuffix, CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS | CJK_HUNDRED_COEFFICIENTS);\n        case _listStyle.LIST_STYLE_TYPE.SIMP_CHINESE_FORMAL:\n            return createCJKCounter(value, '零壹贰叁肆伍陆柒捌玖', CHINESE_FORMAL_MULTIPLIERS, '负', cjkSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS | CJK_HUNDRED_COEFFICIENTS);\n        case _listStyle.LIST_STYLE_TYPE.JAPANESE_INFORMAL:\n            return createCJKCounter(value, '〇一二三四五六七八九', '十百千万', JAPANESE_NEGATIVE, cjkSuffix, 0);\n        case _listStyle.LIST_STYLE_TYPE.JAPANESE_FORMAL:\n            return createCJKCounter(value, '零壱弐参四伍六七八九', '拾百千万', JAPANESE_NEGATIVE, cjkSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS);\n        case _listStyle.LIST_STYLE_TYPE.KOREAN_HANGUL_FORMAL:\n            return createCJKCounter(value, '영일이삼사오육칠팔구', '십백천만', KOREAN_NEGATIVE, koreanSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS);\n        case _listStyle.LIST_STYLE_TYPE.KOREAN_HANJA_INFORMAL:\n            return createCJKCounter(value, '零一二三四五六七八九', '十百千萬', KOREAN_NEGATIVE, koreanSuffix, 0);\n        case _listStyle.LIST_STYLE_TYPE.KOREAN_HANJA_FORMAL:\n            return createCJKCounter(value, '零壹貳參四五六七八九', '拾百千', KOREAN_NEGATIVE, koreanSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS);\n        case _listStyle.LIST_STYLE_TYPE.DEVANAGARI:\n            return createCounterStyleFromRange(value, 0x966, 0x96f, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.GEORGIAN:\n            return createAdditiveCounter(value, 1, 19999, GEORGIAN, _listStyle.LIST_STYLE_TYPE.DECIMAL, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.GUJARATI:\n            return createCounterStyleFromRange(value, 0xae6, 0xaef, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.GURMUKHI:\n            return createCounterStyleFromRange(value, 0xa66, 0xa6f, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.HEBREW:\n            return createAdditiveCounter(value, 1, 10999, HEBREW, _listStyle.LIST_STYLE_TYPE.DECIMAL, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.HIRAGANA:\n            return createCounterStyleFromSymbols(value, 'あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん');\n        case _listStyle.LIST_STYLE_TYPE.HIRAGANA_IROHA:\n            return createCounterStyleFromSymbols(value, 'いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす');\n        case _listStyle.LIST_STYLE_TYPE.KANNADA:\n            return createCounterStyleFromRange(value, 0xce6, 0xcef, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.KATAKANA:\n            return createCounterStyleFromSymbols(value, 'アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン', cjkSuffix);\n        case _listStyle.LIST_STYLE_TYPE.KATAKANA_IROHA:\n            return createCounterStyleFromSymbols(value, 'イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス', cjkSuffix);\n        case _listStyle.LIST_STYLE_TYPE.LAO:\n            return createCounterStyleFromRange(value, 0xed0, 0xed9, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.MONGOLIAN:\n            return createCounterStyleFromRange(value, 0x1810, 0x1819, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.MYANMAR:\n            return createCounterStyleFromRange(value, 0x1040, 0x1049, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.ORIYA:\n            return createCounterStyleFromRange(value, 0xb66, 0xb6f, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.PERSIAN:\n            return createCounterStyleFromRange(value, 0x6f0, 0x6f9, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.TAMIL:\n            return createCounterStyleFromRange(value, 0xbe6, 0xbef, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.TELUGU:\n            return createCounterStyleFromRange(value, 0xc66, 0xc6f, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.THAI:\n            return createCounterStyleFromRange(value, 0xe50, 0xe59, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.TIBETAN:\n            return createCounterStyleFromRange(value, 0xf20, 0xf29, true, defaultSuffix);\n        case _listStyle.LIST_STYLE_TYPE.DECIMAL:\n        default:\n            return createCounterStyleFromRange(value, 48, 57, true, defaultSuffix);\n    }\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar toCodePoints = exports.toCodePoints = function toCodePoints(str) {\n    var codePoints = [];\n    var i = 0;\n    var length = str.length;\n    while (i < length) {\n        var value = str.charCodeAt(i++);\n        if (value >= 0xd800 && value <= 0xdbff && i < length) {\n            var extra = str.charCodeAt(i++);\n            if ((extra & 0xfc00) === 0xdc00) {\n                codePoints.push(((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000);\n            } else {\n                codePoints.push(value);\n                i--;\n            }\n        } else {\n            codePoints.push(value);\n        }\n    }\n    return codePoints;\n};\n\nvar fromCodePoint = exports.fromCodePoint = function fromCodePoint() {\n    if (String.fromCodePoint) {\n        return String.fromCodePoint.apply(String, arguments);\n    }\n\n    var length = arguments.length;\n    if (!length) {\n        return '';\n    }\n\n    var codeUnits = [];\n\n    var index = -1;\n    var result = '';\n    while (++index < length) {\n        var codePoint = arguments.length <= index ? undefined : arguments[index];\n        if (codePoint <= 0xffff) {\n            codeUnits.push(codePoint);\n        } else {\n            codePoint -= 0x10000;\n            codeUnits.push((codePoint >> 10) + 0xd800, codePoint % 0x400 + 0xdc00);\n        }\n        if (index + 1 === length || codeUnits.length > 0x4000) {\n            result += String.fromCharCode.apply(String, codeUnits);\n            codeUnits.length = 0;\n        }\n    }\n    return result;\n};\n\nvar chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n// Use a lookup table to find the index.\nvar lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (var i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\n\nvar decode = exports.decode = function decode(base64) {\n    var bufferLength = base64.length * 0.75,\n        len = base64.length,\n        i = void 0,\n        p = 0,\n        encoded1 = void 0,\n        encoded2 = void 0,\n        encoded3 = void 0,\n        encoded4 = void 0;\n\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n\n    var buffer = typeof ArrayBuffer !== 'undefined' && typeof Uint8Array !== 'undefined' && typeof Uint8Array.prototype.slice !== 'undefined' ? new ArrayBuffer(bufferLength) : new Array(bufferLength);\n    var bytes = Array.isArray(buffer) ? buffer : new Uint8Array(buffer);\n\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n\n        bytes[p++] = encoded1 << 2 | encoded2 >> 4;\n        bytes[p++] = (encoded2 & 15) << 4 | encoded3 >> 2;\n        bytes[p++] = (encoded3 & 3) << 6 | encoded4 & 63;\n    }\n\n    return buffer;\n};\n\nvar polyUint16Array = exports.polyUint16Array = function polyUint16Array(buffer) {\n    var length = buffer.length;\n    var bytes = [];\n    for (var _i = 0; _i < length; _i += 2) {\n        bytes.push(buffer[_i + 1] << 8 | buffer[_i]);\n    }\n    return bytes;\n};\n\nvar polyUint32Array = exports.polyUint32Array = function polyUint32Array(buffer) {\n    var length = buffer.length;\n    var bytes = [];\n    for (var _i2 = 0; _i2 < length; _i2 += 4) {\n        bytes.push(buffer[_i2 + 3] << 24 | buffer[_i2 + 2] << 16 | buffer[_i2 + 1] << 8 | buffer[_i2]);\n    }\n    return bytes;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.parseBorder = exports.BORDER_SIDES = exports.BORDER_STYLE = undefined;\n\nvar _Color = require('../Color');\n\nvar _Color2 = _interopRequireDefault(_Color);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar BORDER_STYLE = exports.BORDER_STYLE = {\n    NONE: 0,\n    SOLID: 1\n};\n\nvar BORDER_SIDES = exports.BORDER_SIDES = {\n    TOP: 0,\n    RIGHT: 1,\n    BOTTOM: 2,\n    LEFT: 3\n};\n\nvar SIDES = Object.keys(BORDER_SIDES).map(function (s) {\n    return s.toLowerCase();\n});\n\nvar parseBorderStyle = function parseBorderStyle(style) {\n    switch (style) {\n        case 'none':\n            return BORDER_STYLE.NONE;\n    }\n    return BORDER_STYLE.SOLID;\n};\n\nvar parseBorder = exports.parseBorder = function parseBorder(style) {\n    return SIDES.map(function (side) {\n        var borderColor = new _Color2.default(style.getPropertyValue('border-' + side + '-color'));\n        var borderStyle = parseBorderStyle(style.getPropertyValue('border-' + side + '-style'));\n        var borderWidth = parseFloat(style.getPropertyValue('border-' + side + '-width'));\n        return {\n            borderColor: borderColor,\n            borderStyle: borderStyle,\n            borderWidth: isNaN(borderWidth) ? 0 : borderWidth\n        };\n    });\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.parseTextDecoration = exports.TEXT_DECORATION_LINE = exports.TEXT_DECORATION = exports.TEXT_DECORATION_STYLE = undefined;\n\nvar _Color = require('../Color');\n\nvar _Color2 = _interopRequireDefault(_Color);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar TEXT_DECORATION_STYLE = exports.TEXT_DECORATION_STYLE = {\n    SOLID: 0,\n    DOUBLE: 1,\n    DOTTED: 2,\n    DASHED: 3,\n    WAVY: 4\n};\n\nvar TEXT_DECORATION = exports.TEXT_DECORATION = {\n    NONE: null\n};\n\nvar TEXT_DECORATION_LINE = exports.TEXT_DECORATION_LINE = {\n    UNDERLINE: 1,\n    OVERLINE: 2,\n    LINE_THROUGH: 3,\n    BLINK: 4\n};\n\nvar parseLine = function parseLine(line) {\n    switch (line) {\n        case 'underline':\n            return TEXT_DECORATION_LINE.UNDERLINE;\n        case 'overline':\n            return TEXT_DECORATION_LINE.OVERLINE;\n        case 'line-through':\n            return TEXT_DECORATION_LINE.LINE_THROUGH;\n    }\n    return TEXT_DECORATION_LINE.BLINK;\n};\n\nvar parseTextDecorationLine = function parseTextDecorationLine(line) {\n    if (line === 'none') {\n        return null;\n    }\n\n    return line.split(' ').map(parseLine);\n};\n\nvar parseTextDecorationStyle = function parseTextDecorationStyle(style) {\n    switch (style) {\n        case 'double':\n            return TEXT_DECORATION_STYLE.DOUBLE;\n        case 'dotted':\n            return TEXT_DECORATION_STYLE.DOTTED;\n        case 'dashed':\n            return TEXT_DECORATION_STYLE.DASHED;\n        case 'wavy':\n            return TEXT_DECORATION_STYLE.WAVY;\n    }\n    return TEXT_DECORATION_STYLE.SOLID;\n};\n\nvar parseTextDecoration = exports.parseTextDecoration = function parseTextDecoration(style) {\n    var textDecorationLine = parseTextDecorationLine(style.textDecorationLine ? style.textDecorationLine : style.textDecoration);\n    if (textDecorationLine === null) {\n        return TEXT_DECORATION.NONE;\n    }\n\n    var textDecorationColor = style.textDecorationColor ? new _Color2.default(style.textDecorationColor) : null;\n    var textDecorationStyle = parseTextDecorationStyle(style.textDecorationStyle);\n\n    return {\n        textDecorationLine: textDecorationLine,\n        textDecorationColor: textDecorationColor,\n        textDecorationStyle: textDecorationStyle\n    };\n};","export enum EdgeScaleType {\n  /** All dimensions are within world space */\n  NONE,\n  /**\n   * The control points are a delta from the end points within screen space, and the line thickness is within\n   * screen space as well all measured in pixels. The scaleFactor scales both thickness and control delta values.\n   * The endpoints remain in world space\n   */\n  SCREEN_CURVE\n}\n\nexport enum EdgeType {\n  /** Makes a straight edge with no curve */\n  LINE,\n  /** Makes a single control point Bezier curve */\n  BEZIER,\n  /** Makes a two control point bezier curve */\n  BEZIER2\n}\n\n/**\n * This is the broadphase control for edges to help handle quad tree adjustments for picking. If the edge scale type\n * is NONE, you don't need to utilize this. If you use screen space and have camera distortions along an axis, this\n * can help greatly.\n */\nexport enum EdgeBroadphase {\n  /** Use this if the broad phase detection should use both width and height of the edge's bounds */\n  ALL,\n  /** Use this to ensure a test against the edge is performed if the mouse aligns with it on the x-axis */\n  PASS_Y,\n  /** Use this to ensure a test against the edge is performed if the mouse aligns with it on the y axis */\n  PASS_X\n}\n","import { Instance, InstanceDiff } from \"../../../instance-provider\";\nimport { isResourceAttribute } from \"../../../types\";\nimport { Vec4 } from \"../../../util/vector\";\nimport { BaseDiffProcessor } from \"../base-diff-processor\";\nimport { IInstanceDiffManagerTarget } from \"../instance-diff-manager\";\nimport {\n  isUniformBufferLocation,\n  IUniformBufferLocation\n} from \"./uniform-buffer-manager\";\n\n// This is a mapping of the vector properties as they relate to an array order\nconst EMPTY: number[] = [];\n\n/**\n * Manages diffs for layers that are utilizing the base uniform instancing buffer strategy.\n */\nexport class UniformDiffProcessor<T extends Instance> extends BaseDiffProcessor<\n  T\n> {\n  /**\n   * This processes add operations from changes in the instancing data\n   */\n  addInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    uniformCluster?: IUniformBufferLocation\n  ) {\n    // If the uniform cluster already exists, then we swap over to a change update\n    if (uniformCluster) {\n      manager.changeInstance(manager, instance, EMPTY, uniformCluster);\n    } else {\n      // Otherwise, we DO need to perform an add and we link a Uniform cluster to our instance\n      const uniforms = manager.layer.bufferManager.add(instance);\n\n      if (isUniformBufferLocation(uniforms)) {\n        instance.active = true;\n        instance.easingId = manager.layer.easingId;\n        manager.updateInstance(manager.layer, instance, uniforms);\n      }\n    }\n  }\n\n  /**\n   * This processes change operations from changes in the instancing data\n   */\n  changeInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    uniformCluster?: IUniformBufferLocation\n  ) {\n    // If there is an existing uniform cluster for this instance, then we can update the uniforms\n    if (uniformCluster) {\n      manager.updateInstance(manager.layer, instance, uniformCluster);\n    } else {\n      // If we don't have existing uniforms, then we must remove the instance\n      manager.addInstance(manager, instance, EMPTY, uniformCluster);\n    }\n  }\n\n  /**\n   * This processes remove operations from changes in the instancing data\n   */\n  removeInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    uniformCluster?: IUniformBufferLocation\n  ) {\n    if (uniformCluster) {\n      // We deactivate the instance so it does not render anymore\n      instance.active = false;\n      // Remove the easing information the instance gained from being apart of the layer\n      instance.clearEasing();\n      // We do one last update on the instance to update to it's deactivated state\n      manager.updateInstance(manager.layer, instance, uniformCluster);\n      // Unlink the instance from the uniform cluster\n      manager.layer.bufferManager.remove(instance);\n    }\n  }\n\n  /**\n   * This performs the actual updating of buffers the instance needs to update\n   */\n  updateInstance(\n    layer: IInstanceDiffManagerTarget<T>,\n    instance: T,\n    uniformCluster: IUniformBufferLocation\n  ) {\n    if (instance.active) {\n      const uniforms = uniformCluster.buffer;\n      const uniformRangeStart = uniformCluster.range[0];\n      const instanceData: Vec4[] = uniforms.value;\n      let instanceUniform, value, block, start;\n      let k: number, endk;\n\n      // Loop through the instance attributes and update the uniform cluster with the valaues\n      // Calculated for the instance\n      for (let i = 0, end = layer.instanceAttributes.length; i < end; ++i) {\n        instanceUniform = layer.instanceAttributes[i];\n        value = instanceUniform.update(instance);\n        block = instanceData[uniformRangeStart + (instanceUniform.block || 0)];\n        isResourceAttribute(instanceUniform) &&\n          layer.resource.setAttributeContext(\n            instanceUniform,\n            instanceUniform.resource.type\n          );\n        start = instanceUniform.blockIndex;\n\n        if (start === undefined) {\n          continue;\n        }\n\n        // Vec4 updating routine. Makes sure the correct components are updated for the provided values\n        for (k = start, endk = value.length + start; k < endk; ++k) {\n          block[k] = value[k - start];\n        }\n      }\n\n      uniforms.value = instanceData;\n    } else {\n      const uniforms = uniformCluster.buffer;\n      const uniformRangeStart = uniformCluster.range[0];\n      const instanceData: Vec4[] = uniforms.value;\n      let instanceUniform, value, block, start;\n\n      // Only update the _active attribute to ensure it is false. When it is false, there is no\n      // Point to updating any other uniform\n      instanceUniform = layer.activeAttribute;\n      value = instanceUniform.update(instance);\n      block = instanceData[uniformRangeStart + (instanceUniform.block || 0)];\n      isResourceAttribute(instanceUniform) &&\n        layer.resource.setAttributeContext(\n          instanceUniform,\n          instanceUniform.resource.type\n        );\n      start = instanceUniform.blockIndex;\n\n      if (start !== undefined) {\n        // Hyper optimized vector filling routine. It uses properties that are globally scoped\n        // To greatly reduce overhead\n        for (\n          let k: number = start, endk = value.length + start;\n          k < endk;\n          ++k\n        ) {\n          block[k] = value[k - start];\n        }\n      }\n\n      uniforms.value = instanceData;\n    }\n  }\n\n  /**\n   * Right now there is no operations for committing for the uniform manager.\n   */\n  commit() {\n    /** no-op */\n  }\n\n  /**\n   * There are no optimizations available for this processor yet.\n   */\n  incomingChangeList(_changes: InstanceDiff<T>[]) {\n    /** no-op */\n  }\n}\n","import { Instance } from \"../../../instance-provider/instance\";\nimport { InstanceDiff } from \"../../../instance-provider/instance-provider\";\nimport {\n  IInstanceAttributeInternal,\n  isResourceAttribute\n} from \"../../../types\";\nimport { Vec } from \"../../../util\";\nimport { BaseDiffProcessor } from \"../base-diff-processor\";\nimport {\n  IBufferLocation,\n  IBufferLocationGroup,\n  isBufferLocationGroup\n} from \"../buffer-manager-base\";\nimport { IInstanceDiffManagerTarget } from \"../instance-diff-manager\";\nimport {\n  IInstanceAttributeBufferLocation,\n  IInstanceAttributeBufferLocationGroup\n} from \"./instance-attribute-buffer-manager\";\n\nconst EMPTY: number[] = [];\nconst { min, max } = Math;\n\nenum DiffMode {\n  /** This mode will analyze incoming buffer location changes and only update the range of changed buffer */\n  PARTIAL,\n  /** This mode will not spend time figuring out what has changed for a buffer, rather the whole buffer will get an update */\n  FULL\n}\n\n/**\n * Manages diffs for layers that are utilizing the base uniform instancing buffer strategy.\n */\nexport class InstanceAttributeDiffProcessor<\n  T extends Instance\n> extends BaseDiffProcessor<T> {\n  /** This is the processor's current diff mode for consuming instance updates. */\n  private diffMode: DiffMode = DiffMode.PARTIAL;\n\n  /** This tracks a buffer attribute's uid to the range of data that it should update */\n  bufferAttributeUpdateRange: {\n    [key: number]: [IInstanceAttributeInternal<T>, number, number];\n  } = {};\n\n  /** This tracks a buffer attribute's uid that will perform a complete update */\n  bufferAttributeWillUpdate: {\n    [key: number]: IInstanceAttributeInternal<T>;\n  } = {};\n\n  /**\n   * The instance updating is a property instead of a method as we will want to be able to gear shift it for varying levels\n   * of adjustments.\n   */\n  updateInstance: (\n    layer: IInstanceDiffManagerTarget<T>,\n    instance: T,\n    propIds: number[],\n    bufferLocations: IBufferLocationGroup<IBufferLocation>\n  ) => void = this.updateInstancePartial;\n\n  /**\n   * This processes add operations from changes in the instancing data\n   */\n  addInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    bufferLocations?: IInstanceAttributeBufferLocationGroup\n  ) {\n    // If the uniform cluster already exists, then we swap over to a change update\n    if (bufferLocations) {\n      manager.changeInstance(manager, instance, EMPTY, bufferLocations);\n    } else {\n      // Otherwise, we DO need to perform an add and we link a Uniform cluster to our instance\n      const newBufferLocations = manager.layer.bufferManager.add(instance);\n\n      if (isBufferLocationGroup(newBufferLocations)) {\n        instance.active = true;\n        instance.easingId = manager.layer.easingId;\n\n        manager.updateInstance(\n          manager.layer,\n          instance,\n          EMPTY,\n          newBufferLocations\n        );\n      }\n    }\n  }\n\n  /**\n   * This processes change operations from changes in the instancing data\n   */\n  changeInstance(\n    manager: this,\n    instance: T,\n    propIds: number[],\n    bufferLocations?: IInstanceAttributeBufferLocationGroup\n  ) {\n    // If there is an existing uniform cluster for this instance, then we can update the bufferLocations\n    if (bufferLocations) {\n      manager.updateInstance(manager.layer, instance, propIds, bufferLocations);\n    } else {\n      // If we don't have existing bufferLocations, then we must add the instance\n      manager.addInstance(manager, instance, EMPTY, bufferLocations);\n    }\n  }\n\n  /**\n   * This processes remove operations from changes in the instancing data\n   */\n  removeInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    bufferLocations?: IInstanceAttributeBufferLocationGroup\n  ) {\n    if (bufferLocations) {\n      // We deactivate the instance so it does not render anymore\n      instance.active = false;\n      // Remove the easing information the instance gained from being apart of the layer\n      instance.clearEasing();\n      // We do one last update on the instance to update to it's deactivated state\n      manager.updateInstance(manager.layer, instance, EMPTY, bufferLocations);\n      // Unlink the instance from the uniform cluster\n      manager.layer.bufferManager.remove(instance);\n    }\n  }\n\n  /**\n   * This performs the actual updating of buffers the instance needs to update\n   */\n  updateInstancePartial(\n    layer: IInstanceDiffManagerTarget<T>,\n    instance: T,\n    propIds: number[],\n    bufferLocations: IBufferLocationGroup<IInstanceAttributeBufferLocation>\n  ) {\n    const propertyToLocation = bufferLocations.propertyToBufferLocation;\n    const bufferAttributeUpdateRange = this.bufferAttributeUpdateRange;\n    const resourceManager = layer.resource;\n\n    let location: IInstanceAttributeBufferLocation;\n    let updateValue: Vec;\n    let updateRange;\n    let childLocations: IInstanceAttributeBufferLocation[];\n    let attribute: IInstanceAttributeInternal<T>;\n    let attributeChangeUID;\n\n    if (instance.active) {\n      // If no prop ids provided, then we perform a complete instance property update\n      if (propIds.length === 0) {\n        propIds = this.bufferManager.getUpdateAllPropertyIdList();\n      }\n\n      for (let i = 0, end = propIds.length; i < end; ++i) {\n        // First update for the instance attribute itself\n        location = propertyToLocation[propIds[i]];\n        attribute = location.attribute;\n        attributeChangeUID = attribute.packUID || attribute.uid;\n        isResourceAttribute(attribute) &&\n          resourceManager.setAttributeContext(\n            attribute,\n            attribute.resource.type\n          );\n        updateValue = attribute.update(instance);\n        location.buffer.value.set(updateValue, location.range[0]);\n        updateRange = bufferAttributeUpdateRange[attributeChangeUID] || [\n          null,\n          Number.MAX_SAFE_INTEGER,\n          Number.MIN_SAFE_INTEGER\n        ];\n        updateRange[0] = attribute;\n        updateRange[1] = min(location.range[0], updateRange[1]);\n        updateRange[2] = max(location.range[1], updateRange[2]);\n        bufferAttributeUpdateRange[attributeChangeUID] = updateRange;\n\n        // Now update any child attributes that would need updating based on the parent attribute changing\n        if (location.childLocations) {\n          childLocations = location.childLocations;\n\n          for (let k = 0, endk = childLocations.length; k < endk; ++k) {\n            location = childLocations[k];\n            attributeChangeUID =\n              location.attribute.packUID || location.attribute.uid;\n            updateValue = location.attribute.update(instance);\n            location.buffer.value.set(updateValue, location.range[0]);\n            updateRange = bufferAttributeUpdateRange[attributeChangeUID] || [\n              null,\n              Number.MAX_SAFE_INTEGER,\n              Number.MIN_SAFE_INTEGER\n            ];\n            updateRange[0] = location.attribute;\n            updateRange[1] = min(location.range[0], updateRange[1]);\n            updateRange[2] = max(location.range[1], updateRange[2]);\n            bufferAttributeUpdateRange[attributeChangeUID] = updateRange;\n          }\n        }\n      }\n    } else {\n      // When the instance is inactive all we update is the active attribute to false\n      location =\n        propertyToLocation[this.bufferManager.getActiveAttributePropertyId()];\n      attribute = location.attribute;\n      attributeChangeUID = attribute.packUID || attribute.uid;\n      updateValue = attribute.update(instance);\n      location.buffer.value.set(updateValue, location.range[0]);\n      updateRange = bufferAttributeUpdateRange[attributeChangeUID] || [\n        null,\n        Number.MAX_SAFE_INTEGER,\n        Number.MIN_SAFE_INTEGER\n      ];\n      updateRange[0] = attribute;\n      updateRange[1] = min(location.range[0], updateRange[1]);\n      updateRange[2] = max(location.range[1], updateRange[2]);\n      bufferAttributeUpdateRange[attributeChangeUID] = updateRange;\n    }\n  }\n\n  /**\n   * This performs an update on the buffers with the intent the entire buffer is going to update\n   * rather than a chunk of it.\n   */\n  updateInstanceFull(\n    layer: IInstanceDiffManagerTarget<T>,\n    instance: T,\n    propIds: number[],\n    bufferLocations: IBufferLocationGroup<IInstanceAttributeBufferLocation>\n  ) {\n    const propertyToLocation = bufferLocations.propertyToBufferLocation;\n    const bufferAttributeWillUpdate = this.bufferAttributeWillUpdate;\n    const resourceManager = layer.resource;\n\n    let location: IInstanceAttributeBufferLocation;\n    let updateValue: Vec;\n    let childLocations: IInstanceAttributeBufferLocation[];\n    let attribute: IInstanceAttributeInternal<T>;\n\n    if (instance.active) {\n      // If no prop ids provided, then we perform a complete instance property update\n      if (propIds.length === 0) {\n        propIds = this.bufferManager.getUpdateAllPropertyIdList();\n      }\n\n      for (let i = 0, end = propIds.length; i < end; ++i) {\n        // First update for the instance attribute itself\n        location = propertyToLocation[propIds[i]];\n        attribute = location.attribute;\n        isResourceAttribute(attribute) &&\n          resourceManager.setAttributeContext(\n            attribute,\n            attribute.resource.type\n          );\n        updateValue = attribute.update(instance);\n        location.buffer.value.set(updateValue, location.range[0]);\n        bufferAttributeWillUpdate[\n          attribute.packUID || attribute.uid\n        ] = attribute;\n\n        // Now update any child attributes that would need updating based on the parent attribute changing\n        if (location.childLocations) {\n          childLocations = location.childLocations;\n\n          for (let k = 0, endk = childLocations.length; k < endk; ++k) {\n            location = childLocations[k];\n            attribute = location.attribute;\n            updateValue = attribute.update(instance);\n            location.buffer.value.set(updateValue, location.range[0]);\n            bufferAttributeWillUpdate[\n              attribute.packUID || attribute.uid\n            ] = attribute;\n          }\n        }\n      }\n    } else {\n      // When the instance is inactive all we update is the active attribute to false\n      location =\n        propertyToLocation[this.bufferManager.getActiveAttributePropertyId()];\n      attribute = location.attribute;\n      isResourceAttribute(attribute) &&\n        resourceManager.setAttributeContext(attribute, attribute.resource.type);\n      updateValue = attribute.update(instance);\n      location.buffer.value.set(updateValue, location.range[0]);\n      bufferAttributeWillUpdate[attribute.packUID || attribute.uid] = attribute;\n    }\n  }\n\n  /**\n   * Finalize all of the buffer changes and apply the correct update ranges\n   */\n  commit() {\n    // If we're in a partial mode: just update the portion of the buffer that needs updating.\n    if (this.diffMode === DiffMode.PARTIAL) {\n      // We now grab all of the attributes and set their update ranges\n      const updates = Object.values(this.bufferAttributeUpdateRange);\n\n      for (let i = 0, end = updates.length; i < end; ++i) {\n        const update = updates[i];\n        const attribute = update[0].bufferAttribute;\n        attribute.updateRange = {\n          count: update[2] - update[1],\n          offset: update[1]\n        };\n      }\n    } else {\n      // Otherwise just update the full buffer\n      // We now grab all of the attributes and set their update ranges\n      const updates = Object.values(this.bufferAttributeWillUpdate);\n\n      for (let i = 0, end = updates.length; i < end; ++i) {\n        const attribute = updates[i].bufferAttribute;\n        attribute.updateRange = {\n          count: -1,\n          offset: 0\n        };\n      }\n    }\n\n    // Clear the attribute update metrics\n    this.bufferAttributeUpdateRange = {};\n  }\n\n  /**\n   * This will optimize the update method used. If there are enough instances being updated, we will\n   * cause the entire attribute buffer to update. If there are not enough, then we will update with\n   * additional steps to only update the chunks of the buffer that are affected by the changelist.\n   */\n  incomingChangeList(changes: InstanceDiff<T>[]) {\n    if (changes.length === 0) {\n      this.diffMode = DiffMode.PARTIAL;\n    } else if (changes.length > this.bufferManager.getInstanceCount() * 0.7) {\n      this.diffMode = DiffMode.FULL;\n    } else {\n      this.diffMode = DiffMode.PARTIAL;\n    }\n\n    if (this.diffMode === DiffMode.PARTIAL) {\n      this.updateInstance = this.updateInstancePartial;\n    } else {\n      this.updateInstance = this.updateInstanceFull;\n    }\n  }\n}\n","/**\n * This is the name used in the shader generated by the system to handle uniform buffer instancing.\n */\nexport const uniformBufferInstanceBufferName = \"instanceData\";\n/**\n * This is the identifying name used as the active atttribute\n * that determines if an instance is rendered or not.\n */\nexport const activeAttributeName = \"_active\";\n","import { Model } from \"./model\";\n\n/**\n * This is an object that contains a list of buffers and state for those buffers to\n * be rendered together.\n */\nexport class Scene {\n  /** The models this scene will render. They will be rendered in the order they were insertted */\n  models = new Set<Model>();\n\n  /**\n   * Add a model to be rendered within the scene\n   */\n  add(model: Model) {\n    this.models.add(model);\n  }\n\n  /**\n   * Remove a model from the scene\n   */\n  remove(model: Model) {\n    this.models.delete(model);\n  }\n}\n","import { GLSettings } from \"./gl-settings\";\nimport { GLContext, IExtensions } from \"./types\";\n\n/**\n * This file contains all method used to decode/encode GLSettings to GL types\n */\n\n/**\n * Decodes a DrawMode to a GL setting\n */\nexport function drawMode(gl: GLContext, mode: GLSettings.Model.DrawMode) {\n  switch (mode) {\n    case GLSettings.Model.DrawMode.LINES:\n      return gl.LINES;\n    case GLSettings.Model.DrawMode.LINE_LOOP:\n      return gl.LINE_LOOP;\n    case GLSettings.Model.DrawMode.LINE_STRIP:\n      return gl.LINE_STRIP;\n    case GLSettings.Model.DrawMode.POINTS:\n      return gl.POINTS;\n    case GLSettings.Model.DrawMode.TRIANGLES:\n      return gl.TRIANGLES;\n    case GLSettings.Model.DrawMode.TRIANGLE_FAN:\n      return gl.TRIANGLE_FAN;\n    case GLSettings.Model.DrawMode.TRIANGLE_STRIP:\n      return gl.TRIANGLE_STRIP;\n\n    default:\n      return gl.TRIANGLES;\n  }\n}\n\n/**\n * Decodes the TexelDataType to a GL setting\n */\nexport function texelFormat(\n  gl: GLContext,\n  format: GLSettings.Texture.TexelDataType\n) {\n  switch (format) {\n    case GLSettings.Texture.TexelDataType.Alpha:\n      return gl.ALPHA;\n    case GLSettings.Texture.TexelDataType.DepthComponent:\n      return gl.DEPTH_COMPONENT;\n    case GLSettings.Texture.TexelDataType.DepthStencil:\n      return gl.DEPTH_STENCIL;\n    case GLSettings.Texture.TexelDataType.Luminance:\n      return gl.LUMINANCE;\n    case GLSettings.Texture.TexelDataType.LuminanceAlpha:\n      return gl.LUMINANCE_ALPHA;\n    case GLSettings.Texture.TexelDataType.RGB:\n      return gl.RGB;\n    case GLSettings.Texture.TexelDataType.RGBA:\n      return gl.RGBA;\n\n    default:\n      console.warn(\"An Unsupported texel format was provided\", format);\n      return gl.RGBA;\n  }\n}\n\n/**\n * Decodes the SourcePixelFormat to a GL setting\n */\nexport function inputImageFormat(\n  gl: GLContext,\n  format: GLSettings.Texture.SourcePixelFormat\n) {\n  switch (format) {\n    case GLSettings.Texture.SourcePixelFormat.Byte:\n      return gl.BYTE;\n    case GLSettings.Texture.SourcePixelFormat.Float:\n      return gl.FLOAT;\n    case GLSettings.Texture.SourcePixelFormat.HalfFloat:\n      console.warn(\"Unsupported HALF_FLOAT\");\n      return gl.BYTE;\n    case GLSettings.Texture.SourcePixelFormat.Int:\n      return gl.INT;\n    case GLSettings.Texture.SourcePixelFormat.Short:\n      return gl.SHORT;\n    case GLSettings.Texture.SourcePixelFormat.UnsignedByte:\n      return gl.UNSIGNED_BYTE;\n    case GLSettings.Texture.SourcePixelFormat.UnsignedInt:\n      return gl.UNSIGNED_INT;\n    case GLSettings.Texture.SourcePixelFormat.UnsignedShort:\n      return gl.UNSIGNED_SHORT;\n    case GLSettings.Texture.SourcePixelFormat.UnsignedShort_4_4_4_4:\n      return gl.UNSIGNED_SHORT_4_4_4_4;\n    case GLSettings.Texture.SourcePixelFormat.UnsignedShort_5_5_5_1:\n      return gl.UNSIGNED_SHORT_5_5_5_1;\n    case GLSettings.Texture.SourcePixelFormat.UnsignedShort_5_6_5:\n      return gl.UNSIGNED_SHORT_5_6_5;\n\n    default:\n      console.warn(\"An Unsupported input image format was provided\", format);\n      return gl.BYTE;\n  }\n}\n\n/**\n * Decodes TextureMagFilter to a GL setting\n */\nexport function magFilter(\n  gl: GLContext,\n  filter: GLSettings.Texture.TextureMagFilter,\n  isPowerOf2: boolean\n) {\n  if (!isPowerOf2) {\n    return gl.LINEAR;\n  }\n\n  switch (filter) {\n    case GLSettings.Texture.TextureMagFilter.Linear:\n      return gl.LINEAR;\n    case GLSettings.Texture.TextureMagFilter.Nearest:\n      return gl.NEAREST;\n  }\n}\n\n/**\n * Decodes TextureMinFilter to a GL setting\n */\nexport function minFilter(\n  gl: GLContext,\n  filter: GLSettings.Texture.TextureMinFilter,\n  isPowerOf2: boolean,\n  hasMipMaps: boolean\n) {\n  if (!isPowerOf2) {\n    return gl.LINEAR;\n  }\n\n  switch (filter) {\n    case GLSettings.Texture.TextureMinFilter.Linear:\n      return gl.LINEAR;\n    case GLSettings.Texture.TextureMinFilter.Nearest:\n      return gl.NEAREST;\n    case GLSettings.Texture.TextureMinFilter.LinearMipMapLinear:\n      return hasMipMaps ? gl.LINEAR_MIPMAP_LINEAR : gl.LINEAR;\n    case GLSettings.Texture.TextureMinFilter.LinearMipMapNearest:\n      return hasMipMaps ? gl.LINEAR_MIPMAP_NEAREST : gl.LINEAR;\n    case GLSettings.Texture.TextureMinFilter.NearestMipMapLinear:\n      return hasMipMaps ? gl.NEAREST_MIPMAP_LINEAR : gl.NEAREST;\n    case GLSettings.Texture.TextureMinFilter.NearestMipMapNearest:\n      return hasMipMaps ? gl.NEAREST_MIPMAP_NEAREST : gl.NEAREST;\n\n    default:\n      return gl.LINEAR;\n  }\n}\n\n/**\n * Decodes a ColorBufferFormat to valid color render buffer storage formats\n */\nexport function colorBufferFormat(\n  gl: GLContext,\n  format: GLSettings.RenderTarget.ColorBufferFormat\n) {\n  switch (format) {\n    case GLSettings.RenderTarget.ColorBufferFormat.RGB565:\n      return gl.RGB565;\n    case GLSettings.RenderTarget.ColorBufferFormat.RGB5_A1:\n      return gl.RGB5_A1;\n    case GLSettings.RenderTarget.ColorBufferFormat.RGBA4:\n      return gl.RGBA4;\n\n    default:\n      return gl.RGBA4;\n  }\n}\n\n/**\n * Decodes a DepthBufferFormat to valid color depth buffer storage formats\n */\nexport function depthBufferFormat(\n  gl: GLContext,\n  format: GLSettings.RenderTarget.DepthBufferFormat\n) {\n  switch (format) {\n    case GLSettings.RenderTarget.DepthBufferFormat.DEPTH_COMPONENT16:\n      return gl.DEPTH_COMPONENT16;\n    case GLSettings.RenderTarget.DepthBufferFormat.DEPTH_STENCIL:\n      return gl.DEPTH_STENCIL;\n\n    default:\n      return gl.DEPTH_COMPONENT16;\n  }\n}\n\n/**\n * Decodes a StencilBufferFormat to valid stencil render buffer storage formats\n */\nexport function stencilBufferFormat(\n  gl: GLContext,\n  format: GLSettings.RenderTarget.StencilBufferFormat\n) {\n  switch (format) {\n    case GLSettings.RenderTarget.StencilBufferFormat.STENCIL_INDEX8:\n      return gl.STENCIL_INDEX8;\n\n    default:\n      return gl.STENCIL_INDEX8;\n  }\n}\n\n/**\n * Decodes Wrapping to a GL setting\n */\nexport function wrapMode(gl: GLContext, mode: GLSettings.Texture.Wrapping) {\n  switch (mode) {\n    case GLSettings.Texture.Wrapping.CLAMP_TO_EDGE:\n      return gl.CLAMP_TO_EDGE;\n    case GLSettings.Texture.Wrapping.MIRRORED_REPEAT:\n      return gl.MIRRORED_REPEAT;\n    case GLSettings.Texture.Wrapping.REPEAT:\n      return gl.REPEAT;\n  }\n}\n\n/**\n * Decodes an index to an appropriate color attachment for a frame buffer\n */\nexport function indexToColorAttachment(\n  gl: GLContext,\n  extensions: IExtensions,\n  index: number,\n  isSingleBuffer: boolean\n) {\n  if (isSingleBuffer) {\n    return gl.COLOR_ATTACHMENT0;\n  }\n\n  const glExt = extensions.drawBuffers;\n\n  if (glExt instanceof WebGL2RenderingContext) {\n    switch (index) {\n      case 0:\n        return glExt.COLOR_ATTACHMENT0;\n      case 1:\n        return glExt.COLOR_ATTACHMENT1;\n      case 2:\n        return glExt.COLOR_ATTACHMENT2;\n      case 3:\n        return glExt.COLOR_ATTACHMENT3;\n      case 4:\n        return glExt.COLOR_ATTACHMENT4;\n      case 5:\n        return glExt.COLOR_ATTACHMENT5;\n      case 6:\n        return glExt.COLOR_ATTACHMENT6;\n      case 7:\n        return glExt.COLOR_ATTACHMENT7;\n      case 8:\n        return glExt.COLOR_ATTACHMENT8;\n      case 9:\n        return glExt.COLOR_ATTACHMENT9;\n      case 10:\n        return glExt.COLOR_ATTACHMENT10;\n      case 11:\n        return glExt.COLOR_ATTACHMENT11;\n      case 12:\n        return glExt.COLOR_ATTACHMENT12;\n      case 13:\n        return glExt.COLOR_ATTACHMENT13;\n      case 14:\n        return glExt.COLOR_ATTACHMENT14;\n      case 15:\n        return glExt.COLOR_ATTACHMENT15;\n    }\n  } else if (glExt) {\n    switch (index) {\n      case 0:\n        return glExt.COLOR_ATTACHMENT0_WEBGL;\n      case 1:\n        return glExt.COLOR_ATTACHMENT1_WEBGL;\n      case 2:\n        return glExt.COLOR_ATTACHMENT2_WEBGL;\n      case 3:\n        return glExt.COLOR_ATTACHMENT3_WEBGL;\n      case 4:\n        return glExt.COLOR_ATTACHMENT4_WEBGL;\n      case 5:\n        return glExt.COLOR_ATTACHMENT5_WEBGL;\n      case 6:\n        return glExt.COLOR_ATTACHMENT6_WEBGL;\n      case 7:\n        return glExt.COLOR_ATTACHMENT7_WEBGL;\n      case 8:\n        return glExt.COLOR_ATTACHMENT8_WEBGL;\n      case 9:\n        return glExt.COLOR_ATTACHMENT9_WEBGL;\n      case 10:\n        return glExt.COLOR_ATTACHMENT10_WEBGL;\n      case 11:\n        return glExt.COLOR_ATTACHMENT11_WEBGL;\n      case 12:\n        return glExt.COLOR_ATTACHMENT12_WEBGL;\n      case 13:\n        return glExt.COLOR_ATTACHMENT13_WEBGL;\n      case 14:\n        return glExt.COLOR_ATTACHMENT14_WEBGL;\n      case 15:\n        return glExt.COLOR_ATTACHMENT15_WEBGL;\n    }\n  }\n\n  return gl.COLOR_ATTACHMENT0;\n}\n\n/**\n * Maps an index to a texture units Enum key to use on a WebGLRenderingContext object\n */\nexport function indexToTextureUnit(gl: GLContext, index: number) {\n  // This is the proper conversion instead of unsing the built in enums. The indices\n  // are controlled via gl.max_texture_image_units. This number can be higher than\n  // the enums indicate.\n  return gl.TEXTURE0 + index;\n}\n\n/**\n * Maps a texture unit to an index that can be used for a uniform.\n */\nexport function textureUnitToIndex(gl: GLContext, unit: number) {\n  // This is the proper conversion instead of unsing the built in enums. The indices\n  // are controlled via gl.max_texture_image_units. This number can be higher than\n  // the enums indicate.\n  return unit - gl.TEXTURE0;\n}\n","import { Camera } from \"./camera\";\n\nexport enum ViewCameraType {\n  /**\n   * Indicates a camera that is forced by the system to follow:\n   * - Match width and height of the view port\n   * - +y axis points downward\n   * - gl origin is at the top left of the screen\n   */\n  CONTROLLED,\n  /**\n   * This allows a custom view camera to be applied to the scene.\n   */\n  CUSTOM\n}\n\n/**\n * This is a camera that controls the view projection matrix. This is a much more\n * complicated way to handle views that is better suited for handling 3D applications\n * and is very overkill for most 2D charting systems. If you are working purely with\n * 2D components, it's recommended to leave this as a CONTROLLED camera and utilize\n * the ChartCamera for most of your needs.\n */\nexport class ViewCamera {\n  type: ViewCameraType = ViewCameraType.CONTROLLED;\n  baseCamera: Camera;\n}\n","import { Vec3 } from \"./vector\";\n\nlet chartCameraUID = 0;\n\nexport interface IChartCameraOptions {\n  /** The world space offset of elements in the chart */\n  offset?: [number] | [number, number] | Vec3;\n  /** The world space scaling present in the chart */\n  scale?: [number] | [number, number] | Vec3;\n}\n\n/**\n * Quick method for applying a source array to a target array. This\n * ensures the arrays both are valid and applies the values without just making\n * a copy of the source.\n */\nfunction applyArray(target?: number[], source?: number[]) {\n  target && source && target.splice(0, source.length, ...source);\n}\n\nexport class ChartCamera {\n  /** Internally set id */\n  private _id: number = chartCameraUID++;\n  /** Represents how much an element should be offset in world space */\n  private _offset: Vec3 = [0, 0, 0];\n  /** Represents how scaled each axis should be in world space */\n  private _scale: Vec3 = [1, 1, 1];\n  /** This indicates whether the view where the camera is in needs drawn */\n  private _needsViewDrawn: boolean = true;\n\n  constructor(options?: IChartCameraOptions) {\n    if (options) {\n      applyArray(this.offset, options.offset);\n      applyArray(this.scale, options.scale);\n    }\n  }\n\n  /** Keep id as readonly */\n  get id() {\n    return this._id;\n  }\n\n  setId(id: number) {\n    this._id = id;\n    this._needsViewDrawn = true;\n  }\n\n  get offset() {\n    return this._offset;\n  }\n\n  /**\n   * Sets the location of the camera by adjusting the offsets to match.\n   */\n  setOffset(offset: Vec3) {\n    this._offset = offset.slice(0) as Vec3;\n    this._needsViewDrawn = true;\n  }\n\n  get scale() {\n    return this._scale;\n  }\n\n  setScale(scale: Vec3) {\n    this._scale = scale;\n    this._needsViewDrawn = true;\n  }\n\n  get needsViewDrawn() {\n    return this._needsViewDrawn;\n  }\n\n  resolve() {\n    this._needsViewDrawn = false;\n  }\n\n  update() {\n    this._needsViewDrawn = true;\n  }\n}\n","import { Bounds } from \"../primitives\";\nimport { IProjection } from \"../types\";\nimport {\n  IDragMetrics,\n  IMouseInteraction,\n  IWheelMetrics,\n  MouseEventManager\n} from \"./mouse-event-manager\";\nimport { View } from \"./view\";\n\n/**\n * Classes can extend this and override the methods to respond to events.\n */\nexport abstract class EventManager {\n  private mouseManager: MouseEventManager;\n\n  abstract handleMouseDown(e: IMouseInteraction, button: number): void;\n  abstract handleMouseUp(e: IMouseInteraction, button: number): void;\n  abstract handleMouseOver(e: IMouseInteraction): void;\n  abstract handleMouseOut(e: IMouseInteraction): void;\n  abstract handleMouseMove(e: IMouseInteraction): void;\n  abstract handleClick(e: IMouseInteraction, button: number): void;\n  abstract handleDrag(e: IMouseInteraction, drag: IDragMetrics): void;\n  abstract handleWheel(e: IMouseInteraction, wheel: IWheelMetrics): void;\n\n  /**\n   * This retrieves the projections for the view specified by the provided viewId.\n   */\n  getProjection(viewId: string): IProjection | null {\n    return this.mouseManager.getView(viewId);\n  }\n\n  /**\n   * This retrieves the actual view for the view specified by the provided viewId.\n   */\n  getView(viewId: string): View | null {\n    return (this.mouseManager && this.mouseManager.getView(viewId)) || null;\n  }\n\n  /**\n   * This retrieves the screen bounds for the view specified by the provided viewId.\n   */\n  getViewScreenBounds(viewId: string): Bounds | null {\n    const view = this.mouseManager.getView(viewId);\n\n    if (view) {\n      return view.screenBounds;\n    }\n\n    return null;\n  }\n\n  /**\n   * This is used internally which provides the parent MouseEventManager via the param mouseManager for this\n   * EventManager.\n   */\n  setMouseManager(mouseManager: MouseEventManager) {\n    this.mouseManager = mouseManager;\n  }\n}\n","import { InstanceProvider } from \"../../instance-provider\";\nimport {\n  fontRequest,\n  FontResourceRequestFetch,\n  IFontResourceRequest\n} from \"../../resources\";\nimport { ILayerProps, Layer } from \"../../surface/layer\";\nimport {\n  createMaterialOptions,\n  IInstanceAttribute,\n  ILayerMaterialOptions,\n  InstanceAttributeSize,\n  IShaderInitialization,\n  ResourceType,\n  VertexAttributeSize\n} from \"../../types\";\nimport {\n  CommonMaterialOptions,\n  IAutoEasingMethod,\n  Vec,\n  Vec2\n} from \"../../util\";\nimport { ScaleMode } from \"../types\";\nimport { GlyphInstance } from \"./glyph-instance\";\n\n/**\n * Options available to this layer as props.\n */\nexport interface IGlyphLayerOptions<T extends GlyphInstance>\n  extends ILayerProps<T> {\n  /** Specifies which attributes to animate */\n  animate?: {\n    anchor?: IAutoEasingMethod<Vec>;\n    color?: IAutoEasingMethod<Vec>;\n    offset?: IAutoEasingMethod<Vec>;\n    origin?: IAutoEasingMethod<Vec>;\n  };\n  /** This is the font resource this pulls from in order to render the glyphs */\n  resourceKey?: string;\n  /** This is the scaling strategy the glyph will use when text is involved. */\n  scaleMode?: ScaleMode;\n}\n\n/**\n * Handles rendering single character glyphs using SDF and MSDF techniques\n */\nexport class GlyphLayer<\n  T extends GlyphInstance,\n  U extends IGlyphLayerOptions<T>\n> extends Layer<T, U> {\n  /** Set up the default props so our auto complete is a happier place */\n  static defaultProps: IGlyphLayerOptions<GlyphInstance> = {\n    key: \"\",\n    data: new InstanceProvider<GlyphInstance>(),\n    resourceKey: \"No resource specified\",\n    scene: \"default\"\n  };\n\n  /**\n   * Easy access names of each attribute to make easing controls easier\n   */\n  static attributeNames = {\n    color: \"color\",\n    depth: \"depth\",\n    anchor: \"anchor\",\n    origin: \"origin\",\n    offset: \"offset\"\n  };\n\n  /**\n   * These are all of the requests the glyphs have generated for each character. This let's us\n   * recycle requests for same glyphs.\n   */\n  glyphRequests: { [key: string]: IFontResourceRequest } = {};\n\n  /**\n   * Create the Shader IO needed to tie our instances and the GPU together.\n   */\n  initShader(): IShaderInitialization<T> {\n    const animate = this.props.animate || {};\n    const {\n      anchor: animateAnchor,\n      color: animateColor,\n      offset: animateOffset,\n      origin: animateOrigin\n    } = animate;\n\n    const vertexInfo: { [key: number]: Vec2 } = {\n      0: [0, 0],\n      1: [0, 0],\n      2: [1, 0],\n      3: [0, 1],\n      4: [1, 1],\n      5: [1, 1]\n    };\n\n    const glyphTextureAttr: IInstanceAttribute<T> = {\n      name: \"texture\",\n      resource: {\n        key: this.props.resourceKey || \"\",\n        name: \"fontMap\",\n        type: ResourceType.FONT\n      },\n      update: o => {\n        const char = o.character;\n\n        if (!o.request || o.character !== o.request.character) {\n          if (this.glyphRequests[o.character]) {\n            o.request = this.glyphRequests[o.character];\n          } else {\n            o.request = fontRequest({\n              character: char\n            });\n\n            this.glyphRequests[o.character] = o.request;\n          }\n\n          // Do a check to see if the request has been resolved. If so, the glyph is ready.\n          if (o.request.fontMap) {\n            if (o.onReady) o.onReady(o);\n          }\n        }\n\n        o.request.fetch = FontResourceRequestFetch.TEXCOORDS;\n        return this.resource.request(this, o, o.request);\n      }\n    };\n\n    /**\n     * We must make this attribute a child attribute as it is based on the exact same property\n     * as another attribute from an instance. This ensures that the change on the instance property\n     * triggers this attribute as well.\n     */\n    const glyphSizeAttr: IInstanceAttribute<T> = {\n      name: \"glyphSize\",\n      parentAttribute: glyphTextureAttr,\n      resource: {\n        key: this.props.resourceKey || \"\",\n        name: \"fontMap\",\n        type: ResourceType.FONT\n      },\n      size: InstanceAttributeSize.TWO,\n      update: o => {\n        const char = o.character;\n\n        if (!o.request || o.character !== o.request.character) {\n          if (this.glyphRequests[o.character]) {\n            o.request = this.glyphRequests[o.character];\n          } else {\n            o.request = fontRequest({\n              character: char\n            });\n\n            this.glyphRequests[o.character] = o.request;\n          }\n\n          // Do a check to see if the request has been resolved. If so, the glyph is ready.\n          if (o.request.fontMap) {\n            if (o.onReady) o.onReady(o);\n          }\n        }\n\n        o.request.fetch = FontResourceRequestFetch.IMAGE_SIZE;\n        return this.resource.request(this, o, o.request);\n      }\n    };\n\n    glyphTextureAttr.childAttributes = [glyphSizeAttr];\n\n    let fs: string, vs: string;\n    const scaleMode = this.props.scaleMode || ScaleMode.ALWAYS;\n\n    switch (scaleMode) {\n      case ScaleMode.BOUND_MAX: {\n        fs = require(\"./glyph-layer-bound-max.fs\");\n        vs = require(\"./glyph-layer-bound-max.vs\");\n        break;\n      }\n\n      case ScaleMode.NEVER: {\n        fs = require(\"./glyph-layer-never.fs\");\n        vs = require(\"./glyph-layer-never.vs\");\n        break;\n      }\n\n      case ScaleMode.ALWAYS:\n      default: {\n        fs = require(\"./glyph-layer-always.fs\");\n        vs = require(\"./glyph-layer-always.vs\");\n        break;\n      }\n    }\n\n    return {\n      fs,\n      instanceAttributes: [\n        {\n          easing: animateColor,\n          name: GlyphLayer.attributeNames.color,\n          size: InstanceAttributeSize.FOUR,\n          update: o => o.color\n        },\n        {\n          name: GlyphLayer.attributeNames.depth,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.depth]\n        },\n        {\n          name: \"fontScale\",\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.fontScale]\n        },\n        {\n          easing: animateAnchor,\n          name: GlyphLayer.attributeNames.anchor,\n          size: InstanceAttributeSize.TWO,\n          update: o => o.anchor\n        },\n        {\n          easing: animateOrigin,\n          name: GlyphLayer.attributeNames.origin,\n          size: InstanceAttributeSize.TWO,\n          update: o => o.origin\n        },\n        {\n          easing: animateOffset,\n          name: GlyphLayer.attributeNames.offset,\n          size: InstanceAttributeSize.TWO,\n          update: o => o.offset\n        },\n        {\n          name: \"padding\",\n          size: InstanceAttributeSize.TWO,\n          update: o => o.padding\n        },\n        glyphSizeAttr,\n        glyphTextureAttr\n      ],\n      uniforms: [],\n      vertexAttributes: [\n        {\n          name: \"normals\",\n          size: VertexAttributeSize.TWO,\n          update: (vertex: number) =>\n            // Quad vertex side information\n            vertexInfo[vertex]\n        }\n      ],\n      vertexCount: 6,\n      vs\n    };\n  }\n\n  /**\n   * Set up material options for the layer\n   */\n  getMaterialOptions(): ILayerMaterialOptions {\n    return Object.assign(\n      {},\n      CommonMaterialOptions.transparentImageBlending,\n      createMaterialOptions({\n        depthTest: false\n      })\n    );\n  }\n}\n","import {\n  IInstanceOptions,\n  Instance,\n  observable\n} from \"../../instance-provider\";\nimport { IFontResourceRequest } from \"../../resources\";\nimport { Omit } from \"../../types\";\nimport { Vec2, Vec4 } from \"../../util/vector\";\nimport { LabelInstance } from \"./label-instance\";\n\nexport type GlyphInstanceOptions = Omit<\n  Partial<GlyphInstance>,\n  \"resourceTrigger\" | keyof Instance | \"parentLabel\" | \"request\"\n> &\n  IInstanceOptions;\n\n/**\n * Instance representing a single glyph being rendered.\n */\nexport class GlyphInstance extends Instance {\n  /** Adjustment to position the glyph relative to an anchor location on an overrarching label */\n  @observable anchor: Vec2 = [0, 0];\n  /** This is the character the glyph will render. */\n  @observable character: string = \"a\";\n  /** The color to tint the glyph */\n  @observable color: Vec4 = [1, 1, 1, 1];\n  /** Z distance of the glyph */\n  @observable depth: number = 0;\n  /**\n   * This is the scale of the glyph compared to the font resource's rendering. If the font resource\n   * is rendered at 32px, then this needs to be 20 / 32 to render the glyph at a font size of 20.\n   */\n  @observable fontScale: number = 1;\n  /** The top left location of this glyph's offset from it's origin */\n  @observable offset: Vec2 = [0, 0];\n  /** This is the anchor point of the glyph to which the glyph scales and rotates about and is positioned */\n  @observable origin: Vec2 = [0, 0];\n  /** This is the amount of padding from the origin position to the anchor position */\n  @observable padding: Vec2 = [0, 0];\n\n  /** The label this glyph is associated with (may NOT be associated at all) */\n  parentLabel?: LabelInstance;\n  /** Fires when this instance is ready for rendering */\n  onReady?: (glyph: GlyphInstance) => void;\n  /** This is populated as a result of character updates */\n  request: IFontResourceRequest;\n\n  constructor(options: GlyphInstanceOptions) {\n    super(options);\n\n    this.origin = options.origin || this.origin;\n    this.offset = options.offset || this.offset;\n    this.character = options.character || this.character;\n    this.color = options.color || this.color;\n    this.onReady = options.onReady;\n  }\n\n  /**\n   * Make a duplicate of this glyph\n   */\n  clone() {\n    const glyph = new GlyphInstance(this);\n    glyph.onReady = this.onReady;\n    glyph.request = this.request;\n  }\n\n  /**\n   * This will trigger when the resource nmanager is ready to render this glyph.\n   */\n  resourceTrigger() {\n    this.offset = this.offset;\n    this.origin = this.origin;\n    this.character = this.character;\n    this.color = this.color;\n\n    // Indicate this glyph is getting ready to render to the screen\n    if (this.onReady) this.onReady(this);\n  }\n}\n","import { subtract2, Vec2 } from \"../util\";\nimport { DataBounds } from \"../util/data-bounds\";\nimport { eventElementPosition, normalizeWheel } from \"../util/mouse\";\nimport { QuadTree } from \"../util/quad-tree\";\nimport { EventManager } from \"./event-manager\";\nimport { LayerScene } from \"./layer-scene\";\nimport { View } from \"./view\";\n\n// If a mouse up after a mouse down happens before this many milliseconds, a click gesture will happen\nconst VALID_CLICK_DELAY = 1e3;\n\n/**\n * Theorectically we can have a view be applied to multiple scenes. So to properly qualify a view\n * it must be paired with the scene it is rendering for.\n */\nexport type SceneView = {\n  /** This specifies the order the view is rendered in so we can pick the top most item when needed */\n  depth: number;\n  /** This is the scene the view is rendering for */\n  scene: LayerScene;\n  /** This is the view itself that our mouse will interact with */\n  view: View;\n  /** Gets the bounds of this view for this particular scene */\n  bounds?: DataBounds<SceneView>;\n};\n\n/**\n * This represents an interaction with the Layer Surface. It provides mouse metrics with how the mouse\n * interacts with the views below it.\n */\nexport interface IMouseInteraction {\n  /** When present indicates any relevant button codes used during a click event */\n  button?: number;\n  /** Metrics of the interaction in screen space */\n  screen: {\n    mouse: Vec2;\n  };\n  /** The View the mouse was 'down' on */\n  start?: {\n    mouse: Vec2;\n    view: View;\n  };\n  /** The View Immediately underneath the mouse */\n  target: {\n    mouse: Vec2;\n    view: View;\n  };\n  /** This is populated with ALL of the views underneath the mouse */\n  viewsUnderMouse: {\n    /** The mouse's location in the views coordinate space */\n    mouse: Vec2;\n    /** The view that is interacted with */\n    view: View;\n  }[];\n}\n\nexport interface IDragMetrics {\n  /** Drag metrics in screen space */\n  screen: {\n    /** The start position of the drag where the mouse down first occurred */\n    start: Vec2;\n    /** The previous position of the mouse last frame */\n    previous: Vec2;\n    /** The current position the mouse is located for this frame */\n    current: Vec2;\n    /** The change in position from last frame to this frame */\n    delta: Vec2;\n  };\n}\n\nexport interface IWheelMetrics {\n  wheel: [number, number];\n}\n\n/**\n * This is metrics measured between two touches\n */\nexport interface ITouchRelation {\n  /** The direction to the other touch */\n  direction: Vec2;\n  /** The current distance to the other touch */\n  distance: number;\n  /** The id of the other touch */\n  id: number;\n}\n\n/**\n * This is the information of a touch for a given frame.\n */\nexport interface ITouchFrame {\n  /** This is the location or delta location of the touch for this frame */\n  location: Vec2;\n  /** This is the direction from the start touch frame */\n  direction: Vec2;\n  /** This is the metrics or delta metrics of the touch relative to the other touches for the frame */\n  relations: Map<number, ITouchRelation>;\n}\n\nexport interface ITouchMetrics {\n  /** The starting metrics of the touch */\n  start: ITouchFrame;\n  /** The delta changes from previous event to the current event */\n  delta: ITouchFrame;\n  /** The current metrics of the touch event */\n  current: ITouchFrame;\n}\n\nfunction sortByDepth(a: DataBounds<SceneView>, b: DataBounds<SceneView>) {\n  return b.data.depth - a.data.depth;\n}\n\nfunction isDefined<T>(val: T | null | undefined): val is T {\n  return Boolean(val);\n}\n\n/**\n * This manages mouse events on the provided canvas and provides some higher level\n * interactions with the surface.\n */\nexport class MouseEventManager {\n  /** This is the canvas context we are rendering to */\n  context: HTMLCanvasElement;\n  /** This is list of Event Managers that receive the events and gestures which perform the nexessary actions */\n  controllers: EventManager[];\n  /** This is the quad tree for finding intersections with the mouse */\n  quadTree: QuadTree<DataBounds<SceneView>>;\n  /** This is the current list of views being managed */\n  views: SceneView[];\n\n  eventCleanup: [string, EventListenerOrEventListenerObject][] = [];\n\n  /**\n   * This flag is set when the system is waiting to render the elements to establish bounds.\n   * No Mouse interations will happen while this is set to true.\n   */\n  private _waitingForRender: boolean = true;\n\n  get waitingForRender() {\n    return this._waitingForRender;\n  }\n\n  set waitingForRender(val: boolean) {\n    this._waitingForRender = val;\n\n    // When we're no longer waiting for render to occur we update all of our views in the quad tree\n    if (!val) {\n      this.quadTree = new QuadTree(0, 0, 0, 0);\n      this.quadTree.addAll(this.views.map(v => v.bounds).filter(isDefined));\n    }\n  }\n\n  constructor(\n    canvas: HTMLCanvasElement,\n    views: SceneView[],\n    controllers: EventManager[],\n    handlesWheelEvents?: boolean\n  ) {\n    this.context = canvas;\n    this.setViews(views);\n    this.setControllers(controllers);\n    this.addContextListeners(handlesWheelEvents);\n  }\n\n  /**\n   * This sets up the DOM events to listen to the events that are broadcasted by the canvas.\n   * These events are set up in such a way as to continue some events when the user\n   * drags the mouse off of the browser or off the canvas without releasing.\n   */\n  addContextListeners(handlesWheelEvents?: boolean) {\n    const element = this.context;\n    let startView: SceneView | undefined;\n    let startPosition: Vec2 = [0, 0];\n\n    if (handlesWheelEvents) {\n      const wheelHandler = (event: MouseWheelEvent) => {\n        const mouse = eventElementPosition(event, element);\n        const interaction = this.makeInteraction(\n          mouse,\n          startPosition,\n          startView\n        );\n        const wheel = this.makeWheel(event);\n\n        this.controllers.forEach(controller => {\n          controller.handleWheel(interaction, wheel);\n        });\n\n        event.stopPropagation();\n        event.preventDefault();\n      };\n\n      if (\"onwheel\" in element) {\n        element.onwheel = wheelHandler;\n      }\n\n      if (\"addEventListener\" in element) {\n        element.addEventListener(\"DOMMouseScroll\", wheelHandler);\n        this.eventCleanup.push([\"DOMMouseScroll\", wheelHandler]);\n      }\n    }\n\n    element.onmouseleave = event => {\n      // No interactions while waiting for the render to update\n      if (this.waitingForRender) return;\n\n      const mouse = eventElementPosition(event, element);\n      const interaction = this.makeInteraction(mouse, startPosition, startView);\n\n      this.controllers.forEach(controller => {\n        controller.handleMouseOut(interaction);\n      });\n    };\n\n    element.onmousemove = event => {\n      // No interactions while waiting for the render to update\n      if (this.waitingForRender) return;\n\n      const mouse = eventElementPosition(event, element);\n      const interaction = this.makeInteraction(mouse, startPosition, startView);\n\n      this.controllers.forEach(controller => {\n        controller.handleMouseMove(interaction);\n      });\n    };\n\n    element.onmousedown = (event: MouseEvent) => {\n      // No interactions while waiting for the render to update\n      if (this.waitingForRender) return;\n\n      startPosition = eventElementPosition(event, element);\n      const downViews = this.getViewsUnderMouse(startPosition);\n      // While this is true, when mouse up happens, the click gesture will execute\n      let canClick = true;\n      const clickStartTime = Date.now();\n\n      // If no views under this view, then we just quick exit with no interactions\n      if (downViews.length <= 0) {\n        return;\n      }\n\n      startView = downViews[0].data;\n      if (!startView) return;\n\n      const interaction = this.makeInteraction(\n        startPosition,\n        startPosition,\n        startView\n      );\n      let currentPosition = startPosition;\n\n      this.controllers.forEach(controller => {\n        controller.handleMouseDown(interaction, event.button);\n      });\n\n      event.stopPropagation();\n\n      document.onmousemove = (event: MouseEvent) => {\n        const mouse = eventElementPosition(event, element);\n        const interaction = this.makeInteraction(\n          mouse,\n          startPosition,\n          startView\n        );\n        const delta: Vec2 = subtract2(mouse, currentPosition);\n\n        const drag = this.makeDrag(\n          mouse,\n          startPosition || { x: 0, y: 0 },\n          currentPosition,\n          delta\n        );\n        currentPosition = mouse;\n\n        this.controllers.forEach(controller => {\n          controller.handleDrag(interaction, drag);\n        });\n\n        // If we move after a mouse down, it's no longer a click\n        canClick = false;\n      };\n\n      document.onmouseup = (_event: MouseEvent) => {\n        document.onmousemove = null;\n        document.onmouseup = null;\n        document.onmouseover = null;\n      };\n\n      document.onmouseover = (event: MouseEvent) => {\n        const mouse = eventElementPosition(event, element);\n        const interaction = this.makeInteraction(\n          mouse,\n          startPosition,\n          startView\n        );\n\n        this.controllers.forEach(controller => {\n          controller.handleMouseOver(interaction);\n        });\n\n        event.stopPropagation();\n      };\n\n      element.onmouseup = (event: MouseEvent) => {\n        const mouse = eventElementPosition(event, element);\n        const interaction = this.makeInteraction(\n          mouse,\n          startPosition,\n          startView\n        );\n\n        this.controllers.forEach(controller => {\n          controller.handleMouseUp(interaction, event.button);\n        });\n\n        // If we release the mouse before the valid click delay\n        if (canClick && Date.now() - clickStartTime < VALID_CLICK_DELAY) {\n          this.controllers.forEach(controller => {\n            controller.handleClick(interaction, event.button);\n          });\n        }\n      };\n\n      // Text will not be selected when it is being dragged\n      const experiemental = element as any;\n      if (experiemental.onselectstart !== undefined) {\n        experiemental.onselectstart = function() {\n          return false;\n        };\n      } else {\n        element.addEventListener(\"selectstart\", function() {\n          event.preventDefault();\n        });\n      }\n    };\n\n    // Enable touch support\n    this.addTouchContextListeners();\n  }\n\n  addTouchContextListeners() {\n    const element = this.context;\n\n    element.ontouchstart = _event => {\n      // TODO: This is the start work for the touch events. And this retains sentimental value.\n      // For (let i = 0, end = event.changedTouches.length; i < end; ++i) {\n      // TODO\n      // Const touch = event.changedTouches.item(i);\n      // CurrentTouches.set(touch.identifier, to);\n      // }\n    };\n\n    element.ontouchend = _event => {\n      // TODO\n    };\n\n    element.ontouchmove = _event => {\n      // TODO\n    };\n\n    element.ontouchcancel = _event => {\n      // TODO\n    };\n  }\n\n  /**\n   * Retrieves the view for the provided id\n   */\n  getView(viewId: string): View | null {\n    for (const view of this.views) {\n      if (view.view.id === viewId) {\n        return view.view;\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Retrieves the views underneath the mouse with the top most view as\n   * the first view in the list.\n   */\n  getViewsUnderMouse = (mouse: Vec2) => {\n    // Find the views the mouse has interacted with\n    const hitViews = this.quadTree.query(mouse);\n    // Sort them by depth\n    hitViews.sort(sortByDepth);\n\n    return hitViews;\n  };\n\n  /**\n   * This generates the metrics for a drag gesture.\n   */\n  makeDrag(\n    mouse: Vec2,\n    start: Vec2,\n    previous: Vec2,\n    delta: Vec2\n  ): IDragMetrics {\n    return {\n      screen: {\n        current: mouse,\n        delta,\n        previous,\n        start\n      }\n    };\n  }\n\n  /**\n   * This makes the metrics for interactions with the views.\n   */\n  makeInteraction(\n    mouse: Vec2,\n    start?: Vec2,\n    startView?: SceneView\n  ): IMouseInteraction {\n    // Find the views the mouse has interacted with\n    const hitViews = this.getViewsUnderMouse(mouse);\n\n    return {\n      screen: {\n        mouse\n      },\n      start: start &&\n        startView && {\n          mouse: startView.view.screenToView(mouse),\n          view: startView.view\n        },\n      target: {\n        mouse: hitViews[0] && hitViews[0].data.view.screenToView(mouse),\n        view: hitViews[0] && hitViews[0].data.view\n      },\n      viewsUnderMouse: hitViews.map(v => ({\n        mouse: v.data.view.screenToView(mouse),\n        view: v.data.view\n      }))\n    };\n  }\n\n  makeWheel(event: MouseWheelEvent): IWheelMetrics {\n    const wheel = normalizeWheel(event);\n\n    return {\n      wheel: [wheel.pixelX, wheel.pixelY]\n    };\n  }\n\n  /**\n   * When the renderer is resized, we must reform our quad tree\n   */\n  resize = () => {\n    this._waitingForRender = true;\n  };\n\n  /**\n   * Sets the controllers to receive events from this manager.\n   */\n  setControllers(controllers: EventManager[]) {\n    this.controllers = controllers;\n\n    for (const controller of this.controllers) {\n      controller.setMouseManager(this);\n    }\n  }\n\n  /**\n   * Sets the views that gets queried for interactions.\n   */\n  setViews(views: SceneView[]) {\n    this.views = views;\n  }\n\n  destroy() {\n    delete this.quadTree;\n    this.context.onmousedown = null;\n    this.context.onmousemove = null;\n    this.context.onmouseleave = null;\n\n    const experimental = this.context as any;\n\n    if (experimental.onmousewheel) {\n      experimental.onmousewheel = null;\n    }\n\n    this.eventCleanup.forEach(event => {\n      this.context.removeEventListener(event[0], event[1]);\n    });\n  }\n}\n","import { Material, MaterialOptions, MaterialUniformType } from \"../../gl\";\nimport { Instance } from \"../../instance-provider/instance\";\nimport { IInstancingUniform, IUniform, UniformSize } from \"../../types\";\nimport { ILayerProps, Layer } from \"../layer\";\n\nconst UNIFORM_SIZE_TO_MATERIAL_TYPE: { [key: number]: MaterialUniformType } = {\n  [UniformSize.ONE]: MaterialUniformType.FLOAT,\n  [UniformSize.TWO]: MaterialUniformType.VEC2,\n  [UniformSize.THREE]: MaterialUniformType.VEC3,\n  [UniformSize.FOUR]: MaterialUniformType.VEC4,\n  [UniformSize.MATRIX3]: MaterialUniformType.MATRIX3x3,\n  [UniformSize.MATRIX4]: MaterialUniformType.MATRIX4x4,\n  [UniformSize.ATLAS]: MaterialUniformType.TEXTURE\n};\n\nconst DEFAULT_UNIFORM_VALUE: { [key: number]: number[] } = {\n  [UniformSize.ONE]: [0],\n  [UniformSize.TWO]: [0, 0],\n  [UniformSize.THREE]: [0, 0, 0],\n  [UniformSize.FOUR]: [0, 0, 0, 0],\n  [UniformSize.MATRIX3]: [0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [UniformSize.MATRIX4]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\n};\n\nfunction toMaterialUniform(uniform: IUniform) {\n  return {\n    type: UNIFORM_SIZE_TO_MATERIAL_TYPE[uniform.size],\n    value: DEFAULT_UNIFORM_VALUE[uniform.size]\n  };\n}\n\nexport function generateLayerMaterial<\n  T extends Instance,\n  U extends ILayerProps<T>\n>(\n  layer: Layer<T, U>,\n  vs: string,\n  fs: string,\n  layerUniforms: IUniform[],\n  instancingUniforms: IInstancingUniform[]\n): Material {\n  // We now need to establish the material for the layer\n  const materialParams: MaterialOptions = layer.getMaterialOptions();\n\n  // The props applied to the layer has a material option declaration as well\n  // these settings take priority over all settings\n  Object.assign(materialParams, layer.props.materialOptions || {});\n\n  materialParams.vertexShader = vs;\n  materialParams.fragmentShader = fs;\n  materialParams.name = layer.id;\n\n  // We must convert all of the uniforms to actual Three material initialization uniforms\n  materialParams.uniforms = {};\n\n  // Convert our non-instancing uniforms to our material uniforms\n  for (let i = 0, end = layerUniforms.length; i < end; ++i) {\n    const uniform = layerUniforms[i];\n    const materialUniform = toMaterialUniform(uniform);\n    materialParams.uniforms[uniform.name] = materialUniform;\n  }\n\n  // Add in the generated instancing uniforms\n  for (let i = 0, end = instancingUniforms.length; i < end; ++i) {\n    const generatedUniform = instancingUniforms[i];\n    materialParams.uniforms[generatedUniform.name] = {\n      type: generatedUniform.type,\n      value: generatedUniform.value\n    };\n  }\n\n  return new Material(materialParams);\n}\n","import { Attribute, Geometry } from \"../../gl\";\nimport { Instance } from \"../../instance-provider/instance\";\nimport {\n  IVertexAttribute,\n  IVertexAttributeInternal,\n  ShaderIOValue\n} from \"../../types\";\nimport { Layer } from \"../layer\";\nimport { LayerBufferType } from \"./layer-buffer-type\";\n\nfunction isNumberCluster(\n  val: ShaderIOValue\n): val is\n  | [number]\n  | [number, number]\n  | [number, number, number]\n  | [number, number, number, number] {\n  return !Array.isArray(val[0]);\n}\n\nexport function generateLayerGeometry<T extends Instance>(\n  layer: Layer<T, any>,\n  maxInstancesPerBuffer: number,\n  vertexAttributes: IVertexAttributeInternal[],\n  vertexCount: number\n): Geometry {\n  // Make the new buffers to be updated\n  const vertexBuffers = [];\n\n  // Certain buffer strategies only need one instance buffered in\n  if (\n    layer.bufferType === LayerBufferType.INSTANCE_ATTRIBUTE ||\n    layer.bufferType === LayerBufferType.INSTANCE_ATTRIBUTE_PACKING\n  ) {\n    maxInstancesPerBuffer = 1;\n  }\n\n  for (let i = 0, end = vertexAttributes.length; i < end; ++i) {\n    const attribute = vertexAttributes[i];\n    vertexBuffers.push(\n      new Float32Array(attribute.size * vertexCount * maxInstancesPerBuffer)\n    );\n  }\n\n  // Let's now fill in the baseline geometry with the instances we will be generating\n  // First we ask the layer for a single instance's buffer setup\n  const endk = vertexAttributes.length;\n  let buffer: Float32Array;\n  let attribute: IVertexAttribute;\n  let value: ShaderIOValue;\n  let formatError: boolean = false;\n\n  for (let i = 0, end = vertexCount; i < end; ++i) {\n    for (let k = 0; k < endk; ++k) {\n      attribute = vertexAttributes[k];\n      buffer = vertexBuffers[k];\n      value = attribute.update(i);\n\n      if (isNumberCluster(value)) {\n        for (\n          let j = i * attribute.size, endj = j + attribute.size, index = 0;\n          j < endj;\n          ++j, ++index\n        ) {\n          buffer[j] = value[index];\n        }\n      } else {\n        formatError = true;\n      }\n    }\n  }\n\n  if (formatError) {\n    console.warn(\n      \"A vertex buffer updating method should not use arrays of arrays of numbers.\"\n    );\n  }\n\n  // After getting the geometry for a single instance, we can now copy paste\n  // For subsequent instances using very fast FLoat32 methods\n  // NOTE: This is ONLY for certain buffering strategies. This is essentially a noop when the\n  // maxInstances is set to one.\n  for (let i = 0, end = vertexAttributes.length; i < end; ++i) {\n    const attribute = vertexAttributes[i];\n    const instanceSize = attribute.size * vertexCount;\n\n    // Copy the first buffer set into the rest of the buffer\n    for (let k = 1, endk = maxInstancesPerBuffer; k < endk; ++k) {\n      vertexBuffers[i].copyWithin(instanceSize * k, 0, instanceSize);\n    }\n  }\n\n  // Lastly, we make the instance attribute reflect correctly so each instance\n  // Can have varied information. This is only appropriate for the uniform buffer strategy\n  if (layer.bufferType === LayerBufferType.UNIFORM) {\n    const instancingBuffer = vertexBuffers[0];\n\n    for (let i = 0, end = maxInstancesPerBuffer; i < end; ++i) {\n      const instanceStartIndex = i * vertexCount;\n\n      for (let k = 0; k < vertexCount; ++k) {\n        instancingBuffer[k + instanceStartIndex] = i;\n      }\n    }\n  }\n\n  // Now we can generate the attributes and apply them to a geometry object\n  const geometry = new Geometry();\n\n  // Generate the attributes, they are all Vertex attributes, thus instancing does not get flagged on them.\n  for (let i = 0, end = vertexAttributes.length; i < end; ++i) {\n    const attribute = vertexAttributes[i];\n    const materialAttribute = new Attribute(vertexBuffers[i], attribute.size);\n    attribute.materialAttribute = materialAttribute;\n    geometry.addAttribute(attribute.name, materialAttribute);\n  }\n\n  return geometry;\n}\n","import {\n  identity4,\n  Mat4x4,\n  multiply4x4,\n  orthographic4x4,\n  perspective4x4,\n  scale4x4by3,\n  translation4x4by3\n} from \"./matrix\";\nimport { copy3, Vec3 } from \"./vector\";\n\nexport enum CameraProjectionType {\n  PERSPECTIVE,\n  ORTHOGRAPHIC\n}\n\n/**\n * Options for generating a camera that has orthographic properties.\n */\nexport interface ICameraOrthographicOptions {\n  /** Forced type requirement, indicates orthographic projection */\n  type: CameraProjectionType.ORTHOGRAPHIC;\n\n  /** Left border of the view range */\n  left: number;\n  /** Right border of the view range */\n  right: number;\n  /** Top border of the view range */\n  top: number;\n  /** Bottom border of the view range */\n  bottom: number;\n  /** Near border of the view range */\n  near: number;\n  /** Far border of the view range */\n  far: number;\n}\n\n/**\n * Options for generating a camera that has perspective properties.\n */\nexport interface ICameraPerspectiveOptions {\n  /** Forced type requirement, indicates perspective projection */\n  type: CameraProjectionType.PERSPECTIVE;\n\n  /** Field of view in radians */\n  fov: number;\n  /** Width of the render space */\n  width: number;\n  /** Height of the render space */\n  height: number;\n  /** The near clipping plane */\n  near: number;\n  /** The far clipping plane */\n  far: number;\n}\n\n/**\n * Base options for camera construction\n */\nexport type ICameraOptions =\n  | ICameraOrthographicOptions\n  | ICameraPerspectiveOptions;\n\nexport interface IOrthoGraphicCamera extends Camera {\n  projectionOptions: ICameraOrthographicOptions;\n}\n\nexport interface IPerspectiveCamera extends Camera {\n  projectionOptions: ICameraPerspectiveOptions;\n}\n\nexport function isOrthographic(camera: Camera): camera is IOrthoGraphicCamera {\n  return (\n    camera.projectionOptions.type === CameraProjectionType.ORTHOGRAPHIC &&\n    \"left\" in camera.projectionOptions\n  );\n}\n\nexport function isPerspective(camera: Camera): camera is IPerspectiveCamera {\n  return (\n    camera.projectionOptions.type === CameraProjectionType.PERSPECTIVE &&\n    \"fov\" in camera.projectionOptions\n  );\n}\n\n/**\n * This class is present to simplify the concepts of Matrix math down to simpler camera concepts.\n */\nexport class Camera {\n  /** The expected projection style of the Camera. */\n  get projectionType() {\n    return this._projectionOptions.type;\n  }\n\n  /** The computed projection of the camera. */\n  get projection() {\n    return this._projection;\n  }\n  private _projection: Mat4x4 = identity4();\n  /** The computed view transform of the camera. */\n  get view() {\n    return this._view;\n  }\n  private _view: Mat4x4 = identity4();\n  /** Flag indicating the transforms for this camera need updating. */\n  get needsUpdate() {\n    return this._needsUpdate;\n  }\n  private _needsUpdate = false;\n\n  /** This is the position of the camera within the world. Call updateTransform for changes to take effect. */\n  get position() {\n    return copy3(this._position);\n  }\n  set position(val: Vec3) {\n    this._position = val;\n    this._needsUpdate = true;\n  }\n  private _position: Vec3 = [0, 0, 0];\n\n  /** This is a scale distortion the camera views the world with */\n  get scale() {\n    return copy3(this._scale);\n  }\n  set scale(val: Vec3) {\n    this._scale = val;\n    this._needsUpdate = true;\n  }\n  private _scale: Vec3 = [1, 1, 1];\n\n  /** This is the rotation of the camera looking into the world */\n  get rotation() {\n    return copy3(this._rotation);\n  }\n  set rotation(val: Vec3) {\n    this._rotation = val;\n    this._needsUpdate = true;\n  }\n  private _rotation: Vec3 = [0, 0, 0];\n\n  /**\n   * Options used for making the projection of the camera. Set new options to update the projection.\n   * Getting the options returns a copy of the object and is not the internal object itself.\n   */\n  get projectionOptions() {\n    return Object.assign({}, this._projectionOptions);\n  }\n  set projectionOptions(val: ICameraOptions) {\n    this._projectionOptions = val;\n    this._needsUpdate = true;\n  }\n  private _projectionOptions: ICameraOptions;\n\n  constructor(options: ICameraOptions) {\n    this._projectionOptions = options;\n    this._needsUpdate = true;\n    this.update();\n  }\n\n  /**\n   * Updates the transform matrices associated with this camera.\n   */\n  update(force?: boolean) {\n    if (this._needsUpdate || force) {\n      this.updateProjection();\n      this.updateTransform();\n    }\n  }\n\n  /**\n   * Takes the current projection options and\n   */\n  updateProjection() {\n    if (isOrthographic(this)) {\n      this._projection = orthographic4x4(\n        this.projectionOptions.left,\n        this.projectionOptions.right,\n        this.projectionOptions.bottom,\n        this.projectionOptions.top,\n        this.projectionOptions.near,\n        this.projectionOptions.far\n      );\n    } else if (isPerspective(this)) {\n      this._projection = perspective4x4(\n        this.projectionOptions.fov,\n        this.projectionOptions.width / this.projectionOptions.height,\n        this.projectionOptions.near,\n        this.projectionOptions.far\n      );\n    }\n  }\n\n  /**\n   * Takes the current components of the camera and updates the transform of the camera (the view)\n   * within Model View Projection Transform\n   */\n  updateTransform() {\n    this._view = multiply4x4(\n      scale4x4by3(this._scale),\n      translation4x4by3(this._position)\n    );\n  }\n}\n","import { AbsolutePosition } from \"../../primitives/absolute-position\";\nimport { Camera, CameraProjectionType } from \"../../util/camera\";\nimport { ChartCamera } from \"../../util/chart-camera\";\nimport { ViewCamera } from \"../../util/view-camera\";\nimport { LayerScene } from \"../layer-scene\";\nimport { View } from \"../view\";\n\nexport interface IDefaultSceneElements {\n  /** Default chartting camera */\n  camera: ChartCamera;\n  /** Default scene for elements to be added into */\n  scene: LayerScene;\n  /** Default view scenes are rendered with when no other views are specified by the layer or the surface */\n  view: View;\n  /**\n   * The default view projection. Defaults to being an orthographic rendering with the origin at the\n   * top left of the canvas and the y-axis as +y going downward.\n   */\n  viewCamera: ViewCamera;\n  /** The default viewport that encompasses the entire canvas */\n  viewport: AbsolutePosition;\n}\n\n/**\n * This generates all of the cameras/views/scenes necessary for default viewing of elements.\n *\n * These defaults are required to ensure the following:\n *\n * - Orthographic view\n * - top left corner of the canvas is 0,0\n * - y axis is +y downward\n * - entire canvas is the viewport.\n */\nexport function generateDefaultScene(\n  context: WebGLRenderingContext\n): IDefaultSceneElements {\n  // Generate a default view camera that is\n  // - Orthographic\n  // - (0, 0) is the top left of the canvas\n  // - the y axis is +y going downward\n  const height = context.canvas.height;\n  const width = context.canvas.width;\n  const aspectRatio = width / height;\n\n  const viewport = {\n    aspectRatio: aspectRatio,\n    bottom: -height / 2,\n    far: 10000000,\n    left: -width / 2,\n    near: -100,\n    right: width / 2,\n    top: height / 2,\n    viewSize: height\n  };\n\n  const defaultCamera: ViewCamera = new ViewCamera();\n  defaultCamera.baseCamera = new Camera({\n    type: CameraProjectionType.ORTHOGRAPHIC,\n    left: viewport.left,\n    right: viewport.right,\n    top: viewport.top,\n    bottom: viewport.bottom,\n    near: viewport.near,\n    far: viewport.far\n  });\n\n  defaultCamera.baseCamera.scale = [1.0, -1.0, 1.0];\n  defaultCamera.baseCamera.position = [0.0, 0.0, -300.0];\n  defaultCamera.baseCamera.update();\n\n  // Generate a charting camera with all scales set to 1 and no offsets in any direction\n  const defaultChartCamera: ChartCamera = new ChartCamera();\n\n  // This is a viewport that covers the entire context\n  const defaultViewport = {\n    bottom: 0,\n    left: 0,\n    right: 0,\n    top: 0\n  };\n\n  // Make a view using our defaults\n  const defaultView = new View({\n    camera: defaultChartCamera,\n    key: View.DEFAULT_VIEW_ID,\n    viewCamera: defaultCamera,\n    viewport: defaultViewport\n  });\n\n  // Make a scene with our defaults\n  const defaultScene = new LayerScene({\n    key: LayerScene.DEFAULT_SCENE_ID,\n    views: []\n  });\n\n  // Make sure the default view is a part of the default scene\n  defaultScene.addView(defaultView);\n\n  return {\n    camera: defaultChartCamera,\n    scene: defaultScene,\n    view: defaultView,\n    viewCamera: defaultCamera,\n    viewport: defaultViewport\n  };\n}\n","import { Instance } from \"../../instance-provider/instance\";\nimport { ILayerProps, Layer } from \"../../surface/layer\";\nimport {\n  IInstanceAttribute,\n  IUniform,\n  IVertexAttribute,\n  Omit,\n  ShaderInjectionTarget\n} from \"../../types\";\n\n/** This is the message used when a module unit is attempted to be modified after it has been locked down */\nconst LOCKED_MODULE_UNIT_MESSAGE =\n  \"Once a ShaderModuleUnit has been registered, you CAN NOT modify it! Module ID:\";\n\n/** Options for the constructor for a new ShaderModuleUnit */\nexport type ShaderModuleUnitOptions = Omit<Partial<ShaderModuleUnit>, \"lock\">;\n\n/**\n * This is a module unit that can be registered as a ShaderModule which the system will use to resolve\n * imports within a shader.\n */\nexport class ShaderModuleUnit {\n  private _isLocked: boolean;\n  private _content: string;\n  private _compatibility: ShaderInjectionTarget;\n  private _moduleId: string;\n  private _dependents: string[] | null = null;\n\n  /**\n   * This is the content that replaces shader imports\n   */\n  get content(): string {\n    return this._content;\n  }\n  set content(val: string) {\n    if (this._isLocked) {\n      console.warn(LOCKED_MODULE_UNIT_MESSAGE, this._moduleId);\n      return;\n    }\n\n    this._content = val;\n  }\n\n  /**\n   * This defines which shader type the content is compatible with. You can only have one content assigned\n   * per each ShaderInjectionTarget type. Thus you can have a module such as 'picking' with two unique implementations\n   * one for Fragment and one for Vertex shaders. Or you can assign it to both.\n   */\n  get compatibility(): ShaderInjectionTarget {\n    return this._compatibility;\n  }\n  set compatibility(val: ShaderInjectionTarget) {\n    if (this._isLocked) {\n      console.warn(LOCKED_MODULE_UNIT_MESSAGE, this._moduleId);\n      return;\n    }\n\n    this._compatibility = val;\n  }\n\n  /**\n   * This is the list of module id dependents this unit will need. We store\n   * this here so the module can be analyzed once. Import statements will be stripped and the sub module contents will\n   * be added to the top of the contents of the shader. This only stores ids, as the ids will still need to be analyzed\n   * so duplication can be prevented.\n   */\n  get dependents(): string[] | null {\n    return this._dependents;\n  }\n  set dependents(val: string[] | null) {\n    // If this has been locked AND the dependents have been established then dependents can not be\n    // adjusted.\n    if (this._isLocked && this._dependents !== null) {\n      console.warn(LOCKED_MODULE_UNIT_MESSAGE, this._moduleId);\n      return;\n    }\n\n    this._dependents = val;\n  }\n\n  /**\n   * Method for the unit to provide instance attributes for the module\n   */\n  instanceAttributes?<T extends Instance, U extends ILayerProps<T>>(\n    layer: Layer<T, U>\n  ): IInstanceAttribute<T>[];\n\n  /**\n   * Indicates this unit cannot be modified anymore.\n   */\n  isLocked() {\n    return this._isLocked;\n  }\n\n  /**\n   * Allows a module to prevent overrides by another module using the same moduleId.\n   * Attempted overrides will throw warnings.\n   */\n  isFinal?: boolean;\n  /** This is the string ID a shader must use to include the provided content. */\n  get moduleId(): string {\n    return this._moduleId;\n  }\n  set moduleId(val: string) {\n    if (this._isLocked) {\n      console.warn(LOCKED_MODULE_UNIT_MESSAGE, this._moduleId);\n      return;\n    }\n\n    this._moduleId = val;\n  }\n\n  /**\n   * Method so the unit can provide uniforms for the module.\n   */\n  uniforms?<T extends Instance, U extends ILayerProps<T>>(\n    layer: Layer<T, U>\n  ): IUniform[];\n\n  /**\n   * Method so the unit can provide vertex attributes for the module.\n   */\n  vertexAttributes?<T extends Instance, U extends ILayerProps<T>>(\n    layer: Layer<T, U>\n  ): IVertexAttribute[];\n\n  /**\n   * Default ctor for creating a new Shader Module Unit to be registered with the system.\n   */\n  constructor(options: ShaderModuleUnitOptions) {\n    Object.assign(this, options);\n  }\n\n  /**\n   * Applies the content after it's been processed for import statements. You can not set the content this way\n   * again after processing has happened.\n   */\n  applyAnalyzedContent(content: string) {\n    if (this._isLocked && this.dependents !== null) {\n      console.warn(LOCKED_MODULE_UNIT_MESSAGE, this._moduleId);\n      return;\n    }\n\n    this._content = content;\n  }\n\n  /**\n   * Makes this unit unable to be modified in anyway\n   */\n  lock() {\n    this._isLocked = true;\n  }\n}\n","import { ShaderInjectionTarget } from \"../../types\";\nimport { shaderTemplate } from \"../../util\";\nimport {\n  ShaderModuleUnit,\n  ShaderModuleUnitOptions\n} from \"./shader-module-unit\";\n\nconst debug = require(\"debug\")(\"performance\");\nconst debugModuleVS = require(\"debug\")(\"shader-module-vs\");\nconst debugModuleFS = require(\"debug\")(\"shader-module-fs\");\n\n/**\n * This is the results expected from a compile() operation from the ShaderModule.\n */\nexport interface IShaderCompileResults {\n  /** Error messages generated from analyzing the shaders */\n  errors: string[];\n  /** The generated shader from analyzing the module */\n  shader: string | null;\n  /** The shader module units discovered during the processing of the module */\n  shaderModuleUnits: Set<ShaderModuleUnit>;\n}\n\n/**\n * The partial token that must be matched to indicate an import statement.\n * (Must be the first non-whitespace word found in the token)\n */\nconst IMPORT_TOKEN = \"import\";\n/**\n * This is a delimiter between the import token and the identifying import id value\n * provided. This must be the next non-whitespace character found after the import token.\n *\n * We allow whitespace between the token and it's delimiter to allow for style preference\n *\n * import: id\n * import:id\n * import : id\n *\n * etc.\n */\nconst IMPORT_DELIMITER = \":\";\n\n/**\n * Tests to see if a ShaderModuleUnit is compatible with a provided Shader Target\n */\nfunction isUnitCompatible(\n  unit: ShaderModuleUnit,\n  target: ShaderInjectionTarget\n) {\n  return (\n    Boolean(unit) &&\n    (unit.compatibility === target ||\n      unit.compatibility === ShaderInjectionTarget.ALL)\n  );\n}\n\n/**\n * This file defines modules for shaders. Shader modules are global to the window context.\n */\nexport class ShaderModule {\n  /** These are all of the currently registered modules for the Shader Modules */\n  static modules = new Map<\n    string,\n    { fs?: ShaderModuleUnit; vs?: ShaderModuleUnit }\n  >();\n\n  /**\n   * This registers a new ShaderModuleUnit. It makes the module available by it's importId within shaders\n   * using this framework.\n   *\n   * If the module is registered with no returned output, the registration was a success. Any returned output\n   * indicates issues encountered while registering the module.\n   */\n  static register(\n    unit: ShaderModuleUnit | ShaderModuleUnitOptions | ShaderModuleUnitOptions[]\n  ): string | null {\n    // If the input is just Shader Module Unit options injected, then we simply handle wrapping\n    // the options into a ShaderModuleUnit and do a registration.\n    if (!(unit instanceof ShaderModuleUnit)) {\n      if (Array.isArray(unit)) {\n        let out = \"\";\n\n        unit.forEach(options => {\n          const output = ShaderModule.register(options);\n          if (output) out += `${output}\\n`;\n        });\n\n        // If there was no output at any time, let's be sure to return a simple null\n        if (!out) {\n          return null;\n        }\n\n        return out;\n      }\n\n      return ShaderModule.register(new ShaderModuleUnit(unit));\n    }\n\n    let current = ShaderModule.modules.get(unit.moduleId);\n\n    if (!current) {\n      current = {};\n      ShaderModule.modules.set(unit.moduleId, current);\n    }\n\n    const fs = current.fs;\n    const vs = current.vs;\n    const isFSCompatible = isUnitCompatible(\n      unit,\n      ShaderInjectionTarget.FRAGMENT\n    );\n    const isVSCompatible = isUnitCompatible(unit, ShaderInjectionTarget.VERTEX);\n\n    if (fs && isFSCompatible) {\n      if (fs.isFinal) {\n        return `Module ID: ${\n          unit.moduleId\n        } Can not override the module's existing Fragment registration as the exisitng module is marked as final`;\n      }\n\n      debug(\n        \"A Shader Module Unit has overridden an existing module for the Fragment Shader Module ID: %o\",\n        unit.moduleId\n      );\n    }\n\n    if (vs && isVSCompatible) {\n      if (vs.isFinal) {\n        return `Module ID: ${\n          unit.moduleId\n        } Can not override the module's existing Vertex registration as the exisitng module is marked as final`;\n      }\n\n      debug(\n        \"A Shader Module Unit has overridden an existing module for the Vertex Shader Module ID: %o\",\n        unit.moduleId\n      );\n    }\n\n    // Register the module as it passed all scrutiny by this point\n    if (isFSCompatible) {\n      current.fs = unit;\n    }\n\n    if (isVSCompatible) {\n      current.vs = unit;\n    }\n\n    // Lock the unit down indicating it can no longer be modified ever again.\n    unit.lock();\n\n    return null;\n  }\n\n  /**\n   * This gathers all of the dependents for the module as ids. This also causes the contents of the module to\n   * be stripped of it's import statements.\n   */\n  static analyzeDependents(unit: ShaderModuleUnit) {\n    // If the dependents are already established for this unit and it can not be modified further,\n    // then we do not bother to analyze the dependents again.\n    if (unit.dependents && unit.isLocked) {\n      return [];\n    }\n\n    // Gathers error messages found while processing the module\n    const errors: string[] = [];\n    // Stores the dependents in the order they are found in the module\n    const dependents: string[] = [];\n    // Stores all of the unique dependents found for this module\n    const dependentSet = new Set<string>();\n    // Get then compatibility target of the module unit so we can properly see what modules are available\n    // to the unit and what is not.\n    const target = unit.compatibility;\n    // This is the identifier of the module requesting it's dependents\n    const id = unit.moduleId;\n\n    // Here we process the module contents and look for additional import statements.\n    const templateResults = shaderTemplate({\n      // We do not want any direct replacement options, we will handle token analyzing\n      // via our onToken callback so we can find our special \"import:\" case\n      options: {},\n      // Provide the shader to our template processor\n      shader: unit.content,\n\n      // We do not want to remove any template macros that do not deal with extension\n      onToken: token => {\n        const trimmedToken = token.trim();\n\n        // See if the token is the first thing to appear\n        if (trimmedToken.indexOf(IMPORT_TOKEN) === 0) {\n          // Analyze the remainder of the token to find the necessary colon to be the NEXT\n          // Non-whitespace character\n          const afterToken = trimmedToken.substr(IMPORT_TOKEN.length).trim();\n\n          // Make sure the character IS a colon\n          if (afterToken[0] === IMPORT_DELIMITER) {\n            // Indicates if content was properly found for the requested ID\n            let moduleContentFound = false;\n            // At this point, ANYTHING after the colon is the module id being requested (with white space trimmed)\n            // We allow comma delimited module ids to be specified\n            const moduleIds = afterToken\n              .substr(IMPORT_DELIMITER.length)\n              .trim()\n              .split(\",\");\n\n            // Wealso  allow trailing comma\n            if (moduleIds[moduleIds.length - 1].trim().length === 0) {\n              moduleIds.pop();\n            }\n\n            // Loop through all discovered module ids after the import statement\n            moduleIds.forEach(moduleId => {\n              // Make sure whitespace is cleared\n              moduleId = moduleId.trim();\n              // Get the requested module\n              const mod = ShaderModule.modules.get(moduleId);\n\n              // If we found the module, great! We can store the identifier as a module associated with this shader\n              // string thus reducing processing time needed for next processing.\n              if (mod) {\n                if (\n                  target === ShaderInjectionTarget.FRAGMENT ||\n                  target === ShaderInjectionTarget.ALL\n                ) {\n                  if (mod.fs) {\n                    moduleContentFound = true;\n\n                    if (!dependentSet.has(moduleId)) {\n                      dependents.push(moduleId);\n                    }\n                  } else {\n                    errors.push(\n                      `Could not find requested target fragment module for Module ID: ${moduleId} requested by module: ${id}`\n                    );\n                  }\n                }\n\n                if (\n                  target === ShaderInjectionTarget.VERTEX ||\n                  target === ShaderInjectionTarget.ALL\n                ) {\n                  if (mod.vs) {\n                    moduleContentFound = true;\n\n                    if (!dependentSet.has(moduleId)) {\n                      dependents.push(moduleId);\n                    }\n                  } else {\n                    errors.push(\n                      `Could not find requested target vertex module for Module ID: ${moduleId} requested by module: ${id}`\n                    );\n                  }\n                }\n\n                if (!mod.vs && !mod.fs) {\n                  errors.push(\n                    \"Could not find a vertex or fragment shader within exisitng module\"\n                  );\n                }\n\n                if (!moduleContentFound) {\n                  errors.push(\n                    `Error Processing module Module ID: ${moduleId} requested by module: ${id}`\n                  );\n                }\n              } else {\n                errors.push(\n                  `Could not find requested module: ${moduleId} requested by module: ${id}`\n                );\n              }\n            });\n\n            // Clear the import token from the body of the shader\n            return \"\";\n          }\n        }\n\n        // Leave any token not processed alone\n        return `$\\{${token}}`;\n      }\n    });\n\n    // Update the content to be stripped of it's import statements\n    unit.applyAnalyzedContent(templateResults.shader);\n    // Update the dependents to include the modules found that this module requested\n    unit.dependents = dependents;\n\n    return errors;\n  }\n\n  /**\n   * This examines a shader string and replaces all import statements with any existing registered modules.\n   * This will also output any issues such as requested modules that don't exist and detect circular dependencies\n   * and such ilk.\n   *\n   * @param shader The content of the shader to analyze for import statements\n   * @param target The shader target type to consider\n   * @param additionalModules Additional modules to include in the shader regardless if the shader requested it or not\n   */\n  static process(\n    id: string,\n    shader: string,\n    target: ShaderInjectionTarget,\n    additionalModules?: string[]\n  ): IShaderCompileResults {\n    // The discovered shader module units during processing\n    const shaderModuleUnits = new Set<ShaderModuleUnit>();\n    // This stores the module id's that have already been included in the shader\n    const included = new Set<string>();\n    // This stores the import stack that is currently being processed\n    const processing: (string | null)[] = [];\n    // This is all of the processed errors discovered while resolving imports\n    const errors: string[] = [];\n    // Pick a debugging target based on shader target\n    const debugTarget =\n      target === ShaderInjectionTarget.VERTEX ? debugModuleVS : debugModuleFS;\n    debugTarget(\"Processing Shader for id %o:\", id);\n\n    // Internal checking method of the state of the process to find circular dependencies\n    function checkCircularDependency(unit: ShaderModuleUnit) {\n      // Get the id of the module being processed for quick reference\n      const id = unit.moduleId;\n      // Debugging for the import id's found along with the current stack\n      debugTarget(\n        \"%o: %o\",\n        id,\n        processing\n          .slice(0)\n          .reverse()\n          .join(\" -> \")\n      );\n\n      // First look to see if the identifier is already in the processing queue. If it is, we\n      // have a heinous circular dependency.\n      const queueIndex = processing.indexOf(id);\n      // Queue up this id as being processed\n      processing.unshift(id);\n\n      // See if the circular dependency is found.\n      if (queueIndex > -1) {\n        // Since we have a queue of our processing path, we can show the circular dependency path\n        const circularPath = processing.slice(0, queueIndex + 2).reverse();\n        // Spew the blood\n        errors.push(\n          `A Shader has detected a Circular dependency in import requests: ${circularPath.join(\n            \" -> \"\n          )}`\n        );\n        // Remove the id from the queue\n        processing.shift();\n\n        // Return a null flag indicating the process failed.\n        return false;\n      }\n\n      return true;\n    }\n\n    // We place this method as an internal recursive strategy to solving this issue due to the complexities of\n    // the problem at hand. We have shaders that have tokens analyzed that MUST be immediately resolved\n    // to a correct value. Thus we can not use a process queue to remove the need for the recursion. Also, as\n    // this is a static method, this provides some needed properties within the context of the function that we\n    // do not want exposed at all, which is impossible to hide within a static context (private static is not supported).\n    function process(unit: ShaderModuleUnit): string | null {\n      // This is the id of the module unit  currently being processed\n      const id = unit.moduleId;\n\n      // Do the circular dependency check for the module\n      if (!checkCircularDependency(unit)) {\n        return null;\n      }\n\n      // At this point we need to determine if the id has already been included in the module imports\n      // Each import should only be included once so we prevent duplicate items from showing up\n      if (id && included.has(id)) {\n        // Remove the id from the queue\n        processing.shift();\n\n        // Return empty, but not errored\n        return \"\";\n      }\n\n      // This will store all of the module content that should be injected as the header\n      let includedModuleContent = \"\";\n      // Make sure the dependents for the module are properly analyzed\n      const dependentsErrors = ShaderModule.analyzeDependents(unit);\n      // Add in any errors discovered during module analysis\n      dependentsErrors.forEach(error => errors.push(error));\n      // Get the dependents for the module for processing\n      const dependents = unit.dependents;\n\n      if (dependents && dependents.length > 0) {\n        for (let i = 0, iMax = dependents.length; i < iMax; ++i) {\n          // The dependent is the id of the module id dependency\n          const moduleId = dependents[i];\n          // Get the requested module\n          const mod = ShaderModule.modules.get(moduleId);\n\n          // If we found the module, great! We can see if the found module has a compatible target for this module.\n          if (mod) {\n            let moduleContent;\n\n            if (\n              target === ShaderInjectionTarget.FRAGMENT ||\n              target === ShaderInjectionTarget.ALL\n            ) {\n              if (mod.fs) {\n                shaderModuleUnits.add(mod.fs);\n                moduleContent = process(mod.fs);\n              } else {\n                errors.push(\n                  `Could not find requested target fragment module for Module ID: ${moduleId} requested by module: ${id}`\n                );\n              }\n            }\n\n            if (\n              target === ShaderInjectionTarget.VERTEX ||\n              target === ShaderInjectionTarget.ALL\n            ) {\n              if (mod.vs) {\n                shaderModuleUnits.add(mod.vs);\n                moduleContent = process(mod.vs);\n              } else {\n                errors.push(\n                  `Could not find requested target vertex module for Module ID: ${moduleId} requested by module: ${id}`\n                );\n              }\n            }\n\n            if (!mod.vs && !mod.fs) {\n              errors.push(\n                \"Could not find a vertex or fragment shader within exisitng module\"\n              );\n            }\n\n            if (moduleContent === null) {\n              errors.push(\n                `Error Processing module Module ID: ${moduleId} requested by module: ${id}`\n              );\n            }\n\n            // Include the discovered content in the module content output\n            includedModuleContent += moduleContent || \"\";\n          } else {\n            errors.push(\n              `Could not find requested module: ${moduleId} requested by module: ${id}`\n            );\n          }\n        }\n      }\n\n      // Remove the id being processed currently\n      processing.shift();\n      // Add the id to the list of items that have been included\n      included.add(id || \"\");\n\n      // Place the included module content at the top of the shader and return this module with it's necessary\n      // inclusions\n      return `${includedModuleContent.trim()}\\n\\n${unit.content.trim()}`;\n    }\n\n    // We throw in the additional imports  at the top of the shader being analyzed\n    let modifedShader = shader;\n\n    if (additionalModules) {\n      let imports = \"\";\n\n      additionalModules.forEach(\n        moduleId => (imports += `$\\{import: ${moduleId}}\\n`)\n      );\n\n      modifedShader = imports + shader;\n    }\n\n    // Make our shader a temp module unit to make it compatible with the rest of the shader module processing\n    const tempShaderModuleUnit = new ShaderModuleUnit({\n      content: modifedShader,\n      compatibility: target,\n      moduleId: `Layer \"${id}\" ${\n        target === ShaderInjectionTarget.ALL\n          ? \"fs vs\"\n          : target === ShaderInjectionTarget.VERTEX\n            ? \"vs\"\n            : \"fs\"\n      }`\n    });\n\n    // Generate the results needed\n    const results = {\n      errors,\n      shader: process(tempShaderModuleUnit),\n      shaderModuleUnits\n    };\n\n    return results;\n  }\n}\n","/**\n * This file is dedicted to the all important step of processing desired inputs from the layer\n * and coming up with automated generated uniforms and attributes that the shader's will need\n * in order to operate with the conveniences the library offers. This includes things such as\n * injecting camera projection uniforms, resource uniforms, animation adjustments etc etc.\n */\nimport { Instance } from \"../../instance-provider/instance\";\nimport { ProcessShaderImportResults } from \"../../shaders/processing/shader-processor\";\nimport {\n  IInstanceAttribute,\n  IShaderInitialization,\n  IUniform,\n  IUniformInternal,\n  IVertexAttribute,\n  IVertexAttributeInternal\n} from \"../../types\";\nimport { BaseIOSorting } from \"../base-io-sorting\";\nimport { ILayerProps, Layer } from \"../layer\";\nimport { BaseIOExpansion } from \"./base-io-expansion\";\nimport { getLayerBufferType } from \"./layer-buffer-type\";\nimport { packAttributes } from \"./pack-attributes\";\n\n/**\n * Instance attribute typeguard\n */\nfunction isInstanceAttribute<T extends Instance>(\n  attr: any\n): attr is IInstanceAttribute<T> {\n  return Boolean(attr);\n}\n\n/**\n * Vertex attribute typeguard\n */\nfunction isVertexAttribute(attr: any): attr is IVertexAttribute {\n  return Boolean(attr);\n}\n\n/**\n * Uniform typeguard\n */\nfunction isUniform(attr: any): attr is IUniform {\n  return Boolean(attr);\n}\n\n/**\n * Converts a layer's vertex to the internal vertex structure used by the framework.\n */\nfunction toVertexAttributeInternal(\n  attribute: IVertexAttribute\n): IVertexAttributeInternal {\n  return Object.assign({}, attribute, { materialAttribute: null });\n}\n\n/**\n * Converts a layer's uniform to the internal uniform structure used by the framework.\n */\nfunction toUniformInternal(uniform: IUniform): IUniformInternal {\n  return Object.assign({}, uniform, { materialUniforms: [] });\n}\n\n/**\n * This processes instance attributes and performs some basic validation on them to ensure their\n * properties are sane and expected for rendering.\n */\nfunction validateInstanceAttributes<T extends Instance>(\n  layer: Layer<T, any>,\n  instanceAttributes: IInstanceAttribute<T>[],\n  vertexAttributes: IVertexAttribute[],\n  _uniforms: IUniform[]\n) {\n  instanceAttributes.forEach(attribute => {\n    if (attribute.name === undefined) {\n      console.warn(\n        \"All instance attributes MUST have a name on Layer:\",\n        layer.id\n      );\n    }\n\n    if (\n      instanceAttributes.find(\n        attr => attr !== attribute && attr.name === attribute.name\n      )\n    ) {\n      console.warn(\n        \"An instance attribute can not have the same name used more than once:\",\n        attribute.name\n      );\n    }\n\n    if (vertexAttributes.find(attr => attr.name === attribute.name)) {\n      console.warn(\n        \"An instance attribute and a vertex attribute in a layer can not share the same name:\",\n        attribute.name\n      );\n    }\n\n    if (!attribute.resource) {\n      if (attribute.size === undefined) {\n        console.warn(\"An instance attribute requires the size to be defined.\");\n        console.warn(attribute);\n      }\n    }\n  });\n}\n\n/**\n * This processes the results of shaders importing modules by gathering the attributes\n * and uniforms that arose from them.\n */\nfunction gatherIOFromShaderModules<\n  T extends Instance,\n  U extends ILayerProps<T>\n>(\n  layer: Layer<T, U>,\n  shaderIO: IShaderInitialization<T>,\n  importResults: ProcessShaderImportResults\n) {\n  if (!importResults) return;\n\n  // Get the existing items from the IO\n  let moduleInstanceAttributes = shaderIO.instanceAttributes || [];\n  let moduleUniforms = shaderIO.uniforms || [];\n  let moduleVertexAttributes = shaderIO.vertexAttributes || [];\n\n  // Add in the module requested items\n  importResults.shaderModuleUnits.forEach(unit => {\n    if (unit.instanceAttributes) {\n      moduleInstanceAttributes = moduleInstanceAttributes.concat(\n        unit.instanceAttributes(layer)\n      );\n    }\n\n    if (unit.uniforms) {\n      moduleUniforms = moduleUniforms.concat(unit.uniforms(layer));\n    }\n\n    if (unit.vertexAttributes) {\n      moduleVertexAttributes = moduleVertexAttributes.concat(\n        unit.vertexAttributes(layer)\n      );\n    }\n  });\n\n  // Dedup any element by name and show warnings when any item is overridden\n  const uniformNames = new Set<string>();\n  const instanceAttributeNames = new Set<string>();\n  const vertexAttributeNames = new Set<string>();\n\n  moduleUniforms.filter(uniform => {\n    if (uniform) {\n      if (uniformNames.has(uniform.name)) {\n        console.warn(\n          \"Included shader modules has introduced duplicate uniform names:\",\n          uniform.name,\n          \"One will be overridden thus causing a potential crash of the shader.\"\n        );\n        return false;\n      }\n\n      uniformNames.add(uniform.name);\n\n      return true;\n    }\n\n    return false;\n  });\n\n  moduleInstanceAttributes.filter(attribute => {\n    if (attribute) {\n      if (instanceAttributeNames.has(attribute.name)) {\n        console.warn(\n          \"Included shader modules has introduced duplicate Instance Attribute names:\",\n          attribute.name,\n          \"One will be overridden thus causing a potential crash of the shader.\"\n        );\n        return false;\n      }\n\n      instanceAttributeNames.add(attribute.name);\n\n      return true;\n    }\n\n    return false;\n  });\n\n  moduleVertexAttributes.filter(attribute => {\n    if (attribute) {\n      if (vertexAttributeNames.has(attribute.name)) {\n        console.warn(\n          \"Included shader modules has introduced duplicate Vertex Attribute names:\",\n          attribute.name,\n          \"One will be overridden thus causing a potential crash of the shader.\"\n        );\n        return false;\n      }\n\n      vertexAttributeNames.add(attribute.name);\n\n      return true;\n    }\n\n    return false;\n  });\n\n  // Apply any changes to the IO object\n  shaderIO.instanceAttributes = moduleInstanceAttributes;\n  shaderIO.uniforms = moduleUniforms;\n  shaderIO.vertexAttributes = moduleVertexAttributes;\n}\n\n/**\n * This is the primary method that analyzes all shader IO and determines which elements needs to be automatically injected\n * into the shader.\n *\n * @param gl The WebGL context this is being utilized on behalf of.\n * @param layer The layer who's ShaderIO we're analyzing and developing.\n * @param shaderIO The initial ShaderIO the layer has provided.\n * @param ioExpansion The list of BaseIOExpansion objects we will use to expand and process the layer's initial Shader IO\n * @param sortIO  The methods to sort the IO configurations\n * @param importResults The Shader IO object provided by the layer after it's had it's imports analyzed from the provided shader.\n */\nexport function injectShaderIO<T extends Instance, U extends ILayerProps<T>>(\n  gl: WebGLRenderingContext,\n  layer: Layer<T, U>,\n  shaderIO: IShaderInitialization<T>,\n  ioExpansion: BaseIOExpansion[],\n  sortIO: BaseIOSorting,\n  importResults: ProcessShaderImportResults\n) {\n  // After processing imports, we can now include any uniforms, or attributes the shader modules requested to be included in the\n  // layer so that the modules can operate properly. This mostly includes items such as times, projection matrices etc\n  // that the system should be providing rather than the layer\n  gatherIOFromShaderModules(layer, shaderIO, importResults);\n\n  // All of the instance attributes with nulls filtered out\n  const instanceAttributes = (shaderIO.instanceAttributes || []).filter(\n    isInstanceAttribute\n  );\n  // All of the vertex attributes with nulls filtered out\n  const vertexAttributes = (shaderIO.vertexAttributes || []).filter(\n    isVertexAttribute\n  );\n  // All of the uniforms with nulls filtered out\n  const uniforms = (shaderIO.uniforms || []).filter(isUniform);\n\n  // Now we process all of the custom attribute expansion specified by the surface\n  // to process the layer's IO to make special features with the attributes operate correctly.\n  for (let i = 0, iMax = ioExpansion.length; i < iMax; ++i) {\n    const expansion = ioExpansion[i];\n\n    // Do special expansion validation for attributes that may meet the criteria of the expander.\n    // If the validation fails, then we skip performing the expansion as it would result in\n    // invalid or undefined behavior. This validation method should provide all of the logged\n    // output necessary to determine why the configuration was wrong.\n    if (\n      expansion.validate(layer, instanceAttributes, vertexAttributes, uniforms)\n    ) {\n      // Perform the expansion\n      const extraIO = expansion.expand(\n        layer,\n        instanceAttributes,\n        vertexAttributes,\n        uniforms\n      );\n      // Now we add in the extra IO discovered\n      extraIO.instanceAttributes\n        .filter(isInstanceAttribute)\n        .forEach(attr => instanceAttributes.push(attr));\n      extraIO.vertexAttributes\n        .filter(isVertexAttribute)\n        .forEach(attr => vertexAttributes.push(attr));\n      extraIO.uniforms.filter(isUniform).forEach(attr => uniforms.push(attr));\n    }\n  }\n\n  // Do a final validation pass of the attributes injected so we can provide feedback as to why things behave odd\n  validateInstanceAttributes(\n    layer,\n    instanceAttributes,\n    vertexAttributes,\n    uniforms\n  );\n\n  // Gather instance attributes in such a way to not be mutated\n  const allInstanceAttributes = instanceAttributes.slice(0);\n  // Make sure the vertex attributes are internal attributes at this point\n  const allVertexAttributes = (vertexAttributes || []).map(\n    toVertexAttributeInternal\n  );\n  // Convert our uniforms to the internal structure they need to be\n  const allUniforms = uniforms.map(toUniformInternal);\n\n  // Apply the sorting\n  allInstanceAttributes.sort(sortIO.sortInstanceAttributes);\n  allUniforms.sort(sortIO.sortUniforms);\n  allVertexAttributes.sort(sortIO.sortVertexAttributes);\n\n  // Let's pack in our attributes automagically so we can determine block and block indices.\n  packAttributes(allInstanceAttributes);\n  // Before we make the vertex attributes, we must determine the buffering strategy our layer will utilize\n  getLayerBufferType(gl, layer, vertexAttributes, allInstanceAttributes);\n\n  return {\n    instanceAttributes: allInstanceAttributes,\n    uniforms: allUniforms,\n    vertexAttributes: allVertexAttributes\n  };\n}\n","import { Omit, ResourceType } from \"../../types\";\nimport { BaseResourceRequest } from \"../base-resource-manager\";\nimport { SubTexture } from \"./sub-texture\";\n\n/**\n * Base information an atlas resource can provide\n */\nexport interface IAtlasResourceRequest extends BaseResourceRequest {\n  /**\n   * When this is set in conjunction with the resource requested, this will cause the resource to be\n   * removed from the resource manager, thus allowing the resource's space to be used at a later\n   * time.\n   */\n  disposeResource?: boolean;\n  /**\n   * This scales the image to be rendered to the texture. A value of 1 means the image will be\n   * rendered full size to the texture. A value of .5 means it will be rendered half size to\n   * the texture.\n   */\n  rasterizationScale?: number;\n  /** This is the requested resource to be loaded into the manager system */\n  source: string | TexImageSource;\n  /**\n   * Once loaded into the texture, this will be populated revealing the informaion needed to sample the image\n   * from the atlas.\n   */\n  texture?: SubTexture;\n  /** Set the type of this resource for categorization by resource managers */\n  type: ResourceType.ATLAS;\n}\n\n/**\n * Simple wrapper to make autocomplete easier for making an atlas request.\n */\nexport function atlasRequest(\n  options: Omit<Partial<IAtlasResourceRequest>, \"type\">\n): IAtlasResourceRequest {\n  return {\n    type: ResourceType.ATLAS,\n    source: \"\",\n    ...options\n  };\n}\n","import { Texture } from \"../../gl/texture\";\nimport { Instance } from \"../../instance-provider/instance\";\nimport { ILayerProps, Layer } from \"../../surface\";\nimport { BaseIOExpansion } from \"../../surface/layer-processing/base-io-expansion\";\nimport {\n  InstanceIOValue,\n  IResourceContext,\n  IResourceInstanceAttribute,\n  ResourceType\n} from \"../../types\";\nimport { nextFrame } from \"../../util\";\nimport {\n  BaseResourceManager,\n  BaseResourceOptions\n} from \"../base-resource-manager\";\nimport { Atlas, IAtlasResource, isAtlasResource } from \"./atlas\";\nimport { AtlasManager } from \"./atlas-manager\";\nimport { IAtlasResourceRequest } from \"./atlas-resource-request\";\nimport { subTextureIOValue } from \"./sub-texture\";\nimport { TextureIOExpansion } from \"./texture-io-expansion\";\n\nexport interface IAtlasResourceManagerOptions {\n  /** This is the atlas manager that handles operations with our atlas' */\n  atlasManager?: AtlasManager;\n}\n\n/**\n * This class is responsible for tracking resources requested to be placed on an Atlas.\n * This makes sure the resource is uploaded and then properly cached so similar requests\n * return already existing resources. This also manages instances waiting for the resource\n * to be made available.\n */\nexport class AtlasResourceManager extends BaseResourceManager<\n  IAtlasResource,\n  IAtlasResourceRequest\n> {\n  /** This is the resources generated by this manager */\n  resources = new Map<string, Atlas>();\n  /** This is the atlas manager that handles operations with our atlas' */\n  atlasManager: AtlasManager;\n  /** This is the atlas currently targetted by requests */\n  targetAtlas: string = \"\";\n  /** This stores all of the requests awaiting dequeueing */\n  private requestQueue = new Map<string, IAtlasResourceRequest[]>();\n  /**\n   * This tracks if a resource is already in the request queue. This also stores ALL instances awaiting the resource.\n   */\n  private requestLookup = new Map<\n    string,\n    Map<IAtlasResourceRequest, [Layer<any, any>, Instance][]>\n  >();\n\n  constructor(options?: IAtlasResourceManagerOptions) {\n    super();\n    this.atlasManager = (options && options.atlasManager) || new AtlasManager();\n  }\n\n  /**\n   * This dequeues all instance requests for a resource and processes the request which will\n   * inevitably make the instance active\n   */\n  async dequeueRequests() {\n    // This flag will be modified to reflect if a dequeue operation has occurred\n    let didDequeue = false;\n\n    const resourceRequestsWithKey: [string, IAtlasResourceRequest[]][] = [];\n\n    this.requestQueue.forEach((requests, resourceKey) => {\n      resourceRequestsWithKey.push([resourceKey, requests]);\n    });\n\n    this.requestQueue.clear();\n\n    for (const [targetAtlas, requests] of resourceRequestsWithKey) {\n      if (requests.length > 0) {\n        // We did dequeue\n        didDequeue = true;\n        // Pull out all of the requests into a new array and empty the existing queue to allow the queue to register\n        // New requests while this dequeue is being processed\n        const allRequests = requests.slice(0);\n        // Empty the queue to begin taking in new requests as needed\n        requests.length = 0;\n        // Tell the atlas manager to update with all of the requested resources\n        await this.atlasManager.updateAtlas(targetAtlas, allRequests);\n        // Get the requests for the given atlas\n        const atlasRequests = this.requestLookup.get(targetAtlas);\n\n        if (atlasRequests) {\n          // Once the manager has been updated, we can now flag all of the instances waiting for the resources\n          // As active, which should thus trigger an update to the layers to perform a diff for each instance\n          allRequests.forEach(request => {\n            const requesters = atlasRequests.get(request);\n            atlasRequests.delete(request);\n\n            if (requesters && !request.disposeResource) {\n              for (let i = 0, iMax = requesters.length; i < iMax; ++i) {\n                const [layer, instance] = requesters[i];\n                // If the instance is still associated with buffer locations, then the instance can be activated. Having\n                // A buffer location is indicative the instance has not been deleted.\n                if (layer.managesInstance(instance)) {\n                  // Make sure the instance is active\n                  instance.active = true;\n                }\n              }\n\n              // Do a delay to next frame before we do our resource trigger so we can see any lingering updates get\n              // applied to the instance's rendering\n              nextFrame(() => {\n                const triggered = new Set();\n\n                for (let i = 0, iMax = requesters.length; i < iMax; ++i) {\n                  const instance = requesters[i][1];\n\n                  if (!triggered.has(instance)) {\n                    triggered.add(instance);\n                    instance.active = true;\n                    instance.resourceTrigger();\n                  }\n                }\n              });\n            }\n          });\n        }\n      }\n    }\n\n    return didDequeue;\n  }\n\n  /**\n   * Free ALL resources managed under this resource manager\n   */\n  destroy() {\n    this.atlasManager.destroy();\n  }\n\n  /**\n   * This retrieves the actual atlas texture that should be applied to a uniform's\n   * value.\n   */\n  getAtlasTexture(key: string): Texture | null {\n    const atlas = this.atlasManager.getAtlasTexture(key);\n\n    if (atlas) {\n      return atlas.texture;\n    }\n\n    return null;\n  }\n\n  /**\n   * Get generated resources from this manager\n   */\n  getResource(resourceKey: string) {\n    return this.resources.get(resourceKey) || null;\n  }\n\n  /**\n   * Return the IO Expander necessary to handle the resurce type this manager is attempting to provide for layers.\n   */\n  getIOExpansion(): BaseIOExpansion[] {\n    return [new TextureIOExpansion(ResourceType.ATLAS, this)];\n  }\n\n  /**\n   * Initialize the atlas resources requested for construction\n   */\n  async initResource(resource: BaseResourceOptions) {\n    if (isAtlasResource(resource)) {\n      const atlas = await this.atlasManager.createAtlas(resource);\n      this.resources.set(resource.key, atlas);\n    }\n  }\n\n  /**\n   * This is a request for atlas texture resources. It will produce either the coordinates needed to\n   * make valid texture lookups, or it will trigger a loading of resources to an atlas and cause an\n   * automated deactivation and reactivation of the instance.\n   */\n  request<T extends Instance, U extends ILayerProps<T>>(\n    layer: Layer<T, U>,\n    instance: Instance,\n    request: IAtlasResourceRequest,\n    context?: IResourceContext\n  ): InstanceIOValue {\n    const resourceContext =\n      this.targetAtlas || (context && context.resource.key) || \"\";\n    const texture = request.texture;\n\n    // If the texture is ready and available, then we simply return the IO values\n    if (texture) {\n      return subTextureIOValue(texture);\n    }\n\n    // If a request is already made, then we must save the instance making the request for deactivation and\n    // Reactivation but without any additional atlas loading\n    let atlasRequests = this.requestLookup.get(resourceContext);\n\n    if (atlasRequests) {\n      const existingRequests = atlasRequests.get(request);\n\n      if (existingRequests) {\n        existingRequests.push([layer, instance]);\n        instance.active = false;\n\n        return subTextureIOValue(texture);\n      }\n    } else {\n      atlasRequests = new Map();\n      this.requestLookup.set(resourceContext, atlasRequests);\n    }\n\n    // If the texture is not available, then we must load the resource, deactivate the instance\n    // And wait for the resource to become available. Once the resource is available, the system\n    // Must activate the instance to render the resource.\n    if (!request.disposeResource) {\n      instance.active = false;\n    }\n\n    let requests = this.requestQueue.get(resourceContext);\n\n    if (!requests) {\n      requests = [];\n      this.requestQueue.set(resourceContext, requests);\n    }\n\n    requests.push(request);\n    atlasRequests.set(request, [[layer, instance]]);\n\n    // This returns essentially returns blank values for the resource lookup\n    return subTextureIOValue(texture);\n  }\n\n  /**\n   * Sets the context attribute during attribute updates from the layers\n   */\n  setAttributeContext(attribute: IResourceInstanceAttribute<Instance>) {\n    this.targetAtlas = attribute.resource.key;\n  }\n}\n","let canvas: CanvasRenderingContext2D | null;\n\nexport interface IImageRasterizedMetrics {\n  canvas: HTMLCanvasElement;\n  height: number;\n  width: number;\n}\n\nexport class ImageRasterizer {\n  /**\n   * This loops until our canvas context is available\n   */\n  static async awaitContext() {\n    // Iterate till the browser provides a valid canvas to render elements into\n    while (!canvas) {\n      this.getContext();\n      await new Promise(resolve => setTimeout(resolve, 10));\n    }\n  }\n\n  /**\n   * Attempts to populate the 'canvas' context for rendering images offscreen.\n   */\n  static getContext() {\n    if (!canvas) {\n      canvas = document.createElement(\"canvas\").getContext(\"2d\");\n    }\n  }\n\n  /**\n   * This ensures an image is renderable at the current moment. This draws the image to a canvas partially\n   * to help the image 'warm up' within some browser contexts to ensure the image can be used as a drawable item.\n   */\n  static async calculateImageSize(image: HTMLImageElement) {\n    await this.awaitContext();\n\n    if (!canvas) {\n      console.warn(\n        \"The Image rasterizer was unable to establish a valid canvas context. Please ensure the system supports contexts and ensure the document is ready first.\"\n      );\n      return;\n    }\n\n    if (image.width === 0 || image.height === 0) {\n      console.warn(\n        \"Images provided shoud have valid dimensions! Please ensure the image is loaded first.\"\n      );\n      return;\n    }\n\n    // Just make sure th canvas is available\n    canvas.canvas.width = 100;\n    canvas.canvas.height = 100;\n    // Render the image into our canvas merely to ensure the image can be rendered\n    // This action often 'warms up' images such as images that have a data URL instead of a path\n    canvas.drawImage(image, 0, 0, 1, 1);\n\n    return [image.width, image.height];\n  }\n\n  /**\n   * This resizes the input image by the provided scale.\n   */\n  static async resizeImage(image: TexImageSource, scale: number) {\n    await this.awaitContext();\n\n    if (!canvas) {\n      console.warn(\n        \"The Image rasterizer was unable to establish a valid canvas context. Please ensure the system supports contexts and ensure the document is ready first.\"\n      );\n\n      return image;\n    }\n\n    if (image.width === 0 || image.height === 0) {\n      console.warn(\n        \"Images provided shoud have valid dimensions! Please ensure the image is loaded first.\"\n      );\n\n      return image;\n    }\n\n    // Make the canvas the proper size to render the resized image\n    canvas.canvas.width = Math.floor(image.width * scale);\n    canvas.canvas.height = Math.floor(image.height * scale);\n\n    // Render the image into our canvas with the resizing taking place\n    if (image instanceof ImageData) {\n      canvas.putImageData(\n        image,\n        0,\n        0,\n        0,\n        0,\n        canvas.canvas.width,\n        canvas.canvas.height\n      );\n    } else {\n      canvas.drawImage(image, 0, 0, canvas.canvas.width, canvas.canvas.height);\n    }\n\n    // Make our canvas a data url for another image to become\n    const out = new Image();\n    out.src = canvas.canvas.toDataURL(\"image/png\");\n    // Ensure the image is renderable at this moment\n    await ImageRasterizer.calculateImageSize(out);\n\n    return out;\n  }\n}\n","import { Bounds } from \"../../primitives/bounds\";\nimport { ImageRasterizer } from \"../../resources/texture/image-rasterizer\";\nimport { Atlas, IAtlasResource } from \"./atlas\";\nimport { IAtlasResourceRequest } from \"./atlas-resource-request\";\nimport { IPackNodeDimensions, PackNode } from \"./pack-node\";\nimport { SubTexture } from \"./sub-texture\";\n\nconst debug = require(\"debug\")(\"performance\");\n\nconst ZERO_IMAGE: SubTexture = {\n  aspectRatio: 0,\n  atlasBL: [0, 0],\n  atlasBR: [0, 0],\n  textureReferenceID: \"\",\n  texture: null,\n  atlasTL: [0, 0],\n  atlasTR: [0, 0],\n  heightOnAtlas: 0,\n  isValid: false,\n  pixelHeight: 0,\n  pixelWidth: 0,\n  widthOnAtlas: 0\n};\n\n/**\n * Determines if a SubTexture is a valid SubTexture for rendering\n */\nfunction isValidImage(image?: SubTexture): image is SubTexture {\n  if (image && image.isValid) {\n    if (image.pixelWidth && image.pixelHeight) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Defines a manager of atlas', which includes generating the atlas and producing\n * textures defining those pieces of atlas.\n */\nexport class AtlasManager {\n  /** Stores all of the generated atlas' in a lookup by name */\n  allAtlas = new Map<string, Atlas>();\n\n  /**\n   * Creates a new atlas that resources can be loaded into.\n   *\n   * @param resources The images with their image path set to be loaded into the atlas.\n   *               Images that keep an atlas ID of null indicates the image did not load\n   *               correctly\n   *\n   * @return {Texture} The texture that is created as our atlas. The images injected\n   *                   into the texture will be populated with the atlas'\n   */\n  async createAtlas(options: IAtlasResource) {\n    // Create the new Atlas object that tracks all of our atlas' metrics\n    const atlas = new Atlas(options);\n    // Make the atlas identifiable by it's name\n    this.allAtlas.set(atlas.id, atlas);\n\n    debug(\"Atlas Created-> %o\", atlas);\n\n    return atlas;\n  }\n\n  /**\n   * Free ALL resources under this manager\n   */\n  destroy() {\n    this.allAtlas.forEach(value => value.destroy());\n  }\n\n  /**\n   * Disposes of the resources the atlas held and makes the atlas invalid for use\n   *\n   * @param atlasName\n   */\n  destroyAtlas(atlasName: string) {\n    const atlas = this.allAtlas.get(atlasName);\n\n    if (atlas) {\n      atlas.destroy();\n    }\n  }\n\n  private setDefaultImage(image: SubTexture, atlasName: string) {\n    image = Object.assign(image, ZERO_IMAGE, { atlasReferenceID: atlasName });\n    return image;\n  }\n\n  /**\n   * This loads, packs, and draws the indicated image into the specified canvas\n   * using the metrics that exists for the specified atlas.\n   *\n   * @param request The image who should have it's image path loaded\n   * @param atlasName The name of the atlas to make the packing work\n   * @param canvas The canvas we will be drawing into to generate the complete image\n   *\n   * @return {Promise<boolean>} Promise that resolves to if the image successfully was drawn or not\n   */\n  private async draw(\n    atlas: Atlas,\n    request: IAtlasResourceRequest\n  ): Promise<boolean> {\n    const atlasName = atlas.id;\n\n    // We don't draw or process requests to resources being disposed.\n    if (request.disposeResource) {\n      return true;\n    }\n\n    // First ensure the atlas does not have this resource referenced yet\n    const existing = atlas.resourceReferences.get(request.source);\n\n    if (existing) {\n      return true;\n    }\n\n    // Immediately register the resource with a subtexture to prevent duplicate\n    // processing.\n    request.texture = request.texture || new SubTexture();\n    request.texture.isValid = true;\n    atlas.resourceReferences.set(request.source, {\n      subtexture: request.texture,\n      count: 0\n    });\n\n    // First we must load the image\n    // Make a buffer to hold our new image\n    // Load the image into memory, default to keeping the alpha channel\n    const loadedImage: TexImageSource | null = await this.loadImage(request);\n    // Get the sub texture that is going to be applied to the atlas\n    const texture = request.texture;\n\n    // Only a non-null image means the image loaded correctly\n    if (loadedImage && isValidImage(texture)) {\n      // Now we create a Rectangle to store the image dimensions\n      const rect: Bounds = new Bounds({\n        bottom: texture.pixelHeight,\n        left: 0,\n        right: texture.pixelWidth,\n        top: 0\n      });\n\n      // Create ImageDimension to insert into our atlas mapper\n      const dimensions: IPackNodeDimensions<SubTexture> = {\n        data: texture,\n        bounds: rect\n      };\n\n      // Auto add a buffer in\n      dimensions.bounds.width += 1;\n      dimensions.bounds.height += 1;\n      // Get the atlas map node\n      let packing: PackNode<SubTexture> = atlas.packing;\n      // Store the node resulting from the insert operation\n      let insertedNode: PackNode<SubTexture> | null = packing.insert(\n        dimensions\n      );\n\n      // If we failed to insert the image, let's repack the atlas and attempt a second round\n      // of packing.\n      if (!insertedNode) {\n        // Repack the atlas\n        this.repackResources(atlas);\n        // Attempt to inset the item again\n        packing = atlas.packing;\n        insertedNode = packing.insert(dimensions);\n      }\n\n      // If the result was NULL we did not successfully insert the image into any map\n      if (insertedNode) {\n        // Apply the image to the node\n        insertedNode.data = texture;\n\n        // Set our image's atlas properties\n        PackNode.applyToSubTexture(packing, insertedNode, texture, {\n          top: 0,\n          left: 0,\n          right: 1,\n          bottom: 1\n        });\n\n        // Now specify the update region to be applied to the texture\n        atlas.texture.update(loadedImage, {\n          ...insertedNode.bounds,\n          y: atlas.height - insertedNode.bounds.y - insertedNode.bounds.height\n        });\n\n        // We have finished inserting\n        return true;\n      } else {\n        // Log an error\n        console.error(`Could not fit resource into atlas`, request);\n        request.texture = this.setDefaultImage(texture, atlasName);\n        return false;\n      }\n    }\n\n    // Since the image did not fit, we now get the atlas to consolidate all of it's existing resources\n    // by removing unused images that were placed in the atlas but were flagged as no longer used.\n    else {\n      if (texture && !texture.isValid) {\n        debug(\"Resource was invalidated during load:\", request);\n      } else {\n        // Log an error and load a default sub texture\n        console.error(`Could not load resource:`, request);\n      }\n\n      if (request.texture) {\n        request.texture = this.setDefaultImage(request.texture, atlasName);\n      }\n\n      return false;\n    }\n  }\n\n  /**\n   * Retrieves the actual Atlas object for a given resource id\n   */\n  getAtlasTexture(resourceId: string): Atlas | undefined {\n    return this.allAtlas.get(resourceId);\n  }\n\n  /**\n   * This takes in any atlas resource and ensures the image is available and ready to\n   * render.\n   */\n  private async loadImage(\n    resource: IAtlasResourceRequest\n  ): Promise<TexImageSource | null> {\n    const subTexture = resource.texture || new SubTexture();\n    const source = resource.source;\n    resource.texture = subTexture;\n    if (resource.texture.isValid === false) return null;\n\n    if (source instanceof HTMLImageElement) {\n      let image = await new Promise<TexImageSource | null>(resolve => {\n        if (!(source instanceof HTMLImageElement)) return;\n        const image: HTMLImageElement | undefined = source;\n\n        if (image.width && image.height) {\n          ImageRasterizer.calculateImageSize(image);\n          subTexture.pixelWidth = image.width;\n          subTexture.pixelHeight = image.height;\n          subTexture.aspectRatio = image.width / image.height;\n          resolve(image);\n          return;\n        }\n\n        if (image) {\n          image.onload = function() {\n            subTexture.pixelWidth = image.width;\n            subTexture.pixelHeight = image.height;\n            subTexture.aspectRatio = image.width / image.height;\n            resolve(image);\n          };\n\n          image.onerror = function() {\n            resolve(null);\n          };\n        } else {\n          resolve(null);\n        }\n      });\n\n      if (\n        image &&\n        resource.rasterizationScale !== undefined &&\n        resource.rasterizationScale !== 1\n      ) {\n        image = await ImageRasterizer.resizeImage(\n          image,\n          resource.rasterizationScale || 1\n        );\n      }\n\n      return image;\n    } else if (source instanceof HTMLVideoElement) {\n      console.warn(\"System does not support HTMLVideoElements yet\");\n    } else if (typeof source === \"string\") {\n      const dataURL = source;\n\n      let image = await new Promise<TexImageSource | null>(resolve => {\n        const image = new Image();\n\n        image.onload = function() {\n          subTexture.pixelWidth = image.width;\n          subTexture.pixelHeight = image.height;\n          subTexture.aspectRatio = image.width / image.height;\n          resolve(image);\n        };\n\n        image.onerror = function() {\n          resolve(null);\n        };\n\n        image.src = dataURL;\n      });\n\n      if (\n        image &&\n        resource.rasterizationScale !== undefined &&\n        resource.rasterizationScale !== 1\n      ) {\n        image = await ImageRasterizer.resizeImage(\n          image,\n          resource.rasterizationScale || 1\n        );\n      }\n    } else {\n      let image: TexImageSource = source;\n\n      if (\n        image &&\n        resource.rasterizationScale !== undefined &&\n        resource.rasterizationScale !== 1\n      ) {\n        image = await ImageRasterizer.resizeImage(\n          image,\n          resource.rasterizationScale || 1\n        );\n      }\n\n      return image;\n    }\n\n    return null;\n  }\n\n  /**\n   * When this is triggered, the atlas will examine all of it's packing and repack it's resources\n   * on the texture for the atlas thus eliminating any dead space from resources that have been disposed.\n   *\n   * This process will cause the atlas to generate a new Texture to utilize and dispose of the old texture\n   * to allow for the atlas to redraw it's texture using GPU operations which is much faster than a CPU operation\n   * of generating the texture.\n   */\n  private repackResources(_atlas: Atlas) {\n    // TODO\n    console.warn(\n      \"Atlas is attempting repacking, but the method to do so has not been implmented yet.\"\n    );\n\n    return true;\n  }\n\n  /**\n   * This targets an existing atlas and attempts to update it with the provided atlas resources.\n   */\n  async updateAtlas(atlasName: string, requests: IAtlasResourceRequest[]) {\n    const atlas = this.allAtlas.get(atlasName);\n\n    if (atlas) {\n      const promises = [];\n\n      for (let i = 0, iMax = requests.length; i < iMax; ++i) {\n        const request = requests[i];\n\n        if (!request.disposeResource) {\n          promises.push(this.draw(atlas, request));\n        }\n      }\n\n      await Promise.all(promises);\n\n      // Now that all of the requests have been processed, we can now update reference counting for the\n      // underlying resources.\n      for (let i = 0, iMax = requests.length; i < iMax; ++i) {\n        const request = requests[i];\n\n        if (request.disposeResource) atlas.stopUsingResource(request);\n        else atlas.useResource(request);\n      }\n\n      // Now resolve the reference counting with the atlas so the atlas can invalidate textures and flag\n      // space on the atlas as available for rendering again.\n      atlas.resolveResources();\n    } else {\n      console.warn(\n        \"Can not update non-existing atlas:\",\n        atlasName,\n        \"These resources will not be loaded:\",\n        requests\n      );\n    }\n\n    return atlas;\n  }\n}\n","import { Texture } from \"../../gl/texture\";\nimport { ResourceType } from \"../../types\";\nimport { BaseResourceRequest } from \"../base-resource-manager\";\nimport { FontMap, KernedLayout } from \"./font-map\";\n\nexport enum FontResourceRequestFetch {\n  /** Retrieves the tex coordinates on the font map of the specified character glyph. Defaults to [0, 0, 0, 0] */\n  TEXCOORDS = 0,\n  /** Retrieves the pixel size of the character glyph on the font map */\n  IMAGE_SIZE = 1\n}\n\n/**\n * Properties needed to make a font resource request\n */\nexport interface IFontResourceRequest extends BaseResourceRequest {\n  /** The character being requested from the fontmap */\n  character?: string;\n  /** This changes the information retrieved as a result of the request method. */\n  fetch?: FontResourceRequestFetch;\n  /**\n   * When the request has been processed and results become available, this is populated with the FontMap object that has everything\n   * needed for the requester to get the information needed.\n   */\n  fontMap?: FontMap;\n  /**\n   * The characters for which we want to have the kerning information retrieved. This will be applied as a list of words\n   * for which we want the kerning information. We do this to prevent concating the words into a single string which can\n   * make it really difficult to preload all possible label combinations.\n   */\n  kerningPairs?: string[];\n  /** When provided, the request will fill in the metrics for the input parameters */\n  metrics?: {\n    /** The desired font size for the layout */\n    fontSize: number;\n    /**\n     * The system will populate this for you with the layout (top left is at 0,0) of the text.\n     * If maxWidth is provided, this will be the layout of the truncated text.\n     */\n    layout?: KernedLayout;\n    /** When provided, this will cause the system to see if the text should be truncated or not */\n    maxWidth?: number;\n    /** This is the source text that we wish to receive the metrics for. */\n    text: string;\n    /** These are the characters to use to indicate truncation in the event truncation takes place */\n    truncation?: string;\n    /**\n     * If maxWidth is provided, this will provide the calculated truncated text. This will be the full\n     * text if no truncation is provided.\n     */\n    truncatedText?: string;\n  };\n  /** This is to satisfy the use of the TextureIOExpansion. This is the texture within the fontmap */\n  texture?: Texture;\n  /** Establish the only type that this request shall be is a FONT type */\n  type: ResourceType.FONT;\n}\n","import { Attribute } from \"../../gl\";\nimport { Instance } from \"../../instance-provider/instance\";\nimport { MetricsProcessing } from \"../../shaders/processing/metrics-processing\";\nimport { ILayerProps, Layer } from \"../../surface/layer\";\nimport {\n  IInstanceAttribute,\n  IInstancingUniform,\n  IUniform,\n  IVertexAttribute,\n  ShaderInjectionTarget\n} from \"../../types\";\n\nconst debug = require(\"debug\")(\"performance\");\n\n/**\n * The result of an injection into the header of a shader. Allows for injection content into the header\n * and provide extra Shader IO such as uniforms and attributes.\n */\nexport type ShaderIOHeaderInjectionResult = {\n  /** The content to inject into the shader */\n  injection: string;\n  /** Additional geometry changes possibly caused by the header injection */\n  geometry?: {\n    attributes: { [key: string]: Attribute };\n  };\n  /** Additional material changes possibly caused by the header injection changes */\n  material?: {\n    uniforms: IInstancingUniform[];\n  };\n};\n\nexport type ShaderDeclarationStatements = Map<string, string>;\n\n/**\n * This is the basis to allow the system to have additional shader injection capabilities.\n * This will cover an object or manager that wishes to inject elements into the header of the\n * shader and inject elements after attribute destructuring.\n */\nexport abstract class BaseShaderIOInjection {\n  /**\n   * This is a helper to apply declarations to the input declaration object. This will automatically use the\n   * performance debug output to provide useful information when overrides occur.\n   */\n  setDeclaration(\n    declarations: ShaderDeclarationStatements,\n    key: string,\n    value: string,\n    debugMessageCtx?: string\n  ) {\n    if (declarations.get(key)) {\n      debug(\n        \"%s: Overriding declaration %s\\nSetting new value: %s\",\n        debugMessageCtx || \"Expand IO Declarations\",\n        key,\n        value\n      );\n    }\n\n    declarations.set(key, value);\n  }\n\n  /**\n   * This allows for injection into the header of the shader.\n   *\n   * The order these controllers are injected\n   * into the system determines the order the contents are written to the header. So dependent injections\n   * must be sorted appropriately.\n   *\n   * @param target Specifies which shader type we should be writing the header for. Will be FS OR VS not ALL.\n   * @param declarations This is where the output should register declarations so the system can composite them together.\n   *                     This allows for IO Injections to override each other on declared names and help them set up expectations\n   *                     amongst each other for shader output.\n   * @param layer The layer that is currently being processed\n   * @param metrics Some metrics processed that are useful for making decisions about buffering strategies etc.\n   */\n  abstract processHeaderInjection(\n    target: ShaderInjectionTarget,\n    declarations: ShaderDeclarationStatements,\n    layer: Layer<Instance, ILayerProps<Instance>>,\n    metrics: MetricsProcessing,\n    vertexAttributes: IVertexAttribute[],\n    instanceAttributes: IInstanceAttribute<Instance>[],\n    uniforms: IUniform[]\n  ): ShaderIOHeaderInjectionResult;\n\n  /**\n   * This allows for injection into the shader AFTER attribute destructuring has taken place.\n   *\n   * The order these controllers are injected\n   * into the system determines the order the contents are written to the header. So dependent injections\n   * must be sorted appropriately.\n   *\n   * @param layer The layer that is currently being processed\n   * @param declarations This is where the output should register declarations so the system can composite them together.\n   *                     This allows for IO Injections to override each other on declared names and help them set up expectations\n   *                     amongst each other for shader output.\n   * @param metrics Some metrics processed that are useful for making decisions about buffering strategies etc.\n   */\n  abstract processAttributeDestructuring(\n    layer: Layer<Instance, ILayerProps<Instance>>,\n    declarations: ShaderDeclarationStatements,\n    metrics: MetricsProcessing,\n    vertexAttributes: IVertexAttribute[],\n    instanceAttributes: IInstanceAttribute<Instance>[],\n    uniforms: IUniform[]\n  ): string;\n}\n","/**\n * This provides the methods needed to render single glyphs and receive the image data\n * for the rendering. The glyphs will be rendered within a given dimension range and centered.\n */\n\nconst { min, max } = Math;\nconst canvas = document.createElement(\"canvas\");\nlet ctx: CanvasRenderingContext2D;\n\n/**\n * Measures the contents of a canvas based on the canvas havinga pure black\n * background with rendered elements as white.\n */\nfunction measureBlackWhiteCanvasContents(canvas: CanvasRenderingContext2D) {\n  const { width, height } = canvas.canvas;\n  const imageData = canvas.getImageData(0, 0, width, height).data;\n  let r;\n\n  let found = false;\n  let minY = Number.MAX_SAFE_INTEGER;\n  let minX = Number.MAX_SAFE_INTEGER;\n  let maxX = Number.MIN_SAFE_INTEGER;\n  let maxY = Number.MIN_SAFE_INTEGER;\n\n  for (let i = 0; i < width; ++i) {\n    for (let k = 0; k < height; ++k) {\n      const redIndex = k * (width * 4) + i * 4;\n      r = imageData[redIndex];\n\n      if (r > 0.0) {\n        found = true;\n        minY = min(minY, k);\n        minX = min(minX, i);\n        maxX = max(maxX, i);\n        maxY = max(maxY, k);\n      }\n    }\n  }\n\n  if (!found) {\n    return null;\n  }\n\n  // The identified pixel needs to be encased and not a direct target\n  minY -= 1;\n  maxY += 2;\n  maxX += 2;\n  minX -= 1;\n\n  minY = max(minY, 0);\n  minX = max(minX, 0);\n\n  return { minX, minY, maxX, maxY };\n}\n\n/**\n * Renders a glyph centered within the provided rectangle size. This also provides the size of the\n * rendered glyph along with a vector pointing to the topleft of the glyph within then rectangle.\n * This vector can be used to find any corner of the glyph as the glyph is centered within the\n * rectangle's space.\n */\nexport function renderGlyph(\n  glyph: string,\n  width: number,\n  height: number,\n  font: string\n) {\n  // Ensure we're rendering a single characters\n  glyph = glyph[0];\n\n  if (canvas.width < width || canvas.height < height) {\n    canvas.width = width;\n    canvas.height = height;\n  }\n\n  if (!ctx) {\n    const context = canvas.getContext(\"2d\");\n    if (context) ctx = context;\n    else return null;\n  }\n\n  // Draw the glyph\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n  ctx.font = font;\n  ctx.fillStyle = \"white\";\n  ctx.fillText(glyph, width / 2, height / 2);\n\n  // Get the metrics of the glyph within the rendering\n  const dimensions = measureBlackWhiteCanvasContents(ctx);\n\n  if (!dimensions) {\n    const data = ctx.getImageData(0, 0, 1, 1);\n\n    return {\n      data,\n      size: [0, 0]\n    };\n  }\n\n  // Copy the data from the rendering\n  const glyphWidth = dimensions.maxX - dimensions.minX;\n  const glyphHeight = dimensions.maxY - dimensions.minY;\n\n  const data = ctx.getImageData(\n    dimensions.minX,\n    dimensions.minY,\n    glyphWidth,\n    glyphHeight\n  );\n\n  return {\n    data,\n    size: [glyphWidth, glyphHeight]\n  };\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Proxy = undefined;\n\nvar _Feature = require('./Feature');\n\nvar _Feature2 = _interopRequireDefault(_Feature);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Proxy = exports.Proxy = function Proxy(src, options) {\n    if (!options.proxy) {\n        return Promise.reject(process.env.NODE_ENV !== 'production' ? 'No proxy defined' : null);\n    }\n    var proxy = options.proxy;\n\n    return new Promise(function (resolve, reject) {\n        var responseType = _Feature2.default.SUPPORT_CORS_XHR && _Feature2.default.SUPPORT_RESPONSE_TYPE ? 'blob' : 'text';\n        var xhr = _Feature2.default.SUPPORT_CORS_XHR ? new XMLHttpRequest() : new XDomainRequest();\n        xhr.onload = function () {\n            if (xhr instanceof XMLHttpRequest) {\n                if (xhr.status === 200) {\n                    if (responseType === 'text') {\n                        resolve(xhr.response);\n                    } else {\n                        var reader = new FileReader();\n                        // $FlowFixMe\n                        reader.addEventListener('load', function () {\n                            return resolve(reader.result);\n                        }, false);\n                        // $FlowFixMe\n                        reader.addEventListener('error', function (e) {\n                            return reject(e);\n                        }, false);\n                        reader.readAsDataURL(xhr.response);\n                    }\n                } else {\n                    reject(process.env.NODE_ENV !== 'production' ? 'Failed to proxy resource ' + src.substring(0, 256) + ' with status code ' + xhr.status : '');\n                }\n            } else {\n                resolve(xhr.responseText);\n            }\n        };\n\n        xhr.onerror = reject;\n        xhr.open('GET', proxy + '?url=' + encodeURIComponent(src) + '&responseType=' + responseType);\n\n        if (responseType !== 'text' && xhr instanceof XMLHttpRequest) {\n            xhr.responseType = responseType;\n        }\n\n        if (options.imageTimeout) {\n            var timeout = options.imageTimeout;\n            xhr.timeout = timeout;\n            xhr.ontimeout = function () {\n                return reject(process.env.NODE_ENV !== 'production' ? 'Timed out (' + timeout + 'ms) proxying ' + src.substring(0, 256) : '');\n            };\n        }\n\n        xhr.send();\n    });\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.FontMetrics = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Util = require('./Util');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar SAMPLE_TEXT = 'Hidden Text';\n\nvar FontMetrics = exports.FontMetrics = function () {\n    function FontMetrics(document) {\n        _classCallCheck(this, FontMetrics);\n\n        this._data = {};\n        this._document = document;\n    }\n\n    _createClass(FontMetrics, [{\n        key: '_parseMetrics',\n        value: function _parseMetrics(font) {\n            var container = this._document.createElement('div');\n            var img = this._document.createElement('img');\n            var span = this._document.createElement('span');\n\n            var body = this._document.body;\n            if (!body) {\n                throw new Error(process.env.NODE_ENV !== 'production' ? 'No document found for font metrics' : '');\n            }\n\n            container.style.visibility = 'hidden';\n            container.style.fontFamily = font.fontFamily;\n            container.style.fontSize = font.fontSize;\n            container.style.margin = '0';\n            container.style.padding = '0';\n\n            body.appendChild(container);\n\n            img.src = _Util.SMALL_IMAGE;\n            img.width = 1;\n            img.height = 1;\n\n            img.style.margin = '0';\n            img.style.padding = '0';\n            img.style.verticalAlign = 'baseline';\n\n            span.style.fontFamily = font.fontFamily;\n            span.style.fontSize = font.fontSize;\n            span.style.margin = '0';\n            span.style.padding = '0';\n\n            span.appendChild(this._document.createTextNode(SAMPLE_TEXT));\n            container.appendChild(span);\n            container.appendChild(img);\n            var baseline = img.offsetTop - span.offsetTop + 2;\n\n            container.removeChild(span);\n            container.appendChild(this._document.createTextNode(SAMPLE_TEXT));\n\n            container.style.lineHeight = 'normal';\n            img.style.verticalAlign = 'super';\n\n            var middle = img.offsetTop - container.offsetTop + 2;\n\n            body.removeChild(container);\n\n            return { baseline: baseline, middle: middle };\n        }\n    }, {\n        key: 'getMetrics',\n        value: function getMetrics(font) {\n            var key = font.fontFamily + ' ' + font.fontSize;\n            if (this._data[key] === undefined) {\n                this._data[key] = this._parseMetrics(font);\n            }\n\n            return this._data[key];\n        }\n    }]);\n\n    return FontMetrics;\n}();","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.breakWords = exports.fromCodePoint = exports.toCodePoints = undefined;\n\nvar _cssLineBreak = require('css-line-break');\n\nObject.defineProperty(exports, 'toCodePoints', {\n    enumerable: true,\n    get: function get() {\n        return _cssLineBreak.toCodePoints;\n    }\n});\nObject.defineProperty(exports, 'fromCodePoint', {\n    enumerable: true,\n    get: function get() {\n        return _cssLineBreak.fromCodePoint;\n    }\n});\n\nvar _NodeContainer = require('./NodeContainer');\n\nvar _NodeContainer2 = _interopRequireDefault(_NodeContainer);\n\nvar _overflowWrap = require('./parsing/overflowWrap');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar breakWords = exports.breakWords = function breakWords(str, parent) {\n    var breaker = (0, _cssLineBreak.LineBreaker)(str, {\n        lineBreak: parent.style.lineBreak,\n        wordBreak: parent.style.overflowWrap === _overflowWrap.OVERFLOW_WRAP.BREAK_WORD ? 'break-word' : parent.style.wordBreak\n    });\n\n    var words = [];\n    var bk = void 0;\n\n    while (!(bk = breaker.next()).done) {\n        words.push(bk.value.slice());\n    }\n\n    return words;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ForeignObjectRenderer = function () {\n    function ForeignObjectRenderer(element) {\n        _classCallCheck(this, ForeignObjectRenderer);\n\n        this.element = element;\n    }\n\n    _createClass(ForeignObjectRenderer, [{\n        key: 'render',\n        value: function render(options) {\n            var _this = this;\n\n            this.options = options;\n            this.canvas = document.createElement('canvas');\n            this.ctx = this.canvas.getContext('2d');\n            this.canvas.width = Math.floor(options.width) * options.scale;\n            this.canvas.height = Math.floor(options.height) * options.scale;\n            this.canvas.style.width = options.width + 'px';\n            this.canvas.style.height = options.height + 'px';\n\n            options.logger.log('ForeignObject renderer initialized (' + options.width + 'x' + options.height + ' at ' + options.x + ',' + options.y + ') with scale ' + options.scale);\n            var svg = createForeignObjectSVG(Math.max(options.windowWidth, options.width) * options.scale, Math.max(options.windowHeight, options.height) * options.scale, options.scrollX * options.scale, options.scrollY * options.scale, this.element);\n\n            return loadSerializedSVG(svg).then(function (img) {\n                if (options.backgroundColor) {\n                    _this.ctx.fillStyle = options.backgroundColor.toString();\n                    _this.ctx.fillRect(0, 0, options.width * options.scale, options.height * options.scale);\n                }\n\n                _this.ctx.drawImage(img, -options.x * options.scale, -options.y * options.scale);\n                return _this.canvas;\n            });\n        }\n    }]);\n\n    return ForeignObjectRenderer;\n}();\n\nexports.default = ForeignObjectRenderer;\nvar createForeignObjectSVG = exports.createForeignObjectSVG = function createForeignObjectSVG(width, height, x, y, node) {\n    var xmlns = 'http://www.w3.org/2000/svg';\n    var svg = document.createElementNS(xmlns, 'svg');\n    var foreignObject = document.createElementNS(xmlns, 'foreignObject');\n    svg.setAttributeNS(null, 'width', width);\n    svg.setAttributeNS(null, 'height', height);\n\n    foreignObject.setAttributeNS(null, 'width', '100%');\n    foreignObject.setAttributeNS(null, 'height', '100%');\n    foreignObject.setAttributeNS(null, 'x', x);\n    foreignObject.setAttributeNS(null, 'y', y);\n    foreignObject.setAttributeNS(null, 'externalResourcesRequired', 'true');\n    svg.appendChild(foreignObject);\n\n    foreignObject.appendChild(node);\n\n    return svg;\n};\n\nvar loadSerializedSVG = exports.loadSerializedSVG = function loadSerializedSVG(svg) {\n    return new Promise(function (resolve, reject) {\n        var img = new Image();\n        img.onload = function () {\n            return resolve(img);\n        };\n        img.onerror = reject;\n\n        img.src = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(new XMLSerializer().serializeToString(svg));\n    });\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.parseTextBounds = exports.TextBounds = undefined;\n\nvar _Bounds = require('./Bounds');\n\nvar _textDecoration = require('./parsing/textDecoration');\n\nvar _Feature = require('./Feature');\n\nvar _Feature2 = _interopRequireDefault(_Feature);\n\nvar _Unicode = require('./Unicode');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TextBounds = exports.TextBounds = function TextBounds(text, bounds) {\n    _classCallCheck(this, TextBounds);\n\n    this.text = text;\n    this.bounds = bounds;\n};\n\nvar parseTextBounds = exports.parseTextBounds = function parseTextBounds(value, parent, node) {\n    var letterRendering = parent.style.letterSpacing !== 0;\n    var textList = letterRendering ? (0, _Unicode.toCodePoints)(value).map(function (i) {\n        return (0, _Unicode.fromCodePoint)(i);\n    }) : (0, _Unicode.breakWords)(value, parent);\n    var length = textList.length;\n    var defaultView = node.parentNode ? node.parentNode.ownerDocument.defaultView : null;\n    var scrollX = defaultView ? defaultView.pageXOffset : 0;\n    var scrollY = defaultView ? defaultView.pageYOffset : 0;\n    var textBounds = [];\n    var offset = 0;\n    for (var i = 0; i < length; i++) {\n        var text = textList[i];\n        if (parent.style.textDecoration !== _textDecoration.TEXT_DECORATION.NONE || text.trim().length > 0) {\n            if (_Feature2.default.SUPPORT_RANGE_BOUNDS) {\n                textBounds.push(new TextBounds(text, getRangeBounds(node, offset, text.length, scrollX, scrollY)));\n            } else {\n                var replacementNode = node.splitText(text.length);\n                textBounds.push(new TextBounds(text, getWrapperBounds(node, scrollX, scrollY)));\n                node = replacementNode;\n            }\n        } else if (!_Feature2.default.SUPPORT_RANGE_BOUNDS) {\n            node = node.splitText(text.length);\n        }\n        offset += text.length;\n    }\n    return textBounds;\n};\n\nvar getWrapperBounds = function getWrapperBounds(node, scrollX, scrollY) {\n    var wrapper = node.ownerDocument.createElement('html2canvaswrapper');\n    wrapper.appendChild(node.cloneNode(true));\n    var parentNode = node.parentNode;\n    if (parentNode) {\n        parentNode.replaceChild(wrapper, node);\n        var bounds = (0, _Bounds.parseBounds)(wrapper, scrollX, scrollY);\n        if (wrapper.firstChild) {\n            parentNode.replaceChild(wrapper.firstChild, wrapper);\n        }\n        return bounds;\n    }\n    return new _Bounds.Bounds(0, 0, 0, 0);\n};\n\nvar getRangeBounds = function getRangeBounds(node, offset, length, scrollX, scrollY) {\n    var range = node.ownerDocument.createRange();\n    range.setStart(node, offset);\n    range.setEnd(node, offset + length);\n    return _Bounds.Bounds.fromClientRect(range.getBoundingClientRect(), scrollX, scrollY);\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.reformatInputBounds = exports.inlineSelectElement = exports.inlineTextAreaElement = exports.inlineInputElement = exports.getInputBorderRadius = exports.INPUT_BACKGROUND = exports.INPUT_BORDERS = exports.INPUT_COLOR = undefined;\n\nvar _TextContainer = require('./TextContainer');\n\nvar _TextContainer2 = _interopRequireDefault(_TextContainer);\n\nvar _background = require('./parsing/background');\n\nvar _border = require('./parsing/border');\n\nvar _Circle = require('./drawing/Circle');\n\nvar _Circle2 = _interopRequireDefault(_Circle);\n\nvar _Vector = require('./drawing/Vector');\n\nvar _Vector2 = _interopRequireDefault(_Vector);\n\nvar _Color = require('./Color');\n\nvar _Color2 = _interopRequireDefault(_Color);\n\nvar _Length = require('./Length');\n\nvar _Length2 = _interopRequireDefault(_Length);\n\nvar _Bounds = require('./Bounds');\n\nvar _TextBounds = require('./TextBounds');\n\nvar _Util = require('./Util');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar INPUT_COLOR = exports.INPUT_COLOR = new _Color2.default([42, 42, 42]);\nvar INPUT_BORDER_COLOR = new _Color2.default([165, 165, 165]);\nvar INPUT_BACKGROUND_COLOR = new _Color2.default([222, 222, 222]);\nvar INPUT_BORDER = {\n    borderWidth: 1,\n    borderColor: INPUT_BORDER_COLOR,\n    borderStyle: _border.BORDER_STYLE.SOLID\n};\nvar INPUT_BORDERS = exports.INPUT_BORDERS = [INPUT_BORDER, INPUT_BORDER, INPUT_BORDER, INPUT_BORDER];\nvar INPUT_BACKGROUND = exports.INPUT_BACKGROUND = {\n    backgroundColor: INPUT_BACKGROUND_COLOR,\n    backgroundImage: [],\n    backgroundClip: _background.BACKGROUND_CLIP.PADDING_BOX,\n    backgroundOrigin: _background.BACKGROUND_ORIGIN.PADDING_BOX\n};\n\nvar RADIO_BORDER_RADIUS = new _Length2.default('50%');\nvar RADIO_BORDER_RADIUS_TUPLE = [RADIO_BORDER_RADIUS, RADIO_BORDER_RADIUS];\nvar INPUT_RADIO_BORDER_RADIUS = [RADIO_BORDER_RADIUS_TUPLE, RADIO_BORDER_RADIUS_TUPLE, RADIO_BORDER_RADIUS_TUPLE, RADIO_BORDER_RADIUS_TUPLE];\n\nvar CHECKBOX_BORDER_RADIUS = new _Length2.default('3px');\nvar CHECKBOX_BORDER_RADIUS_TUPLE = [CHECKBOX_BORDER_RADIUS, CHECKBOX_BORDER_RADIUS];\nvar INPUT_CHECKBOX_BORDER_RADIUS = [CHECKBOX_BORDER_RADIUS_TUPLE, CHECKBOX_BORDER_RADIUS_TUPLE, CHECKBOX_BORDER_RADIUS_TUPLE, CHECKBOX_BORDER_RADIUS_TUPLE];\n\nvar getInputBorderRadius = exports.getInputBorderRadius = function getInputBorderRadius(node) {\n    return node.type === 'radio' ? INPUT_RADIO_BORDER_RADIUS : INPUT_CHECKBOX_BORDER_RADIUS;\n};\n\nvar inlineInputElement = exports.inlineInputElement = function inlineInputElement(node, container) {\n    if (node.type === 'radio' || node.type === 'checkbox') {\n        if (node.checked) {\n            var size = Math.min(container.bounds.width, container.bounds.height);\n            container.childNodes.push(node.type === 'checkbox' ? [new _Vector2.default(container.bounds.left + size * 0.39363, container.bounds.top + size * 0.79), new _Vector2.default(container.bounds.left + size * 0.16, container.bounds.top + size * 0.5549), new _Vector2.default(container.bounds.left + size * 0.27347, container.bounds.top + size * 0.44071), new _Vector2.default(container.bounds.left + size * 0.39694, container.bounds.top + size * 0.5649), new _Vector2.default(container.bounds.left + size * 0.72983, container.bounds.top + size * 0.23), new _Vector2.default(container.bounds.left + size * 0.84, container.bounds.top + size * 0.34085), new _Vector2.default(container.bounds.left + size * 0.39363, container.bounds.top + size * 0.79)] : new _Circle2.default(container.bounds.left + size / 4, container.bounds.top + size / 4, size / 4));\n        }\n    } else {\n        inlineFormElement(getInputValue(node), node, container, false);\n    }\n};\n\nvar inlineTextAreaElement = exports.inlineTextAreaElement = function inlineTextAreaElement(node, container) {\n    inlineFormElement(node.value, node, container, true);\n};\n\nvar inlineSelectElement = exports.inlineSelectElement = function inlineSelectElement(node, container) {\n    var option = node.options[node.selectedIndex || 0];\n    inlineFormElement(option ? option.text || '' : '', node, container, false);\n};\n\nvar reformatInputBounds = exports.reformatInputBounds = function reformatInputBounds(bounds) {\n    if (bounds.width > bounds.height) {\n        bounds.left += (bounds.width - bounds.height) / 2;\n        bounds.width = bounds.height;\n    } else if (bounds.width < bounds.height) {\n        bounds.top += (bounds.height - bounds.width) / 2;\n        bounds.height = bounds.width;\n    }\n    return bounds;\n};\n\nvar inlineFormElement = function inlineFormElement(value, node, container, allowLinebreak) {\n    var body = node.ownerDocument.body;\n    if (value.length > 0 && body) {\n        var wrapper = node.ownerDocument.createElement('html2canvaswrapper');\n        (0, _Util.copyCSSStyles)(node.ownerDocument.defaultView.getComputedStyle(node, null), wrapper);\n        wrapper.style.position = 'absolute';\n        wrapper.style.left = container.bounds.left + 'px';\n        wrapper.style.top = container.bounds.top + 'px';\n        if (!allowLinebreak) {\n            wrapper.style.whiteSpace = 'nowrap';\n        }\n        var text = node.ownerDocument.createTextNode(value);\n        wrapper.appendChild(text);\n        body.appendChild(wrapper);\n        container.childNodes.push(_TextContainer2.default.fromTextNode(text, container));\n        body.removeChild(wrapper);\n    }\n};\n\nvar getInputValue = function getInputValue(node) {\n    var value = node.type === 'password' ? new Array(node.value.length + 1).join('\\u2022') : node.value;\n\n    return value.length === 0 ? node.placeholder || '' : value;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar TEXT_TRANSFORM = exports.TEXT_TRANSFORM = {\n    NONE: 0,\n    LOWERCASE: 1,\n    UPPERCASE: 2,\n    CAPITALIZE: 3\n};\n\nvar parseTextTransform = exports.parseTextTransform = function parseTextTransform(textTransform) {\n    switch (textTransform) {\n        case 'uppercase':\n            return TEXT_TRANSFORM.UPPERCASE;\n        case 'lowercase':\n            return TEXT_TRANSFORM.LOWERCASE;\n        case 'capitalize':\n            return TEXT_TRANSFORM.CAPITALIZE;\n    }\n\n    return TEXT_TRANSFORM.NONE;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar POSITION = exports.POSITION = {\n    STATIC: 0,\n    RELATIVE: 1,\n    ABSOLUTE: 2,\n    FIXED: 3,\n    STICKY: 4\n};\n\nvar parsePosition = exports.parsePosition = function parsePosition(position) {\n    switch (position) {\n        case 'relative':\n            return POSITION.RELATIVE;\n        case 'absolute':\n            return POSITION.ABSOLUTE;\n        case 'fixed':\n            return POSITION.FIXED;\n        case 'sticky':\n            return POSITION.STICKY;\n    }\n\n    return POSITION.STATIC;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar OVERFLOW_WRAP = exports.OVERFLOW_WRAP = {\n    NORMAL: 0,\n    BREAK_WORD: 1\n};\n\nvar parseOverflowWrap = exports.parseOverflowWrap = function parseOverflowWrap(overflow) {\n    switch (overflow) {\n        case 'break-word':\n            return OVERFLOW_WRAP.BREAK_WORD;\n        case 'normal':\n        default:\n            return OVERFLOW_WRAP.NORMAL;\n    }\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.parsePadding = exports.PADDING_SIDES = undefined;\n\nvar _Length = require('../Length');\n\nvar _Length2 = _interopRequireDefault(_Length);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar PADDING_SIDES = exports.PADDING_SIDES = {\n    TOP: 0,\n    RIGHT: 1,\n    BOTTOM: 2,\n    LEFT: 3\n};\n\nvar SIDES = ['top', 'right', 'bottom', 'left'];\n\nvar parsePadding = exports.parsePadding = function parsePadding(style) {\n    return SIDES.map(function (side) {\n        return new _Length2.default(style.getPropertyValue('padding-' + side));\n    });\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Logger = function () {\n    function Logger(enabled, id, start) {\n        _classCallCheck(this, Logger);\n\n        this.enabled = enabled;\n        this.start = start ? start : Date.now();\n        this.id = id;\n    }\n\n    _createClass(Logger, [{\n        key: 'child',\n        value: function child(id) {\n            return new Logger(this.enabled, id, this.start);\n        }\n\n        // eslint-disable-next-line flowtype/no-weak-types\n\n    }, {\n        key: 'log',\n        value: function log() {\n            if (this.enabled && window.console && window.console.log) {\n                for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                    args[_key] = arguments[_key];\n                }\n\n                Function.prototype.bind.call(window.console.log, window.console).apply(window.console, [Date.now() - this.start + 'ms', this.id ? 'html2canvas (' + this.id + '):' : 'html2canvas:'].concat([].slice.call(args, 0)));\n            }\n        }\n\n        // eslint-disable-next-line flowtype/no-weak-types\n\n    }, {\n        key: 'error',\n        value: function error() {\n            if (this.enabled && window.console && window.console.error) {\n                for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n                    args[_key2] = arguments[_key2];\n                }\n\n                Function.prototype.bind.call(window.console.error, window.console).apply(window.console, [Date.now() - this.start + 'ms', this.id ? 'html2canvas (' + this.id + '):' : 'html2canvas:'].concat([].slice.call(args, 0)));\n            }\n        }\n    }]);\n\n    return Logger;\n}();\n\nexports.default = Logger;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Path = require('../drawing/Path');\n\nvar _textDecoration = require('../parsing/textDecoration');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar addColorStops = function addColorStops(gradient, canvasGradient) {\n    var maxStop = Math.max.apply(null, gradient.colorStops.map(function (colorStop) {\n        return colorStop.stop;\n    }));\n    var f = 1 / Math.max(1, maxStop);\n    gradient.colorStops.forEach(function (colorStop) {\n        canvasGradient.addColorStop(f * colorStop.stop, colorStop.color.toString());\n    });\n};\n\nvar CanvasRenderer = function () {\n    function CanvasRenderer(canvas) {\n        _classCallCheck(this, CanvasRenderer);\n\n        this.canvas = canvas ? canvas : document.createElement('canvas');\n    }\n\n    _createClass(CanvasRenderer, [{\n        key: 'render',\n        value: function render(options) {\n            this.ctx = this.canvas.getContext('2d');\n            this.options = options;\n            this.canvas.width = Math.floor(options.width * options.scale);\n            this.canvas.height = Math.floor(options.height * options.scale);\n            this.canvas.style.width = options.width + 'px';\n            this.canvas.style.height = options.height + 'px';\n\n            this.ctx.scale(this.options.scale, this.options.scale);\n            this.ctx.translate(-options.x, -options.y);\n            this.ctx.textBaseline = 'bottom';\n            options.logger.log('Canvas renderer initialized (' + options.width + 'x' + options.height + ' at ' + options.x + ',' + options.y + ') with scale ' + this.options.scale);\n        }\n    }, {\n        key: 'clip',\n        value: function clip(clipPaths, callback) {\n            var _this = this;\n\n            if (clipPaths.length) {\n                this.ctx.save();\n                clipPaths.forEach(function (path) {\n                    _this.path(path);\n                    _this.ctx.clip();\n                });\n            }\n\n            callback();\n\n            if (clipPaths.length) {\n                this.ctx.restore();\n            }\n        }\n    }, {\n        key: 'drawImage',\n        value: function drawImage(image, source, destination) {\n            this.ctx.drawImage(image, source.left, source.top, source.width, source.height, destination.left, destination.top, destination.width, destination.height);\n        }\n    }, {\n        key: 'drawShape',\n        value: function drawShape(path, color) {\n            this.path(path);\n            this.ctx.fillStyle = color.toString();\n            this.ctx.fill();\n        }\n    }, {\n        key: 'fill',\n        value: function fill(color) {\n            this.ctx.fillStyle = color.toString();\n            this.ctx.fill();\n        }\n    }, {\n        key: 'getTarget',\n        value: function getTarget() {\n            return Promise.resolve(this.canvas);\n        }\n    }, {\n        key: 'path',\n        value: function path(_path) {\n            var _this2 = this;\n\n            this.ctx.beginPath();\n            if (Array.isArray(_path)) {\n                _path.forEach(function (point, index) {\n                    var start = point.type === _Path.PATH.VECTOR ? point : point.start;\n                    if (index === 0) {\n                        _this2.ctx.moveTo(start.x, start.y);\n                    } else {\n                        _this2.ctx.lineTo(start.x, start.y);\n                    }\n\n                    if (point.type === _Path.PATH.BEZIER_CURVE) {\n                        _this2.ctx.bezierCurveTo(point.startControl.x, point.startControl.y, point.endControl.x, point.endControl.y, point.end.x, point.end.y);\n                    }\n                });\n            } else {\n                this.ctx.arc(_path.x + _path.radius, _path.y + _path.radius, _path.radius, 0, Math.PI * 2, true);\n            }\n\n            this.ctx.closePath();\n        }\n    }, {\n        key: 'rectangle',\n        value: function rectangle(x, y, width, height, color) {\n            this.ctx.fillStyle = color.toString();\n            this.ctx.fillRect(x, y, width, height);\n        }\n    }, {\n        key: 'renderLinearGradient',\n        value: function renderLinearGradient(bounds, gradient) {\n            var linearGradient = this.ctx.createLinearGradient(bounds.left + gradient.direction.x1, bounds.top + gradient.direction.y1, bounds.left + gradient.direction.x0, bounds.top + gradient.direction.y0);\n\n            addColorStops(gradient, linearGradient);\n            this.ctx.fillStyle = linearGradient;\n            this.ctx.fillRect(bounds.left, bounds.top, bounds.width, bounds.height);\n        }\n    }, {\n        key: 'renderRadialGradient',\n        value: function renderRadialGradient(bounds, gradient) {\n            var _this3 = this;\n\n            var x = bounds.left + gradient.center.x;\n            var y = bounds.top + gradient.center.y;\n\n            var radialGradient = this.ctx.createRadialGradient(x, y, 0, x, y, gradient.radius.x);\n            if (!radialGradient) {\n                return;\n            }\n\n            addColorStops(gradient, radialGradient);\n            this.ctx.fillStyle = radialGradient;\n\n            if (gradient.radius.x !== gradient.radius.y) {\n                // transforms for elliptical radial gradient\n                var midX = bounds.left + 0.5 * bounds.width;\n                var midY = bounds.top + 0.5 * bounds.height;\n                var f = gradient.radius.y / gradient.radius.x;\n                var invF = 1 / f;\n\n                this.transform(midX, midY, [1, 0, 0, f, 0, 0], function () {\n                    return _this3.ctx.fillRect(bounds.left, invF * (bounds.top - midY) + midY, bounds.width, bounds.height * invF);\n                });\n            } else {\n                this.ctx.fillRect(bounds.left, bounds.top, bounds.width, bounds.height);\n            }\n        }\n    }, {\n        key: 'renderRepeat',\n        value: function renderRepeat(path, image, imageSize, offsetX, offsetY) {\n            this.path(path);\n            this.ctx.fillStyle = this.ctx.createPattern(this.resizeImage(image, imageSize), 'repeat');\n            this.ctx.translate(offsetX, offsetY);\n            this.ctx.fill();\n            this.ctx.translate(-offsetX, -offsetY);\n        }\n    }, {\n        key: 'renderTextNode',\n        value: function renderTextNode(textBounds, color, font, textDecoration, textShadows) {\n            var _this4 = this;\n\n            this.ctx.font = [font.fontStyle, font.fontVariant, font.fontWeight, font.fontSize, font.fontFamily].join(' ');\n\n            textBounds.forEach(function (text) {\n                _this4.ctx.fillStyle = color.toString();\n                if (textShadows && text.text.trim().length) {\n                    textShadows.slice(0).reverse().forEach(function (textShadow) {\n                        _this4.ctx.shadowColor = textShadow.color.toString();\n                        _this4.ctx.shadowOffsetX = textShadow.offsetX * _this4.options.scale;\n                        _this4.ctx.shadowOffsetY = textShadow.offsetY * _this4.options.scale;\n                        _this4.ctx.shadowBlur = textShadow.blur;\n\n                        _this4.ctx.fillText(text.text, text.bounds.left, text.bounds.top + text.bounds.height);\n                    });\n                } else {\n                    _this4.ctx.fillText(text.text, text.bounds.left, text.bounds.top + text.bounds.height);\n                }\n\n                if (textDecoration !== null) {\n                    var textDecorationColor = textDecoration.textDecorationColor || color;\n                    textDecoration.textDecorationLine.forEach(function (textDecorationLine) {\n                        switch (textDecorationLine) {\n                            case _textDecoration.TEXT_DECORATION_LINE.UNDERLINE:\n                                // Draws a line at the baseline of the font\n                                // TODO As some browsers display the line as more than 1px if the font-size is big,\n                                // need to take that into account both in position and size\n                                var _options$fontMetrics$ = _this4.options.fontMetrics.getMetrics(font),\n                                    baseline = _options$fontMetrics$.baseline;\n\n                                _this4.rectangle(text.bounds.left, Math.round(text.bounds.top + text.bounds.height - baseline), text.bounds.width, 1, textDecorationColor);\n                                break;\n                            case _textDecoration.TEXT_DECORATION_LINE.OVERLINE:\n                                _this4.rectangle(text.bounds.left, Math.round(text.bounds.top), text.bounds.width, 1, textDecorationColor);\n                                break;\n                            case _textDecoration.TEXT_DECORATION_LINE.LINE_THROUGH:\n                                // TODO try and find exact position for line-through\n                                var _options$fontMetrics$2 = _this4.options.fontMetrics.getMetrics(font),\n                                    middle = _options$fontMetrics$2.middle;\n\n                                _this4.rectangle(text.bounds.left, Math.ceil(text.bounds.top + middle), text.bounds.width, 1, textDecorationColor);\n                                break;\n                        }\n                    });\n                }\n            });\n        }\n    }, {\n        key: 'resizeImage',\n        value: function resizeImage(image, size) {\n            if (image.width === size.width && image.height === size.height) {\n                return image;\n            }\n\n            var canvas = this.canvas.ownerDocument.createElement('canvas');\n            canvas.width = size.width;\n            canvas.height = size.height;\n            var ctx = canvas.getContext('2d');\n            ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, size.width, size.height);\n            return canvas;\n        }\n    }, {\n        key: 'setOpacity',\n        value: function setOpacity(opacity) {\n            this.ctx.globalAlpha = opacity;\n        }\n    }, {\n        key: 'transform',\n        value: function transform(offsetX, offsetY, matrix, callback) {\n            this.ctx.save();\n            this.ctx.translate(offsetX, offsetY);\n            this.ctx.transform(matrix[0], matrix[1], matrix[2], matrix[3], matrix[4], matrix[5]);\n            this.ctx.translate(-offsetX, -offsetY);\n\n            callback();\n\n            this.ctx.restore();\n        }\n    }]);\n\n    return CanvasRenderer;\n}();\n\nexports.default = CanvasRenderer;","/**\n * The purpose of this file is to provide a means to render glyphs to a grid and to provide\n * an approach to estimating kerning values for characters utilizing any custom embedded font\n * in a web page.\n */\nimport * as html2canvas from \"html2canvas\";\nimport { WebGLStat } from \"../../gl/webgl-stat\";\nimport { IResourceType, ResourceType } from \"../../types\";\nimport { scale2, Vec2 } from \"../../util\";\nimport { IdentifyByKey } from \"../../util/identify-by-key\";\nimport { renderGlyph } from \"./glyph-renderer\";\n\nconst debug = require(\"debug\")(\"performance\");\nconst { floor } = Math;\n\ntype IGlyphRenderMetrics = {\n  [key: string]: { glyph: ImageData; glyphIndex: number };\n};\n\nexport type KerningPairs = {\n  [leftLetter: string]: { [rightLtter: string]: Vec2 };\n};\n\nexport type KerningInfo = {\n  all: string[];\n  pairs: KerningPairs;\n  spaceWidth: number;\n};\n\n/**\n * This function is calculate the offset of adjacent letters\n */\nasync function renderEachPair(\n  fontString: string,\n  fontSize: number,\n  pairs: KerningInfo,\n  calculateSpace: boolean\n) {\n  // Calculate the max width the system can reliably handle\n  const contextWidth = WebGLStat.MAX_TEXTURE_SIZE / window.devicePixelRatio;\n  // Create the table\n  const table = document.createElement(\"div\");\n  const maxColumns = floor(contextWidth / (fontSize * 2));\n  const cellWidth = fontSize * 2;\n  const cellHeight = fontSize * 2;\n\n  table.style.display = \"table\";\n  table.style.width = `${contextWidth}px`;\n  table.style.textAlign = \"center\";\n  table.style.tableLayout = \"fixed\";\n  table.style.position = \"relative\";\n  table.style.left = \"0px\";\n  table.style.top = `${window.innerHeight}px`;\n\n  let currentPair = 0;\n  let columnIndex = 0;\n  let currentRow;\n  let rowSpacer;\n  let remainingSpace = 0;\n\n  // Render each pair to cell of the table\n  while (currentPair < pairs.all.length) {\n    const tr = document.createElement(\"div\");\n    currentRow = tr;\n    tr.style.display = \"table-row\";\n    tr.style.height = `${cellHeight}px`;\n    tr.style.width = `width:${contextWidth}px`;\n\n    // We track how much room is remaining so we can inject an empty cell at the end to ensure\n    // the table doesn't stretch to fill\n    let remaining = contextWidth;\n\n    // Render each tr with col number of td\n    for (\n      columnIndex = 0;\n      columnIndex < maxColumns && currentPair < pairs.all.length;\n      columnIndex++\n    ) {\n      const td = document.createElement(\"div\");\n      td.style.display = \"table-cell\";\n      td.style.width = `${cellWidth}px`;\n      td.style.height = `${cellHeight}px`;\n      td.style.overflow = \"hidden\";\n      td.style.font = fontString;\n\n      const pair = pairs.all[currentPair];\n      currentPair++;\n      const leftStr = pair[0];\n      const rightStr = pair[1];\n\n      // Each td has two spans\n      const leftSpan = document.createElement(\"span\");\n      const rightSpan = document.createElement(\"span\");\n      leftSpan.style.color = \"#ff0000\";\n      rightSpan.style.color = \"#0000ff\";\n\n      leftSpan.innerText = leftStr;\n      rightSpan.innerText = rightStr;\n\n      td.appendChild(leftSpan);\n      td.appendChild(rightSpan);\n      tr.appendChild(td);\n\n      remaining -= cellWidth;\n    }\n\n    if (remaining >= 0) {\n      const td = document.createElement(\"div\");\n      td.style.display = \"table-cell\";\n      td.style.width = `${remaining}px`;\n      tr.appendChild(td);\n      rowSpacer = td;\n    } else {\n      rowSpacer = null;\n    }\n\n    remainingSpace = remaining;\n    table.appendChild(tr);\n  }\n\n  // Init the array for left-top corners for each letter in a pair\n  // [leftLetter->left, leftLetter->top, rightLetter->left, rightLetter->top]\n  const mins: [number, number, number, number][] = [];\n  for (let i = 0; i < pairs.all.length; i++) {\n    mins.push([\n      Number.MAX_SAFE_INTEGER,\n      Number.MAX_SAFE_INTEGER,\n      Number.MAX_SAFE_INTEGER,\n      Number.MAX_SAFE_INTEGER\n    ]);\n  }\n\n  // This stores how large the test character's rendering is that will be used for analyzing\n  // how large a space between characters is.\n  let testSpaceCharacterWidth = 0;\n  let doSpaceCheck = false;\n\n  // If the distance of a space is required, then we add in one more additional cell\n  if (calculateSpace) {\n    const testChar = pairs.all[0][0];\n    const td = document.createElement(\"div\");\n    td.style.display = \"table-cell\";\n    td.style.width = `${cellWidth}px`;\n    td.style.height = `${cellHeight}px`;\n    td.style.overflow = \"hidden\";\n    td.style.font = fontString;\n\n    // The test character for the spacing will be the first character in the pairs we\n    // wanted to render.\n    const render = await renderGlyph(testChar, 128, 128, fontString);\n\n    if (render) {\n      // Keep how wide the test character is for after the kerning calculation so we can accurately\n      // determine how large a space is by subtracting the width of the character from the kerning distance.\n      testSpaceCharacterWidth = render.size[0];\n      // We create two of the test characters and place a space between them. This will allow\n      td.innerHTML = `<span style=\"color:#ff0000\">${testChar}</span> <span style=\"color:#0000ff\">${testChar}</span>`;\n\n      // If the last row has room for the rendering, then we just add to it\n      if (columnIndex < maxColumns && currentRow) {\n        currentRow.appendChild(td);\n        remainingSpace -= cellWidth;\n\n        // If a spacer at the end of the row is present, it should be adjusted to the size needed\n        // It should also be moved to the end of the child list\n        if (rowSpacer) {\n          rowSpacer.remove();\n\n          if (remainingSpace > 0) {\n            currentRow.style.width = `${remainingSpace}px`;\n            currentRow.appendChild(rowSpacer);\n          }\n        }\n      }\n\n      // Otherwise, we make a new row to inject into\n      else {\n        const tr = document.createElement(\"div\");\n        currentRow = tr;\n        tr.style.display = \"table-row\";\n        tr.style.height = `${cellHeight}px`;\n        tr.style.width = `width:${contextWidth}px`;\n        currentRow.appendChild(td);\n        table.appendChild(tr);\n\n        // Inject a spacer to fill the remaining space\n        rowSpacer = document.createElement(\"div\");\n        rowSpacer.style.display = \"table-cell\";\n        rowSpacer.style.width = `${(maxColumns - 1) * cellWidth}px`;\n        tr.appendChild(rowSpacer);\n      }\n\n      // Add an additional min tracker for the check\n      mins.push([\n        Number.MAX_SAFE_INTEGER,\n        Number.MAX_SAFE_INTEGER,\n        Number.MAX_SAFE_INTEGER,\n        Number.MAX_SAFE_INTEGER\n      ]);\n\n      // Indicate the space check is indeed happening\n      doSpaceCheck = true;\n    }\n  }\n\n  // The element must be a part of the body for html2canvas to work\n  document.getElementsByTagName(\"body\")[0].appendChild(table);\n\n  // Config for html2canvas\n  const config: Html2Canvas.Html2CanvasOptions = {\n    backgroundColor: null,\n    logging: debug.enabled\n  };\n\n  debug(\"Rendering table for font kerning analysis\", pairs, table);\n  const canvas = await html2canvas(table, config);\n\n  if (!canvas) {\n    console.warn(\"Could not convert DOM structure to canvas\");\n    return;\n  }\n\n  // table.remove();\n\n  // Width and height of each cell\n  const w = cellWidth * window.devicePixelRatio;\n  const h = cellHeight * window.devicePixelRatio;\n\n  const ctx = canvas.getContext(\"2d\");\n  debug(\"Analyzing rendered canvas\", canvas);\n\n  if (ctx) {\n    const data = ctx.getImageData(0, 0, canvas.width, canvas.height).data;\n    let pixel, r, g, b, min, index;\n\n    for (let y = 0, canvasHeight = canvas.height; y < canvasHeight; y++) {\n      for (let x = 0, canvasWidth = canvas.width; x < canvasWidth; x++) {\n        pixel = (canvasWidth * y + x) * 4;\n        r = data[pixel + 0];\n        g = data[pixel + 1];\n        b = data[pixel + 2];\n\n        // Get the index of the pair by the position of pixel\n        index = floor(y / h) * maxColumns + floor(x / w);\n\n        if (index < mins.length) {\n          min = mins[index];\n\n          // Red pixel is for left letter\n          if (r > 0 && g === 0 && b === 0) {\n            if (x < min[0]) min[0] = x;\n            if (y < min[1]) min[1] = y;\n          }\n\n          // Blue pixel is for right letter\n          if (r === 0 && g === 0 && b > 0) {\n            if (x < min[2]) min[2] = x;\n            if (y < min[3]) min[3] = y;\n          }\n        }\n      }\n    }\n\n    // Before letter processing, remove and analyze processing for the 'space' character\n    if (doSpaceCheck) {\n      const min = mins.pop();\n\n      if (min) {\n        const vec: Vec2 = [min[2] - min[0], 0];\n        const exact = scale2(vec, 1 / window.devicePixelRatio);\n        pairs.spaceWidth = Math.ceil(exact[0]) - testSpaceCharacterWidth;\n      }\n    }\n\n    // Set pairs map based on mins array\n    for (let i = 0, iMax = mins.length; i < iMax; i++) {\n      const pair = pairs.all[i];\n      const left = pair[0];\n      const right = pair[1];\n      const min = mins[i];\n      const vec: Vec2 = [min[2] - min[0], min[3] - min[1]];\n      const rightLetters = pairs.pairs[left];\n\n      if (rightLetters) {\n        // The calculations done on the space are in a devices pixel ratio. So we must\n        // adjust by that ratio to make it normal world space coordinates.\n        const exact = scale2(vec, 1 / window.devicePixelRatio);\n        rightLetters[right] = [Math.ceil(exact[0]), exact[1]];\n      }\n    }\n  } else {\n    console.warn(\n      \"html2canvas did not produce a valid canvas context to analyze\"\n    );\n  }\n\n  debug(\"Kerning rendering analysis complete\", pairs.pairs);\n}\n\n/**\n * This function takes a string to return a map with next letters of each letter\n */\nfunction stringToPairs(\n  str: string,\n  existing: KerningPairs,\n  out?: KerningInfo\n): KerningInfo {\n  // Remove all the whitespace\n  str = str.replace(/\\s/g, \"\");\n  const all: string[] = (out && out.all) || [];\n  const pairs: KerningPairs = (out && out.pairs) || {};\n\n  for (let i = 0; i < str.length - 1; i++) {\n    const left = str[i];\n    const right = str[i + 1];\n    let neighbors = pairs[left];\n\n    if (!neighbors) {\n      neighbors = pairs[left] = {};\n    }\n\n    // Don't remake a pair for already existing pairs\n    if ((!existing[left] || !existing[left][right]) && !neighbors[right]) {\n      neighbors[right] = [0, 0];\n      all.push(`${left}${right}`);\n    }\n  }\n\n  return {\n    all,\n    pairs,\n    spaceWidth: 0\n  };\n}\n\nexport interface IFontOptions extends IdentifyByKey, IResourceType {\n  /** This resource must have it's type explcitly be set to a Font */\n  type: ResourceType.FONT;\n}\n\nexport class FontRenderer {\n  /**\n   * This function takes a sentence and grid info\n   * Returns a canvas with a list of glyphs where each glyph fits cnetered within each grid cell\n   */\n  makeBitmapGlyphs(\n    glyphs: string,\n    fontString: string,\n    fontSize: number\n  ): IGlyphRenderMetrics {\n    // It is used to store the metrics of each glyph\n    const map: IGlyphRenderMetrics = {};\n    // Get all unique glyphs provided\n    const uniqueGlyphs = new Set();\n\n    for (let i = 0, iMax = glyphs.length; i < iMax; ++i) {\n      uniqueGlyphs.add(glyphs[i]);\n    }\n\n    // Get the characters to be rendered\n    const chars = Array.from(uniqueGlyphs.values());\n\n    for (let i = 0, iMax = chars.length; i < iMax; ++i) {\n      const char = chars[i];\n      const glyph = renderGlyph(char, fontSize * 2, fontSize * 2, fontString);\n\n      if (glyph) {\n        map[char] = {\n          glyph: glyph.data,\n          glyphIndex: i\n        };\n      } else {\n        console.warn(\n          \"Unable to render character\",\n          char,\n          \"to font map for rendering.\"\n        );\n      }\n    }\n\n    return map;\n  }\n\n  /**\n   * This performs a special rendering to guess kerning of letters of embedded fonts (fonts we don't\n   * have access to their raw font files). This will provide kerning information of a letter by providing\n   * the distance from a 'left' letter's top left  corner to the 'right' letter's topleft corner.\n   */\n  async estimateKerning(\n    str: string[],\n    fontString: string,\n    fontSize: number,\n    existing: KerningPairs,\n    includeSpace: boolean\n  ) {\n    // Get all of the new pairs of letters that need kerning infoz\n    const pairInfo: KerningInfo = {\n      all: [],\n      pairs: {},\n      spaceWidth: 0\n    };\n\n    debug(\"Estimating Kerning for\", str);\n\n    for (let i = 0, iMax = str.length; i < iMax; ++i) {\n      const s = str[i];\n      stringToPairs(s, existing, pairInfo);\n    }\n\n    // Only if there are new kerning needs do we actually need to run this method\n    if (pairInfo.all.length > 0) {\n      await renderEachPair(fontString, fontSize, pairInfo, includeSpace);\n    }\n\n    return pairInfo;\n  }\n}\n","import { GLSettings, Texture, TextureOptions } from \"../../gl\";\nimport { isWhiteSpace, ResourceType, Size, TextureSize } from \"../../types\";\nimport { IdentifyByKey } from \"../../util/identify-by-key\";\nimport { add2, scale2, Vec2 } from \"../../util/vector\";\nimport { PackNode } from \"../texture/pack-node\";\nimport { SubTexture } from \"../texture/sub-texture\";\nimport {\n  FontManager,\n  FontMapSource,\n  IFontResourceOptions\n} from \"./font-manager\";\nimport { FontRenderer, KerningPairs } from \"./font-renderer\";\n\nconst debug = require(\"debug\")(\"performance\");\n\nexport enum FontMapGlyphType {\n  /** Straight images for each glyph */\n  BITMAP,\n  /** Signed distance field glyphs */\n  SDF,\n  /** Multichannel signed distance fields */\n  MSDF\n}\n\nexport interface IFontMapOptions extends IFontResourceOptions {\n  /**\n   * This is the initial characters registered with this font map. If this is not Dynamic,\n   * these are the only characters this map can provide.\n   */\n  characters?: [string, SubTexture][];\n  /**\n   * This is the glyph type for the font.\n   */\n  glyphType: FontMapGlyphType;\n}\n\n/**\n * This describes a string's individual letter offsets when properly kerned relative to each other.\n */\nexport type KernedLayout = {\n  /** The scaling of the font relative to the desired font size vs the rendered size of the font on the font map */\n  fontScale: number;\n  /** This is the glyphs given positions. This is essentially the text minus the whitespace. */\n  glyphs: string;\n  /**\n   * This provides the kerning of each letter. The order of the positions provided is in\n   * the order the letters appear in the text measured. This is all relative to placing the\n   * top left of the rendering at [0, 0]\n   */\n  positions: Vec2[];\n  /** The width and height of the entire rendered string */\n  size: Size;\n  /** The text used in calculating this layout */\n  text: string;\n};\n\n/**\n * This represents the actual font map resource. It contains the raw texture object for manipulating.\n */\nexport class FontMap extends IdentifyByKey implements IFontResourceOptions {\n  /** Makes a CSS font string from the font properties in the map */\n  get fontString() {\n    return `${this.fontSource.size}px ${this.fontSource.family}`;\n  }\n  /**\n   * A dynamic font map renders single glyphs at a time into the resource rather than preloads.\n   */\n  dynamic: boolean = false;\n  /** The metrics of the font rendered to this font map */\n  fontSource: FontMapSource;\n  /**\n   * The number of glyphs successfully registered with this font map. This is used to determine the\n   * position of the next glyph for the font map.\n   */\n  glyphCount: number;\n  /**\n   * This maps all of the glyphs this resource provides for to the SubTexture where the glyph is rendered\n   * on the resource.\n   */\n  glyphMap: { [char: string]: SubTexture } = {};\n  /**\n   * These  are the calculated kerning pairs available for this font map. If a pair does not\n   * exist here, then the map may not have the character or the pair may not have been calculated\n   * for the font map yet.\n   */\n  kerning: KerningPairs = {};\n  /** This is the manager storing the Font Map */\n  manager: FontManager;\n  /** Tracks how the glyphs are packed into the map */\n  packing: PackNode<SubTexture>;\n  /** This is the calculated width of a space for the font map */\n  spaceWidth: number = 0;\n  /** The base texture where the font map is stored */\n  texture: Texture;\n  /**\n   * The settings applied to the texture object itself. This is managed by the type of glyph in use.\n   */\n  private textureSettings: TextureOptions;\n  /**\n   * This finishes establishing this font map as a resource that is a IFontMapResourceOptions\n   */\n  type: ResourceType.FONT = ResourceType.FONT;\n\n  constructor(options: IFontMapOptions) {\n    super(options);\n\n    this.dynamic = options.dynamic || false;\n    this.fontSource = options.fontSource;\n\n    if (options.characters) {\n      options.characters.forEach(pair => {\n        this.doRegisterGlyph(pair[0], pair[1]);\n      });\n    }\n\n    const fontMapSize: Size = options.fontMapSize\n      ? options.fontMapSize\n      : [TextureSize._1024, TextureSize._1024];\n\n    this.makeGlyphTypeTextureSettings(options.glyphType);\n    this.createTexture(fontMapSize);\n\n    // Initialize the packing layout for the texture\n    this.packing = new PackNode(0, 0, fontMapSize[0], fontMapSize[1]);\n    // If allowed, load the cached kerning from the system\n    this.addCachedKerning();\n  }\n\n  private getKerningCacheName() {\n    return `__deltav_kerning_cache_${this.fontSource.family}__`;\n  }\n\n  /**\n   * Loads the stored cached kerning if it's available.\n   */\n  private addCachedKerning() {\n    if (this.fontSource.localKerningCache) {\n      const cachedKerningStr = localStorage.getItem(this.getKerningCacheName());\n\n      if (cachedKerningStr) {\n        debug(\"Loading cached kerning items:\", this.getKerningCacheName());\n\n        try {\n          const cachedKerning = JSON.parse(cachedKerningStr);\n          let totalKernsLoaded = 0;\n\n          for (const left in cachedKerning) {\n            let isValid: boolean =\n              typeof left === \"string\" && left.length === 1;\n            if (!isValid) continue;\n\n            const rights = cachedKerning[left];\n            const rightKerning = this.kerning[left] || {};\n            this.kerning[left] = rightKerning;\n\n            for (const right in rights) {\n              isValid = typeof left === \"string\" && left.length === 1;\n              if (!isValid) continue;\n              rightKerning[right] = rights[right];\n              totalKernsLoaded++;\n            }\n          }\n\n          debug(\n            \"Found kerning items in the cache!\",\n            \"Count:\",\n            totalKernsLoaded\n          );\n        } catch (err) {\n          /** do nothing as the kerning info is not valid */\n        }\n      }\n    }\n  }\n\n  /**\n   * Applies additional kerning pair information to the map.\n   */\n  addKerning(kerning: KerningPairs) {\n    let hasNew = false;\n\n    for (const left in kerning) {\n      const rights = kerning[left];\n      const rightKerning = this.kerning[left] || {};\n      if (!this.kerning[left]) hasNew = true;\n      this.kerning[left] = rightKerning;\n\n      for (const right in rights) {\n        if (!rightKerning[right]) hasNew = true;\n        rightKerning[right] = rights[right];\n      }\n    }\n\n    // If new kerning pairs applied, then we should update the cache\n    if (hasNew && this.fontSource.localKerningCache) {\n      try {\n        debug(\"Storing kerning info in cache...\");\n        const kerningCache = JSON.stringify(this.kerning);\n        localStorage.setItem(this.getKerningCacheName(), kerningCache);\n      } catch (err) {\n        // Failures just silently fail\n        debug(\"Could not cache kerning info\");\n      }\n    }\n  }\n\n  /**\n   * Generates the texture for the font map which makes it ready for utilization and ready\n   * for updates.\n   */\n  private createTexture(size: Size) {\n    if (this.texture) return;\n\n    // Establish the settings to be applied to the Texture\n    let textureSettings;\n\n    if (this.textureSettings) {\n      textureSettings = {\n        generateMipMaps: true,\n        premultiplyAlpha: true,\n        ...this.textureSettings\n      };\n    } else {\n      textureSettings = {\n        generateMipMaps: true,\n        premultiplyAlpha: true\n      };\n    }\n\n    // Generate the texture\n    this.texture = new Texture({\n      data: {\n        width: size[0],\n        height: size[1],\n        buffer: null\n      },\n      ...textureSettings\n    });\n  }\n\n  /**\n   * Free resources for this manager\n   */\n  destroy() {\n    this.texture.dispose();\n  }\n\n  /**\n   * Performs the internal glyph registration.\n   */\n  private doRegisterGlyph(char: string, tex: SubTexture) {\n    const oneChar = char[0];\n\n    if (!this.glyphMap[oneChar]) {\n      this.glyphMap[oneChar] = tex;\n    } else {\n      console.warn(\"A Glyph is already registered with a rendering\");\n    }\n  }\n\n  /**\n   * This returns which characters are not included in this font map.\n   */\n  findMissingCharacters(newCharacters: string) {\n    const missing = new Set<string>();\n    let allMissing: string = \"\";\n\n    for (let i = 0, iMax = newCharacters.length; i < iMax; ++i) {\n      const char = newCharacters[i];\n\n      if (!this.glyphMap[char] && !missing.has(char)) {\n        missing.add(char);\n        allMissing += char;\n      }\n    }\n\n    return allMissing;\n  }\n\n  /**\n   * This retrieves the glyph texture information from the FontMap.\n   */\n  getGlyphTexture(char: string): SubTexture | null {\n    return this.glyphMap[char[0]] || null;\n  }\n\n  /**\n   * This provides the expected vector from the top left corner of the left vector\n   * to the top left corner of the right vector.\n   */\n  getGlyphKerning(leftChar: string, rightChar: string): Vec2 {\n    const right = this.kerning[leftChar];\n    // If not pairs for the provided left character, just provide 0\n    if (!right) return [0, 0];\n\n    // Produce the kerning value or zero if none exists\n    return right[rightChar] || [0, 0];\n  }\n\n  /**\n   * This looks at the glyphs directly from a layout and provides the width of the glyphs.\n   *\n   * This differs from getStringWidth as the indices reference GLYPHS (not white space) while\n   * the parameters on the other reference the text.\n   *\n   * This method is a little less intuitive but can perform faster.\n   */\n  getGlyphWidth(stringLayout: KernedLayout, start: number, end: number) {\n    const startOffset = stringLayout.positions[start];\n    const endOffset = stringLayout.positions[end];\n    // The indices must be valid to work\n    if (!start || !end) return 0;\n    // Get the width of the final glyph\n    const image = this.glyphMap[stringLayout.glyphs[end]];\n    if (!image) return 0;\n\n    // Now we can output the rendered width\n    return endOffset[0] + image.pixelWidth - startOffset[0];\n  }\n\n  /**\n   * This looks at a string layout and provides a layout that reflects the layout bounded\n   * by a max width. This accounts for including\n   */\n  async getTruncatedLayout(\n    layout: KernedLayout,\n    truncation: string,\n    maxWidth: number,\n    fontSize: number,\n    fontRenderer: FontRenderer\n  ) {\n    // If the label exceeds the specified maxWidth then truncation must take places\n    if (layout.size[0] > maxWidth) {\n      let truncatedText = \"\";\n      let truncationWidth = 0;\n\n      // We'll get a rough and dirty truncation character width estimate by simply adding the width of\n      // all the glyphs\n      for (let i = 0, iMax = truncation.length; i < iMax; ++i) {\n        truncationWidth += this.glyphMap[truncation[i]].pixelWidth;\n      }\n\n      // Now find a width of glyphs + the width of the truncation that will fit within the maxWidth\n      // If the truncation width is wider than the max width, then we truncate to no text at all.\n      if (truncationWidth > maxWidth) {\n        return {\n          fontScale: 1,\n          glyphs: \"\",\n          positions: [],\n          size: [0, 0],\n          text: \"\"\n        } as KernedLayout;\n      }\n\n      // Otherwise, let's do the search for the correct glyphs to show that will fit properly.\n      // We will use a simple binary search to find the appropriate length to use.\n      let left = 0;\n      let right = layout.positions.length;\n      let cursor = 0;\n      let check = 0;\n      let char = \"\";\n\n      while (left !== right) {\n        cursor = Math.floor((right - left) / 2) + left;\n        char = layout.glyphs[cursor];\n        check =\n          layout.positions[cursor][0] +\n          this.glyphMap[char].pixelWidth +\n          truncationWidth;\n\n        if (check > maxWidth) right = cursor;\n        else if (check < maxWidth) left = cursor;\n        else break;\n\n        if (Math.abs(left - right) <= 1) {\n          if (check < maxWidth) break;\n\n          while (check > maxWidth && cursor >= 0) {\n            cursor--;\n            check =\n              layout.positions[cursor][0] +\n              this.glyphMap[char].pixelWidth +\n              truncationWidth;\n          }\n\n          break;\n        }\n      }\n\n      // Our cursor should now be pointing to the letter that will be our truncation point\n      // We must make sure with the characters specified it does fit, if not, we only render\n      // the truncation glyphs\n      check =\n        layout.positions[cursor][0] +\n        this.glyphMap[char].pixelWidth +\n        truncationWidth;\n\n      if (check < maxWidth) {\n        // Loop through the text and find the glyph matching to the actual text with glyphs\n        let glyphIndex = 0;\n        let charIndex = 0;\n\n        for (\n          let i = 0, iMax = layout.text.length;\n          i < iMax && glyphIndex <= cursor;\n          ++i\n        ) {\n          const char = layout.text[i];\n\n          charIndex++;\n          if (!isWhiteSpace(char)) glyphIndex++;\n        }\n\n        // Make sure the last character attached to the first truncated letter has kerning info\n        const lastChar = layout.text[charIndex - 1];\n        let firstTruncChar;\n\n        for (let i = 0, iMax = truncation.length; i < iMax; ++i) {\n          if (!isWhiteSpace(truncation[i])) {\n            firstTruncChar = truncation[i];\n            break;\n          }\n        }\n\n        if (\n          lastChar &&\n          firstTruncChar &&\n          !this.kerning[lastChar][firstTruncChar]\n        ) {\n          const kerning = await fontRenderer.estimateKerning(\n            [lastChar + firstTruncChar],\n            this.fontString,\n            this.fontSource.size,\n            this.kerning,\n            false\n          );\n\n          this.addKerning(kerning.pairs);\n        }\n\n        truncatedText = `${layout.text.substr(0, charIndex)}${truncation}`;\n      } else {\n        truncatedText = truncation;\n      }\n\n      // Caculate the layout of the truncated text\n      return this.getStringLayout(truncatedText, fontSize);\n    }\n\n    return layout;\n  }\n\n  /**\n   * Get the width of a set of characters within a string layout.\n   *\n   * To use this, first use the getStringLayout() method to get the KernedLayout then insert\n   * the the range of characters the width should be calculated for.\n   *\n   * [start, end)\n   */\n  getStringWidth(\n    stringLayout: KernedLayout,\n    start: number,\n    end: number\n  ): number;\n  /**\n   * Get the width of a substring from a string layout.\n   *\n   * To use this, first use the getStringLayout() method to get the KernedLayout then insert\n   * the substring of text desired for calculating the width.\n   */\n  getStringWidth(stringLayout: KernedLayout, substr: string): number;\n  /**\n   * Calculates the width of a chunk of characters within a calculated KernedLayout.\n   * To use this, first use the getStringLayout() method to get the KernedLayout then insert\n   * the substring of text desired for calculating the width.\n   */\n  getStringWidth(\n    stringLayout: KernedLayout,\n    param1: string | number,\n    param2?: number\n  ): number {\n    const text = stringLayout.text;\n    let firstChar = 0;\n    let lastChar = text.length;\n\n    // String param means we look for a substring\n    if (typeof param1 === \"string\") {\n      const index = text.indexOf(param1);\n      // No found sub string means the examined text does not exist\n      if (index < 0) return 0;\n      // Now we have the letter within the text we begin with.\n      firstChar = index;\n      // Last character is the first + length of sub string\n      lastChar = firstChar + param1.length;\n    } else {\n      firstChar = param1;\n    }\n\n    // Set the explicit last character to use\n    if (param2 !== undefined) {\n      lastChar = param2;\n    }\n\n    // We now trim out white space from our indices to get the actual glyph indices that match our search\n    let i = 0;\n    const endOfFirst = Math.min(text.length, firstChar);\n    const endOfLast = Math.min(text.length, lastChar);\n\n    for (; i < endOfFirst; ++i) {\n      if (isWhiteSpace(text[i])) {\n        firstChar--;\n        lastChar--;\n      }\n    }\n\n    for (; i < endOfLast; ++i) {\n      if (isWhiteSpace(text[i])) lastChar--;\n    }\n\n    // We now have the indices of the first and last glyph's position information in our text.\n    // We can use these two to determine the width of the text.\n    const lastGlyph = this.glyphMap[stringLayout.text[lastChar] || \"\"];\n    if (!lastGlyph) return 0;\n\n    return (\n      (stringLayout.positions[lastChar] || [0, 0])[0] -\n      (stringLayout.positions[firstChar] || [0, 0])[0] +\n      lastGlyph.pixelWidth\n    );\n  }\n\n  /**\n   * This processes a string and lays it out by the kerning rules available to this font map.\n   *\n   * NOTE: This ONLY processes a SINGLE LINE!! ALL whitespace characters will be considered a single\n   * space.\n   */\n  getStringLayout(text: string, fontSize: number): KernedLayout {\n    // The output positions for each letter in the text\n    const positions: Vec2[] = [];\n    // The output of each character found that is provided a position (the string without the whitespace)\n    let glyphs: string = \"\";\n    // Calculate the scaling of the font which would be the font map's rendered glyph size\n    // as a ratio to the label's desired font size.\n    const fontScale = fontSize / this.fontSource.size;\n\n    // Start with the initial glyph dimensions as the min and max y the label will have\n    let minY = Number.MAX_SAFE_INTEGER;\n    let maxY = 0;\n    let currentWidth = 0;\n    // The current offset for the current letter to be rendered properly\n    let offset: Vec2 = [0, 0];\n    // The amount each white space moves the text forward\n    const whiteSpacing = this.spaceWidth;\n    // Number of found whitespace characters since last character\n    let whiteSpaceCount = 0;\n    // The current character found to the left of the current one being processed\n    let leftChar = \"\";\n    // Holder for the found kerning of the character pair\n    let kern: Vec2;\n    // The image of the glyph that was rendered\n    let image: SubTexture;\n\n    // Loop through the text and calculate the offsets of each non-whitespace character\n    for (let i = 0, iMax = text.length; i < iMax; ++i) {\n      const char = text[i];\n\n      // White space merely moves the offset forward by the amount of a space\n      if (isWhiteSpace(char)) {\n        whiteSpaceCount++;\n        continue;\n      }\n\n      kern = [0, 0];\n\n      if (leftChar) {\n        kern = this.kerning[leftChar][char] || [0, 0];\n      }\n\n      offset = add2(add2(offset, scale2(kern, fontScale)), [\n        whiteSpaceCount * whiteSpacing * fontScale,\n        0\n      ]);\n\n      // Copy the offset to our output positions for the character\n      positions.push([offset[0], offset[1]]);\n      glyphs += char;\n\n      // Get the glyph rendering from the font map\n      image = this.glyphMap[char];\n      // Use the offset and the rendering height to determine the top and bottom of the glyph\n      minY = Math.min(offset[1], minY);\n      maxY = Math.max(offset[1] + image.pixelHeight, maxY);\n      // Make this processed glyph the next glyph that is 'to the left' for the next glyph\n      leftChar = char;\n      // Calculate the width of the label as we lay out\n      currentWidth = offset[0] + image.pixelWidth * fontScale;\n      // Reset the whitespace count so we can see whitespaces to next character\n      whiteSpaceCount = 0;\n    }\n\n    // Now we have positioned all of our glyphs with relative kerning.\n    // We can now get a width and height of the total label\n    const height = maxY - minY;\n    // Update the instance with the calculated width of the label\n    const size: Size = [currentWidth, height / window.devicePixelRatio];\n\n    // Move all of the glyphs by -minY. This will effectively frame the label where the\n    // top left is 0,0 relative to all of the contents of the label.\n    // We also apply the calculated anchor at this time for the label\n    for (let i = 0, iMax = positions.length; i < iMax; ++i) {\n      offset = positions[i];\n      offset[1] -= minY;\n    }\n\n    return {\n      fontScale,\n      glyphs,\n      positions,\n      size,\n      text\n    };\n  }\n\n  /**\n   * This generates the necessary texture settings for the font map based on it's glyph type.\n   */\n  private makeGlyphTypeTextureSettings(type: FontMapGlyphType) {\n    switch (type) {\n      // Simple bitmap glyphs. Just need luminance and alpha value for the glyph\n      case FontMapGlyphType.BITMAP:\n        this.textureSettings = {\n          magFilter: GLSettings.Texture.TextureMagFilter.Linear,\n          minFilter: GLSettings.Texture.TextureMinFilter.LinearMipMapLinear,\n          format: GLSettings.Texture.TexelDataType.LuminanceAlpha\n        };\n        break;\n\n      // Only a single channel is needed for SDF\n      case FontMapGlyphType.SDF:\n        this.textureSettings = {\n          magFilter: GLSettings.Texture.TextureMagFilter.Linear,\n          minFilter: GLSettings.Texture.TextureMinFilter.Linear,\n          format: GLSettings.Texture.TexelDataType.Luminance\n        };\n        break;\n\n      // The MSDF strategy uses all RGB channels for the algorithm. Heavier data use\n      // better quality results.\n      case FontMapGlyphType.MSDF:\n        this.textureSettings = {\n          magFilter: GLSettings.Texture.TextureMagFilter.Linear,\n          minFilter: GLSettings.Texture.TextureMinFilter.Linear,\n          format: GLSettings.Texture.TexelDataType.RGB\n        };\n        break;\n    }\n  }\n\n  /**\n   * Registers a glyph with it's location on the map.\n   */\n  registerGlyph(char: string, tex: SubTexture) {\n    if (this.dynamic) {\n      this.doRegisterGlyph(char, tex);\n    } else {\n      console.warn(\n        \"Attempted to register a new glyph with a non-dynamic FontMap\"\n      );\n    }\n  }\n\n  /**\n   * Validates if all the kerning specified is ready for the text\n   */\n  supportsKerning(text: string) {\n    // Loop through the characters in the text and see if all pairs of glyphs\n    // have their kerning determined and calculated.\n    for (let i = 1, iMax = text.length; i < iMax; ++i) {\n      const char = text[i];\n      const leftChar = text[i - 1];\n\n      // If the left or the right character is not found properly, then this text is not supported\n      // by the font map kerning yet.\n      if (this.kerning[leftChar]) {\n        if (!this.kerning[leftChar][char]) {\n          return false;\n        }\n      } else return false;\n    }\n\n    return true;\n  }\n}\n","import { Bounds } from \"../../primitives\";\nimport { PackNode } from \"../../resources/texture/pack-node\";\nimport { Omit, ResourceType, Size } from \"../../types\";\nimport { BaseResourceOptions } from \"../base-resource-manager\";\nimport { SubTexture } from \"../texture/sub-texture\";\nimport { FontMap, FontMapGlyphType } from \"./font-map\";\nimport { FontRenderer } from \"./font-renderer\";\nimport { IFontResourceRequest } from \"./font-resource-request\";\n\nconst debug = require(\"debug\")(\"performance\");\n\n/**\n * Valid glyph rendering sizes that the system will use when rendering the glyphs to the font map's texture.\n */\nexport enum FontGlyphRenderSize {\n  /** NOT RECOMMENDED: You lose a lot of quality with this size. Use only if you do not need your text larger than 16 ever. */\n  _16 = 16,\n  /** Ideal size for simple SDF technique that trades used memory for quality */\n  _32 = 32,\n  /** Better quality glyphs for rendering, but suffers from resource useasge */\n  _64 = 64,\n  /** NOT RECOMMENDED: This is very large and will not allow for many glyphs on a single texture */\n  _128 = 128\n}\n\n/**\n * Metrics for a font map source specification.\n */\nexport interface IFontMapMetrics {\n  /**\n   * EXPERIMENTAL: When enabled, this allows the framework to cache the kerning pair calculations in the local storage.\n   * This can greatly speed up reload times of this chart, but may come with consequences as well.\n   */\n  localKerningCache?: boolean;\n  /** A type indicator to help identify which type of font resource is provided */\n  type?: FontMapGlyphType;\n  /** Size the font is rendered to the font map */\n  size: number;\n  /** Family of the font to be rendered to the font map */\n  family: string;\n  /** Font weight of the font to be rendered to the font map */\n  weight: string | number;\n}\n\nexport interface ISimpleFontMapMetrics extends IFontMapMetrics {\n  type: undefined;\n}\n\n/**\n * Indicates a bitmap font source.\n */\nexport interface IBitmapFontSource extends IFontMapMetrics {\n  /** This indicates a bitmap style of font rendering is required of the font. */\n  type: FontMapGlyphType.BITMAP;\n}\n\n/**\n * The available properties of a prerendered font source\n */\nexport interface IPrerenderedFontSource extends IFontMapMetrics {\n  /** This is the glyph renderings in Base64 encoding */\n  glyphs: { [key: string]: string };\n  /** This is the glyph used when no glyph is available */\n  errorGlyph: string;\n}\n\n/**\n * This is a provided pre-rendered SDF resource object format.\n */\nexport interface IPrerenderedSDFFontSource extends IPrerenderedFontSource {\n  /** This is the indicator that this prerendered resource is SDF */\n  type: FontMapGlyphType.SDF;\n}\n\n/**\n * This is a provided pre-rendered MSDF resource object format.\n */\nexport interface IPrerenderedMSDFFontSource extends IPrerenderedFontSource {\n  /** This is the indicator that this prerendered resource is MlSDF */\n  type: FontMapGlyphType.MSDF;\n}\n\n/**\n * These are the valid sources of a font from which the system will derive the glyphs and font metrics necessary\n * to render text to the screen.\n */\nexport type FontMapSource =\n  | IFontMapMetrics\n  | IBitmapFontSource\n  | IPrerenderedSDFFontSource\n  | IPrerenderedMSDFFontSource;\n\n/**\n * Options for creating a new Font Resource.\n */\nexport interface IFontResourceOptions extends BaseResourceOptions {\n  /**\n   * When this is provided ONLY these characters will be supplied by this resource.\n   * This is simply a string with every character to allow. Filtering glyphs can greatly\n   * speed up performance. When not provided, the system will analyze strings as they stream in\n   * and will update the atlas with the needed glyphs to render the text.\n   */\n  characterFilter?: string;\n  /**\n   * When this is set, the system will add glyphs to the font map from the font source provided as the glyphs\n   * are needed. This performs not as well as preset fonts. You can combine dynamic with characterFilter to have\n   * initial glyphs be preloaded and work faster from the start. Or you can use the character filter but NOT be dynamic\n   * and enforce strict character allowances.\n   */\n  dynamic?: boolean;\n  /** If the system has generated the font map for this resource, this will be populated */\n  fontMap?: FontMap;\n  /**\n   * This is the source the font information is derived from.\n   *\n   * A string will cause the system to use canvas rendering to attempt to best calculate the font glyphs and metrics as best\n   * as possible. This is the slowest possible method to render text.\n   *\n   * It is much better to used the pre-rendered formats.\n   */\n  fontSource: FontMapSource;\n  /** Enforce the resource to be a FONT type */\n  type: ResourceType.FONT;\n  /** If provided will constrain the texture to the provided size */\n  fontMapSize?: Size;\n}\n\n/**\n * Type guard for font resource options type\n */\nexport function isFontResource(\n  val: BaseResourceOptions\n): val is IFontResourceOptions {\n  return val && val.type === ResourceType.FONT;\n}\n\n/**\n * This is the string font source type guard.\n */\nfunction isSimpleFontMetrics(val: any): val is ISimpleFontMapMetrics {\n  return val && val.type === undefined;\n}\n\n/**\n * Method for making typings and API feedback easier. Just a wrapper for building\n * an IFontResourceOptions object. Excludes the need to specify the type.\n */\nexport function createFont(\n  options: Omit<IFontResourceOptions, \"type\">\n): IFontResourceOptions {\n  return {\n    type: ResourceType.FONT,\n    ...options\n  };\n}\n\n/**\n * This manager is responsible for handling the actual generation and updating of Font textures.\n *\n * This manager handles consuming resource options and producing an appropriate resource based on\n * either generating the SDF at run time or loading up a provided pre-rendered font resource.\n */\nexport class FontManager {\n  /** The lookup for the font map resources by their key */\n  fontMaps = new Map<string, FontMap>();\n  /**\n   * Contains the methods needed to render glyphs and calculate kerning\n   * when no precomputed resources are available.\n   */\n  fontRenderer = new FontRenderer();\n\n  /**\n   * This takes all requests that want layout information included for a group of text\n   * and populates the request with the appropriate information.\n   */\n  async calculateMetrics(\n    resourceKey: string,\n    requests: IFontResourceRequest[]\n  ) {\n    debug(\"Calculating metrics for requests\");\n    const fontMap = this.fontMaps.get(resourceKey);\n    if (!fontMap) return;\n\n    for (let i = 0, iMax = requests.length; i < iMax; ++i) {\n      const request = requests[i];\n      const metrics = request.metrics;\n\n      // Only some requests will have metrics to be calculated\n      if (metrics) {\n        // Get the layout of the request\n        metrics.layout = fontMap.getStringLayout(\n          metrics.text,\n          metrics.fontSize\n        );\n\n        // If a max width is present, we need to calculate the truncation of the label\n        if (metrics.maxWidth) {\n          debug(\"Calculating truncation for\", metrics.text, metrics.maxWidth);\n\n          metrics.layout = await fontMap.getTruncatedLayout(\n            metrics.layout,\n            metrics.truncation || \"\",\n            metrics.maxWidth,\n            metrics.fontSize,\n            this.fontRenderer\n          );\n\n          // Show what the truncated text is\n          metrics.truncatedText = metrics.layout.text;\n        }\n      }\n    }\n  }\n\n  /**\n   * Converts a character filter to a deduped list of single characters\n   */\n  private characterFilterToCharacters(filter: string): string {\n    const characters = new Set<string>();\n    let all = \"\";\n\n    for (let i = 0, iMax = filter.length; i < iMax; ++i) {\n      const char = filter[i];\n\n      if (!characters.has(char)) {\n        characters.add(char);\n        all += char;\n      }\n    }\n\n    return all;\n  }\n\n  /**\n   * This generates a new font map object to work with. It will either be pre-rendered or dynamically\n   * populated as requests are made.\n   */\n  async createFontMap(resourceOptions: IFontResourceOptions) {\n    // This will contain all of the characters that the map initially starts with\n    const characters: string = this.characterFilterToCharacters(\n      resourceOptions.characterFilter || \"\"\n    );\n    // This is the generated font map specified by the resource options\n    let fontMap: FontMap | undefined;\n    // This is the source information of the font which the system will utilize to produce the map\n    const fontSource = resourceOptions.fontSource;\n    // This is the determined glyph type of the resource\n    let glyphType: FontMapGlyphType = FontMapGlyphType.SDF;\n\n    // We now determine what type of font source the options provide and set our font map\n    // up properly for it.\n    if (fontSource) {\n      if (isSimpleFontMetrics(fontSource)) {\n        glyphType = FontMapGlyphType.BITMAP;\n      } else {\n        glyphType = fontSource.type || glyphType;\n      }\n    }\n\n    // Create our new font map resource\n    fontMap = new FontMap({\n      ...resourceOptions,\n      glyphType\n    });\n\n    // Apply initial characters to the fontMap\n    await this.updateFontMapCharacters(characters, fontMap);\n    // Keep the generated font map as our resource\n    this.fontMaps.set(resourceOptions.key, fontMap);\n\n    return fontMap;\n  }\n\n  /**\n   * Free all generated resources here.\n   */\n  destroy() {\n    // Clears up resources\n    this.fontMaps.forEach(font => font.destroy());\n  }\n\n  /**\n   * This updates a font map with requests made. After the font map is updated, the\n   * requests should be populated with the appropriate sub texture information.\n   */\n  async updateFontMap(resourceKey: string, requests: IFontResourceRequest[]) {\n    const fontMap = this.fontMaps.get(resourceKey);\n    if (!fontMap) return;\n\n    let allPairs: string[] = [];\n    const allCharacters = new Set<string>();\n\n    // Aggregate all kerning and character requests and needs\n    for (let i = 0, iMax = requests.length; i < iMax; ++i) {\n      const req = requests[i];\n      if (req.character) allCharacters.add(req.character);\n      if (req.kerningPairs) allPairs = allPairs.concat(req.kerningPairs);\n\n      // We add in truncation characters as well if provided\n      if (req.metrics) {\n        if (req.metrics.truncation) {\n          const truncation = req.metrics.truncation.replace(/\\s/g, \"\");\n          allPairs.push(truncation);\n\n          for (let i = 0, iMax = req.metrics.truncation.length; i < iMax; ++i) {\n            allCharacters.add(truncation);\n          }\n        }\n      }\n    }\n\n    // Kerning pairs are also candidates for being rendered to the font map\n    for (let i = 0, iMax = allPairs.length; i < iMax; ++i) {\n      allCharacters.add(allPairs[i]);\n    }\n\n    // Convert the characters to be rendered to a sinple string\n    let uniqueCharacters: string = \"\";\n    allCharacters.forEach(char => (uniqueCharacters += char));\n\n    // Perform the updates to the font map\n    await this.updateFontMapCharacters(uniqueCharacters, fontMap);\n    // Perform the updates to the kerning pairs\n    await this.updateKerningPairs(allPairs, fontMap);\n\n    // After all this is done, all the requests can be populated with the font map\n    // signaling the request now has the resources to accomplish what it needs\n    for (let i = 0, iMax = requests.length; i < iMax; ++i) {\n      requests[i].fontMap = fontMap;\n    }\n  }\n\n  /**\n   * This updates the calculated kerning pairs for a given font map.\n   */\n  private async updateKerningPairs(pairs: string[], fontMap?: FontMap) {\n    if (!fontMap) return;\n\n    // Calculate the new kerning pair information\n    const kerning = await this.fontRenderer.estimateKerning(\n      pairs,\n      fontMap.fontString,\n      fontMap.fontSource.size,\n      fontMap.kerning,\n      !fontMap.spaceWidth\n    );\n\n    // Add the pairs to the font map\n    fontMap.addKerning(kerning.pairs);\n    // Set the calculated width of a space\n    fontMap.spaceWidth = fontMap.spaceWidth || kerning.spaceWidth;\n  }\n\n  /**\n   * This updates a specified font map with a list of characters expected within it.\n   */\n  private async updateFontMapCharacters(characters: string, fontMap?: FontMap) {\n    if (!fontMap) return;\n    const texture = fontMap.texture;\n\n    // We must determine which characters are not supported by the font map first\n    const toAdd = fontMap.findMissingCharacters(characters);\n    // Nothing to add, then nothig to do!\n    if (toAdd.length <= 0) return;\n\n    // Get all the glyph data we need to update to the Font Map's texture\n    const glyphs = this.fontRenderer.makeBitmapGlyphs(\n      toAdd,\n      fontMap.fontString,\n      fontMap.fontSource.size\n    );\n\n    // Apply each newly rendered glyph into the font map\n    for (const char in glyphs) {\n      const metrics = glyphs[char];\n\n      if (texture.data) {\n        const packBounds = new Bounds({\n          x: 0,\n          y: 0,\n          width: metrics.glyph.width,\n          height: metrics.glyph.height\n        });\n\n        // Make the sub texture object our packing is going to associate with\n        const subTexture = new SubTexture();\n\n        // Pack the glyph information into the font map texture\n        const packing = fontMap.packing.insert({\n          data: subTexture,\n          bounds: packBounds\n        });\n\n        if (!packing) {\n          console.warn(\n            \"Font map is full and could not pack in any more glyphs\"\n          );\n          return;\n        }\n\n        // Now use the packing information to update our texture\n        PackNode.applyToSubTexture(\n          fontMap.packing,\n          packing,\n          subTexture,\n          undefined,\n          true\n        );\n\n        // Apply the image to the texture\n        texture.update(metrics.glyph, {\n          ...packing.bounds,\n          y:\n            fontMap.packing.bounds.height -\n            packing.bounds.y -\n            packing.bounds.height\n        });\n\n        // Register the glyph with the font map\n        if (subTexture) fontMap.registerGlyph(char, subTexture);\n        else {\n          console.warn(\n            \"Could not generate a subtexture for the font map registration.\"\n          );\n        }\n      } else {\n        console.warn(\n          \"Can not update font map as the maps texture data is not defined.\"\n        );\n      }\n    }\n  }\n\n  /**\n   * TODO:\n   * We do not use this method yet as we do not have a format set for prerendered fonts.\n   * Currently the system only uses the bitmap font dynamic pattern.\n   *\n   * This renders the specified characters from a pre-rendered font source in ImageData that can be used to composite\n   * a texture.\n   */\n  async getPrerenderedImageData(\n    source: IPrerenderedFontSource,\n    glyphSize: FontGlyphRenderSize,\n    characters: string[]\n  ) {\n    const promises: Promise<void>[] = [];\n\n    // Loop through all of the characters to be loaded from the source\n    characters.forEach(char => {\n      let glyphData = source.glyphs[char];\n\n      // Make sure the character exists, if not, use the error glyph provided by the source\n      if (!glyphData) {\n        glyphData = source.errorGlyph;\n      }\n\n      // A valid error glyph MUST be present\n      if (!source.errorGlyph) {\n        console.warn(\n          \"The prerendered source provided did NOT provide a proper glyph for rendering when a glyph could not be located.\"\n        );\n        return [];\n      }\n\n      // Set up the waiting mechanisms and the resources to render our glyphs from Base64\n      const image = new Image();\n      let resolve: Function;\n      const promise = new Promise<void>(resolver => (resolve = resolver));\n\n      // Wait for the image to finish loading\n      image.onload = function() {\n        // Make our canvas context to render the glyph data to.\n        const canvas: HTMLCanvasElement = document.createElement(\"canvas\");\n        const context = canvas.getContext(\"2d\");\n        if (!context) return;\n        // Our canvas to render to will be the specified glyphSize block\n        canvas.width = glyphSize;\n        canvas.height = glyphSize;\n        // We want to draw the glyph the size of the desired glyph rendering\n        context.drawImage(image, 0, 0, glyphSize, glyphSize);\n        // Retreieve the data rendered to the canvas as our glyph data\n        const glyphData = context.getImageData(0, 0, glyphSize, glyphSize);\n        // Resolve with the rendered portion\n        resolve(glyphData);\n      };\n\n      // If an error occurrs\n      image.onerror = function() {\n        console.warn(\n          \"There was an issue with loading the glyph data for character:\",\n          char\n        );\n        resolve(null);\n      };\n\n      // Begin loading the glyph data into the image\n      image.src = source.glyphs[char];\n      promises.push(promise);\n\n      return [];\n    });\n\n    // This will contain all of the glyph render information\n    return await Promise.all(promises);\n  }\n}\n","import { Bounds } from \"../primitives/bounds\";\n\nexport class DataBounds<T> extends Bounds {\n  data: T;\n\n  static emptyBounds<T>() {\n    return new DataBounds<T>({\n      height: 0,\n      width: 0,\n      x: 0,\n      y: 0\n    });\n  }\n}\n","import { DataBounds } from \"../util/data-bounds\";\nimport { Bounds } from \"./bounds\";\n\n/**\n * Anytime this is used to express bounds of an object, it is expected\n * to behave like CSS styling with absolute positioning.\n *\n * Setting a left and a right will auto calculate width (setting width takes precedence)\n *\n * You can set numbers to a %. If no % is present all other characters will be ignored\n * (px, em, and other dimensions will not be supported...just px by default unless %)\n */\nexport type AbsolutePosition = {\n  bottom?: number | string;\n  height?: number | string;\n  left?: number | string;\n  right?: number | string;\n  top?: number | string;\n  width?: number | string;\n};\n\nfunction value(val: number | string, ref: number, scaleRatio: number) {\n  const parse = `${val}`;\n  const num = parseFloat(parse);\n\n  if (isNaN(num)) {\n    return 0;\n  }\n\n  // If this is a percentage use the reference as the num to multiply against\n  if (parse.indexOf(\"%\") > -1) {\n    return num / 100.0 * ref;\n  }\n\n  return num * scaleRatio;\n}\n\n/**\n * This evaluates an absolute position with a reference to produce meaningful bounds.\n *\n * The scaleRatio provided should be available in or for percents to have the same weighting\n * as whole number values.\n */\nexport function getAbsolutePositionBounds<T>(\n  item: AbsolutePosition,\n  reference: Bounds,\n  scaleRatio: number\n): DataBounds<T> {\n  if (reference.width === 0 || reference.height === 0) {\n    console.warn(\n      \"An AbsolutePosition evaluated to invalid dimensions.\",\n      \"Please ensure that the object provided and the reference has valid dimensions\",\n      \"to produce dimensions with width and height that are non-zero.\",\n      \"item:\",\n      item,\n      \"reference:\",\n      reference.toString()\n    );\n  }\n\n  const bounds = DataBounds.emptyBounds<T>();\n  let width;\n  let height;\n\n  // Calculate the horizontal values\n  if (item.width) {\n    bounds.width = value(item.width, reference.width, scaleRatio);\n\n    if (item.left !== undefined) {\n      bounds.x = value(item.left, reference.width, scaleRatio);\n    } else if (item.right !== undefined) {\n      bounds.x =\n        reference.width -\n        value(item.right, reference.width, scaleRatio) -\n        bounds.width;\n    }\n  } else {\n    const left = value(item.left || 0, reference.width, scaleRatio);\n    const right =\n      reference.width - value(item.right || 0, reference.width, scaleRatio);\n    width = right - left;\n\n    if (width < 0) {\n      console.warn(\n        \"An AbsolutePosition evaluated to invalid dimensions.\",\n        \"Please ensure that the object provided and the reference has valid dimensions\",\n        \"to produce dimensions with width and height that are greater than zero.\",\n        \"item:\",\n        item,\n        \"reference:\",\n        reference.toString()\n      );\n    }\n\n    bounds.x = left;\n    bounds.width = width;\n  }\n\n  // Calculate the vertical values\n  if (item.height) {\n    bounds.height = value(item.height, reference.height, scaleRatio);\n\n    if (item.top !== undefined) {\n      bounds.y = value(item.top, reference.height, scaleRatio);\n    } else if (item.bottom !== undefined) {\n      bounds.y =\n        reference.height -\n        value(item.bottom, reference.height, scaleRatio) -\n        bounds.height;\n    }\n  } else {\n    const top = value(item.top || 0, reference.height, scaleRatio);\n    const bottom =\n      reference.height - value(item.bottom || 0, reference.height, scaleRatio);\n    height = bottom - top;\n\n    if (height === undefined || height < 0) {\n      console.warn(\n        \"An AbsolutePosition evaluated to invalid dimensions.\",\n        \"Please ensure that the object provided and the reference has valid dimensions\",\n        \"to produce dimensions with width and height that are greater than zero.\",\n        \"item:\",\n        item,\n        \"reference:\",\n        reference.toString()\n      );\n    }\n\n    bounds.y = top;\n    bounds.height = height;\n  }\n\n  if (\n    bounds.width === 0 ||\n    bounds.height === 0 ||\n    isNaN(bounds.x + bounds.y + bounds.width + bounds.height)\n  ) {\n    bounds.x = 0;\n    bounds.y = 0;\n    bounds.width = reference.width;\n    bounds.height = reference.height;\n  }\n\n  return bounds;\n}\n","import { Instance, InstanceDiff } from \"../../instance-provider\";\nimport {\n  BufferManagerBase,\n  IBufferLocation,\n  IBufferLocationGroup\n} from \"./buffer-manager-base\";\nimport { IInstanceDiffManagerTarget } from \"./instance-diff-manager\";\n\n/**\n * Base requirements for handling diffs from a layer.\n */\nexport abstract class BaseDiffProcessor<T extends Instance> {\n  layer: IInstanceDiffManagerTarget<T>;\n  bufferManager: BufferManagerBase<T, IBufferLocation>;\n\n  constructor(\n    layer: IInstanceDiffManagerTarget<T>,\n    bufferManager: BufferManagerBase<T, IBufferLocation>\n  ) {\n    this.layer = layer;\n    this.bufferManager = bufferManager;\n  }\n\n  /** Perform an 'add' operation for the instance's buffer */\n  abstract addInstance(\n    manager: this,\n    instance: T,\n    propIds: number[],\n    bufferLocation?: IBufferLocation | IBufferLocationGroup<IBufferLocation>\n  ): void;\n  /** Perform a 'change' operation for the instance's buffer */\n  abstract changeInstance(\n    manager: this,\n    instance: T,\n    propIds: number[],\n    bufferLocation?: IBufferLocation | IBufferLocationGroup<IBufferLocation>\n  ): void;\n  /** Perform a 'remove' operation for the instance's buffer */\n  abstract removeInstance(\n    manager: this,\n    instance: T,\n    propIds: number[],\n    bufferLocation?: IBufferLocation | IBufferLocationGroup<IBufferLocation>\n  ): void;\n\n  /**\n   * This indicates all changes have been applied, this allows the processor to finalize buffer updates\n   */\n  abstract commit(): void;\n  /**\n   * This will be called with the changes that WILL be processed. This allows this processor to make extra judgement calls on\n   * how it will process the changes and let's it optimize itself before changes are actually processed. An example optimization:\n   *\n   * Buffers have an update range we can adjust so only a piece of the buffer is updated. However, calculating that range causes\n   * overhead to calculate the affected range. So, if we have mass changes happening for major sections of the buffer (number of\n   * changes approaches some large percentage of the instances supported by the buffer), then it would be more efficient just to\n   * update the entire buffer rather than discover the portion needing updating.\n   */\n  abstract incomingChangeList(changes: InstanceDiff<T>[]): void;\n}\n","let toEmit: { [key: string]: [Function, number, number] } = {};\n\nexport function emitOnce(\n  id: string,\n  callback: (calledCountBeforeEmit: number, id: string) => void\n) {\n  const emit = toEmit[id] || [callback, -1, 0];\n  toEmit[id] = emit;\n  emit[2]++;\n\n  clearTimeout(emit[1]);\n  emit[1] = window.setTimeout(() => {\n    callback(emit[2], id);\n    delete toEmit[id];\n  }, 1);\n}\n\nexport function flushEmitOnce() {\n  for (const id in toEmit) {\n    const emit = toEmit[id];\n    clearTimeout(emit[1]);\n    emit[0](emit[2], id);\n  }\n\n  toEmit = {};\n}\n","import { IEasingProps } from \"../types\";\nimport { Vec } from \"./vector\";\n\n/**\n * This object represents the data associated with easing. It provides the\n * information needed to make an easing equation execute to completion. It also\n * contains a few methods to aid in properly adjusting the easing values.\n */\nexport class EasingProps implements IEasingProps {\n  delay: number = 0;\n  duration: number;\n  end: Vec;\n  isManualStart = false;\n  isTimeSet = false;\n  start: Vec;\n  startTime: number;\n\n  constructor(options: IEasingProps) {\n    Object.assign(this, options);\n  }\n\n  /**\n   * If you manually set values for the easing properties, then you use this to return\n   * the easing object back to an automated state which is where the start value is\n   * the calculated current position of the output and the delay and duration is determined\n   * by the easing set to the layer's IAutomatedEasingMethod value set to the layer.\n   */\n  setAutomatic() {\n    this.isManualStart = false;\n    this.isTimeSet = false;\n  }\n\n  /**\n   * This controls the start value of the easing. This should be used to force a starting\n   * value of the animation.\n   *\n   * Use setAutomatic() to return to default easing behavior.\n   */\n  setStart(start?: Vec) {\n    if (start) {\n      if (this.start.length !== start.length) {\n        console.warn(\n          \"A manual easing adjustment provided an incompatible value for the easing type.\"\n        );\n      } else {\n        this.start = start;\n        this.isManualStart = true;\n      }\n    }\n  }\n\n  /**\n   * This controls of the timing of the easing equation. This should be used to adjust\n   * when a value is to be adjusted\n   *\n   * Use setAutomatic() to return to default easing behavior.\n   */\n  setTiming(delay?: number, duration?: number) {\n    this.delay = delay === undefined ? this.delay : delay;\n    this.duration = duration === undefined ? this.duration : duration;\n    this.isTimeSet = true;\n  }\n}\n","import { IInstanceProvider } from \"../surface/layer\";\nimport { InstanceDiffType } from \"../types\";\nimport { uid } from \"../util/uid\";\nimport { Instance } from \"./instance\";\n\n/**\n * This is an entry within the change list of the provider. It represents the type of change\n * and stores the property id's of the properties on the instance that have changed.\n */\nexport type InstanceDiff<T extends Instance> = [\n  T,\n  InstanceDiffType,\n  { [key: number]: number }\n];\n\ntype InstanceDisposer<T extends Instance> = [T, Function];\n\n/**\n * This is an optimized provider, that can provide instances that use the internal observable system\n * to deliver updates to the framework.\n */\nexport class InstanceProvider<T extends Instance>\n  implements IInstanceProvider<T> {\n  /** A uid provided to this object to give it some easy to identify uniqueness */\n  get uid() {\n    return this._uid;\n  }\n  private _uid: number = uid();\n  /** Stores the disposers that are called when the instance is no longer listened to */\n  private cleanObservation = new Map<number, InstanceDisposer<T>>();\n  /** This stores the changes to the instances themselves */\n  private instanceChanges = new Map<number, InstanceDiff<T>>();\n  /** This flag is true when resolving changes when the change list is retrieved. it blocks changes until the current list is resolved */\n  private allowChanges = true;\n  /**\n   * This indicates the context this provider was handled within. Currently, only one context is allowed per provider,\n   * so we use this to detect when multiple contexts have attempted use of this provider.\n   */\n  resolveContext: string = \"\";\n\n  /**\n   * Retrieve all of the changes applied to instances\n   */\n  get changeList(): InstanceDiff<T>[] {\n    this.allowChanges = false;\n    const changes: InstanceDiff<T>[] = [];\n    this.instanceChanges.forEach(val => changes.push(val));\n\n    return changes;\n  }\n\n  /**\n   * Adds an instance to the provider which will stream observable changes of the instance to\n   * the framework.\n   */\n  add(instance: T) {\n    // No need to duplicate the addition\n    if (this.cleanObservation.get(instance.uid)) {\n      return instance;\n    }\n\n    if (this.allowChanges) {\n      instance.observer = this;\n      const disposer: Function = instance.observableDisposer;\n      // Store the disposers so we can clean up the observable properties\n      this.cleanObservation.set(instance.uid, [instance, disposer]);\n      // Indicate we have a new instance\n      this.instanceChanges.set(instance.uid, [\n        instance,\n        InstanceDiffType.INSERT,\n        instance.changes\n      ]);\n    }\n\n    return instance;\n  }\n\n  /**\n   * Removes all instances from this provider\n   */\n  clear() {\n    this.cleanObservation.forEach(values => {\n      this.remove(values[0]);\n    });\n  }\n\n  /**\n   * Clear all resources held by this provider. It IS valid to lose reference to all instances\n   * and to this object, which would effectively cause this object to get GC'ed. But if you\n   * desire to hang onto the instance objects, then this should be called.\n   */\n  destroy() {\n    this.cleanObservation.forEach(values => {\n      values[1]();\n    });\n\n    this.cleanObservation.clear();\n    this.instanceChanges.clear();\n  }\n\n  /**\n   * This is called from observables to indicate it's parent has been updated.\n   * This is what an instance calls when it's observable property is modified.\n   */\n  instanceUpdated(instance: T) {\n    if (this.allowChanges) {\n      // Flag the instance as having a property changed\n      this.instanceChanges.set(instance.uid, [\n        instance,\n        InstanceDiffType.CHANGE,\n        instance.changes\n      ]);\n    }\n  }\n\n  /**\n   * Stops the instance's ability to register changes with this provider and flags\n   * a final removal diff change.\n   */\n  remove(instance: T) {\n    if (this.allowChanges) {\n      const disposer = this.cleanObservation.get(instance.uid);\n\n      if (disposer) {\n        disposer[1]();\n        this.cleanObservation.delete(instance.uid);\n        this.instanceChanges.set(instance.uid, [\n          instance,\n          InstanceDiffType.REMOVE,\n          {}\n        ]);\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Flagged all changes as dealt with\n   */\n  resolve(context: string) {\n    this.allowChanges = true;\n    this.instanceChanges.clear();\n\n    if (this.resolveContext && this.resolveContext !== context) {\n      throw new Error(\n        \"An instance provider has been issued to two layers. This is not a suppported feature yet and can cause issues.\"\n      );\n    }\n\n    this.resolveContext = context;\n  }\n\n  /**\n   * This performs an operation that forces all of the instances to be flagged as an\n   * 'add' change. This allows a layer listening to this provider to ensure it has added\n   * all currently existing instances monitored by the provider.\n   *\n   * NOTE: This is a VERY poor performing method and should probably be used by the framework\n   * and not manually.\n   */\n  sync() {\n    const emptyPropertyChanges: number[] = [];\n\n    // Loop through all registered instances (which is only stored in the disposer list kept by this provider)\n    this.cleanObservation.forEach(disposer => {\n      const [instance] = disposer;\n      // Flag the instance as having a property changed\n      this.instanceChanges.set(instance.uid, [\n        instance,\n        InstanceDiffType.INSERT,\n        emptyPropertyChanges\n      ]);\n    });\n  }\n}\n","import { Size } from \"../types\";\nimport { Vec4 } from \"../util\";\nimport { Attribute } from \"./attribute\";\nimport { GLProxy } from \"./gl-proxy\";\nimport { GLState } from \"./gl-state\";\nimport { Model } from \"./model\";\nimport { RenderTarget } from \"./render-target\";\nimport { Scene } from \"./scene\";\nimport { WebGLStat } from \"./webgl-stat\";\n\n/**\n * Options used to create or update the renderer.\n */\nexport interface IWebGLRendererOptions {\n  /**\n   * Determines if the rendering context renders to a buffer with an alpha channel.\n   * Performs better if no alpha channel is used, but may be needed if any DOM elements or\n   * backgrounds needs to bleed through the canvas.\n   */\n  alpha?: boolean;\n  /**\n   * Set to true to use the system antialiasing set up. Performs much better when false, but definitely\n   * looks better when true.\n   */\n  antialias?: boolean;\n  /**\n   * This is the canvas that is required to retrieve the webgl context to make all webgl calls with.\n   */\n  canvas: HTMLCanvasElement;\n  /**\n   * This needs to be true in order to query the canvas current rendered output. Performs better when false,\n   * but some cases may need it to do such operations like snapshots etc.\n   */\n  preserveDrawingBuffer?: boolean;\n  /**\n   * Set to true to make the default context expect premultipled alpha for blending.\n   */\n  premultipliedAlpha?: boolean;\n\n  /**\n   * Callback indicating a context could not be generated.\n   */\n  onNoContext?(): void;\n}\n\n/**\n * Internal state of the renderer.\n */\nexport interface IWebGLRendererState {\n  /** Sets up a clear mask to ensure the clear operation only happens once per draw */\n  clearMask: [boolean, boolean, boolean];\n  /** Stores which render target is in focus for the current operations on the renderer */\n  currentRenderTarget: RenderTarget | null;\n  /** The current display size of the canvas */\n  displaySize: Size;\n  /** The current pixel ratio in use */\n  pixelRatio: number;\n  /** The current rendering size of the canvas */\n  renderSize: Size;\n}\n\n/**\n * This is the primary file where the rendering and compositing resources and managing\n * gl state happens. A context is provided for the renderer to work with, then it is the\n * renderer's job to ensure state changes as expected and provide as much convenience as necessary\n * to make working with the webgl pipeline as easy as possible.\n */\nexport class WebGLRenderer {\n  /** When this is set this creates */\n  set debugContext(val: string) {\n    if (this.glProxy) this.glProxy.debugContext = val;\n    if (this.glState) this.glState.debugContext = val;\n  }\n\n  /** The context the renderer is managing */\n  private _gl?: WebGLRenderingContext;\n  /** The readonly gl context the renderer determined for use */\n  get gl() {\n    return this._gl;\n  }\n  /** This is the compiler that performs all actions related to creating and updating buffers and objects on the GPU */\n  glProxy: GLProxy;\n  /** This handles anything related to state changes in the GL state */\n  glState: GLState;\n  /** The options that constructed or are currently applied to the renderer */\n  options: IWebGLRendererOptions;\n\n  /** Any current internal state the renderer has applied to it's target */\n  state: IWebGLRendererState = {\n    clearMask: [false, false, false],\n    currentRenderTarget: null,\n    displaySize: [1, 1],\n    pixelRatio: 1,\n    renderSize: [1, 1]\n  };\n\n  constructor(options: IWebGLRendererOptions) {\n    // Assign defaults to our options\n    this.options = Object.assign(\n      {\n        alpha: false,\n        antialias: false,\n        preserveDrawingBuffer: false\n      },\n      options\n    );\n\n    // Make sure we are provided a canvas to work with\n    if (!this.options.canvas) {\n      console.warn(\"WebGLRenderer ERROR: A canvas is REQUIRED as a parameter.\");\n    }\n\n    // Initialize context for the renderer\n    this.getContext();\n  }\n\n  /**\n   * Clears the specified buffers.\n   */\n  clear(color?: boolean, depth?: boolean, stencil?: boolean) {\n    const clear = this.state.clearMask;\n\n    this.state.clearMask = [\n      clear[0] || color || false,\n      clear[1] || depth || false,\n      clear[2] || stencil || false\n    ];\n  }\n\n  /**\n   * Clears the color either set with setClearColor, or clears the color specified.\n   */\n  clearColor(color?: Vec4) {\n    if (color) {\n      this.glState.setClearColor(color);\n    }\n  }\n\n  /**\n   * Free all resources this renderer utilized. Make sure textures and frame/render/geometry\n   * buffers are all deleted. We may even use aggressive buffer removal that force resizes the buffers\n   * so their resources are immediately reduced instead of waiting for the JS engine to free up resources.\n   */\n  dispose() {\n    // TODO\n  }\n\n  /**\n   * Retrieve and establish the context from the canvas.\n   */\n  getContext() {\n    if (this._gl) return this._gl;\n\n    const gl = GLProxy.getContext(this.options.canvas, {\n      alpha: this.options.alpha || false,\n      antialias: this.options.antialias || false,\n      premultipliedAlpha: this.options.premultipliedAlpha || false,\n      preserveDrawingBuffer: this.options.preserveDrawingBuffer || false\n    });\n\n    if (gl.context) {\n      this._gl = gl.context;\n      this.glState = new GLState(gl.context, gl.extensions);\n      this.glProxy = new GLProxy(gl.context, this.glState, gl.extensions);\n      this.glState.setProxy(this.glProxy);\n\n      // Make sure our GPU is synced with our default state\n      this.glState.syncState();\n    } else if (this.options.onNoContext) {\n      this.options.onNoContext();\n    } else {\n      console.warn(\n        \"No context was able to be produced, and the handler onNoContext was not implemented for such cases.\"\n      );\n    }\n\n    return this._gl;\n  }\n\n  /**\n   * Retrieves the size of the canvas ignoring pixel ratio.\n   */\n  getDisplaySize(): Size {\n    return this.state.displaySize;\n  }\n\n  /**\n   * Retrieves the current pixel ratio in use for the context.\n   */\n  getPixelRatio() {\n    return this.state.pixelRatio;\n  }\n\n  /**\n   * Retrieves the size of the rendering context. This is the pixel dimensions\n   * of what is being rendered into.\n   */\n  getRenderSize(): Size {\n    return this.state.renderSize;\n  }\n\n  /**\n   * Returns the full viewport for the current target.\n   *\n   * If a RenderTarget is not set, then this returns the viewport of the canvas ignoring\n   * the current pixel ratio.\n   */\n  getFullViewport() {\n    const target = this.state.currentRenderTarget;\n\n    if (target) {\n      return {\n        x: 0,\n        y: 0,\n        width: target.width,\n        height: target.height\n      };\n    } else {\n      const size = this.getDisplaySize();\n\n      return {\n        x: 0,\n        y: 0,\n        width: size[0],\n        height: size[1]\n      };\n    }\n  }\n\n  /**\n   * Prepares the specified attribute\n   */\n  prepareAttribute(attribute: Attribute, name: string) {\n    // If we successfully update/compile the attribute, then we enable it's vertex array\n    if (this.glProxy.updateAttribute(attribute)) {\n      this.glProxy.useAttribute(name, attribute);\n    }\n\n    // Otherwise, we flag this as invalid geometry so we don't cause errors or undefined\n    // behavior while rendering\n    else {\n      console.warn(\"Could not update attribute\", attribute);\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Renders the Scene specified\n   */\n  render(scene: Scene, target: RenderTarget | null = null) {\n    // Context must be established to render\n    if (!this.gl) return;\n\n    // Establish the rendering state we're in right now\n    this.setRenderTarget(target);\n\n    // Apply the last clear mask provided for the render\n    const clear = this.state.clearMask;\n    if (clear[0] || clear[1] || clear[2]) {\n      this.glProxy.clear(clear[0], clear[1], clear[2]);\n      this.state.clearMask = [false, false, false];\n    }\n\n    // If the fbo is not ready, we're not drawing\n    if (target && !target.gl) {\n      console.warn(\n        \"FBO is not ready for drawing. Skipping the rendering of the scene and target:\",\n        { scene, target }\n      );\n      return;\n    }\n\n    // We'll remove any models that have errored from the scene\n    const toRemove: Model[] = [];\n    // Loop through all of the models of the scene and process them for rendering\n    scene.models.forEach((model: Model) => {\n      this.renderModel(model, toRemove);\n    });\n\n    // Clear out any failed models from the scene\n    toRemove.forEach(model => {\n      scene.remove(model);\n    });\n  }\n\n  /**\n   * Renders the specified model\n   */\n  private renderModel(model: Model, toRemove: Model[]) {\n    const geometry = model.geometry;\n    const material = model.material;\n\n    // Let's put the material's program in use first so we can have the attribute information\n    // available to us.\n    if (this.glState.useMaterial(material)) {\n      let geometryIsValid = true;\n\n      // Faster to use defined functions rather than closures for loops\n      const attributeLoop = function(attribute: Attribute, name: string) {\n        geometryIsValid =\n          this.prepareAttribute(attribute, name) && geometryIsValid;\n      };\n\n      // First update/compile all aspects of the geometry\n      geometry.attributes.forEach(attributeLoop, this);\n      // Now all of our attributes are established, we must make sure our vertex arrays are cleaned up\n      this.glState.applyVertexAttributeArrays();\n\n      // If all of the attribute updates passed correctly, then we can use the established state\n      // to make our draw call\n      if (geometryIsValid) {\n        this.glProxy.draw(model);\n      } else {\n        console.warn(\n          \"Geometry was unable to update correctly, thus we are skipping the drawing of\",\n          model\n        );\n\n        toRemove.push(model);\n      }\n    } else {\n      console.warn(\n        \"Could not utilize material. Skipping draw call for:\",\n        material,\n        geometry\n      );\n\n      toRemove.push(model);\n    }\n  }\n\n  /**\n   * Reads the pixels from the current Render Target (or more specifically from the current framebuffer)\n   *\n   * By default the viewport is set based on the canvas being rendered into. Include a render target\n   * to make the viewport be applied with the target considered rather than needing pixel density considerations.\n   */\n  readPixels(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    out: ArrayBufferView\n  ) {\n    if (!this.gl) return;\n    const target = this.state.currentRenderTarget;\n    let canRead = true;\n    if (target) canRead = target.validFramebuffer;\n\n    if (!canRead) {\n      console.warn(\n        \"Framebuffer is incomplete. Can not read pixels at this time.\"\n      );\n      return;\n    }\n\n    x = Math.max(0, x);\n    y = Math.max(0, y);\n\n    if (target) {\n      if (x + width > target.width) width = target.width - x;\n      if (y + height > target.height) height = target.height - y;\n      const _height = target.height;\n\n      this.gl.readPixels(\n        x,\n        _height - y - height,\n        width,\n        height,\n        this.gl.RGBA,\n        this.gl.UNSIGNED_BYTE,\n        out\n      );\n    } else {\n      const { pixelRatio } = this.state;\n      const size = this.getDisplaySize();\n      const _height = size[1];\n\n      if (x + width > size[0]) width = size[0] - x;\n      if (y + height > size[1]) height = size[1] - y;\n\n      this.gl.readPixels(\n        x * pixelRatio,\n        (_height - y - height) * pixelRatio,\n        width * pixelRatio,\n        height * pixelRatio,\n        this.gl.RGBA,\n        this.gl.UNSIGNED_BYTE,\n        out\n      );\n    }\n  }\n\n  /**\n   * Sets the clear color to be used when the clear operation executes.\n   */\n  setClearColor(color: Vec4) {\n    this.glState.setClearColor(color);\n  }\n\n  /**\n   * Applies a given ratio for the provided canvas context.\n   */\n  setPixelRatio(ratio: number) {\n    const { canvas } = this.options;\n    const size = this.getDisplaySize();\n\n    canvas.width = size[0] * ratio;\n    canvas.height = size[1] * ratio;\n\n    this.state.pixelRatio = ratio;\n  }\n\n  /**\n   * Sets the region the scissor test will accept as visible. Anything outside the region\n   * will be clipped.\n   *\n   * By default the scissor region is set based on the canvas being rendered into. Include a render target\n   * to make the scissor region be applied with the target considered rather than needing pixel density considerations.\n   */\n  setScissor(\n    bounds?: { x: number; y: number; width: number; height: number },\n    target?: RenderTarget\n  ) {\n    if (target) {\n      const _height = target.height;\n\n      if (bounds) {\n        const { x, y, width, height } = bounds;\n        // Apply the viewport in a fashion that is more web dev friendly where top left is 0, 0\n        this.glState.setScissor({ x, y: _height - y - height, width, height });\n      } else {\n        this.glState.setScissor(null);\n      }\n    } else {\n      const { pixelRatio } = this.state;\n      const size = this.getDisplaySize();\n      const _height = size[1];\n\n      if (bounds) {\n        const { x, y, width, height } = bounds;\n        this.glState.setScissor({\n          x: x * pixelRatio,\n          y: (_height - y - height) * pixelRatio,\n          width: width * pixelRatio,\n          height: height * pixelRatio\n        });\n      } else {\n        this.glState.setScissor(null);\n      }\n    }\n  }\n\n  /**\n   * Resizes the render area to the specified amount.\n   */\n  setSize(width: number, height: number) {\n    const { canvas } = this.options;\n    const { pixelRatio } = this.state;\n\n    // Set the rendering width and height of the canvas to the screen's resolution for maximum sharpness\n    // but it must be limited by the max texture size the hardware supports\n    canvas.width = Math.min(width * pixelRatio, WebGLStat.MAX_TEXTURE_SIZE);\n    canvas.height = Math.min(height * pixelRatio, WebGLStat.MAX_TEXTURE_SIZE);\n\n    // Scale the canvas to fit the desired width and height\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`;\n\n    this.state.renderSize = [canvas.width, canvas.height];\n    this.state.displaySize = [width, height];\n  }\n\n  /**\n   * This sets the context to render into the indicated target\n   */\n  setRenderTarget(target: RenderTarget | null) {\n    // Don't need to do anything forsame render targets\n    if (this.state.currentRenderTarget === target) return;\n\n    if (!this.glState.useRenderTarget(target) && target) {\n      // If unable to use yet, this indicates the FBO needs to be compiled\n      // Probably due to uncompiled texture objects that the FBO needs.\n      // First flag all textures as needing a texture unit\n      target.getTextures().forEach(texture => {\n        this.glState.willUseTextureUnit(texture, target);\n      });\n\n      // Now apply those textures (compile them while utilizing the texture units requested)\n      // This will also trigger the compilation of the target since the textures used\n      // This will also ensure the FBO is in use for the next draw call\n      this.glState.applyUsedTextures();\n\n      // Compile the render target then use if successful\n      if (this.glProxy.compileRenderTarget(target)) {\n        this.glState.useRenderTarget(target);\n      }\n    }\n\n    // Set this as the current render target for the renderer\n    this.state.currentRenderTarget = target;\n  }\n\n  /**\n   * Sets the viewport we render into.\n   *\n   * By default the viewport is set based on the canvas being rendered into. Include a render target\n   * to make the viewport be applied with the target considered rather than needing pixel density considerations.\n   */\n  setViewport(bounds: { x: number; y: number; width: number; height: number }) {\n    const target = this.state.currentRenderTarget;\n    const { x, y, width, height } = bounds;\n\n    if (target) {\n      const _height = target.height;\n\n      // Apply the viewport in a fashion that is more web dev friendly where top left is 0, 0\n      this.glState.setViewport(x, _height - y - height, width, height);\n    } else {\n      const { pixelRatio } = this.state;\n      const size = this.getDisplaySize();\n      const _height = size[1];\n\n      // Apply the viewport in a fashion that is more web dev friendly where top left is 0, 0\n      this.glState.setViewport(\n        x * pixelRatio,\n        (_height - y - height) * pixelRatio,\n        width * pixelRatio,\n        height * pixelRatio\n      );\n    }\n  }\n}\n","import { Vec2 } from \"../util\";\nimport { Geometry } from \"./geometry\";\nimport { GLSettings } from \"./gl-settings\";\nimport { Material } from \"./material\";\n\n/**\n * This represents a Geometry with a Material as a paired configuration to be rendered\n * within a scene.\n */\nexport class Model {\n  /** Specifies how the system will utilize the geometry applied */\n  drawMode: GLSettings.Model.DrawMode = GLSettings.Model.DrawMode.TRIANGLES;\n  /** Specifies the vertices to render within the Model */\n  vertexDrawRange?: Vec2 = [-1, -1];\n  /** This specifies how many instances to draw of this model */\n  drawInstances: number = -1;\n  /** The vertex information of the Model */\n  geometry: Geometry;\n  /** The material associated with the model */\n  material: Material;\n  /** Specifies the number of vertices available to the underlying geometry */\n  vertexCount: number = 0;\n\n  constructor(geometry: Geometry, material: Material) {\n    this.geometry = geometry;\n    this.material = material;\n  }\n}\n","import { Omit, TypeVec } from \"../types\";\nimport { GLProxy } from \"./gl-proxy\";\nimport { GLSettings } from \"./gl-settings\";\nimport { IMaterialUniform, MaterialUniformType } from \"./types\";\n\nexport type MaterialOptions = Omit<\n  Partial<Material>,\n  \"clone\" | \"dispose\" | \"gl\"\n>;\n\n/**\n * This represents a Shader configuration and a state for the configuration to be applied\n * when a model is rendered.\n */\nexport class Material {\n  /** This is the computed blend mode state. Set to null to deactivate */\n  blending: {\n    blendDst: GLSettings.Material.BlendingDstFactor;\n    blendEquation: GLSettings.Material.BlendingEquations;\n    blendSrc: GLSettings.Material.BlendingSrcFactor;\n  } | null = {\n    blendDst: GLSettings.Material.BlendingDstFactor.OneMinusSrcAlpha,\n    blendEquation: GLSettings.Material.BlendingEquations.Add,\n    blendSrc: GLSettings.Material.BlendingSrcFactor.SrcAlpha\n  };\n  /**\n   * The write mask to the color buffer. Each channel can be toggled on or off as the color buffer is written to. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/colorMask\n   */\n  colorWrite: TypeVec<boolean> = [true, true, true, true];\n  /** Sets the cull mode of GL for the polygons */\n  culling: GLSettings.Material.CullSide = GLSettings.Material.CullSide.CCW;\n  /** The comparator used to classify when a fragment will be rendered vs discarded when tested against the depth buffer */\n  depthFunc: GLSettings.Material.DepthFunctions = GLSettings.Material\n    .DepthFunctions.LESS_OR_EQUAL;\n  /**\n   * Enable / disable depth test (determines if the fragment depth is compared to the depth buffer before writing). See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/enable\n   */\n  depthTest: boolean = true;\n  /**\n   * Enable / disable depth mask (determines if fragments write to the depth buffer). See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/depthMask\n   */\n  depthWrite: boolean = true;\n  /**\n   * Sets whether or not GL should use it's dithering routine. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/enable\n   */\n  dithering: boolean = true;\n  /** The fragment shader in raw text format that will be compiled to run as the program to use when this material is used */\n  fragmentShader: string = \"\";\n  /**\n   * Stores any gl state associated with this object. Modifying this outside the framework\n   * is almost guaranteed to break something.\n   */\n  gl?: {\n    fsId: WebGLShader;\n    vsId: WebGLShader;\n    programId: WebGLProgram;\n    proxy: GLProxy;\n  };\n  /** A name for the  */\n  name: string = \"\";\n  /**\n   * TODO: This is NOT IN USE YET\n   * GL Polygon offset settings. When set, enables polygon offset modes within the gl state. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/enable\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/polygonOffset\n   */\n  polygonOffset?: {\n    polygonOffsetFactor?: number;\n    polygonOffsetUnits?: number;\n  };\n\n  /** Uniforms that will be synced with the GPU when this material is used */\n  uniforms: { [key: string]: IMaterialUniform<MaterialUniformType> } = {};\n  /** The vertex shader that will be compiled to run as the program to use when this material is used */\n  vertexShader: string = \"\";\n\n  constructor(options: MaterialOptions) {\n    // Take in the properties\n    Object.assign(this, options);\n    // Ensure the gl property did not get copied in if using the copy constructor new Material(Material)\n    delete this.gl;\n  }\n\n  /**\n   * Makes a duplicate material with identical settings as this material. It provides the\n   * benefit of being able to adjust uniform values for the new material while sharing the same\n   * programs and shaders.\n   */\n  clone() {\n    // Make a new copy material container and copy over the properties (shallow copy)\n    const copy = new Material(this);\n    // Now we deeper copy any sub objects\n    copy.blending = Object.assign({}, this.blending);\n    copy.polygonOffset = Object.assign({}, this.polygonOffset);\n    // And last we need a deep copy of uniforms, such that we get new uniform objects\n    copy.uniforms = Object.assign({}, this.uniforms);\n\n    // Deeper copy objects\n    // We DO NOT copy the data object as it is expected to be able to share data buffers\n    // between uniforms.\n    for (const name in copy.uniforms) {\n      const uniform: IMaterialUniform<MaterialUniformType> =\n        copy.uniforms[name];\n\n      // Make sure the gl references are the same but their own object\n      if (uniform.gl) {\n        const newLocations = new Map();\n        uniform.gl.forEach((location, program) => {\n          newLocations.set(program, Object.assign({}, location));\n        });\n      }\n    }\n\n    return copy;\n  }\n\n  /**\n   * This frees up all GL resources utilized by this material.\n   */\n  dispose() {\n    if (this.gl) {\n      this.gl.proxy.disposeMaterial(this);\n    }\n  }\n}\n","import { uid } from \"../util\";\nimport { GLProxy } from \"./gl-proxy\";\nimport { GLSettings } from \"./gl-settings\";\nimport { Texture } from \"./texture\";\n\n/**\n * These are the options available for creating a new RenderTarget.\n */\nexport interface IRenderTargetOptions {\n  /** Specifies the buffers the render target will render into when draw calls happen. */\n  buffers: {\n    /** The color buffer attachment. This allows multiple color buffers for MRT when available. */\n    color?:\n      | GLSettings.RenderTarget.ColorBufferFormat\n      | Texture\n      | (GLSettings.RenderTarget.ColorBufferFormat | Texture)[];\n    /** The depth buffer attachment. Exclusion automatically makes depth testing not work. */\n    depth?: GLSettings.RenderTarget.DepthBufferFormat | Texture;\n    /** The stencil buffer attachment. Exclusion automatically disables stencil testing. */\n    stencil?: GLSettings.RenderTarget.StencilBufferFormat | Texture;\n  };\n  /**\n   * The height of the render target. This is used when the textures are not dictating the width\n   * and the height. This is required if no Textures are specified as a buffer.\n   */\n  height?: number;\n  /**\n   * The width of the render target. This is used when the textures are not dictating the width\n   * and the width. This is required if no Textures are specified as a buffer.\n   */\n  width?: number;\n}\n\n/**\n * This represents an FBO render target to be rendered into. This can manage several\n * targets at once for MRT (or within compatibility modes).\n *\n * DO NOT EDIT existing render targets after they are constructed. Just dispose of old targets\n * and create new ones.\n */\nexport class RenderTarget {\n  /** UID for the object */\n  get uid() {\n    return this._uid;\n  }\n  private _uid = uid();\n\n  /** The buffer settings utilized in rendering this target */\n  get buffers() {\n    return {\n      color: Array.isArray(this._buffers.color)\n        ? this._buffers.color.slice(0)\n        : this._buffers.color,\n      depth: this._buffers.depth,\n      stencil: this._buffers.stencil\n    };\n  }\n  private _buffers: IRenderTargetOptions[\"buffers\"];\n  /**\n   * The height of the render target. This is automatically set if any of the buffers are a Texture\n   * object. Otherwise, this reflects the value provided in the options.\n   */\n  get height() {\n    return this._height;\n  }\n  private _height: number;\n  /**\n   * The width of the render target. This is automatically set if any of the buffers are a Texture\n   * object. Otherwise, this reflects the value provided in the options.\n   */\n  get width() {\n    return this._width;\n  }\n  private _width: number;\n  /**\n   * This is a flag indicating if the render target passed it's frame buffer status check\n   */\n  get validFramebuffer() {\n    return this._validFramebuffer;\n  }\n  private _validFramebuffer: boolean = false;\n\n  /**\n   * Split buffers occur to handle compatibility problems with MRT (multi render targeting)\n   * If the system this is running on does not support MRT, then for every color buffer attachment\n   * requested, we need to create a split buffer that has a single color buffer for each color buffer\n   * provided.\n   *\n   * TODO: We have not implemented split render buffers yet.\n   */\n  get splitRenderBuffers() {\n    return this._splitRenderBuffers;\n  }\n  private _splitRenderBuffers: RenderTarget[] | null = null;\n\n  /**\n   * This contains gl state that is processed and identified for the render target.\n   * Modifying this outside of the framework is guaranteed to break something.\n   */\n  gl?: {\n    /** Identifier for the FBO object representing this target */\n    fboId: WebGLFramebuffer;\n    /** The color buffer(s) this target is rendering into */\n    colorBufferId?:\n      | WebGLRenderbuffer\n      | Texture\n      | (WebGLRenderbuffer | Texture)[];\n    /** The depth buffer this target is rendering into */\n    depthBufferId?: WebGLRenderbuffer | Texture;\n    /** The stencil buffer this target is rendering into */\n    stencilBufferId?: WebGLRenderbuffer | Texture;\n    /** The managing GL proxy of this target */\n    proxy: GLProxy;\n  };\n\n  constructor(options: IRenderTargetOptions) {\n    this._buffers = {\n      color: Array.isArray(options.buffers.color)\n        ? options.buffers.color.slice(0)\n        : options.buffers.color,\n      depth: options.buffers.depth,\n      stencil: options.buffers.stencil\n    };\n    this._width = options.width || 0;\n    this._height = options.height || 0;\n    this.getDimensions();\n  }\n\n  /**\n   * Free all resources associated with this render target.\n   */\n  dispose() {\n    if (this.gl) {\n      this.gl.proxy.disposeRenderTarget(this);\n    }\n  }\n\n  /**\n   * This analyzes the buffers for Textures to infer the width and height. This\n   * also ensures all Texture objects are the same size to prevent errors.\n   */\n  private getDimensions() {\n    const textures: Texture[] = [];\n\n    if (this._buffers.color instanceof Texture) {\n      textures.push(this._buffers.color);\n    }\n\n    if (Array.isArray(this._buffers.color)) {\n      this._buffers.color.forEach(buffer => {\n        if (buffer instanceof Texture) {\n          textures.push(buffer);\n        }\n      });\n    }\n\n    if (this._buffers.depth instanceof Texture) {\n      textures.push(this._buffers.depth);\n    }\n\n    if (this._buffers.stencil instanceof Texture) {\n      textures.push(this._buffers.stencil);\n    }\n\n    if (textures.length > 0 && textures[0].data) {\n      const { width, height } = textures[0].data;\n\n      textures.forEach(texture => {\n        if (!texture.data) return;\n        const { width: checkWidth, height: checkHeight } = texture.data;\n\n        if (checkWidth !== width || checkHeight !== height) {\n          console.warn(\n            \"Texture applied to the render target is invalid as it does not match dimensions of all textures applied:\",\n            texture,\n            textures,\n            \"The texture will be removed as a target for the render target\"\n          );\n\n          this.removeTextureFromBuffer(texture);\n        }\n      });\n\n      this._width = width;\n      this._height = height;\n    } else if (!this._width || !this._height) {\n      console.warn(\n        \"A RenderTarget was not able to establish valid dimensions. This target had no texture buffers and did not specify valid width and height values.\",\n        this\n      );\n    }\n  }\n\n  /**\n   * Retrieves all of the textures associated with this render target\n   */\n  getTextures() {\n    const textures = [];\n\n    if (Array.isArray(this.buffers.color)) {\n      this.buffers.color.forEach(buffer => {\n        if (buffer instanceof Texture) {\n          textures.push(buffer);\n        }\n      });\n    } else {\n      if (this.buffers.color instanceof Texture) {\n        textures.push(this.buffers.color);\n      }\n    }\n\n    if (this.buffers.depth instanceof Texture) {\n      textures.push(this.buffers.depth);\n    }\n\n    if (this.buffers.stencil instanceof Texture) {\n      textures.push(this.buffers.stencil);\n    }\n\n    return textures;\n  }\n\n  /**\n   * Cleanses a texture from being used as a buffer\n   */\n  private removeTextureFromBuffer(texture: Texture) {\n    if (Array.isArray(this._buffers.color)) {\n      const index = this._buffers.color.indexOf(texture);\n      if (index > -1) this._buffers.color.splice(index, 1);\n    } else if (this._buffers.color === texture) {\n      delete this._buffers.color;\n    }\n\n    if (this._buffers.depth === texture) {\n      delete this._buffers.depth;\n    }\n\n    if (this._buffers.stencil === texture) {\n      delete this._buffers.stencil;\n    }\n  }\n\n  /**\n   * Changes the size of this render target. This is a VERY costly operation.\n   * It will delete all existing buffers associated with this target. Change the intended\n   * size of each buffer / texture, then cause the buffer / texture to get recreated with\n   * the new size settings.\n   *\n   * This operation clears any existing texture contents that may have existed.\n   */\n  setSize(width: number, height: number) {\n    // Delete all previous GL content\n    this.dispose();\n    // Set our new width and height desires\n    this._width = width;\n    this._height = height;\n    // Adjust all of the texture objects data to size properly\n    const textures = this.getTextures();\n\n    textures.forEach(texture => {\n      texture.data = {\n        buffer: null,\n        height,\n        width\n      };\n    });\n  }\n\n  /**\n   * Flags this render target as having a valid framebuffer for rendering.\n   */\n  setAsValid() {\n    this._validFramebuffer = true;\n  }\n}\n","import { TypeVec } from \"../types\";\nimport { compare4, copy4, flatten4, Vec4 } from \"../util\";\nimport { indexToTextureUnit, textureUnitToIndex } from \"./gl-decode\";\nimport { GLProxy } from \"./gl-proxy\";\nimport { GLSettings } from \"./gl-settings\";\nimport { Material } from \"./material\";\nimport { RenderTarget } from \"./render-target\";\nimport { Texture } from \"./texture\";\nimport {\n  IExtensions,\n  IMaterialUniform,\n  MaterialUniformType,\n  MaterialUniformValue\n} from \"./types\";\n\nconst debug = require(\"debug\")(\"performance\");\n\n/**\n * This class represents all of the current state and settings that the gl context is in currently. This\n * helps to decide when to make gl calls to alter the state and not do so unecessarily.\n *\n * This state focuses on global state settings like bound objects and gl settings. Other state\n * for the GL context is stored within objects that are generated, such as Texture and Attribute.\n */\nexport class GLState {\n  /** Message to include with debug, warns, and errors */\n  debugContext: string = \"\";\n  /** The extensions enabled for the context */\n  private extensions: IExtensions;\n  /** Stores the gl context this is watching the state over */\n  private gl: WebGLRenderingContext;\n  /** This is a proxy to execute commands that do not change global gl state */\n  private glProxy: GLProxy;\n  /** Lookup a texture unit to it's current assigned texture. */\n  private _textureUnitToTexture = new Map<number, Texture | null>();\n  /** This holds which texture units are free for use and have no Texture assigned to them */\n  private _freeUnits: number[] = [];\n\n  /** Indicates if blending is enabled */\n  get blendingEnabled() {\n    return this._blendingEnabled;\n  }\n  private _blendingEnabled = true;\n\n  /** The current destination factor used in the blending equation */\n  get blendDstFactor() {\n    return this._blendDstFactor;\n  }\n  private _blendDstFactor = GLSettings.Material.BlendingDstFactor.One;\n\n  /** The current destination factor used in the blending equation */\n  get blendSrcFactor() {\n    return this._blendSrcFactor;\n  }\n  private _blendSrcFactor:\n    | GLSettings.Material.BlendingSrcFactor\n    | GLSettings.Material.BlendingDstFactor = GLSettings.Material\n    .BlendingDstFactor.One;\n\n  /** The current equation used in the blend mode */\n  get blendEquation() {\n    return this._blendEquation;\n  }\n  private _blendEquation = GLSettings.Material.BlendingEquations.Add;\n\n  /** Indicates which faces will be culled */\n  get cullFace() {\n    return this._cullFace;\n  }\n  private _cullFace: GLSettings.Material.CullSide = GLSettings.Material.CullSide\n    .NONE;\n\n  /** The channels in the color buffer a fragment is allowed to write to */\n  get colorMask() {\n    return this._colorMask;\n  }\n  private _colorMask: TypeVec<boolean> = [true, true, true, true];\n\n  /** The current color the context will clear when clear with the color buffer bit is called */\n  get clearColor() {\n    return this._clearColor;\n  }\n  private _clearColor: Vec4 = [0.0, 0.0, 0.0, 1.0];\n\n  /** Comparator used when testing a fragment against the depth buffer */\n  get depthFunc() {\n    return this._depthFunc;\n  }\n  private _depthFunc = GLSettings.Material.DepthFunctions.ALWAYS;\n\n  /** Indicates if fragments are tested against the depth buffer or not */\n  get depthTestEnabled() {\n    return this._depthTestEnabled;\n  }\n  private _depthTestEnabled = true;\n\n  /** Indicates if the fragment will write to the depth buffer or not */\n  get depthMask() {\n    return this._depthMask;\n  }\n  private _depthMask = true;\n\n  /** Indicates if dithering is enabled */\n  get ditheringEnabled() {\n    return this._ditheringEnabled;\n  }\n  private _ditheringEnabled = true;\n\n  /** The currently bound frame buffer object. null if nothing bound. */\n  get boundFBO() {\n    return this._boundFBO;\n  }\n  private _boundFBO: WebGLFramebuffer | null = null;\n\n  /** The currently bound render buffer object. null if nothing bound. */\n  get boundRBO() {\n    return this._boundRBO;\n  }\n  private _boundRBO: WebGLRenderbuffer | null = null;\n\n  /** The current id of the current bound vbo. If null, nothing is bound */\n  get boundVBO() {\n    return this._boundVBO;\n  }\n  private _boundVBO: WebGLBuffer | null = null;\n\n  /**\n   * The current texture object bound. If null, nothing is bound. This also tracks\n   * the texture unit to which it was bound. The unit and the texture object must match for\n   * a binding call to be skipped.\n   */\n  get boundTexture() {\n    return this._boundTexture;\n  }\n  private _boundTexture: { id: WebGLTexture | null; unit: number } = {\n    id: null,\n    unit: -1\n  };\n\n  /** The current program in use */\n  get currentProgram() {\n    return this._currentProgram;\n  }\n  private _currentProgram: WebGLProgram | null = null;\n\n  /** Indicates if the scissor test is enabled in the context */\n  get scissorTestEnabled() {\n    return this._scissorTestEnabled;\n  }\n  private _scissorTestEnabled: boolean = false;\n\n  /** The current bounds of the scissor test */\n  get scissorBounds() {\n    return this._scissorBounds;\n  }\n  private _scissorBounds = { x: 0, y: 0, width: 1, height: 1 };\n\n  /** These are the current uniforms uploaded to the GPU */\n  get currentUniforms() {\n    return this._currentUniforms;\n  }\n  private _currentUniforms: {\n    [name: string]: IMaterialUniform<MaterialUniformType>;\n  };\n\n  /** This is the texture unit currently active */\n  get activeTextureUnit() {\n    return this._activeTextureUnit;\n  }\n  private _activeTextureUnit: number = -1;\n\n  /**\n   * This contains all of the textures that are are needing to be utilized for next draw.\n   * Textures are used by either uniforms or by RenderTargets in a single draw call. Thus\n   * we track the uniforms or the render targets awaiting use of the texture.\n   */\n  get textureWillBeUsed() {\n    return this._textureWillBeUsed;\n  }\n  private _textureWillBeUsed = new Map<\n    Texture,\n    Set<WebGLUniformLocation> | RenderTarget\n  >();\n\n  /** The current viewport gl is using */\n  get viewport() {\n    return this._viewport;\n  }\n  private _viewport = { x: 0, y: 0, width: 100, height: 100 };\n\n  /** This contains all of the currently enabled vertex attribute pointers */\n  get enabledVertexAttributeArray() {\n    return this._enabledVertexAttributeArray\n      .slice(0)\n      .filter(n => n !== undefined);\n  }\n  private _enabledVertexAttributeArray: number[] = [];\n  private _willUseVertexAttributeArray: number[] = [];\n\n  /** Tracks the current divisor set to a given vertex array location. */\n  private _vertexAttributeArrayDivisor = new Map<number, number>();\n\n  /**\n   * Generate a new state manager and establish some initial state settings by querying the context.\n   */\n  constructor(gl: WebGLRenderingContext, extensions: IExtensions) {\n    this.gl = gl;\n    this.extensions = extensions;\n    // Retrieve how many units are allowed at the same time to be assiged so we can initialize our free units array\n    const totalUnits = this.gl.getParameter(\n      gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS\n    );\n\n    for (let i = 0; i < totalUnits; ++i) {\n      this._freeUnits.push(indexToTextureUnit(gl, i));\n    }\n\n    // Initialize state to valid value\n    this._activeTextureUnit = gl.TEXTURE0;\n  }\n\n  /**\n   * Sets the provided buffer identifier as the current bound item.\n   */\n  bindVBO(id: WebGLBuffer | null) {\n    if (this._boundVBO !== id) {\n      this._boundVBO = id;\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, id);\n    }\n  }\n\n  /**\n   * Sets the provided buffer identifier as the current bound item\n   */\n  bindRBO(id: WebGLRenderbuffer) {\n    if (this._boundRBO !== id) {\n      this._boundRBO = id;\n      this.gl.bindRenderbuffer(this.gl.RENDERBUFFER, id);\n    }\n  }\n\n  /**\n   * Sets the provided buffer identifier as the current bound item\n   */\n  bindFBO(id: WebGLFramebuffer | null) {\n    if (this._boundFBO !== id) {\n      this._boundFBO = id;\n      this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, id);\n    }\n  }\n\n  /**\n   * Sets the provided buffer identifier as the current bound item. This automatically\n   * updates all stateful information to track that a texture is now utilizing a texture unit.\n   */\n  bindTexture(\n    texture: Texture,\n    target: GLSettings.Texture.TextureBindingTarget\n  ) {\n    if (!texture.gl || !texture.gl.textureId) return;\n\n    if (\n      !texture ||\n      this._boundTexture.id !== texture.gl.textureId ||\n      this._boundTexture.unit !== this._activeTextureUnit\n    ) {\n      this._boundTexture = {\n        id: texture.gl.textureId,\n        unit: this._activeTextureUnit\n      };\n\n      switch (target) {\n        case GLSettings.Texture.TextureBindingTarget.TEXTURE_2D:\n          this.gl.bindTexture(this.gl.TEXTURE_2D, texture.gl.textureId);\n          break;\n\n        case GLSettings.Texture.TextureBindingTarget.TEXTURE_2D:\n          this.gl.bindTexture(this.gl.TEXTURE_CUBE_MAP, texture.gl.textureId);\n          break;\n      }\n\n      // Since the binding happened, we HAVE to track that this texture is now the texture\n      // for the current active unit. We must also remove the unit from any texture previously\n      // utilizing the unit\n      const previous = this._textureUnitToTexture.get(this._activeTextureUnit);\n\n      if (previous) {\n        if (previous.gl) previous.gl.textureUnit = -1;\n      }\n\n      this._textureUnitToTexture.set(this._activeTextureUnit, texture);\n      texture.gl.textureUnit = this._activeTextureUnit;\n    }\n  }\n\n  /**\n   * Flags an attribute array as going to be used. Any attribute array location\n   * no longer in use will be disabled when applyVertexAttributeArrays is called.\n   */\n  willUseVertexAttributeArray(index: number) {\n    // Flag the index as will be used\n    this._willUseVertexAttributeArray[index] = index;\n    // If already enabled we're done\n    if (this._enabledVertexAttributeArray[index] !== undefined) return;\n    // Flag the index as enabled\n    this._enabledVertexAttributeArray[index] = index;\n    // Otherwise, get this location enabled right away\n    this.gl.enableVertexAttribArray(index);\n  }\n\n  /**\n   * This enables the necessary vertex attribute arrays.\n   */\n  applyVertexAttributeArrays() {\n    // All locations that should be enabled are now enabled\n    // Disable any locations that will not be used\n    for (\n      let i = 0, iMax = this._enabledVertexAttributeArray.length;\n      i < iMax;\n      ++i\n    ) {\n      const index = this._enabledVertexAttributeArray[i];\n\n      if (index !== undefined) {\n        if (this._willUseVertexAttributeArray[index] !== undefined) return;\n        this.gl.disableVertexAttribArray(index);\n        delete this._enabledVertexAttributeArray[index];\n      }\n    }\n\n    // Reset the use array for next draw\n    this._willUseVertexAttributeArray = [];\n  }\n\n  /**\n   * Applies (if necessary) the divisor for a given array. This only works if the array location\n   * is enabled.\n   */\n  setVertexAttributeArrayDivisor(index: number, divisor: number) {\n    if (!this.extensions.instancing) return;\n\n    if (this._enabledVertexAttributeArray[index] !== undefined) {\n      if (this._vertexAttributeArrayDivisor.get(index) !== divisor) {\n        if (this.extensions.instancing instanceof WebGL2RenderingContext) {\n          this.extensions.instancing.vertexAttribDivisor(index, divisor);\n        } else {\n          this.extensions.instancing.vertexAttribDivisorANGLE(index, divisor);\n        }\n\n        this._vertexAttributeArrayDivisor.set(index, divisor);\n      }\n    }\n  }\n\n  /**\n   * This takes a texture and flags it's texture unit as freed if the texture has a used unit\n   */\n  freeTextureUnit(texture: Texture) {\n    if (texture.gl) {\n      if (texture.gl.textureUnit > -1) {\n        this._freeUnits.unshift(texture.gl.textureUnit);\n        texture.gl.textureUnit = -1;\n      }\n    }\n  }\n\n  /**\n   * Changes the active texture unit to the provided unit.\n   */\n  setActiveTextureUnit(unit: number) {\n    if (this._activeTextureUnit !== unit) {\n      this._activeTextureUnit = unit;\n      this.gl.activeTexture(unit);\n    }\n  }\n\n  /**\n   * Changes the gl clear color state\n   */\n  setClearColor(color: Vec4) {\n    if (!compare4(color, this._clearColor)) {\n      this._clearColor = copy4(color);\n      this.applyClearColor();\n    }\n  }\n\n  /**\n   * Sets the GPU proxy to be used to handle commands that call to the GPU but don't alter\n   * global GL state.\n   */\n  setProxy(proxy: GLProxy) {\n    this.glProxy = proxy;\n  }\n\n  /**\n   * Enables or disables the scissor test\n   */\n  setScissor(\n    bounds: { x: number; y: number; width: number; height: number } | null\n  ) {\n    if (bounds) {\n      if (!this._scissorTestEnabled) {\n        this._scissorTestEnabled = true;\n        this.gl.enable(this.gl.SCISSOR_TEST);\n      }\n\n      if (\n        bounds.x !== this._scissorBounds.x ||\n        bounds.y !== this._scissorBounds.y ||\n        bounds.width !== this._scissorBounds.width ||\n        bounds.height !== this._scissorBounds.height\n      ) {\n        this._scissorBounds = bounds;\n        this.applyScissorBounds();\n      }\n    } else {\n      if (this._scissorTestEnabled) {\n        this._scissorTestEnabled = false;\n        this.gl.disable(this.gl.SCISSOR_TEST);\n      }\n    }\n  }\n\n  /**\n   * Applies a viewport to the given state\n   */\n  setViewport(x: number, y: number, width: number, height: number) {\n    if (\n      x !== this._viewport.x ||\n      y !== this._viewport.y ||\n      width !== this._viewport.width ||\n      height !== this._viewport.height\n    ) {\n      this._viewport = { x, y, width, height };\n      this.applyViewport();\n    }\n  }\n\n  /**\n   * Uses the program indicated\n   */\n  useProgram(program: WebGLProgram) {\n    if (this._currentProgram !== program) {\n      this._currentProgram = program;\n      this.gl.useProgram(this._currentProgram);\n    }\n  }\n\n  /**\n   * Sets all current gl state to match the materials settings.\n   */\n  useMaterial(material: Material) {\n    // Make sure the material is compiled\n    if (!material.gl) {\n      if (!this.glProxy.compileMaterial(material)) {\n        return false;\n      }\n\n      if (!material.gl) {\n        return false;\n      }\n    }\n\n    if (!material.gl.programId) {\n      return false;\n    }\n\n    // Use the material's program\n    this.useProgram(material.gl.programId);\n    // Synchronize the material's settings to the gl state\n    this.syncMaterial(material);\n\n    return true;\n  }\n\n  /**\n   * Sets all current gl state to match the render target specified\n   */\n  useRenderTarget(target: RenderTarget | null) {\n    if (!target) {\n      this.bindFBO(null);\n      return true;\n    }\n\n    // The gl context must be specified for the target in order to use it\n    if (!target.gl) return false;\n    // Bind the FBO of the target as the current item we are rendering into\n    this.bindFBO(target.gl.fboId);\n\n    return true;\n  }\n\n  /**\n   * This syncs the state of the GL context with the requested state of a material\n   */\n  syncMaterial(material: Material) {\n    const gl = this.gl;\n    const depthWrite = Boolean(material.depthWrite);\n\n    // Depth mode changes\n    if (this._depthMask !== depthWrite) {\n      this._depthMask = depthWrite;\n      gl.depthMask(this._depthMask);\n    }\n\n    if (this._depthTestEnabled !== material.depthTest) {\n      this._depthTestEnabled = material.depthTest;\n      this._depthTestEnabled\n        ? gl.enable(gl.DEPTH_TEST)\n        : gl.disable(gl.DEPTH_TEST);\n    }\n\n    if (this._depthFunc !== material.depthFunc) {\n      this._depthFunc = material.depthFunc;\n      this.applyDepthFunc();\n    }\n\n    // Blending changes\n    if (material.blending) {\n      if (!this._blendingEnabled) {\n        gl.enable(gl.BLEND);\n      }\n\n      if (\n        this._blendDstFactor !== material.blending.blendDst ||\n        this._blendSrcFactor !== material.blending.blendSrc ||\n        this._blendEquation !== material.blending.blendEquation\n      ) {\n        this._blendDstFactor =\n          material.blending.blendDst || this._blendDstFactor;\n        this._blendSrcFactor =\n          material.blending.blendSrc || this._blendSrcFactor;\n        this._blendEquation =\n          material.blending.blendEquation || this._blendEquation;\n        this.applyBlendFactors();\n      }\n    } else {\n      if (this._blendingEnabled) {\n        gl.disable(gl.BLEND);\n      }\n    }\n\n    // Cull mode\n    if (this._cullFace !== material.culling) {\n      this._cullFace = material.culling;\n      this.applyCullFace();\n    }\n\n    // Color mode\n    if (\n      this._colorMask[0] !== material.colorWrite[0] ||\n      this._colorMask[1] !== material.colorWrite[1] ||\n      this._colorMask[2] !== material.colorWrite[2] ||\n      this._colorMask[3] !== material.colorWrite[3]\n    ) {\n      this._colorMask = material.colorWrite;\n      this.applyColorMask();\n    }\n\n    // Dithering\n    if (this._ditheringEnabled !== material.dithering) {\n      this._ditheringEnabled = material.dithering;\n      this._ditheringEnabled ? gl.enable(gl.DITHER) : gl.disable(gl.DITHER);\n    }\n\n    // Uniforms\n    this._currentUniforms = material.uniforms;\n    let success = true;\n\n    if (!this._currentProgram) {\n      return false;\n    }\n\n    // Now we can update and retrieve the locations for each uniform in the program\n    Object.entries(material.uniforms).forEach(([name, uniform]) => {\n      if (!this._currentProgram) return;\n      if (!uniform.gl) uniform.gl = new Map();\n      let glSettings = uniform.gl.get(this._currentProgram);\n\n      // If no settings for the given program are present, then we must\n      // query the program for the uniform's locations and what not.\n      if (!glSettings) {\n        const location = this.gl.getUniformLocation(this._currentProgram, name);\n\n        if (!location) {\n          console.warn(\n            this.debugContext,\n            `A Material specified a uniform ${name}, but none was found in the current program.`\n          );\n          success = false;\n          return;\n        }\n\n        glSettings = {\n          location\n        };\n\n        // Store the found location for the uniform\n        uniform.gl.set(this._currentProgram, glSettings);\n      }\n\n      // After locations for the uniforms are established, we must now copy the uniform\n      // info into the GPU\n      this.uploadUniform(glSettings.location, uniform);\n    });\n\n    if (!success) {\n      console.warn(material.vertexShader);\n      console.warn(material.fragmentShader);\n      return false;\n    }\n\n    // Textures\n    if (this._textureWillBeUsed.size > 0) {\n      if (!this.applyUsedTextures()) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   * Performs the upload operation of a uniform to the GL context\n   */\n  private uploadUniform(\n    location: WebGLUniformLocation,\n    uniform: IMaterialUniform<MaterialUniformType>\n  ) {\n    let v;\n\n    switch (uniform.type) {\n      case MaterialUniformType.FLOAT:\n        v = uniform.value as MaterialUniformValue<MaterialUniformType.FLOAT>;\n        this.gl.uniform1f(location, v);\n        break;\n\n      case MaterialUniformType.VEC2:\n        v = uniform.value as MaterialUniformValue<MaterialUniformType.VEC2>;\n        this.gl.uniform2f(location, v[0], v[1]);\n        break;\n\n      case MaterialUniformType.VEC3:\n        v = uniform.value as MaterialUniformValue<MaterialUniformType.VEC3>;\n        this.gl.uniform3f(location, v[0], v[1], v[2]);\n        break;\n\n      case MaterialUniformType.VEC4:\n        v = uniform.value as MaterialUniformValue<MaterialUniformType.VEC4>;\n        this.gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n        break;\n\n      case MaterialUniformType.VEC4_ARRAY:\n        v = uniform.value as MaterialUniformValue<\n          MaterialUniformType.VEC4_ARRAY\n        >;\n        this.gl.uniform4fv(location, flatten4(v));\n        break;\n\n      case MaterialUniformType.MATRIX3x3:\n        v = uniform.value as MaterialUniformValue<\n          MaterialUniformType.MATRIX3x3\n        >;\n        this.gl.uniformMatrix3fv(location, false, v);\n        break;\n\n      case MaterialUniformType.MATRIX4x4:\n        v = uniform.value as MaterialUniformValue<\n          MaterialUniformType.MATRIX4x4\n        >;\n        this.gl.uniformMatrix4fv(location, false, v);\n        break;\n\n      case MaterialUniformType.TEXTURE:\n        v = uniform.value as MaterialUniformValue<MaterialUniformType.TEXTURE>;\n        this.willUseTextureUnit(v, location);\n        break;\n\n      default:\n        console.warn(\n          this.debugContext,\n          \"A uniform specified an unrecognized type. It will not sync with the GPU:\",\n          uniform\n        );\n    }\n  }\n\n  /**\n   * This will consume the values aggregated within willUseTextureUnit. All Texture objects\n   * consumed will be assigned an active texture unit (if one was not already applied), then\n   * the Texture will be compiled / updated as necessary and applied to all uniforms requiring\n   * a Sampler unit.\n   */\n  applyUsedTextures() {\n    // Assign texture units to the textures that will be used\n    const failedTextures = this.assignTextureUnits(\n      Array.from(this._textureWillBeUsed.keys())\n    );\n\n    // We apply the default unit to each texture that failed. Output will be made from the\n    // previous method, so at this point, let's just try to make lemonade out of lemons (set\n    // sane defaults)\n    failedTextures.forEach(texture => {\n      if (texture.gl) {\n        texture.gl.textureUnit = this.gl.TEXTURE0;\n      } else {\n        texture.gl = {\n          textureId: null,\n          textureUnit: this.gl.TEXTURE0,\n          proxy: this.glProxy\n        };\n      }\n    });\n\n    // Let's sort out which textures are affiliated with a RenderTarget or with a uniform set.\n    const textureToUniforms = new Map<Texture, Set<WebGLUniformLocation>>();\n    const renderTargets = new Set<RenderTarget>();\n\n    this._textureWillBeUsed.forEach((targets, texture) => {\n      if (targets instanceof RenderTarget) {\n        renderTargets.add(targets);\n      } else {\n        textureToUniforms.set(texture, targets);\n      }\n    });\n\n    // Now our list of render targets is guaranteed to have their textures set with an active texture unit,\n    // so we can now officially ensure the render target is compiled.\n    renderTargets.forEach(target => {\n      const textures = target.getTextures();\n      const failed = textures.some(texture => {\n        // Only compile and process successful texture units\n        if (failedTextures.indexOf(texture) < 0) {\n          this.glProxy.updateTexture(texture);\n        } else return true;\n\n        return false;\n      });\n\n      if (!failed) {\n        this.glProxy.compileRenderTarget(target);\n      } else {\n        console.warn(\n          this.debugContext,\n          \"A RenderTarget can not be used because all of it's textures could not be compiled.\"\n        );\n      }\n    });\n\n    // Now that all of our textures have units, we loop through each texture and have them\n    // compiled and/or updated then upload the unit to the appropriate uniforms indicated.\n    textureToUniforms.forEach((uniforms, texture) => {\n      // Only compile and process successful texture units\n      if (failedTextures.indexOf(texture) < 0) {\n        this.glProxy.updateTexture(texture);\n\n        uniforms.forEach(uniform => {\n          this.uploadTextureToUniform(uniform, texture);\n        });\n      }\n\n      // Failed textures get their uniforms filled with the default 0 texture unit\n      else {\n        uniforms.forEach(uniform => {\n          this.gl.uniform1i(uniform, textureUnitToIndex(this.gl, 0));\n        });\n      }\n    });\n\n    // We used the textures! This is no longer needed\n    this._textureWillBeUsed.clear();\n\n    return true;\n  }\n\n  /**\n   * Attempts to assign free or freed texture units to the provided texture objects.\n   * This will return a list of textures\n   */\n  private assignTextureUnits(textures: Texture[]) {\n    const needsUnit: Texture[] = [];\n    const hasUnit: Texture[] = [];\n\n    // First establish all textures that need a unit\n    textures.forEach(texture => {\n      if (!texture.gl || texture.gl.textureUnit < 0) {\n        needsUnit.push(texture);\n      } else {\n        hasUnit.push(texture);\n      }\n    });\n\n    // We now first see if we have free units to statisfy the needs\n    while (this._freeUnits.length > 0 && needsUnit.length > 0) {\n      const texture = needsUnit.shift();\n      if (!texture) continue;\n\n      const freeUnit = this._freeUnits.shift();\n\n      if (freeUnit === undefined) {\n        needsUnit.unshift(texture);\n        continue;\n      }\n\n      if (!texture.gl) {\n        texture.gl = {\n          textureId: null,\n          textureUnit: freeUnit,\n          proxy: this.glProxy\n        };\n      } else {\n        texture.gl.textureUnit = freeUnit;\n      }\n\n      hasUnit.push(texture);\n    }\n\n    // If nothing needs a unit still, then we can just exit now\n    if (needsUnit.length <= 0) {\n      return needsUnit;\n    }\n\n    // We now get any remaining texture that still needs a unit. We will claim the unit\n    // of a texture using a unit but is NOT going to be used for the next call.\n    // If there are no units available in this manner, then we are officially using too many\n    // textures for the next draw call.\n    debug(\n      \"WARNING: Too many textures in use are causing texture units to be swapped. Doing this occasionally is fine, but handling this on a frame loop can have serious performance concerns.\"\n    );\n\n    // Get a list of texture units in use but are not required for next draw call\n    const inUse = new Map<Texture, boolean>();\n\n    this._textureUnitToTexture.forEach(texture => {\n      if (texture) {\n        inUse.set(texture, false);\n      }\n    });\n\n    hasUnit.forEach(texture => {\n      inUse.set(texture, true);\n    });\n\n    const canGiveUpUnit: Texture[] = [];\n\n    inUse.forEach((isUsed, texture) => {\n      if (!isUsed) canGiveUpUnit.push(texture);\n    });\n\n    // We should now have all textures able to give up their unit for the next draw call\n    if (canGiveUpUnit.length === 0) {\n      console.warn(\n        this.debugContext,\n        \"There are too many textures being used for a single draw call. These textures will not be utilized on the GPU\",\n        needsUnit\n      );\n      return needsUnit;\n    }\n\n    while (canGiveUpUnit.length > 0 && needsUnit.length > 0) {\n      const texture = needsUnit.shift();\n      if (!texture) continue;\n\n      const freeUnit = canGiveUpUnit.shift();\n\n      if (\n        freeUnit === undefined ||\n        !freeUnit.gl ||\n        freeUnit.gl.textureUnit < 0\n      ) {\n        needsUnit.unshift(texture);\n        continue;\n      }\n\n      if (!texture.gl) {\n        texture.gl = {\n          textureId: null,\n          textureUnit: freeUnit.gl.textureUnit,\n          proxy: this.glProxy\n        };\n      } else {\n        texture.gl.textureUnit = freeUnit.gl.textureUnit;\n      }\n\n      hasUnit.push(texture);\n    }\n\n    // If by some voodoo we still have not provided a unit for a texture needing it, then we have a problem\n    if (needsUnit.length > 0) {\n      console.warn(\n        this.debugContext,\n        \"There are too many textures being used for a single draw call. These textures will not be utilized on the GPU\",\n        needsUnit\n      );\n    }\n\n    return needsUnit;\n  }\n\n  /**\n   * Applies the necessary value for a texture to be applied to a sampler uniform.\n   */\n  private uploadTextureToUniform(\n    location: WebGLUniformLocation,\n    texture: Texture\n  ) {\n    if (texture.gl && texture.gl.textureUnit >= 0) {\n      this.gl.uniform1i(\n        location,\n        textureUnitToIndex(this.gl, texture.gl.textureUnit)\n      );\n    } else {\n      console.warn(\n        this.debugContext,\n        \"Attempted to set a Texture Object to a uniform, but the Texture object did not have a valid texture unit.\",\n        texture\n      );\n    }\n  }\n\n  /**\n   * This flags a texture as going to be used within the next upcoming draw call\n   */\n  willUseTextureUnit(\n    texture: Texture,\n    target: WebGLUniformLocation | RenderTarget\n  ) {\n    const uniforms = this._textureWillBeUsed.get(texture);\n\n    if (target instanceof RenderTarget) {\n      if (!uniforms) {\n        this._textureWillBeUsed.set(texture, target);\n      } else if (uniforms instanceof RenderTarget) {\n        if (uniforms !== target) {\n          console.warn(\n            this.debugContext,\n            \"A Texture is attempting to be used by two different render targets in a single draw.\"\n          );\n        }\n      }\n    } else {\n      if (!uniforms) {\n        this._textureWillBeUsed.set(texture, new Set([target]));\n      } else {\n        if (uniforms instanceof RenderTarget) {\n          console.warn(\n            this.debugContext,\n            \"A texture in a single draw is attempting to attach to a uniform AND a render target which is invalid.\"\n          );\n        } else {\n          uniforms.add(target);\n        }\n      }\n    }\n  }\n\n  /**\n   * This method applies ALL of the state elements monitored and force sets them with WebGL calls\n   * to make sure the GPU is in the same state as this state object.\n   */\n  syncState() {\n    const gl = this.gl;\n\n    this._blendingEnabled ? gl.enable(gl.BLEND) : gl.disable(gl.BLEND);\n    this._ditheringEnabled ? gl.enable(gl.DITHER) : gl.disable(gl.DITHER);\n    this._depthTestEnabled\n      ? gl.enable(gl.DEPTH_TEST)\n      : gl.disable(gl.DEPTH_TEST);\n    this._scissorTestEnabled\n      ? gl.enable(gl.SCISSOR_TEST)\n      : gl.disable(gl.SCISSOR_TEST);\n    this.setActiveTextureUnit(this._activeTextureUnit);\n    this.applyClearColor();\n    this.applyCullFace();\n    this.applyBlendFactors();\n    this.applyBlendEquation();\n    this.applyColorMask();\n    this.applyDepthFunc();\n    this.applyScissorBounds();\n    this.applyViewport();\n    gl.depthMask(this._depthMask);\n  }\n\n  /**\n   * Applies the current clearColor to the gl state\n   */\n  private applyClearColor() {\n    const gl = this.gl;\n\n    gl.clearColor(\n      this._clearColor[0],\n      this._clearColor[1],\n      this._clearColor[2],\n      this._clearColor[3]\n    );\n  }\n\n  /**\n   * Applies the current depth function to the gl state\n   */\n  private applyDepthFunc() {\n    const gl = this.gl;\n\n    switch (this._depthFunc) {\n      case GLSettings.Material.DepthFunctions.ALWAYS:\n        gl.depthFunc(gl.ALWAYS);\n        break;\n      case GLSettings.Material.DepthFunctions.EQUAL:\n        gl.depthFunc(gl.EQUAL);\n        break;\n      case GLSettings.Material.DepthFunctions.GREATER:\n        gl.depthFunc(gl.GREATER);\n        break;\n      case GLSettings.Material.DepthFunctions.GREATER_OR_EQUAL:\n        gl.depthFunc(gl.GEQUAL);\n        break;\n      case GLSettings.Material.DepthFunctions.LESS:\n        gl.depthFunc(gl.LESS);\n        break;\n      case GLSettings.Material.DepthFunctions.LESS_OR_EQUAL:\n        gl.depthFunc(gl.LEQUAL);\n        break;\n      case GLSettings.Material.DepthFunctions.NEVER:\n        gl.depthFunc(gl.NEVER);\n        break;\n      case GLSettings.Material.DepthFunctions.NOTEQUAL:\n        gl.depthFunc(gl.NOTEQUAL);\n        break;\n\n      default:\n        gl.depthFunc(gl.ALWAYS);\n        break;\n    }\n  }\n\n  /**\n   * Applies the current scissor bounds to the gl state\n   */\n  private applyScissorBounds() {\n    this.gl.scissor(\n      this._scissorBounds.x,\n      this._scissorBounds.y,\n      this._scissorBounds.width,\n      this._scissorBounds.height\n    );\n  }\n\n  /**\n   * Applies the writing mask to the color buffer to the gl state.\n   */\n  private applyColorMask() {\n    this.gl.colorMask(\n      this.colorMask[0] || false,\n      this.colorMask[1] || false,\n      this.colorMask[2] || false,\n      this.colorMask[3] || false\n    );\n  }\n\n  /**\n   * Applies the blending equations to the gl state\n   */\n  private applyBlendEquation() {\n    const gl = this.gl;\n\n    switch (this._blendEquation) {\n      case GLSettings.Material.BlendingEquations.Add:\n        gl.blendEquation(gl.FUNC_ADD);\n        break;\n      case GLSettings.Material.BlendingEquations.Subtract:\n        gl.blendEquation(gl.FUNC_SUBTRACT);\n        break;\n      case GLSettings.Material.BlendingEquations.ReverseSubtract:\n        gl.blendEquation(gl.FUNC_REVERSE_SUBTRACT);\n        break;\n      // case GLSettings.Material.BlendingEquations.Min: /** Requires extension for Webgl 1 */ break;\n      // case GLSettings.Material.BlendingEquations.Max: /** Requires extension for Webgl 1 */ break;\n    }\n  }\n\n  /**\n   * Applies the blending factors to the gl state\n   */\n  private applyBlendFactors() {\n    const gl = this.gl;\n    let dst, src;\n\n    switch (this._blendDstFactor) {\n      case GLSettings.Material.BlendingDstFactor.DstAlpha:\n        dst = gl.BLEND_DST_ALPHA;\n        break;\n      case GLSettings.Material.BlendingDstFactor.DstColor:\n        dst = gl.BLEND_DST_RGB;\n        break;\n      case GLSettings.Material.BlendingDstFactor.One:\n        dst = gl.ONE;\n        break;\n      case GLSettings.Material.BlendingDstFactor.OneMinusDstAlpha:\n        dst = gl.ONE_MINUS_DST_ALPHA;\n        break;\n      case GLSettings.Material.BlendingDstFactor.OneMinusDstColor:\n        dst = gl.ONE_MINUS_DST_COLOR;\n        break;\n      case GLSettings.Material.BlendingDstFactor.OneMinusSrcAlpha:\n        dst = gl.ONE_MINUS_SRC_ALPHA;\n        break;\n      case GLSettings.Material.BlendingDstFactor.OneMinusSrcColor:\n        dst = gl.ONE_MINUS_SRC_COLOR;\n        break;\n      case GLSettings.Material.BlendingDstFactor.SrcAlpha:\n        dst = gl.SRC_ALPHA;\n        break;\n      case GLSettings.Material.BlendingDstFactor.SrcColor:\n        dst = gl.SRC_COLOR;\n        break;\n      case GLSettings.Material.BlendingDstFactor.Zero:\n        dst = gl.ZERO;\n        break;\n\n      default:\n        dst = gl.ONE;\n        break;\n    }\n\n    switch (this._blendSrcFactor) {\n      case GLSettings.Material.BlendingDstFactor.DstAlpha:\n        src = gl.BLEND_DST_ALPHA;\n        break;\n      case GLSettings.Material.BlendingDstFactor.DstColor:\n        src = gl.BLEND_DST_RGB;\n        break;\n      case GLSettings.Material.BlendingDstFactor.One:\n        src = gl.ONE;\n        break;\n      case GLSettings.Material.BlendingDstFactor.OneMinusDstAlpha:\n        src = gl.ONE_MINUS_DST_ALPHA;\n        break;\n      case GLSettings.Material.BlendingDstFactor.OneMinusDstColor:\n        src = gl.ONE_MINUS_DST_COLOR;\n        break;\n      case GLSettings.Material.BlendingDstFactor.OneMinusSrcAlpha:\n        src = gl.ONE_MINUS_SRC_ALPHA;\n        break;\n      case GLSettings.Material.BlendingDstFactor.OneMinusSrcColor:\n        src = gl.ONE_MINUS_SRC_COLOR;\n        break;\n      case GLSettings.Material.BlendingDstFactor.SrcAlpha:\n        src = gl.SRC_ALPHA;\n        break;\n      case GLSettings.Material.BlendingDstFactor.SrcColor:\n        src = gl.SRC_COLOR;\n        break;\n      case GLSettings.Material.BlendingDstFactor.Zero:\n        src = gl.ZERO;\n        break;\n      case GLSettings.Material.BlendingSrcFactor.SrcAlphaSaturate:\n        src = gl.SRC_ALPHA_SATURATE;\n        break;\n\n      default:\n        src = gl.ONE;\n        break;\n    }\n\n    gl.blendFunc(src, dst);\n  }\n\n  /**\n   * Applies the cull face property to the gl state\n   */\n  private applyCullFace() {\n    const gl = this.gl;\n\n    if (this._cullFace !== GLSettings.Material.CullSide.NONE) {\n      gl.enable(gl.CULL_FACE);\n    }\n\n    switch (this._cullFace) {\n      case GLSettings.Material.CullSide.CW:\n        gl.frontFace(gl.CW);\n        gl.cullFace(gl.FRONT);\n        break;\n      case GLSettings.Material.CullSide.CCW:\n        gl.frontFace(gl.CCW);\n        gl.cullFace(gl.FRONT);\n        break;\n      case GLSettings.Material.CullSide.BOTH:\n        gl.frontFace(gl.CW);\n        gl.cullFace(gl.FRONT_AND_BACK);\n        break;\n\n      default:\n        gl.disable(gl.CULL_FACE);\n    }\n  }\n\n  /**\n   * This applies the current viewport property to the gl context\n   */\n  private applyViewport() {\n    this.gl.viewport(\n      this._viewport.x,\n      this._viewport.y,\n      this._viewport.width,\n      this._viewport.height\n    );\n  }\n}\n","import { Attribute } from \"./attribute\";\nimport { Geometry } from \"./geometry\";\nimport {\n  colorBufferFormat,\n  depthBufferFormat,\n  drawMode,\n  indexToColorAttachment,\n  inputImageFormat,\n  magFilter,\n  minFilter,\n  stencilBufferFormat,\n  texelFormat,\n  wrapMode\n} from \"./gl-decode\";\nimport { GLSettings } from \"./gl-settings\";\nimport { GLState } from \"./gl-state\";\nimport { Material } from \"./material\";\nimport { Model } from \"./model\";\nimport { RenderTarget } from \"./render-target\";\nimport { Texture } from \"./texture\";\nimport { GLContext, IExtensions } from \"./types\";\n\nconst debug = require(\"debug\")(\"performance\");\n\n/**\n * Type guard to see if a textire object's data is a buffer.\n */\nfunction isDataBuffer(\n  val: any\n): val is { width: number; height: number; buffer: ArrayBufferView | null } {\n  return (\n    (val &&\n      val.buffer &&\n      val.buffer.byteOffset !== undefined &&\n      val.buffer.byteLength) ||\n    val.buffer === null\n  );\n}\n\n/**\n * Tests if a value is a power of 2\n */\nfunction isPowerOf2(val: number) {\n  return (val & (val - 1)) === 0;\n}\n\n/**\n * This determines if a texture object is ready for use meaning\n * it's compiled and has a current active texture unit.\n */\nfunction isTextureReady(\n  texture: Texture\n): texture is Texture & {\n  gl: { textureId: WebGLTexture; textureUnit: number };\n} {\n  return Boolean(\n    texture.gl && texture.gl.textureId && texture.gl.textureUnit > -1\n  );\n}\n\n/**\n * This is where all objects go to be processed and updated with webgl calls. Such as textures, geometries, etc\n */\nexport class GLProxy {\n  /** Message to include with debugging statements, warnings and errors */\n  debugContext: string = \"\";\n  /** This is the gl context we're manipulating. */\n  gl: GLContext;\n  /** This is the state tracker of the GL context */\n  state: GLState;\n  /** These are the extensions established for the context */\n  extensions: IExtensions;\n\n  /**\n   * Store all of the compiled shaders based on the string text of the\n   * shader so we never duplicate a shader program.\n   */\n  private fragmentShaders = new Map<string, WebGLShader>();\n  /**\n   * Store all of the compiled shaders based on the string text of the\n   * shader so we never duplicate a shader program.\n   */\n  private vertexShaders = new Map<string, WebGLShader>();\n  /**\n   * Make a look up for existing programs based on shader objects.\n   */\n  private programs = new Map<\n    WebGLShader,\n    Map<WebGLShader, { useCount: number; program: WebGLProgram }>\n  >();\n\n  constructor(gl: GLContext, state: GLState, extensions: IExtensions) {\n    this.gl = gl;\n    this.state = state;\n    this.extensions = extensions;\n  }\n\n  /**\n   * This enables the desired and supported extensions this framework utilizes.\n   */\n  static addExtensions(gl: GLContext): IExtensions {\n    const instancing = gl.getExtension(\"ANGLE_instanced_arrays\");\n    const drawBuffers = gl.getExtension(\"WEBGL_draw_buffers\");\n    const anisotropicFiltering = gl.getExtension(\n      \"EXT_texture_filter_anisotropic\"\n    );\n\n    const anisotropicStats = {\n      maxAnistropicFilter: 0\n    };\n\n    // This exists as an extension or as a webgl2 context\n    if (!instancing && !(gl instanceof WebGL2RenderingContext)) {\n      debug(\n        \"This device does not have hardware instancing. All buffering strategies will be utilizing compatibility modes.\"\n      );\n    }\n\n    // This exists as an extension or as a webgl2 context\n    if (!drawBuffers && !(gl instanceof WebGL2RenderingContext)) {\n      debug(\n        \"This device does not have hardware multi-render target capabilities. The system will have to fallback to multiple render passes to multiple FBOs to achieve the same result.\"\n      );\n    }\n\n    // This only exists as an extension\n    if (!anisotropicFiltering) {\n      debug(\n        \"This device does not have hardware anisotropic filtering for textures. This property will be ignored when setting texture settings.\"\n      );\n    } else {\n      anisotropicStats.maxAnistropicFilter = gl.getParameter(\n        anisotropicFiltering.MAX_TEXTURE_MAX_ANISOTROPY_EXT\n      );\n    }\n\n    return {\n      instancing:\n        (gl instanceof WebGL2RenderingContext ? gl : instancing) || undefined,\n      drawBuffers:\n        (gl instanceof WebGL2RenderingContext ? gl : drawBuffers) || undefined,\n      anisotropicFiltering: anisotropicFiltering\n        ? {\n            ext: anisotropicFiltering,\n            stat: anisotropicStats\n          }\n        : undefined\n    };\n  }\n\n  /**\n   * Clears the specified buffers\n   */\n  clear(color?: boolean, depth?: boolean, stencil?: boolean) {\n    let mask = 0;\n\n    if (color) mask = mask | this.gl.COLOR_BUFFER_BIT;\n    if (depth) mask = mask | this.gl.DEPTH_BUFFER_BIT;\n    if (stencil) mask = mask | this.gl.STENCIL_BUFFER_BIT;\n\n    this.gl.clear(mask);\n  }\n\n  /**\n   * Takes an Attribute object and ensures it's buffer is created and initialized.\n   */\n  compileAttribute(attribute: Attribute) {\n    if (attribute.gl) return;\n\n    const gl = this.gl;\n    const buffer = gl.createBuffer();\n\n    if (!buffer) {\n      console.warn(\n        this.debugContext,\n        \"Could bot create WebGLBuffer. Printing any existing gl errors:\"\n      );\n      this.printError();\n\n      return;\n    }\n\n    // State change\n    this.state.bindVBO(buffer);\n\n    // Upload the data to the GPU\n    gl.bufferData(\n      gl.ARRAY_BUFFER,\n      attribute.data,\n      attribute.isDynamic ? gl.DYNAMIC_DRAW : gl.STATIC_DRAW\n    );\n\n    attribute.gl = {\n      bufferId: buffer,\n      type: gl.ARRAY_BUFFER\n    };\n\n    // Indicate the attribute is updated to it's latest needs and concerns\n    attribute.resolve();\n\n    return true;\n  }\n\n  /**\n   * Takes a geometry object and ensures all of it's buffers are generated\n   */\n  compileGeometry(geometry: Geometry) {\n    let success = true;\n\n    // Loop through each attribute of the geometry\n    geometry.attributes.forEach(attribute => {\n      success = Boolean(this.compileAttribute(attribute) && success);\n    });\n\n    return success;\n  }\n\n  /**\n   * This creates the shaders and programs needed to create a material.\n   */\n  compileMaterial(material: Material) {\n    // If the gl object exists, then this is considered finished\n    if (material.gl) return;\n\n    // Check for existing shader programs for the fragment shader\n    let fs = this.fragmentShaders.get(material.fragmentShader) || null;\n\n    // If none exists, then we create and compile the fragments shader\n    if (!fs) {\n      fs = this.gl.createShader(this.gl.FRAGMENT_SHADER);\n\n      if (!fs) {\n        console.warn(\n          this.debugContext,\n          \"Could not create a Fragment WebGLShader. Printing GL Errors:\"\n        );\n        this.printError();\n        return;\n      }\n\n      this.gl.shaderSource(fs, material.fragmentShader);\n      this.gl.compileShader(fs);\n\n      if (!this.gl.getShaderParameter(fs, this.gl.COMPILE_STATUS)) {\n        console.error(\n          this.debugContext,\n          \"FRAGMENT SHADER COMPILER ERROR:\",\n          material.name\n        );\n        console.warn(\n          \"Could not compile provided shader. Printing logs and errors:\"\n        );\n        console.warn(this.lineFormatShader(material.fragmentShader));\n        console.warn(\"LOGS:\");\n        console.warn(this.gl.getShaderInfoLog(fs));\n        this.printError();\n        this.gl.deleteShader(fs);\n\n        return;\n      }\n    }\n\n    // Check for existingg vertex shader object\n    let vs = this.vertexShaders.get(material.vertexShader) || null;\n\n    // If none exists, then compile\n    if (!vs) {\n      vs = this.gl.createShader(this.gl.VERTEX_SHADER);\n\n      if (!vs) {\n        console.warn(\n          this.debugContext,\n          \"Could not create a Vertex WebGLShader. Printing GL Errors:\"\n        );\n        this.printError();\n        return;\n      }\n\n      this.gl.shaderSource(vs, material.vertexShader);\n      this.gl.compileShader(vs);\n\n      if (!this.gl.getShaderParameter(vs, this.gl.COMPILE_STATUS)) {\n        console.error(\n          this.debugContext,\n          \"VERTEX SHADER COMPILER ERROR\",\n          material.name\n        );\n        console.warn(\n          \"Could not compile provided shader. Printing logs and errors:\"\n        );\n        console.warn(this.lineFormatShader(material.vertexShader));\n        console.warn(\"LOGS:\");\n        console.warn(this.gl.getShaderInfoLog(vs));\n        this.printError();\n        this.gl.deleteShader(vs);\n\n        return;\n      }\n    }\n\n    let vertexPrograms = this.programs.get(vs);\n\n    if (!vertexPrograms) {\n      vertexPrograms = new Map();\n      this.programs.set(vs, vertexPrograms);\n    }\n\n    let useMetrics = vertexPrograms.get(fs) || null;\n\n    if (!useMetrics) {\n      const program = this.gl.createProgram();\n\n      if (!program) {\n        console.warn(\n          this.debugContext,\n          \"Could not create a WebGLProgram. Printing GL Errors:\"\n        );\n        this.printError();\n\n        return;\n      }\n\n      useMetrics = {\n        useCount: 1,\n        program\n      };\n\n      this.gl.attachShader(program, vs);\n      this.gl.attachShader(program, fs);\n\n      // Make the shaders operate together\n      this.gl.linkProgram(program);\n      this.gl.validateProgram(program);\n\n      if (\n        !this.gl.getProgramParameter(program, this.gl.LINK_STATUS) ||\n        !this.gl.getProgramParameter(program, this.gl.VALIDATE_STATUS)\n      ) {\n        const info = this.gl.getProgramInfoLog(program);\n        console.warn(\n          this.debugContext,\n          \"Could not compile WebGL program. \\n\\n\",\n          info\n        );\n        this.gl.deleteProgram(program);\n\n        return;\n      }\n\n      vertexPrograms.set(fs, useMetrics);\n    } else {\n      // Up the use count of the program for like programs that are found\n      useMetrics.useCount++;\n    }\n\n    // Establish the gl context info that makes this material tick.\n    material.gl = {\n      fsId: fs,\n      vsId: vs,\n      programId: useMetrics.program,\n      proxy: this\n    };\n\n    // Let's get a list of all uniforms the shaders are demanding and make sure the material is\n    // supplying them. If not, then the shader will not have all of the information it may need\n    // and thus would be considered invalid rendering.\n\n    // Switch to the program and clean up any uniform mismatches\n    this.state.useProgram(useMetrics.program);\n    // Get the current program applied to our state\n    const program = this.state.currentProgram;\n    if (!program) return false;\n\n    // Get the total uniforms requested by the program so we can loop through them\n    const totalProgramUniforms = this.gl.getProgramParameter(\n      program,\n      this.gl.ACTIVE_UNIFORMS\n    );\n    const usedUniforms = new Set<string>();\n\n    for (let i = 0; i < totalProgramUniforms; i++) {\n      const uniformInfo = this.gl.getActiveUniform(program, i);\n\n      if (uniformInfo) {\n        usedUniforms.add(uniformInfo.name);\n      }\n    }\n\n    // We now delete any uniforms that are not matched between material and program as they are not needed\n    // and will just be lingering unused clutter.\n    const uniformToRemove = new Set();\n\n    Object.keys(material.uniforms).forEach(name => {\n      if (!usedUniforms.has(name)) {\n        uniformToRemove.add(name);\n      }\n    });\n\n    uniformToRemove.forEach(name => {\n      delete material.uniforms[name];\n    });\n\n    // Now we validate we have all of the uniforms the program requested\n    if (Object.keys(material.uniforms).length !== usedUniforms.size) {\n      console.warn(\n        this.debugContext,\n        \"A program is requesting a set of uniforms:\",\n        Array.from(usedUniforms.values()),\n        \"but our material only provides\",\n        Object.keys(material.uniforms),\n        \"thus the expected rendering will be considered invalid.\"\n      );\n\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * This does what is needed to generate a GPU FBO that we can utilize as a render target\n   * for subsequent draw calls.\n   *\n   * TODO: For MRT (using extensions or webgl 2) Our current set up is ok. However, we need\n   * to change this to compile out split buffers for compatibility MRT.\n   */\n  compileRenderTarget(target: RenderTarget) {\n    // If the gl target exists, then this is considered to be compiled already\n    if (target.gl) return;\n\n    // We will now create the frame buffer and render buffers and targets necessary\n    // to make this render target work.\n    const gl = this.gl;\n    const fbo = gl.createFramebuffer();\n\n    if (!fbo) {\n      console.warn(\n        this.debugContext,\n        \"Could not generate a frame buffer object. Printing GL errors:\"\n      );\n      this.printError();\n      return false;\n    }\n\n    // Change state\n    this.state.bindFBO(fbo);\n\n    // Generate the context to be attached to the render target\n    const glContext: RenderTarget[\"gl\"] = {\n      fboId: fbo,\n      proxy: this\n    };\n\n    // Color buffer\n    if (Array.isArray(target.buffers.color)) {\n      const buffers: (WebGLRenderbuffer | Texture)[] = [];\n      let isReady = true;\n      glContext.colorBufferId = buffers;\n\n      target.buffers.color.forEach((buffer, i) => {\n        if (!isReady) return;\n        if (buffer instanceof Texture) {\n          buffers.push(buffer);\n\n          if (isTextureReady(buffer)) {\n            gl.framebufferTexture2D(\n              gl.FRAMEBUFFER,\n              indexToColorAttachment(gl, this.extensions, i, true),\n              gl.TEXTURE_2D,\n              buffer.gl.textureId,\n              0\n            );\n          } else {\n            console.warn(\n              this.debugContext,\n              \"Attempted to compile render target whose target texture was not ready for use.\"\n            );\n            isReady = false;\n          }\n        } else {\n          const rboId = this.compileColorBuffer(\n            buffer,\n            target.width,\n            target.height\n          );\n\n          if (rboId) {\n            buffers.push(rboId);\n            gl.framebufferRenderbuffer(\n              gl.FRAMEBUFFER,\n              indexToColorAttachment(gl, this.extensions, i, true),\n              gl.RENDERBUFFER,\n              rboId\n            );\n          }\n        }\n      });\n\n      if (!isReady) {\n        return false;\n      }\n    } else if (target.buffers.color !== undefined) {\n      const buffer = target.buffers.color;\n\n      if (buffer instanceof Texture) {\n        glContext.colorBufferId = buffer;\n\n        if (isTextureReady(buffer)) {\n          gl.framebufferTexture2D(\n            gl.FRAMEBUFFER,\n            indexToColorAttachment(gl, this.extensions, 0, true),\n            gl.TEXTURE_2D,\n            buffer.gl.textureId,\n            0\n          );\n        } else {\n          console.warn(\n            this.debugContext,\n            \"Attempted to compile render target whose target texture was not ready for use.\"\n          );\n          return false;\n        }\n      } else {\n        const rboId = this.compileColorBuffer(\n          buffer,\n          target.width,\n          target.height\n        );\n\n        if (rboId) {\n          glContext.colorBufferId = rboId;\n          gl.framebufferRenderbuffer(\n            gl.FRAMEBUFFER,\n            indexToColorAttachment(gl, this.extensions, 0, true),\n            gl.RENDERBUFFER,\n            rboId\n          );\n        }\n      }\n    }\n\n    // Depth buffer\n    if (target.buffers.depth !== undefined) {\n      const buffer = target.buffers.depth;\n\n      if (buffer instanceof Texture) {\n        glContext.depthBufferId = buffer;\n\n        if (isTextureReady(buffer)) {\n          gl.framebufferTexture2D(\n            gl.FRAMEBUFFER,\n            gl.DEPTH_ATTACHMENT,\n            gl.TEXTURE_2D,\n            buffer.gl.textureId,\n            0\n          );\n        }\n      } else {\n        const rboId = this.compileDepthBuffer(\n          buffer,\n          target.width,\n          target.height\n        );\n\n        if (rboId) {\n          glContext.depthBufferId = rboId;\n          gl.framebufferRenderbuffer(\n            gl.FRAMEBUFFER,\n            gl.DEPTH_ATTACHMENT,\n            gl.RENDERBUFFER,\n            rboId\n          );\n        }\n      }\n    }\n\n    // Stencil buffer\n    if (target.buffers.stencil !== undefined) {\n      const buffer = target.buffers.stencil;\n\n      if (buffer instanceof Texture) {\n        glContext.stencilBufferId = buffer;\n\n        if (isTextureReady(buffer)) {\n          gl.framebufferTexture2D(\n            gl.FRAMEBUFFER,\n            gl.STENCIL_ATTACHMENT,\n            gl.TEXTURE_2D,\n            buffer.gl.textureId,\n            0\n          );\n        }\n      } else {\n        const rboId = this.compileStencilBuffer(\n          buffer,\n          target.width,\n          target.height\n        );\n\n        if (rboId) {\n          glContext.stencilBufferId = rboId;\n          gl.framebufferRenderbuffer(\n            gl.FRAMEBUFFER,\n            gl.STENCIL_ATTACHMENT,\n            gl.RENDERBUFFER,\n            rboId\n          );\n        }\n      }\n    }\n\n    // Store the generated information in the target\n    target.gl = glContext;\n\n    // Check framebuffer for success\n    const frameBufferCheckResult = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n    let unidentifiedResult = false;\n    let stillUnidentifiedResult = false;\n    let message = \"\";\n\n    switch (frameBufferCheckResult) {\n      case gl.FRAMEBUFFER_COMPLETE:\n        target.setAsValid();\n        break;\n\n      case gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:\n        message = \"FRAMEBUFFER_INCOMPLETE_ATTACHMENT\";\n        break;\n\n      case gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:\n        message = \"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT\";\n        break;\n\n      case gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:\n        message = \"FRAMEBUFFER_INCOMPLETE_DIMENSIONS\";\n        break;\n\n      case gl.FRAMEBUFFER_UNSUPPORTED:\n        message = \"FRAMEBUFFER_UNSUPPORTED\";\n        break;\n\n      default:\n        unidentifiedResult = true;\n        break;\n    }\n\n    // WebGL 2 specific checks\n    if (gl instanceof WebGL2RenderingContext) {\n      switch (frameBufferCheckResult) {\n        case gl.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:\n          message = \"FRAMEBUFFER_INCOMPLETE_MULTISAMPLE\";\n          break;\n\n        case gl.RENDERBUFFER_SAMPLES:\n          message = \"RENDERBUFFER_SAMPLES\";\n          break;\n\n        default:\n          stillUnidentifiedResult = true;\n          break;\n      }\n    }\n\n    if (unidentifiedResult && stillUnidentifiedResult) {\n      console.warn(\n        this.debugContext,\n        \"A framebuffer check failed to return a known result. This FBO for render target will be assumed failed\"\n      );\n      console.warn(\"Result:\", frameBufferCheckResult, \"Render Target:\", target);\n      message = \"UNKNOWN\";\n    }\n\n    if (message) {\n      console.warn(\n        this.debugContext,\n        \"When creating a new FrameBuffer Object, the check on the framebuffer failed. Printing Errors:\"\n      );\n      console.warn(message);\n      console.warn(\"FAILED RENDER TARGET:\", target);\n      delete target.gl;\n\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Produces a render buffer object intended for a render target for the depth buffer attachment\n   */\n  private compileDepthBuffer(\n    buffer: GLSettings.RenderTarget.DepthBufferFormat,\n    width: number,\n    height: number\n  ) {\n    const gl = this.gl;\n    const rbo = gl.createRenderbuffer();\n\n    if (!rbo) {\n      console.warn(\n        this.debugContext,\n        \"Could not generate a WebGLRenderBuffer. Printing GL Errors:\"\n      );\n      this.printError();\n      return;\n    }\n\n    // State change\n    this.state.bindRBO(rbo);\n    // Set the storage format of the RBO\n    gl.renderbufferStorage(\n      gl.RENDERBUFFER,\n      depthBufferFormat(gl, buffer),\n      width,\n      height\n    );\n\n    return rbo;\n  }\n\n  /**\n   * Produces a render buffer object intended for a render target for the stencil buffer attachment\n   */\n  private compileStencilBuffer(\n    buffer: GLSettings.RenderTarget.StencilBufferFormat,\n    width: number,\n    height: number\n  ) {\n    const gl = this.gl;\n    const rbo = gl.createRenderbuffer();\n\n    if (!rbo) {\n      console.warn(\n        this.debugContext,\n        \"Could not generate a WebGLRenderBuffer. Printing GL Errors:\"\n      );\n      this.printError();\n      return;\n    }\n\n    // State change\n    this.state.bindRBO(rbo);\n    // Set the storage format of the RBO\n    gl.renderbufferStorage(\n      gl.RENDERBUFFER,\n      stencilBufferFormat(gl, buffer),\n      width,\n      height\n    );\n\n    return rbo;\n  }\n\n  /**\n   * Produces a render buffer object intended for a render target for the color buffer attachment\n   */\n  private compileColorBuffer(\n    buffer: GLSettings.RenderTarget.ColorBufferFormat,\n    width: number,\n    height: number\n  ) {\n    const gl = this.gl;\n    const rbo = gl.createRenderbuffer();\n\n    if (!rbo) {\n      console.warn(\n        this.debugContext,\n        \"Could not generate a WebGLRenderBuffer. Printing GL Errors:\"\n      );\n      this.printError();\n      return;\n    }\n\n    // State change\n    this.state.bindRBO(rbo);\n    // Set the storage format of the RBO\n    gl.renderbufferStorage(\n      gl.RENDERBUFFER,\n      colorBufferFormat(gl, buffer),\n      width,\n      height\n    );\n\n    return rbo;\n  }\n\n  /**\n   * This does what is needed to generate a GPU texture object and format it to the\n   * Texture object specifications.\n   */\n  compileTexture(texture: Texture) {\n    if (!texture.gl) return;\n    // If the id is already established, this does noe need a compile but an update\n    if (texture.gl.textureId) return;\n\n    // The texture must have a unit established in order to be compiled\n    if (texture.gl.textureUnit < 0) {\n      console.warn(\n        this.debugContext,\n        \"A Texture object attempted to be compiled without an established Texture Unit.\",\n        texture\n      );\n      return;\n    }\n\n    // Set our unit to the unit allotted to the texture for this operation\n    this.state.setActiveTextureUnit(texture.gl.textureUnit);\n\n    const gl = this.gl;\n    const textureId = gl.createTexture();\n\n    if (!textureId) {\n      console.warn(\n        this.debugContext,\n        \"Could not generate a texture object on the GPU. Printing any gl errors:\"\n      );\n      this.printError();\n      return;\n    }\n\n    // Establish the texture's generated gl context\n    texture.gl.textureId = textureId;\n    // No matter what, when compiled both data and settings should be updated immediately\n    texture.needsDataUpload = true;\n    texture.needsSettingsUpdate = true;\n\n    // Upload the texture's data to the object\n    this.updateTextureData(texture);\n    // Make sure the settings for the texture are set correctly to match the texture object\n    this.updateTextureSettings(texture);\n\n    return true;\n  }\n\n  /**\n   * Executes the draw operation for a given model\n   */\n  draw(model: Model) {\n    let instancing;\n    let drawRange = [0, 0];\n\n    // Get the appropriate draw range from the model\n    if (\n      model.vertexDrawRange &&\n      model.vertexDrawRange[0] >= 0 &&\n      model.vertexDrawRange[1] >= 0\n    ) {\n      drawRange = [\n        model.vertexDrawRange[0],\n        model.vertexDrawRange[1] - model.vertexDrawRange[0]\n      ];\n    } else {\n      drawRange = [0, model.vertexCount];\n    }\n\n    // Only if this geomxetry has instances requested will it attempt to render instances\n    if (model.drawInstances >= 0) {\n      instancing = this.extensions.instancing;\n    }\n\n    if (instancing && instancing instanceof WebGL2RenderingContext) {\n      instancing.drawArraysInstanced(\n        drawMode(this.gl, model.drawMode),\n        drawRange[0],\n        drawRange[1],\n        model.drawInstances\n      );\n    } else if (instancing) {\n      instancing.drawArraysInstancedANGLE(\n        drawMode(this.gl, model.drawMode),\n        drawRange[0],\n        drawRange[1],\n        model.drawInstances\n      );\n    } else {\n      this.gl.drawArrays(\n        drawMode(this.gl, model.drawMode),\n        drawRange[0],\n        drawRange[1]\n      );\n    }\n  }\n\n  /**\n   * Destroys a material's resources from the GL Context.\n   */\n  disposeMaterial(material: Material) {\n    if (material.gl) {\n      const { vsId, fsId, programId } = material.gl;\n      let fsLookup = this.programs.get(vsId);\n\n      // If nothing is found we have something with odd state. Just delete the vertex\n      // and fake the object to continue the program normally\n      if (!fsLookup) {\n        fsLookup = new Map();\n        this.gl.deleteShader(vsId);\n      }\n\n      let useMetrics = fsLookup.get(fsId);\n\n      // No use metrics means odd state, make a fake object to continue the process normally\n      if (!useMetrics) {\n        useMetrics = {\n          useCount: 0,\n          program: programId\n        };\n      }\n\n      // We're removing a material from utilizing this program, thus reduce it's useage\n      useMetrics.useCount--;\n\n      // If the useage is at or drops below zero, the program is no longer valid and not in use\n      if (useMetrics.useCount < 1) {\n        this.gl.deleteProgram(useMetrics.program);\n        fsLookup.delete(fsId);\n\n        // If removing this fragment shader reference reduces the lookups to zero, then the\n        // vertex shader is not paired with anything and has no programs. It is ready for\n        // removal as well\n        if (fsLookup.size <= 0) {\n          this.gl.deleteShader(vsId);\n        }\n      }\n\n      // The fragment shader is a bit trickier, we must go through all vertex shader lookups and see\n      // if the fragment shader exists in any of them. If not: the fragment shader is ready for removal\n      let found = false;\n      this.programs.forEach(fsLookup => {\n        if (fsLookup.has(fsId)) found = true;\n      });\n\n      // If no fragment shader references remain: delete it.\n      if (!found) {\n        this.gl.deleteShader(fsId);\n      }\n    }\n\n    delete material.gl;\n  }\n\n  /**\n   * Destroy a render buffer (RBO)\n   */\n  disposeRenderBuffer(buffer: WebGLRenderbuffer) {\n    this.gl.deleteRenderbuffer(buffer);\n  }\n\n  /**\n   * Destroys a render target's resources from the GL context\n   */\n  disposeRenderTarget(target: RenderTarget) {\n    if (target.gl) {\n      // List of color buffers for MRT\n      if (Array.isArray(target.gl.colorBufferId)) {\n        target.gl.colorBufferId.forEach(buffer => {\n          if (buffer instanceof Texture) this.disposeTexture(buffer);\n          else this.disposeRenderBuffer(buffer);\n        });\n      } else if (target.gl.colorBufferId instanceof Texture) {\n        this.disposeTexture(target.gl.colorBufferId);\n      } else if (target.gl.colorBufferId instanceof WebGLRenderbuffer) {\n        this.disposeRenderBuffer(target.gl.colorBufferId);\n      }\n\n      // Dispose of depth buffer\n      if (target.gl.depthBufferId instanceof Texture) {\n        this.disposeTexture(target.gl.depthBufferId);\n      } else if (target.gl.depthBufferId instanceof WebGLRenderbuffer) {\n        this.disposeRenderBuffer(target.gl.depthBufferId);\n      }\n\n      // Dispose of stencil buffer\n      if (target.gl.stencilBufferId instanceof Texture) {\n        this.disposeTexture(target.gl.stencilBufferId);\n      } else if (target.gl.stencilBufferId instanceof WebGLRenderbuffer) {\n        this.disposeRenderBuffer(target.gl.stencilBufferId);\n      }\n\n      // Clean up the context generated for the render target\n      delete target.gl;\n    }\n  }\n\n  /**\n   * Destroys a texture's resources from the GL context\n   */\n  disposeTexture(texture: Texture) {\n    if (texture.gl) {\n      this.gl.deleteTexture(texture.gl.textureId);\n      this.state.freeTextureUnit(texture);\n    }\n\n    delete texture.gl;\n  }\n\n  /**\n   * Retrieves the gl context from the canvas\n   */\n  static getContext(canvas: HTMLCanvasElement, options: {}) {\n    // TODO: Let's make sure webgl works before we attempt any webgl 2 shenanigans\n    const names = [/** \"webgl2\", */ \"webgl\", \"experimental-webgl\"];\n    let context: GLContext | null = null;\n    let extensions: IExtensions = {};\n\n    for (let i = 0; i < names.length; ++i) {\n      const name = names[i];\n      const ctx = canvas.getContext(name, options);\n\n      if (\n        ctx &&\n        (ctx instanceof WebGLRenderingContext ||\n          ctx instanceof WebGL2RenderingContext)\n      ) {\n        debug(\n          \"Generated GL Context of version with attributes:\",\n          name,\n          options\n        );\n        context = ctx;\n        extensions = GLProxy.addExtensions(context);\n        break;\n      }\n    }\n\n    return {\n      context,\n      extensions\n    };\n  }\n\n  /**\n   * This decodes and prints any webgl context error in a  human readable manner.\n   */\n  printError() {\n    const glError = this.gl.getError();\n\n    switch (glError) {\n      case this.gl.NO_ERROR:\n        console.warn(\"GL Error: No Error\");\n        break;\n\n      case this.gl.INVALID_ENUM:\n        console.warn(\"GL Error: INVALID ENUM\");\n        break;\n\n      case this.gl.INVALID_VALUE:\n        console.warn(\"GL Error: INVALID_VALUE\");\n        break;\n\n      case this.gl.INVALID_OPERATION:\n        console.warn(\"GL Error: INVALID OPERATION\");\n        break;\n\n      case this.gl.INVALID_FRAMEBUFFER_OPERATION:\n        console.warn(\"GL Error: INVALID FRAMEBUFFER OPERATION\");\n        break;\n\n      case this.gl.OUT_OF_MEMORY:\n        console.warn(\"GL Error: OUT OF MEMORY\");\n        break;\n\n      case this.gl.CONTEXT_LOST_WEBGL:\n        console.warn(\"GL Error: CONTEXT LOST WEBGL\");\n        break;\n\n      default:\n        console.warn(\n          \"GL Error: GL Context output an unrecognized error value:\",\n          glError\n        );\n        break;\n    }\n  }\n\n  /**\n   * Prints a shader broken down by lines\n   */\n  lineFormatShader(shader: string) {\n    const lines = shader.split(\"\\n\");\n    const lineChars = String(lines.length).length + 1;\n\n    return `\\n${lines\n      .map(\n        (l, i) =>\n          `${Array(lineChars - String(i + 1).length).join(\" \")}${i + 1}: ${l}`\n      )\n      .join(\"\\n\")}`;\n  }\n\n  /**\n   * Ensures a texture object is compiled and/or updated.\n   */\n  updateTexture(texture: Texture) {\n    if (!texture.gl || texture.gl.textureUnit < 0) {\n      console.warn(\n        this.debugContext,\n        \"Can not update or compile a texture that does not have an established texture unit.\",\n        texture\n      );\n      return;\n    }\n\n    // Perform any necessary compilation or settings changes requested of the texture\n    this.compileTexture(texture);\n    this.updateTextureData(texture);\n    this.updateTexturePartialData(texture);\n    this.updateTextureSettings(texture);\n\n    // Indicate all updates required of the texture have been performed\n    texture.resolve();\n  }\n\n  /**\n   * Ensures the texture object has it's data uploaded to the GPU\n   */\n  private updateTextureData(texture: Texture) {\n    // Check for upload flag\n    if (!texture.needsDataUpload) return;\n    // Check for gl context established\n    if (!texture.gl) return;\n    // This texture must have an establish texture id\n    if (!texture.gl.textureId) return;\n\n    // The texture must have a unit established in order to have it's data updated\n    if (texture.gl.textureUnit < 0) {\n      console.warn(\n        this.debugContext,\n        \"A Texture object attempted to update it's data without an established Texture Unit.\",\n        texture\n      );\n      return;\n    }\n\n    const gl = this.gl;\n\n    // Ensure we are operating on the correct active unit\n    this.state.setActiveTextureUnit(texture.gl.textureUnit);\n    // Ensure our texture is bound as the active texture unit\n    this.state.bindTexture(\n      texture,\n      GLSettings.Texture.TextureBindingTarget.TEXTURE_2D\n    );\n\n    // Make sure the settings are properly set for the texture before performing the data upload\n    texture.needsSettingsUpdate = true;\n    this.updateTextureSettings(texture);\n\n    // First set the data in the texture\n    if (gl instanceof WebGLRenderingContext) {\n      if (isDataBuffer(texture.data)) {\n        if (\n          !isPowerOf2(texture.data.width) ||\n          !isPowerOf2(texture.data.height)\n        ) {\n          debug(\"Created a texture that is not using power of 2 dimensions.\");\n        }\n\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          0,\n          texelFormat(gl, texture.format),\n          texture.data.width,\n          texture.data.height,\n          0,\n          texelFormat(gl, texture.format),\n          inputImageFormat(gl, texture.type),\n          texture.data.buffer\n        );\n      } else if (texture.data) {\n        if (\n          !isPowerOf2(texture.data.width) ||\n          !isPowerOf2(texture.data.height)\n        ) {\n          debug(\n            \"Created a texture that is not using power of 2 dimensions. %o\",\n            texture\n          );\n        }\n\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          0,\n          texelFormat(gl, texture.format),\n          texelFormat(gl, texture.format),\n          inputImageFormat(gl, texture.type),\n          texture.data\n        );\n      }\n\n      if (texture.generateMipMaps) {\n        gl.generateMipmap(gl.TEXTURE_2D);\n      }\n    }\n\n    // Let's not hang onto large data buffers that are being uploaded to the gpu. Let's\n    // delete the buffer but keep some simple metrics about it.\n    if (texture.data) {\n      texture.data = {\n        width: texture.data.width,\n        height: texture.data.height,\n        buffer: null\n      };\n    }\n\n    // Clear the flag for updates\n    texture.needsDataUpload = false;\n  }\n\n  /**\n   * This consumes all of the partial texture updates applied to the texture.\n   */\n  private updateTexturePartialData(texture: Texture) {\n    // Check for partial update flag\n    if (!texture.needsPartialDataUpload) return;\n    // Check for gl context established\n    if (!texture.gl) return;\n    // This texture must have an establish texture id\n    if (!texture.gl.textureId) return;\n\n    // The texture must have a unit established in order to have it's data updated\n    if (texture.gl.textureUnit < 0) {\n      console.warn(\n        this.debugContext,\n        \"A Texture object attempted to update it's data without an established Texture Unit.\",\n        texture\n      );\n      return;\n    }\n\n    // Get gl context to work with\n    const gl = this.gl;\n    // Ensure we are operating on the correct active unit\n    this.state.setActiveTextureUnit(texture.gl.textureUnit);\n    // Ensure our texture is bound as the active texture unit\n    this.state.bindTexture(\n      texture,\n      GLSettings.Texture.TextureBindingTarget.TEXTURE_2D\n    );\n\n    // Loop through all the necessary update regions and apply the changes\n    texture.updateRegions.forEach(region => {\n      const buffer = region[0];\n      const bounds = region[1];\n\n      // First set the data in the texture\n      if (gl instanceof WebGLRenderingContext) {\n        if (isDataBuffer(buffer)) {\n          gl.texSubImage2D(\n            gl.TEXTURE_2D,\n            0,\n            bounds.x,\n            bounds.y,\n            buffer.width,\n            buffer.height,\n            texelFormat(gl, texture.format),\n            inputImageFormat(gl, texture.type),\n            buffer.buffer\n          );\n        } else if (buffer) {\n          gl.texSubImage2D(\n            gl.TEXTURE_2D,\n            0,\n            bounds.x,\n            bounds.y,\n            texelFormat(gl, texture.format),\n            inputImageFormat(gl, texture.type),\n            buffer\n          );\n        }\n\n        if (texture.generateMipMaps) {\n          gl.generateMipmap(gl.TEXTURE_2D);\n        }\n      }\n    });\n\n    // Flag the deed as done\n    texture.needsPartialDataUpload = false;\n  }\n\n  /**\n   * Modifies all settings needing modified on the provided texture object.\n   */\n  private updateTextureSettings(texture: Texture) {\n    // Check update flag\n    if (!texture.needsSettingsUpdate) return;\n    // Check for gl context\n    if (!texture.gl || !texture.data) return;\n    // This texture must have an establish texture id\n    if (!texture.gl.textureId) return;\n\n    // The texture must have a unit established in order to be compiled\n    if (texture.gl.textureUnit < 0) {\n      console.warn(\n        this.debugContext,\n        \"A Texture object attempted to update it's settings without an established Texture Unit.\",\n        texture\n      );\n      return;\n    }\n\n    const isPower2 =\n      isPowerOf2(texture.data.width) && isPowerOf2(texture.data.height);\n    const gl = this.gl;\n    this.state.setActiveTextureUnit(texture.gl.textureUnit);\n    this.state.bindTexture(\n      texture,\n      GLSettings.Texture.TextureBindingTarget.TEXTURE_2D\n    );\n\n    // Set filtering and other properties to the texture\n    gl.texParameteri(\n      gl.TEXTURE_2D,\n      gl.TEXTURE_MAG_FILTER,\n      magFilter(gl, texture.magFilter, isPower2)\n    );\n    gl.texParameteri(\n      gl.TEXTURE_2D,\n      gl.TEXTURE_MIN_FILTER,\n      minFilter(gl, texture.minFilter, isPower2, texture.generateMipMaps)\n    );\n    gl.texParameteri(\n      gl.TEXTURE_2D,\n      gl.TEXTURE_WRAP_S,\n      wrapMode(gl, texture.wrapHorizontal)\n    );\n    gl.texParameteri(\n      gl.TEXTURE_2D,\n      gl.TEXTURE_WRAP_T,\n      wrapMode(gl, texture.wrapVertical)\n    );\n\n    // NOTE: All pixelStorei with boolean settings:\n    // The typescript definitions are wrong right now thus requiring some weird casting\n    // voodoo. The correct value according to the webgl specs IS true right here and not a number\n    // for this particular enum.\n\n    gl.pixelStorei(\n      gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,\n      (texture.premultiplyAlpha as unknown) as number\n    );\n\n    gl.pixelStorei(\n      gl.UNPACK_FLIP_Y_WEBGL,\n      (texture.flipY as unknown) as number\n    );\n\n    // Apply the anistropic extension (if available)\n    if (this.extensions.anisotropicFiltering) {\n      const { ext, stat } = this.extensions.anisotropicFiltering;\n      gl.texParameterf(\n        gl.TEXTURE_2D,\n        ext.TEXTURE_MAX_ANISOTROPY_EXT,\n        Math.min(stat.maxAnistropicFilter, Math.floor(texture.anisotropy))\n      );\n    }\n\n    // Clear the flag for updates\n    texture.needsSettingsUpdate = false;\n  }\n\n  /**\n   * This updates an attribute's buffer data\n   */\n  updateAttribute(attribute: Attribute) {\n    if (!attribute.gl) return this.compileAttribute(attribute);\n\n    // Make sure an update is even needed\n    if (!attribute.fullUpdate && !attribute.needsUpdate) {\n      return true;\n    }\n\n    const gl = this.gl;\n\n    // Check to see if this should be a complete buffer update\n    if (\n      attribute.fullUpdate ||\n      attribute.updateRange.count < 0 ||\n      attribute.updateRange.offset < 0\n    ) {\n      // State change\n      this.state.bindVBO(attribute.gl.bufferId);\n      // Upload data\n      gl.bufferData(\n        gl.ARRAY_BUFFER,\n        attribute.data,\n        attribute.isDynamic ? gl.DYNAMIC_DRAW : gl.STATIC_DRAW\n      );\n    }\n\n    // Otherwise, we work to upload only a partial update to the buffer\n    else if (attribute.updateRange.count > 0) {\n      // State change\n      this.state.bindVBO(attribute.gl.bufferId);\n      // Upload data\n      const start = attribute.updateRange.offset;\n      gl.bufferSubData(\n        gl.ARRAY_BUFFER,\n        start * 4,\n        attribute.data.subarray(start, start + attribute.updateRange.count)\n      );\n    }\n\n    // Flag the attribute as updated to all of it's necessities\n    attribute.resolve();\n\n    return true;\n  }\n\n  /**\n   * This performs all necessary functions to use the attribute utilizing\n   * the current program in use.\n   */\n  useAttribute(name: string, attribute: Attribute) {\n    // We need a valid program in use.\n    if (!this.state.currentProgram) return false;\n    // Must have it's gl context established\n    if (!attribute.gl) return false;\n\n    // Ensure the attribute has established location information for this program\n    attribute.gl.locations = attribute.gl.locations || new Map();\n    // Find existing attribute location for the current program\n    let location = attribute.gl.locations.get(this.state.currentProgram);\n\n    // If no location is found for this attribute for this program we must query for it\n    if (location === undefined) {\n      location = this.gl.getAttribLocation(this.state.currentProgram, name);\n\n      if (location === -1) {\n        debug(\n          \"WARN: An attribute is not being used with the current material: %o\",\n          attribute\n        );\n      }\n\n      attribute.gl.locations.set(this.state.currentProgram, location);\n    }\n\n    // Exit if our location is invalid for this attribute. It won't be used in next draw call.\n    if (location === -1) return;\n\n    // At this point we're ready to establish the attribute's state and stride\n    this.state.bindVBO(attribute.gl.bufferId);\n    // Enable the use of the vertex location\n    this.state.willUseVertexAttributeArray(location);\n    // Now we establish the metrics of the buffer\n    this.gl.vertexAttribPointer(\n      location,\n      attribute.size, // How many floats used for the attribute\n      this.gl.FLOAT, // We are only sending over float data right now\n      attribute.normalize,\n      0,\n      0\n    );\n\n    if (attribute.isInstanced && this.extensions.instancing) {\n      this.state.setVertexAttributeArrayDivisor(location, 1);\n    } else {\n      this.state.setVertexAttributeArrayDivisor(location, 0);\n    }\n\n    return true;\n  }\n}\n","import { Attribute } from \"./attribute\";\n\n/**\n * This represents a buffer of data that is expressed as attributes to be placed\n * within a scene. This is generally paired with a Material in a Model to indicate\n * the configuration for how the buffer should be rendered.\n */\nexport class Geometry {\n  /** The attributes bound to this geometry.  */\n  private _attributes: { [key: string]: Attribute } = {};\n  get attributes() {\n    return new Map(Object.entries(this._attributes));\n  }\n  /** This contains any gl specific state associated with this object */\n  gl = {};\n  /** Number of instances this geometry covers */\n  maxInstancedCount: number = 0;\n\n  /**\n   * Adds an attribute to this geometry. This will associate the attribute's buffer to an attribute\n   * with the same name used within the shader program.\n   */\n  addAttribute(name: string, attribute: Attribute) {\n    this._attributes[name] = attribute;\n  }\n\n  /**\n   * Removes any attributes associated with the specified identifying name.\n   */\n  removeAttribute(name: string) {\n    delete this._attributes[name];\n  }\n\n  dispose() {\n    // TODO\n  }\n}\n","/**\n * Defines an attribute applied to a geometry object. This keeps track of a buffer associated\n * with the attribute to bind to attributes within the shader program.\n */\nexport class Attribute {\n  /**\n   * The data buffer that is applied to the GPU. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/bufferData\n   */\n  data: Float32Array;\n  /**\n   * Anything specific to gl state is stored here for this object.\n   * Modifying anything in here outside of the framework probably will\n   * break everything.\n   */\n  gl?: {\n    /** Stores the buffer id for the attribute */\n    bufferId: WebGLBuffer;\n    /** Stores the buffer type (typically gl.ARRAY_BUFFER) */\n    type: number;\n    /** Stores the locations of each attribute discovered for each program identified */\n    locations?: Map<WebGLProgram, number>;\n  };\n  /**\n   * The optimization state for frequently changing buffers. See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/bufferData\n   */\n  get isDynamic() {\n    return this._isDynamic;\n  }\n  private _isDynamic: boolean;\n  /**\n   * Indicates the data in this attribute is structured per instance rather than per vertex.\n   */\n  get isInstanced() {\n    return this._isInstanced;\n  }\n  private _isInstanced: boolean = false;\n  /** Indicates a full update of the buffer will happen. This is managed internally to determine when needed */\n  get fullUpdate() {\n    return this._fullUpdate;\n  }\n  private _fullUpdate: boolean = false;\n  /** Indicates if the data should be normalized when provided to the shader. */\n  normalize: boolean = false;\n  /** This flags the attribute as needing to commit updates to it's buffer */\n  get needsUpdate() {\n    return this._needsUpdate;\n  }\n  private _needsUpdate: boolean;\n  /**\n   * The packing size of the vertex attribute (how many floats per attribute). See:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/enableVertexAttribArray\n   */\n  size: number;\n  /**\n   * Defines a range to update for the buffer object. Getting the range object is a copy of the object.\n   * Setting the updateRange triggers an update.\n   *\n   * Although these properties represent vertex indicies it directly ties to all implications of:\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/bufferSubData\n   */\n  get updateRange() {\n    return this._updateRange;\n  }\n  set updateRange(val: Attribute[\"_updateRange\"]) {\n    this._updateRange = val;\n    this._needsUpdate = true;\n  }\n  private _updateRange = {\n    /** Number of vertices to update */\n    count: -1,\n    /** Offset to the first vertex to begin updating */\n    offset: -1\n  };\n\n  /**\n   * The data provided is the array that holds all of the information that should be pushed to\n   * the GPU. The size defines how large the vertex attribute is defined in the shader.\n   */\n  constructor(\n    data: Float32Array,\n    size: number,\n    isDynamic: boolean = false,\n    isInstanced: boolean = false\n  ) {\n    this.data = data;\n    this.size = size;\n    this._isDynamic = isDynamic;\n    this._isInstanced = isInstanced;\n  }\n\n  /**\n   * Flags this attribute as completely resolved in it's needs for updates\n   */\n  resolve() {\n    this._needsUpdate = false;\n    this._fullUpdate = false;\n  }\n\n  /**\n   * Flags the buffer as dynamic. This is a performance optimization that some GPUs can use for\n   * buffers that change their contents frequently. Toggling this\n   */\n  setDynamic(isDynmaic: boolean) {\n    this._isDynamic = isDynmaic;\n    this._needsUpdate = true;\n    this._fullUpdate = true;\n  }\n}\n","/**\n * This utility makes an operation occur in a render frame after the current render frame.\n */\n\nlet queuedCommands: Function[] = [];\nlet nextFrameCommands: Function[] = [];\n\n/**\n * Frame loop that queues and shuffles commands to execute them on the frame after the frame\n * they were queued up.\n */\nconst loop = (time: number) => {\n  // Get next loop iteration queued up\n  requestAnimationFrame(loop);\n\n  // Empty and execute all next frame commands\n  for (let i = 0, iMax = nextFrameCommands.length; i < iMax; ++i) {\n    const command = nextFrameCommands[i];\n\n    if (command) {\n      command(time);\n    }\n  }\n\n  // Currently queued commands get put into the nextFrameCommand buffer to be\n  // executed next animation frame instead of the current frame.\n  nextFrameCommands = queuedCommands.slice(0);\n  queuedCommands = [];\n};\n\n// Start the next frame command loop\nrequestAnimationFrame(loop);\n\n/**\n * Method that queues up a command to be executed not on this animation frame, but the next one\n */\nexport function nextFrame(command: Function) {\n  queuedCommands.push(command);\n}\n","import { Vec3Compat } from \"./vector\";\n\nexport type Mat2x2 = [number, number, number, number];\n\nexport type Mat3x3 = [\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number\n];\n\nexport type Mat4x4 = [\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number\n];\n\nexport function determinant2x2(mat: Mat2x2) {\n  return mat[3] * mat[0] - mat[1] * mat[2];\n}\n\nexport function determinant3x3(mat: Mat3x3): number {\n  return (\n    mat[0] * mat[4] * mat[8] -\n    mat[0] * mat[5] * mat[7] +\n    mat[1] * mat[5] * mat[6] -\n    mat[1] * mat[3] * mat[8] +\n    mat[2] * mat[3] * mat[7] -\n    mat[2] * mat[4] * mat[6]\n  );\n}\n\nexport function determinant4x4(mat: Mat4x4): number {\n  const m0: Mat3x3 = [\n    mat[5],\n    mat[6],\n    mat[7],\n    mat[9],\n    mat[10],\n    mat[11],\n    mat[13],\n    mat[14],\n    mat[15]\n  ];\n  const m1: Mat3x3 = [\n    mat[4],\n    mat[6],\n    mat[7],\n    mat[8],\n    mat[10],\n    mat[11],\n    mat[12],\n    mat[14],\n    mat[15]\n  ];\n  const m2: Mat3x3 = [\n    mat[4],\n    mat[5],\n    mat[7],\n    mat[8],\n    mat[9],\n    mat[11],\n    mat[12],\n    mat[13],\n    mat[15]\n  ];\n  const m3: Mat3x3 = [\n    mat[4],\n    mat[5],\n    mat[6],\n    mat[8],\n    mat[9],\n    mat[10],\n    mat[12],\n    mat[13],\n    mat[14]\n  ];\n\n  return (\n    mat[0] * determinant3x3(m0) -\n    mat[1] * determinant3x3(m1) +\n    mat[2] * determinant3x3(m2) -\n    mat[3] * determinant3x3(m3)\n  );\n}\n\nexport function affineInverse2x2(mat: Mat2x2): Mat2x2 | null {\n  const determinant = determinant2x2(mat);\n  if (determinant === 0) return null;\n  return [\n    mat[3] / determinant,\n    -mat[1] / determinant,\n    -mat[2] / determinant,\n    mat[0] / determinant\n  ];\n}\n\nexport function affineInverse3x3(mat: Mat3x3): Mat3x3 | null {\n  const determiant = determinant3x3(mat);\n  if (determiant === 0) return null;\n  const m0 = determinant2x2([mat[4], mat[5], mat[7], mat[8]]);\n  const m1 = determinant2x2([mat[3], mat[5], mat[6], mat[8]]);\n  const m2 = determinant2x2([mat[3], mat[4], mat[6], mat[7]]);\n  const m3 = determinant2x2([mat[1], mat[2], mat[7], mat[8]]);\n  const m4 = determinant2x2([mat[0], mat[2], mat[6], mat[8]]);\n  const m5 = determinant2x2([mat[0], mat[1], mat[6], mat[7]]);\n  const m6 = determinant2x2([mat[1], mat[2], mat[4], mat[5]]);\n  const m7 = determinant2x2([mat[0], mat[2], mat[3], mat[5]]);\n  const m8 = determinant2x2([mat[0], mat[1], mat[3], mat[4]]);\n\n  return [\n    m0 / determiant,\n    -m3 / determiant,\n    m6 / determiant,\n    -m1 / determiant,\n    m4 / determiant,\n    m7 / determiant,\n    m2 / determiant,\n    -m5 / determiant,\n    m8 / determiant\n  ];\n}\n\nexport function affineInverse4x4(mat: Mat4x4): Mat4x4 | null {\n  const determiant = determinant4x4(mat);\n  if (determiant === 0) return null;\n\n  const s0 = determinant2x2([mat[0], mat[1], mat[4], mat[5]]);\n  const s1 = determinant2x2([mat[0], mat[2], mat[4], mat[6]]);\n  const s2 = determinant2x2([mat[0], mat[3], mat[4], mat[7]]);\n  const s3 = determinant2x2([mat[1], mat[2], mat[5], mat[6]]);\n  const s4 = determinant2x2([mat[1], mat[3], mat[5], mat[7]]);\n  const s5 = determinant2x2([mat[2], mat[3], mat[6], mat[7]]);\n\n  const c5 = determinant2x2([mat[10], mat[11], mat[14], mat[15]]);\n  const c4 = determinant2x2([mat[9], mat[11], mat[13], mat[15]]);\n  const c3 = determinant2x2([mat[9], mat[10], mat[13], mat[14]]);\n  const c2 = determinant2x2([mat[8], mat[11], mat[12], mat[15]]);\n  const c1 = determinant2x2([mat[8], mat[10], mat[12], mat[14]]);\n  const c0 = determinant2x2([mat[8], mat[9], mat[12], mat[13]]);\n\n  return [\n    // r00\n    (mat[5] * c5 - mat[6] * c4 + mat[7] * c3) / determiant,\n    // r01\n    (-mat[1] * c5 + mat[2] * c4 - mat[3] * c3) / determiant,\n    // r02\n    (mat[12] * s5 - mat[13] * s4 + mat[14] * s3) / determiant,\n    // r03\n    (-mat[9] * s5 + mat[10] * s4 - mat[11] * s3) / determiant,\n    // r10\n    (-mat[4] * c5 + mat[6] * c2 - mat[7] * c1) / determiant,\n    // r11\n    (mat[0] * c5 - mat[2] * c2 + mat[3] * c1) / determiant,\n    // r12\n    (-mat[12] * s5 + mat[14] * s2 - mat[15] * s1) / determiant,\n    // r13\n    (mat[8] * s5 - mat[10] * s2 + mat[11] * s1) / determiant,\n    // r20\n    (mat[4] * c4 - mat[5] * c2 + mat[7] * c0) / determiant,\n    // r21\n    (-mat[0] * c4 + mat[1] * c2 - mat[3] * c0) / determiant,\n    // r22\n    (mat[12] * s4 - mat[13] * s2 + mat[15] * s0) / determiant,\n    // r23\n    (-mat[8] * s4 + mat[9] * s2 - mat[11] * s0) / determiant,\n    // r30\n    (-mat[4] * c3 + mat[5] * c1 - mat[6] * c0) / determiant,\n    // r31\n    (mat[0] * c3 - mat[1] * c1 + mat[2] * c0) / determiant,\n    // r32\n    (-mat[12] * s3 + mat[13] * s1 - mat[14] * s0) / determiant,\n    // r33\n    (mat[8] * s3 - mat[9] * s1 + mat[10] * s0) / determiant\n  ];\n}\n\nexport function scale2x2(mat: Mat2x2, scale: number): Mat2x2 {\n  return [mat[0] * scale, mat[1] * scale, mat[2] * scale, mat[3] * scale];\n}\n\nexport function scale3x3(mat: Mat3x3, scale: number): Mat3x3 {\n  return [\n    mat[0] * scale,\n    mat[1] * scale,\n    mat[2] * scale,\n    mat[3] * scale,\n    mat[4] * scale,\n    mat[5] * scale,\n    mat[6] * scale,\n    mat[7] * scale,\n    mat[8] * scale\n  ];\n}\n\nexport function multiplyScalar4x4(mat: Mat4x4, scale: number): Mat4x4 {\n  return [\n    mat[0] * scale,\n    mat[1] * scale,\n    mat[2] * scale,\n    mat[3] * scale,\n    mat[4] * scale,\n    mat[5] * scale,\n    mat[6] * scale,\n    mat[7] * scale,\n    mat[8] * scale,\n    mat[9] * scale,\n    mat[10] * scale,\n    mat[11] * scale,\n    mat[12] * scale,\n    mat[13] * scale,\n    mat[14] * scale,\n    mat[15] * scale\n  ];\n}\n\nexport function identity2(): Mat2x2 {\n  return [1, 0, 0, 1];\n}\n\nexport function identity3(): Mat3x3 {\n  return [1, 0, 0, 0, 1, 0, 0, 0, 1];\n}\n\nexport function identity4(): Mat4x4 {\n  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n}\n\nexport function multiply2x2(left: Mat2x2, right: Mat2x2): Mat2x2 {\n  return [\n    // r0\n    left[0] * right[0] + left[1] * right[2],\n    // r1\n    left[0] * right[1] + left[1] * right[3],\n    // r2\n    left[2] * right[0] + left[3] * right[2],\n    // r3\n    left[2] * right[1] + left[1] * right[3]\n  ];\n}\n\nexport function multiply3x3(left: Mat3x3, right: Mat3x3): Mat3x3 {\n  return [\n    // r0\n    left[0] * right[0] + left[1] * right[3] + left[2] * right[6],\n    // r1\n    left[0] * right[1] + left[1] * right[4] + left[2] * right[7],\n    // r2\n    left[0] * right[2] + left[1] * right[5] + left[2] * right[8],\n    // r3\n    left[3] * right[0] + left[4] * right[3] + left[5] * right[6],\n    // r4\n    left[3] * right[1] + left[4] * right[4] + left[5] * right[7],\n    // r5\n    left[3] * right[2] + left[4] * right[5] + left[5] * right[8],\n    // r6\n    left[6] * right[0] + left[7] * right[3] + left[8] * right[6],\n    // r7\n    left[6] * right[1] + left[7] * right[4] + left[8] * right[7],\n    // r8\n    left[6] * right[2] + left[7] * right[5] + left[8] * right[8]\n  ];\n}\n\nexport function multiply4x4(left: Mat4x4, right: Mat4x4): Mat4x4 {\n  return [\n    // r0\n    left[0] * right[0] +\n      left[1] * right[4] +\n      left[2] * right[8] +\n      left[3] * right[12],\n    // r1\n    left[0] * right[1] +\n      left[1] * right[5] +\n      left[2] * right[9] +\n      left[3] * right[13],\n    // r2\n    left[0] * right[2] +\n      left[1] * right[6] +\n      left[2] * right[10] +\n      left[3] * right[14],\n    // r3\n    left[0] * right[3] +\n      left[1] * right[7] +\n      left[2] * right[11] +\n      left[3] * right[15],\n    // r4\n    left[4] * right[0] +\n      left[5] * right[4] +\n      left[6] * right[8] +\n      left[7] * right[12],\n    // r5\n    left[4] * right[1] +\n      left[5] * right[5] +\n      left[6] * right[9] +\n      left[7] * right[13],\n    // r6\n    left[4] * right[2] +\n      left[5] * right[6] +\n      left[6] * right[10] +\n      left[7] * right[14],\n    // r7\n    left[4] * right[3] +\n      left[5] * right[7] +\n      left[6] * right[11] +\n      left[7] * right[15],\n    // r8\n    left[8] * right[0] +\n      left[9] * right[4] +\n      left[10] * right[8] +\n      left[11] * right[12],\n    // r9\n    left[8] * right[1] +\n      left[9] * right[5] +\n      left[10] * right[9] +\n      left[11] * right[13],\n    // r10\n    left[8] * right[2] +\n      left[9] * right[6] +\n      left[10] * right[10] +\n      left[11] * right[14],\n    // r11\n    left[8] * right[3] +\n      left[9] * right[7] +\n      left[10] * right[11] +\n      left[11] * right[15],\n    // r12\n    left[12] * right[0] +\n      left[13] * right[4] +\n      left[14] * right[8] +\n      left[15] * right[12],\n    // r13\n    left[12] * right[1] +\n      left[13] * right[5] +\n      left[14] * right[9] +\n      left[15] * right[13],\n    // r14\n    left[12] * right[2] +\n      left[13] * right[6] +\n      left[14] * right[10] +\n      left[15] * right[14],\n    // r15\n    left[12] * right[3] +\n      left[13] * right[7] +\n      left[14] * right[11] +\n      left[15] * right[15]\n  ];\n}\n\nexport function add2x2(left: Mat2x2, right: Mat2x2): Mat2x2 {\n  return [\n    // r0\n    left[0] + right[0],\n    // r1\n    left[1] + right[1],\n    // r2\n    left[2] + right[2],\n    // r3\n    left[3] + right[3]\n  ];\n}\n\nexport function add3x3(left: Mat3x3, right: Mat3x3): Mat3x3 {\n  return [\n    // r0\n    left[0] + right[0],\n    // r1\n    left[1] + right[1],\n    // r2\n    left[2] + right[2],\n    // r3\n    left[3] + right[3],\n    // r4\n    left[4] + right[4],\n    // r5\n    left[5] + right[5],\n    // r6,\n    left[6] + right[6],\n    // r7,\n    left[7] + right[7],\n    // r8,\n    left[8] + right[8]\n  ];\n}\n\nexport function add4x4(left: Mat4x4, right: Mat4x4): Mat4x4 {\n  return [\n    // r0\n    left[0] + right[0],\n    // r1\n    left[1] + right[1],\n    // r2\n    left[2] + right[2],\n    // r3\n    left[3] + right[3],\n    // r4\n    left[4] + right[4],\n    // r5\n    left[5] + right[5],\n    // r6,\n    left[6] + right[6],\n    // r7,\n    left[7] + right[7],\n    // r8,\n    left[8] + right[8],\n    // r9,\n    left[9] + right[9],\n    // r10,\n    left[10] + right[10],\n    // r11,\n    left[11] + right[11],\n    // r12,\n    left[12] + right[12],\n    // r13,\n    left[13] + right[13],\n    // r14,\n    left[14] + right[14],\n    // r15\n    left[15] + right[15]\n  ];\n}\n\nexport function subtract2x2(left: Mat2x2, right: Mat2x2): Mat2x2 {\n  return [\n    // r0\n    left[0] - right[0],\n    // r1\n    left[1] - right[1],\n    // r2\n    left[2] - right[2],\n    // r3\n    left[3] - right[3]\n  ];\n}\n\nexport function subtract3x3(left: Mat3x3, right: Mat3x3): Mat3x3 {\n  return [\n    // r0\n    left[0] - right[0],\n    // r1\n    left[1] - right[1],\n    // r2\n    left[2] - right[2],\n    // r3\n    left[3] - right[3],\n    // r4\n    left[4] - right[4],\n    // r5\n    left[5] - right[5],\n    // r6,\n    left[6] - right[6],\n    // r7,\n    left[7] - right[7],\n    // r8,\n    left[8] - right[8]\n  ];\n}\n\nexport function subtract4x4(left: Mat4x4, right: Mat4x4): Mat4x4 {\n  return [\n    // r0\n    left[0] - right[0],\n    // r1\n    left[1] - right[1],\n    // r2\n    left[2] - right[2],\n    // r3\n    left[3] - right[3],\n    // r4\n    left[4] - right[4],\n    // r5\n    left[5] - right[5],\n    // r6,\n    left[6] - right[6],\n    // r7,\n    left[7] - right[7],\n    // r8,\n    left[8] - right[8],\n    // r9,\n    left[9] - right[9],\n    // r10,\n    left[10] - right[10],\n    // r11,\n    left[11] - right[11],\n    // r12,\n    left[12] - right[12],\n    // r13,\n    left[13] - right[13],\n    // r14,\n    left[14] - right[14],\n    // r15\n    left[15] - right[15]\n  ];\n}\n\nexport function Hadamard2x2(left: Mat2x2, right: Mat2x2): Mat2x2 {\n  return [\n    // r0\n    left[0] * right[0],\n    // r1\n    left[1] * right[1],\n    // r2\n    left[2] * right[2],\n    // r3\n    left[3] * right[3]\n  ];\n}\n\nexport function Hadamard3x3(left: Mat3x3, right: Mat3x3): Mat3x3 {\n  return [\n    // r0\n    left[0] * right[0],\n    // r1\n    left[1] * right[1],\n    // r2\n    left[2] * right[2],\n    // r3\n    left[3] * right[3],\n    // r4\n    left[4] * right[4],\n    // r5\n    left[5] * right[5],\n    // r6,\n    left[6] * right[6],\n    // r7,\n    left[7] * right[7],\n    // r8,\n    left[8] * right[8]\n  ];\n}\n\nexport function Hadamard4x4(left: Mat4x4, right: Mat4x4): Mat4x4 {\n  return [\n    // r0\n    left[0] * right[0],\n    // r1\n    left[1] * right[1],\n    // r2\n    left[2] * right[2],\n    // r3\n    left[3] * right[3],\n    // r4\n    left[4] * right[4],\n    // r5\n    left[5] * right[5],\n    // r6,\n    left[6] * right[6],\n    // r7,\n    left[7] * right[7],\n    // r8,\n    left[8] * right[8],\n    // r9,\n    left[9] * right[9],\n    // r10,\n    left[10] * right[10],\n    // r11,\n    left[11] * right[11],\n    // r12,\n    left[12] * right[12],\n    // r13,\n    left[13] * right[13],\n    // r14,\n    left[14] * right[14],\n    // r15\n    left[15] * right[15]\n  ];\n}\n\nexport function transpose2x2(mat: Mat2x2): Mat2x2 {\n  return [mat[0], mat[2], mat[1], mat[3]];\n}\n\nexport function transpose3x3(mat: Mat3x3): Mat3x3 {\n  return [\n    mat[0],\n    mat[3],\n    mat[6],\n    mat[1],\n    mat[4],\n    mat[7],\n    mat[2],\n    mat[5],\n    mat[8]\n  ];\n}\n\nexport function transpose4x4(mat: Mat4x4): Mat4x4 {\n  return [\n    mat[0],\n    mat[4],\n    mat[8],\n    mat[12],\n    mat[1],\n    mat[5],\n    mat[9],\n    mat[13],\n    mat[2],\n    mat[6],\n    mat[10],\n    mat[14],\n    mat[3],\n    mat[7],\n    mat[11],\n    mat[15]\n  ];\n}\n\n/**\n * Converts a 4x4 to a pretty print string\n */\nexport function toString4x4(mat: Mat4x4): string {\n  return `Matrix: [\n    ${mat[0]}, ${mat[1]}, ${mat[2]}, ${mat[3]},\n    ${mat[4]}, ${mat[5]}, ${mat[6]}, ${mat[7]},\n    ${mat[8]}, ${mat[9]}, ${mat[10]}, ${mat[11]},\n    ${mat[12]}, ${mat[13]}, ${mat[14]}, ${mat[15]},\n  ]`;\n}\n\n/**\n * Creates a scaling matrix from a vector\n */\nexport function scale4x4by3(p: Vec3Compat): Mat4x4 {\n  return scale4x4(p[0], p[1], p[2]);\n}\n/**\n * Creates a scaling matrix\n */\nexport function scale4x4(x: number, y: number, z: number): Mat4x4 {\n  return [x, 0, 0, 0, 0, y, 0, 0, 0, 0, z, 0, 0, 0, 0, 1];\n}\n\n/**\n * Creates a translation Matrix from a vector\n */\nexport function translation4x4by3(t: Vec3Compat): Mat4x4 {\n  return translation4x4(t[0], t[1], t[2]);\n}\n/**\n * Creates a translation Matrix\n */\nexport function translation4x4(x: number, y: number, z: number): Mat4x4 {\n  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, x, y, z, 1];\n}\n\n/**\n * Generate a projection matrix with perspective\n */\nexport function perspective4x4(\n  fovRadians: number,\n  aspectRatio: number,\n  near: number,\n  far: number\n): Mat4x4 {\n  const f = 1.0 / Math.tan(fovRadians / 2);\n  const rangeInv = 1 / (near - far);\n\n  return [\n    f / aspectRatio,\n    0,\n    0,\n    0,\n    0,\n    f,\n    0,\n    0,\n    0,\n    0,\n    (near + far) * rangeInv,\n    -1,\n    0,\n    0,\n    near * far * rangeInv * 2,\n    0\n  ];\n}\n\n/**\n * Generate a projection matrix with no perspective. Useful for flat 2D or isometric rendering.\n */\nexport function orthographic4x4(\n  left: number,\n  right: number,\n  bottom: number,\n  top: number,\n  near: number,\n  far: number\n): Mat4x4 {\n  return [\n    2 / (right - left),\n    0,\n    0,\n    0,\n    0,\n    2 / (top - bottom),\n    0,\n    0,\n    0,\n    0,\n    -1 / (far - near),\n    0,\n    (right + left) / (left - right),\n    (top + bottom) / (bottom - top),\n    -near / (near - far),\n    1\n  ];\n}\n","import { normalizeWheel } from \"./normalize-wheel\";\nimport { Vec2 } from \"./vector\";\n\n/**\n * Analyzes a MouseEvent and calculates the mouse coordinates (relative to the element).\n */\nfunction eventElementPosition(e: any, relative?: HTMLElement): Vec2 {\n  let mouseX: number = 0,\n    mouseY: number = 0,\n    eventX: number = 0,\n    eventY: number = 0,\n    object: any =\n      relative || (e.nativeEvent && e.nativeEvent.target) || e.target;\n\n  // Get mouse position on document crossbrowser\n  if (!e) {\n    e = window.event;\n  }\n\n  if (e.pageX || e.pageY) {\n    mouseX = e.pageX;\n    mouseY = e.pageY;\n  } else if (e.clientX || e.clientY) {\n    let scrollLeft = 0;\n    let scrollTop = 0;\n\n    if (document.documentElement) {\n      scrollLeft = document.documentElement.scrollLeft;\n      scrollTop = document.documentElement.scrollTop;\n    }\n\n    mouseX = e.clientX + document.body.scrollLeft + scrollLeft;\n    mouseY = e.clientY + document.body.scrollTop + scrollTop;\n  }\n\n  // Get parent element position in document\n  if (object.offsetParent) {\n    do {\n      eventX += object.offsetLeft;\n      eventY += object.offsetTop;\n      object = object.offsetParent;\n    } while (object);\n  }\n\n  // Mouse position minus elm position is mouseposition relative to element:\n  return [mouseX - eventX, mouseY - eventY];\n}\n\nexport { eventElementPosition, normalizeWheel };\n","export const templateVars = {\n  attributes: \"attributes\",\n  easingMethod: \"easingMethod\",\n  extend: \"extend\",\n  extendHeader: \"extendHeader\",\n  T: \"T\"\n};\n","import { Instance } from \"../../instance-provider/instance\";\nimport { IShaderExtension, IShaderInitialization } from \"../../types\";\nimport {\n  IShaderTemplateRequirements,\n  shaderTemplate\n} from \"../../util/shader-templating\";\nimport { templateVars } from \"../template-vars\";\n\nexport function extendShader<T extends Instance>(\n  shaderIO: IShaderInitialization<T>,\n  vs?: IShaderExtension,\n  fs?: IShaderExtension\n) {\n  const baseVS = shaderIO.vs;\n  const baseFS = shaderIO.fs;\n\n  let extendedVS = { shader: baseVS };\n  let extendedFS = { shader: baseFS };\n\n  // Set the replacements for the extension locations, but also retain the extension modifier to allow for\n  // Further extensions if desired.\n  if (vs) {\n    const options: { [key: string]: string } = {};\n\n    options[templateVars.extendHeader] = vs.header\n      ? `${vs.header}\\n$\\{${templateVars.extendHeader}}`\n      : \"\";\n    options[templateVars.extend] = vs.body\n      ? `${vs.body}\\n$\\{${templateVars.extend}}`\n      : \"\";\n\n    // It is REQUIRED to have both header and body extensions to be a valid extendible shader\n    const required: IShaderTemplateRequirements = {\n      name: \"Extend VS Shader\",\n      values: [templateVars.extendHeader, templateVars.extend]\n    };\n\n    // Generated the extended shader\n    extendedVS = shaderTemplate({\n      options,\n      required,\n      shader: baseVS,\n\n      // We do not want to remove any template macros that do not deal with extension\n      onToken: (token, replace) => {\n        if (\n          token === templateVars.extendHeader ||\n          token === templateVars.extend\n        ) {\n          return replace;\n        }\n\n        return `$\\{${token}}`;\n      }\n    });\n  }\n\n  // Next, extend the fragment shader\n\n  // Set the replacements for the extension locations, but also retain the extension modifier to allow for\n  // Further extensions if desired.\n  if (fs) {\n    const options: { [key: string]: string } = {};\n\n    options[templateVars.extendHeader] = fs.header\n      ? `${fs.header}\\n$\\{${templateVars.extendHeader}}`\n      : \"\";\n    options[templateVars.extend] = fs.body\n      ? `${fs.body}\\n$\\{${templateVars.extend}}`\n      : \"\";\n\n    // It is REQUIRED to have both header and body extensions to be a valid extendible shader\n    const required = {\n      name: \"Extend FS Shader\",\n      values: [templateVars.extendHeader, templateVars.extend]\n    };\n\n    // Generate the extended shader\n    extendedFS = shaderTemplate({\n      options,\n      required,\n      shader: baseFS,\n\n      // We do not want to remove any template macros that do not deal with extension\n      onToken: (token, replace) => {\n        if (\n          token === templateVars.extendHeader ||\n          token === templateVars.extend\n        ) {\n          return replace;\n        }\n\n        return `$\\{${token}}`;\n      }\n    });\n  }\n\n  // Apply the extension to the shader io program\n  return {\n    fs: extendedFS.shader,\n    vs: extendedVS.shader\n  };\n}\n","import { InstanceIOValue } from \"../types\";\nimport { uid } from \"../util/uid\";\nimport { Vec, VecMath } from \"./vector\";\n\nconst { min, max, pow, round, sin, PI } = Math;\nconst GPU_PI = round(PI * 1000) / 1000;\n\nfunction clamp(x: number, minVal: number, maxVal: number) {\n  return min(max(x, minVal), maxVal);\n}\n\nexport enum AutoEasingLoopStyle {\n  /** Time will go from 0 -> 1 then stop at 1 */\n  NONE = 1,\n  /** Time will go from 0 -> infinity */\n  CONTINUOUS = 4,\n  /** Time will continuously go 0 -> 1 then 0 -> 1 then 0 -> 1 etc etc */\n  REPEAT = 2,\n  /** Time will continously go 0 -> 1 then 1 -> 0 then 0 -> 1 then 1 -> 0 etc etc */\n  REFLECT = 3\n}\n\n/**\n * This defines a GPU enabled easing method that will be executed on the GPU to maneuver\n *\n */\nexport interface IAutoEasingMethod<T extends InstanceIOValue> {\n  /** An easing method that should produce IDENTICAL values to the values of the gpu easing method using the exact same parameters */\n  cpu(start: T, end: T, t: number): T;\n  /** This adds a delay to the starting time of an easing change */\n  delay: number;\n  /** This is how long the easing method should last */\n  duration: number;\n  /**\n   * An easing method written in shader language that should produce IDENTICAL\n   * values to the values of the cpu easing method using the exact same parameters.\n   */\n  gpu: string;\n  /**\n   * This defines the looping style of the easing.\n   */\n  loop: AutoEasingLoopStyle;\n  /**\n   * This shall be the name of the easing method as it appears in the spu shader.\n   * BE WARNED: This name is used to dedup the methods created on the shader. So,\n   * if you use the same name as another ease method used on a single layer, you run\n   * the risk of one overriding the other with an undefined chance of who wins.\n   */\n  methodName: string;\n  /**\n   * A unique identifier for the auto easing method.\n   */\n  uid: number;\n\n  /**\n   * This lets you modify some auto easing validation rules.\n   */\n  validation?: {\n    ignoreEndValueCheck?: boolean;\n    ignoreOverTimeCheck?: boolean;\n  };\n}\n\n// GPU easing methods! Written here because it's cleaner to write `` style strings\n// Against the left side of the editor\n\nconst immediateGPU = `\n$\\{easingMethod} {\n  return end;\n}\n`;\n\nconst linearGPU = `\n$\\{easingMethod} {\n  return (end - start) * t + start;\n}\n`;\n\nconst easeInQuadGPU = `\n$\\{easingMethod} {\n  float time = t * t;\n  return (end - start) * time + start;\n}\n`;\n\nconst easeOutQuadGPU = `\n$\\{easingMethod} {\n  float time = t * (2.0 - t);\n  return (end - start) * time + start;\n}\n`;\nconst easeInOutQuadGPU = `\n$\\{easingMethod} {\n  float time = t < 0.5 ? 2.0 * t * t : -1.0 + (4.0 - 2.0 * t) * t;\n  return (end - start) * time + start;\n}\n`;\nconst easeInCubicGPU = `\n$\\{easingMethod} {\n  float time = t * t * t;\n  return (end - start) * time + start;\n}\n`;\nconst easeOutCubicGPU = `\n$\\{easingMethod} {\n  float t1 = t - 1.0;\n  float time = t1 * t1 * t1 + 1.0;\n  return (end - start) * time + start;\n}\n`;\nconst easeInOutCubicGPU = `\n$\\{easingMethod} {\n  float time = t < 0.5 ? 4.0 * t * t * t : (t - 1.0) * (2.0 * t - 2.0) * (2.0 * t - 2.0) + 1.0;\n  return (end - start) * time + start;\n}\n`;\nconst easeInQuartGPU = `\n$\\{easingMethod} {\n  float time = t * t * t * t;\n  return (end - start) * time + start;\n}\n`;\nconst easeOutQuartGPU = `\n$\\{easingMethod} {\n  float t1 = t - 1.0;\n  float time = 1.0 - t1 * t1 * t1 * t1;\n  return (end - start) * time + start;\n}\n`;\nconst easeInOutQuartGPU = `\n$\\{easingMethod} {\n  float t1 = t - 1.0;\n  float time = t < 0.5 ? 8.0 * t * t * t * t : 1.0 - 8.0 * t1 * t1 * t1 * t1;\n  return (end - start) * time + start;\n}\n`;\nconst easeInQuintGPU = `\n$\\{easingMethod} {\n  float time = t * t * t * t * t;\n  return (end - start) * time + start;\n}\n`;\nconst easeOutQuintGPU = `\n$\\{easingMethod} {\n  float t1 = t - 1.0;\n  float time = 1.0 + t1 * t1 * t1 * t1 * t1;\n  return (end - start) * time + start;\n}\n`;\nconst easeInOutQuintGPU = `\n$\\{easingMethod} {\n  float t1 = t - 1.0;\n  float time = t < 0.5 ? 16.0 * t * t * t * t * t : 1.0 + 16.0 * t1 * t1 * t1 * t1 * t1;\n  return (end - start) * time + start;\n}\n`;\n\nconst easeOutElasticGPU = `\n$\\{easingMethod} {\n  float p = 0.3;\n  float time = pow(2.0, -10.0 * t) * sin((t - p / 4.0) * (2.0 * ${GPU_PI}) / p) + 1.0;\n  return (end - start) * time + start;\n}\n`;\n\nconst easeBackInGPU = `\n$\\{easingMethod} {\n  float time = t * t * t - t * 1.05 * sin(t * ${GPU_PI});\n  return (end - start) * time + start;\n}\n`;\n\nconst easeBackOutGPU = `\n$\\{easingMethod} {\n  float t1 = t - 1.0;\n  float a = 1.7;\n  float time = (t1 * t1 * ((a + 1.0) * t1 + a) + 1.0);\n  return (end - start) * time + start;\n}\n`;\n\nconst easeBackInOutGPU = `\n$\\{easingMethod} {\n  float a = 1.4;\n  float a1 = a * 1.525;\n  float t1 = t / 0.5;\n  float t2 = t1 - 2.0;\n  float time =\n    (t1 < 1.0) ? 0.5 * (t1 * t1 * (a1 + 1.0) * t1 - a1) :\n    0.5 * (t2 * t2 * ((a1 + 1.0) * t2 + a1) + 2.0)\n  ;\n\n  return (end - start) * time + start;\n}\n`;\n\nconst continuousSinusoidalGPU = `\n$\\{easingMethod} {\n  $\\{T} direction = end - start;\n  float amplitude = length(direction) * 2.0;\n  return start + direction * sin(t * ${GPU_PI} * 2.0) * amplitude;\n}\n`;\n\n/**\n * Class of base AutoEasingMethods as well as helper constructs for making the methods.\n */\nexport class AutoEasingMethod<T extends InstanceIOValue>\n  implements IAutoEasingMethod<T> {\n  /**\n   * Autoeasing methods for linear easing\n   */\n  static immediate<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (_start: T, end: T, _t: number) => end,\n      delay,\n      duration,\n      gpu: immediateGPU,\n      loop,\n      methodName: \"immediate\"\n    };\n  }\n\n  /**\n   * Autoeasing methods for linear easing\n   */\n  static linear<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        const { add, scale, subtract } = VecMath(start);\n        t = clamp(t, 0, 1);\n        return add(scale(subtract(end, start), t), start);\n      },\n      delay,\n      duration,\n      gpu: linearGPU,\n      loop,\n      methodName: \"linear\"\n    };\n  }\n\n  /**\n   * Auto easing for Accelerating to end\n   */\n  static easeInQuad<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const time = t * t;\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeInQuadGPU,\n      loop,\n      methodName: \"easeInQuad\"\n    };\n  }\n\n  /**\n   * Auto easing for decelerating to end\n   */\n  static easeOutQuad<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const time = t * (2 - t);\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeOutQuadGPU,\n      loop,\n      methodName: \"easeOutQuad\"\n    };\n  }\n\n  /**\n   * Auto easing for Accelerate to mid, then decelerate to end\n   */\n  static easeInOutQuad<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const time = t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeInOutQuadGPU,\n      loop,\n      methodName: \"easeInOutQuad\"\n    };\n  }\n\n  /**\n   * Auto easing for Slower acceleration\n   */\n  static easeInCubic<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const time = t * t * t;\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeInCubicGPU,\n      loop,\n      methodName: \"easeInCubic\"\n    };\n  }\n\n  /**\n   * Auto easing for Slower deceleration\n   */\n  static easeOutCubic<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const time = --t * t * t + 1;\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeOutCubicGPU,\n      loop,\n      methodName: \"easeOutCubic\"\n    };\n  }\n\n  /**\n   * Auto easing for Slower acceleration to mid, and slower deceleration to end\n   */\n  static easeInOutCubic<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const time =\n          t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeInOutCubicGPU,\n      loop,\n      methodName: \"easeInOutCubic\"\n    };\n  }\n\n  /**\n   * Auto easing for even Slower acceleration to end\n   */\n  static easeInQuart<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const time = t * t * t * t;\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeInQuartGPU,\n      loop,\n      methodName: \"easeInQuart\"\n    };\n  }\n\n  /**\n   * Auto easing for even Slower deceleration to end\n   */\n  static easeOutQuart<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const time = 1 - --t * t * t * t;\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeOutQuartGPU,\n      loop,\n      methodName: \"easeOutQuart\"\n    };\n  }\n\n  /**\n   * Auto easing for even Slower acceleration to mid, and even slower deceleration to end\n   */\n  static easeInOutQuart<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const time = t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t;\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeInOutQuartGPU,\n      loop,\n      methodName: \"easeInOutQuart\"\n    };\n  }\n\n  /**\n   * Auto easing for super slow accelerating to the end\n   */\n  static easeInQuint<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const time = t * t * t * t * t;\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeInQuintGPU,\n      loop,\n      methodName: \"easeInQuint\"\n    };\n  }\n\n  /**\n   * Auto easing for super slow decelerating to the end\n   */\n  static easeOutQuint<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const time = 1 + --t * t * t * t * t;\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeOutQuintGPU,\n      loop,\n      methodName: \"easeOutQuint\"\n    };\n  }\n\n  /**\n   * Auto easing for super slow accelerating to mid and super slow decelerating to the end\n   */\n  static easeInOutQuint<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const time =\n          t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeInOutQuintGPU,\n      loop,\n      methodName: \"easeInOutQuint\"\n    };\n  }\n\n  /**\n   * Auto easing for elastic effect\n   */\n  static easeOutElastic<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const p = 0.3;\n        const time = pow(2, -10 * t) * sin((t - p / 4) * (2 * PI) / p) + 1;\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeOutElasticGPU,\n      loop,\n      methodName: \"easeOutElastic\"\n    };\n  }\n\n  /**\n   * Auto easing for retracting first then shooting to the end\n   */\n  static easeBackIn<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const a = 1.05;\n        const time = t * t * t - t * a * sin(t * PI);\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeBackInGPU,\n      loop,\n      methodName: \"easeBackIn\"\n    };\n  }\n\n  /**\n   * Auto easing for overshooting at the end\n   */\n  static easeBackOut<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const a = 1.7;\n        const t1 = t - 1;\n        const time = t1 * t1 * ((a + 1) * t1 + a) + 1;\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeBackOutGPU,\n      loop,\n      methodName: \"easeBackOut\"\n    };\n  }\n\n  /**\n   * Auto easing for overshooting at the end\n   */\n  static easeBackInOut<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.NONE\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        t = clamp(t, 0, 1);\n        const a = 1.7;\n        const a1 = a * 1.525;\n        const t1 = t / 0.5;\n        const t2 = t1 - 2;\n        const time =\n          t1 < 1\n            ? 0.5 * (t1 * t1 * (a1 + 1) * t1 - a1)\n            : 0.5 * (t2 * t2 * ((a1 + 1) * t2 + a1) + 2);\n        const { add, scale, subtract } = VecMath(start);\n        return add(scale(subtract(end, start), time), start);\n      },\n      delay,\n      duration,\n      gpu: easeBackInOutGPU,\n      loop,\n      methodName: \"easeBackInOut\"\n    };\n  }\n\n  /**\n   * This is an easing method that performs a sinusoidal wave where the amplitude is\n   * (start - end) * 2 and the wave starts at the start value.\n   *\n   * This is intended to work best with the CONTINUOUS loop style.\n   */\n  static continuousSinusoidal<T extends Vec>(\n    duration: number,\n    delay: number = 0,\n    loop = AutoEasingLoopStyle.CONTINUOUS\n  ): IAutoEasingMethod<T> {\n    return {\n      uid: uid(),\n      cpu: (start: T, end: T, t: number) => {\n        const { add, length, scale, subtract } = VecMath(start);\n        t = clamp(t, 0, 1);\n        const direction = subtract(end, start);\n        const amplitude = length(direction) * 2.0;\n        return add(start, scale(direction, sin(t * PI * 2) * amplitude));\n      },\n      delay,\n      duration,\n      gpu: continuousSinusoidalGPU,\n      loop,\n      methodName: \"repeatingSinusoidal\",\n\n      // Since this is sinusoidial and operates off of a continuous time structure\n      validation: {\n        // When time = 1 our value will = start and NOT end\n        ignoreEndValueCheck: true,\n        // When the time is > 1 our value will not clamp to the value at 1.\n        ignoreOverTimeCheck: true\n      }\n    };\n  }\n\n  /** A uid for the easing method */\n  uid = uid();\n  /** The easing method for the cpu */\n  cpu: IAutoEasingMethod<T>[\"cpu\"];\n  /** Time before a delay  */\n  delay: number = 0;\n  /** The time in ms is takes to complete the animation */\n  duration: number = 500;\n  /** The easing method on the GPU */\n  gpu: IAutoEasingMethod<T>[\"gpu\"];\n  /** The looping style of the animation */\n  loop = AutoEasingLoopStyle.NONE;\n  /** Method name of the ease function on the gpu */\n  methodName: string;\n\n  constructor(\n    cpu: IAutoEasingMethod<T>[\"cpu\"],\n    gpu: IAutoEasingMethod<T>[\"gpu\"],\n    duration?: number,\n    method?: string\n  ) {\n    this.cpu = cpu;\n    this.gpu = gpu;\n    this.duration = duration || 500;\n    this.methodName = method || \"easingMethod\";\n  }\n}\n","import { GLSettings } from \"../gl/gl-settings\";\nimport { ILayerMaterialOptions } from \"../types\";\n\n/**\n * These are material options you may commonly see for handling various scenarios.\n */\nexport class CommonMaterialOptions {\n  /**\n   * Sets up blending for transparent shapes.\n   * Removes need for gl_FragColor.rgb *= gl_FragColor.a in shader.\n   */\n  static transparentShapeBlending: ILayerMaterialOptions = {\n    blending: {\n      blendDst: GLSettings.Material.BlendingDstFactor.OneMinusSrcAlpha,\n      blendEquation: GLSettings.Material.BlendingEquations.Add,\n      blendSrc: GLSettings.Material.BlendingSrcFactor.SrcAlpha\n    },\n    culling: GLSettings.Material.CullSide.NONE\n  };\n\n  /**\n   * Sets up blending for transparent images. This requires the image to be premultipled alpha.\n   * Removes need for texel.rgb *= texel.a; as it assumes the value is premultiplied.\n   */\n  static transparentImageBlending: ILayerMaterialOptions = {\n    blending: {\n      blendSrc: GLSettings.Material.BlendingSrcFactor.One,\n      blendDst: GLSettings.Material.BlendingDstFactor.OneMinusSrcAlpha,\n      blendEquation: GLSettings.Material.BlendingEquations.Add\n    },\n    culling: GLSettings.Material.CullSide.NONE\n  };\n}\n","module.exports = \"void main() {\\n  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\\n}\\n\"","module.exports = \"void main() {\\n  gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\\n}\\n\"","import { ShaderInjectionTarget } from \"../../types\";\nimport { ShaderModule } from \"../processing\";\n\nShaderModule.register([\n  {\n    moduleId: \"no-op\",\n    content: require(\"./shader-fragments/no-op.vs\"),\n    compatibility: ShaderInjectionTarget.VERTEX\n  },\n  {\n    moduleId: \"no-op\",\n    content: require(\"./shader-fragments/no-op.fs\"),\n    compatibility: ShaderInjectionTarget.FRAGMENT\n  }\n]);\n","module.exports = \"lowp vec4 setColor(vec4 color) {\\n  gl_FragColor = color;\\n  return gl_FragColor;\\n}\\n\"","module.exports = \"\\n\"","module.exports = \"// This contains the method required to be used on a fragment shader when a layer desires to use\\n// PickType.SINGLE (color picking).\\nvarying highp vec4 _picking_color_pass_;\\n\\nhighp vec4 setColor(vec4 color) {\\n  gl_FragColor = mix(color, _picking_color_pass_, pickingActive);\\n\\n  if (color.a == 0.0) {\\n    discard;\\n  }\\n\\n  return gl_FragColor;\\n}\\n\"","module.exports = \"// This is the varying auto generated for the fragment shader that is needed in the vertex shader to pass the\\n// color for the instance through to the fragment shader\\nvarying highp vec4 _picking_color_pass_;\\n\"","import { Layer } from \"../../surface/layer\";\nimport {\n  InstanceAttributeSize,\n  PickType,\n  ShaderInjectionTarget,\n  UniformSize\n} from \"../../types\";\nimport { ShaderModule } from \"../processing\";\n\nShaderModule.register([\n  {\n    moduleId: \"picking\",\n    content: require(\"./shader-fragments/picking.vs\"),\n    compatibility: ShaderInjectionTarget.VERTEX,\n\n    instanceAttributes: (_layer: Layer<any, any>) => [\n      {\n        name: \"_pickingColor\",\n        size: InstanceAttributeSize.FOUR,\n        update: o => {\n          // We start from white and move down so the colors are more visible\n          // For debugging\n          const color = 0xffffff - o.uid;\n\n          // Do bit maths do get float components out of the int color\n          return [\n            ((color & 0xff0000) >> 16) / 255.0,\n            ((color & 0x00ff00) >> 8) / 255.0,\n            (color & 0x0000ff) / 255.0,\n            1\n          ];\n        }\n      }\n    ],\n\n    uniforms: layer => [\n      {\n        name: \"pickingActive\",\n        shaderInjection: ShaderInjectionTarget.ALL,\n        size: UniformSize.ONE,\n        update: () => [\n          layer.picking.currentPickMode === PickType.SINGLE ? 1.0 : 0.0\n        ]\n      }\n    ]\n  },\n  {\n    moduleId: \"picking\",\n    content: require(\"./shader-fragments/picking.fs\"),\n    compatibility: ShaderInjectionTarget.FRAGMENT\n  },\n  {\n    moduleId: \"no-picking\",\n    content: require(\"./shader-fragments/no-picking.vs\"),\n    compatibility: ShaderInjectionTarget.VERTEX\n  },\n  {\n    moduleId: \"no-picking\",\n    content: require(\"./shader-fragments/no-picking.fs\"),\n    compatibility: ShaderInjectionTarget.FRAGMENT\n  }\n]);\n","module.exports = \"${import: PI, PI2}\\n\\n/**\\n * This is an approximation of sin that allows us to bypass hardware precision\\n * limitations for sin.\\n *\\n * http://lab.polygonal.de/2007/07/18/fast-and-accurate-sinecosine-approximation/\\n * This is a GPU adaptation of this method to provide optimal GPU performance for the operation\\n */\\nfloat fsin(float x) {\\n  float sine;\\n\\n  // Always wrap input angle to -PI..PI\\n  x += mix(\\n    mix(\\n      0.0,\\n      -PI2, float(x > PI)\\n    ),\\n    PI2, float(x < -PI)\\n  );\\n\\n  // Compute sine\\n  sine = 1.27323954 * x;\\n  sine += mix(-1.0, 1.0, float(x < 0.0)) * 0.405284735 * x * x;\\n  sine = 0.225 * (sine * (mix(1.0, -1.0, float(sine < 0.0)) * sine) - sine) + sine;\\n\\n  return sine;\\n}\\n\"","module.exports = \"${import: PI, PI2, PI_2}\\n\\n/**\\n * This is an approximation of cos that allows us to bypass hardware precision\\n * limitations for cos.\\n *\\n * http://lab.polygonal.de/2007/07/18/fast-and-accurate-sinecosine-approximation/\\n * This is a GPU adaptation of this method to provide optimal GPU performance for the operation\\n */\\nfloat fcos(float x) {\\n  float sine;\\n  // Cos is the same as sine but\\n  x += PI_2;\\n\\n  // Always wrap input angle to -PI..PI\\n  x += mix(\\n    mix(\\n      0.0,\\n      -PI2, float(x > PI)\\n    ),\\n    PI2, float(x < -PI)\\n  );\\n\\n  // Compute sine\\n  sine = 1.27323954 * x;\\n  sine += mix(-1.0, 1.0, float(x < 0.0)) * 0.405284735 * x * x;\\n  sine = 0.225 * (sine * (mix(1.0, -1.0, float(sine < 0.0)) * sine) - sine) + sine;\\n\\n  return sine;\\n}\\n\"","module.exports = \"${import: fsin, fcos}\\n\\n/**\\n * A circular arc interpolator\\n */\\nvec2 arc(float t, vec2 center, float radius, float start, float end) {\\n  float angle = (end - start) * t + start;\\n  return center + vec2(fcos(angle) * radius, fsin(angle) * radius);\\n}\\n\"","module.exports = \"/**\\n * Two control point bezier curve\\n */\\nvec2 bezier2(float t, vec2 p1, vec2 p2, vec2 c1, vec2 c2) {\\n  float t1 = 1.0 - t;\\n  return pow(t1, 3.0) * p1 + 3.0 * t * pow(t1, 2.0) * c1 + 3.0 * pow(t, 2.0) * t1 * c2 + pow(t, 3.0) * p2;\\n}\"","module.exports = \"/**\\n * Single control point bezier curve\\n */\\nvec2 bezier1(float t, vec2 p1, vec2 p2, vec2 c1) {\\n  return (1.0 - t) * (1.0 - t) * p1 + 2.0 * t * (1.0 - t) * c1 + t * t * p2;\\n}\\n\"","module.exports = \"float toRadians = 0.01745329252;\\n\"","module.exports = \"float toDegrees = 57.2957795131;\\n\"","module.exports = \"float PI2 = 6.2831853;\\n\"","module.exports = \"float PI = 3.14159265;\\n\"","module.exports = \"float PI_4 = 0.7853981634;\\n\"","module.exports = \"float PI_2 = 1.5707963268;\\n\"","import { ShaderInjectionTarget } from \"../../types\";\nimport { ShaderModule } from \"../processing\";\n\n// All of the constants fragments\nconst constants = [\n  {\n    moduleId: \"PI_2\",\n    content: require(\"./shader-fragments/constants/pi_2.vs\"),\n    compatibility: ShaderInjectionTarget.ALL\n  },\n  {\n    moduleId: \"PI_4\",\n    content: require(\"./shader-fragments/constants/pi_4.vs\"),\n    compatibility: ShaderInjectionTarget.ALL\n  },\n  {\n    moduleId: \"PI\",\n    content: require(\"./shader-fragments/constants/pi.vs\"),\n    compatibility: ShaderInjectionTarget.ALL\n  },\n  {\n    moduleId: \"PI2\",\n    content: require(\"./shader-fragments/constants/pi2.vs\"),\n    compatibility: ShaderInjectionTarget.ALL\n  },\n  {\n    moduleId: \"toDegrees\",\n    content: require(\"./shader-fragments/constants/to-degrees.vs\"),\n    compatibility: ShaderInjectionTarget.ALL\n  },\n  {\n    moduleId: \"toRadians\",\n    content: require(\"./shader-fragments/constants/to-radians.vs\"),\n    compatibility: ShaderInjectionTarget.ALL\n  }\n];\n\n// A bin import that let's you add all common constants to your shader\nconst allConstants = {\n  moduleId: \"constants\",\n  content: `$\\{import: ${constants.map(c => c.moduleId).join(\", \")}}`,\n  compatibility: ShaderInjectionTarget.ALL\n};\n\n// All of the mathematical methods\nconst methods = [\n  {\n    moduleId: \"bezier1\",\n    content: require(\"./shader-fragments/bezier1.vs\"),\n    compatibility: ShaderInjectionTarget.ALL\n  },\n  {\n    moduleId: \"bezier2\",\n    content: require(\"./shader-fragments/bezier2.vs\"),\n    compatibility: ShaderInjectionTarget.ALL\n  },\n  {\n    moduleId: \"arc\",\n    content: require(\"./shader-fragments/arc.vs\"),\n    compatibility: ShaderInjectionTarget.ALL\n  },\n  {\n    moduleId: \"fcos\",\n    content: require(\"./shader-fragments/fcos.vs\"),\n    compatibility: ShaderInjectionTarget.ALL\n  },\n  {\n    moduleId: \"fsin\",\n    content: require(\"./shader-fragments/fsin.vs\"),\n    compatibility: ShaderInjectionTarget.ALL\n  }\n];\n\n// Register all modules\nShaderModule.register([...methods, ...constants, allConstants]);\n","import { Instance } from \"../../instance-provider/instance\";\nimport { LayerBufferType } from \"../../surface/layer-processing/layer-buffer-type\";\nimport {\n  IInstanceAttribute,\n  InstanceAttributeSize,\n  ShaderInjectionTarget,\n  VertexAttributeSize\n} from \"../../types\";\nimport { ShaderModule } from \"../processing\";\n\n/**\n * This module contains the basic needs required to facilitate instancing for our shaders\n */\nShaderModule.register({\n  moduleId: \"instancing\",\n  content: \"\",\n  compatibility: ShaderInjectionTarget.ALL,\n\n  instanceAttributes: layer => {\n    // This is injected so the system can control when an instance should not be rendered.\n    // This allows for holes to be in the buffer without having to correct them immediately\n    const activeAttribute: IInstanceAttribute<Instance> = {\n      name: \"_active\",\n      size: InstanceAttributeSize.ONE,\n      update: o => [o.active ? 1 : 0]\n    };\n\n    // Set the active attribute to the layer for quick reference\n    layer.activeAttribute = activeAttribute;\n\n    return [activeAttribute];\n  },\n\n  vertexAttributes: layer => {\n    // Only the uniform buffering strategy requires instance information in it's vertex attributes\n    if (layer.bufferType === LayerBufferType.UNIFORM) {\n      return [\n        // We add an inherent instance attribute to our vertices so they can determine the instancing\n        // Data to retrieve.\n        {\n          name: \"instance\",\n          size: VertexAttributeSize.ONE,\n          // We no op this as our geometry generating routine will establish the values needed here\n          update: () => [0]\n        }\n      ];\n    }\n\n    return [];\n  }\n});\n","import { Layer } from \"../../surface/layer\";\nimport { ShaderInjectionTarget, UniformSize } from \"../../types\";\nimport { ShaderModule } from \"../processing\";\n\n/**\n * This module provides uniforms for retrieving camera propeerties within the shader.\n */\nShaderModule.register({\n  moduleId: \"frame\",\n  content: \"\",\n  compatibility: ShaderInjectionTarget.ALL,\n  uniforms: (layer: Layer<any, any>) => [\n    // This will be the current frame's current time which is updated in the layer's surface draw call\n    {\n      name: \"currentTime\",\n      size: UniformSize.ONE,\n      update: () => [layer.surface.frameMetrics.currentTime]\n    }\n  ]\n});\n","module.exports = \"// These are projection methods utilizing the simpler camera breakdown approach\\n${import: camera}\\n\\nvec3 cameraSpace(vec3 world) {\\n  return (world + cameraOffset) * cameraScale;\\n}\\n\\nvec3 cameraSpaceSize(vec3 worldSize) {\\n  return worldSize * cameraScale;\\n}\\n\\nvec4 clipSpace(vec3 world) {\\n  return vec4(((projection * modelView) * vec4(cameraSpace(world), 1.0)).xyz, 1.0);\\n}\\n\\nvec4 clipSpaceSize(vec3 worldSize) {\\n  return vec4(((projection * modelView) * vec4(cameraSpaceSize(worldSize), 0.0)).xyz, 1.0);\\n}\\n\"","import { Layer } from \"../../surface/layer\";\nimport { ShaderInjectionTarget, UniformSize } from \"../../types\";\nimport { ShaderModule } from \"../processing\";\n\n/**\n * This module provides uniforms for retrieving camera propeerties within the shader.\n */\nShaderModule.register([\n  {\n    moduleId: \"camera\",\n    content: \"\",\n    compatibility: ShaderInjectionTarget.ALL,\n    uniforms: (layer: Layer<any, any>) => [\n      // This injects the projection matrix from the view camera\n      {\n        name: \"projection\",\n        size: UniformSize.MATRIX4,\n        update: () => layer.view.viewCamera.baseCamera.projection\n      },\n      // This injects the model view matrix from the view camera\n      {\n        name: \"modelView\",\n        size: UniformSize.MATRIX4,\n        update: () => layer.view.viewCamera.baseCamera.view\n      },\n      // This injects the camera offset uniforms that need to be present for projecting in a more\n      // Chart centric style\n      {\n        name: \"cameraOffset\",\n        size: UniformSize.THREE,\n        update: () => layer.view.camera.offset\n      },\n      // This injects the camera scaling uniforms that need to be present for projecting in a more\n      // Chart centric style\n      {\n        name: \"cameraScale\",\n        size: UniformSize.THREE,\n        update: () => layer.view.camera.scale\n      },\n      // This injects the camera scaling uniforms that need to be present for projecting in a more\n      // Chart centric style\n      {\n        name: \"viewSize\",\n        size: UniformSize.TWO,\n        update: () => [\n          layer.view.viewBounds.width,\n          layer.view.viewBounds.height\n        ]\n      },\n      // This injects the current layer's pixel ratio so pixel ratio dependent items can react to it\n      // Things like gl_PointSize will need this metric if not working in clip space\n      {\n        name: \"pixelRatio\",\n        size: UniformSize.ONE,\n        update: () => [layer.view.pixelRatio]\n      }\n    ]\n  },\n  {\n    moduleId: \"projection\",\n    content: require(\"./shader-fragments/projection.vs\"),\n    compatibility: ShaderInjectionTarget.ALL\n  }\n]);\n","import \"./camera-metrics\";\nimport \"./frame-metrics\";\nimport \"./instancing\";\nimport \"./math-modules\";\nimport \"./picking\";\nimport \"./util-modules\";\n","import \"./base-modules\";\nexport * from \"./util/extend-shader\";\nexport * from \"./processing\";\n","export * from \"./layer-surface\";\nexport * from \"./event-manager\";\nexport * from \"./layer-processing/generate-default-scene\";\nexport * from \"./layer-processing/generate-layer-geometry\";\nexport * from \"./layer-processing/generate-layer-material\";\nexport * from \"./layer-processing/generate-layer-model\";\nexport * from \"./layer-processing/inject-shader-io\";\nexport * from \"./layer\";\nexport * from \"./mouse-event-manager\";\nexport * from \"./layer-scene\";\nexport * from \"./view\";\n","module.exports = \"precision highp float;\\n\\n${import: projection}\\n\\nvarying vec4 vertexColor;\\nvarying float edgeSharpness;\\nvarying float borderSize;\\nvarying vec2 pointCoord;\\n${extendHeader}\\n\\nvarying float scale;\\n\\nvoid main() {\\n  ${attributes}\\n\\n  scale = scaleFactor;\\n\\n  vertexColor = color;\\n  float size = radius * scaleFactor;\\n\\n  float ringWidth = mix(2.0 , thickness, float(thickness > 2.0));\\n\\n  borderSize = mix(\\n    (ringWidth) / size,\\n    ((ringWidth * pixelRatio) / size),\\n    float(pixelRatio > 1.0)\\n  );\\n\\n  edgeSharpness = min(0.2 / (ringWidth * scale),  0.1);\\n\\n  pointCoord = (normals.xy + vec2(1.0, 1.0)) / 2.0;\\n\\n  // Center within clip space\\n  vec4 clipCenter = clipSpace(vec3(center, depth));\\n  // Center in screen space\\n  vec2 screenCenter = (clipCenter.xy + vec2(1.0, 1.0)) * vec2(0.5, 0.5) * viewSize;\\n  // Position in screen space\\n  vec2 vertex = (normals.xy * size) + screenCenter;\\n  // Position back to clip space\\n  gl_Position = vec4((vertex / viewSize) * vec2(2.0, 2.0) - vec2(1.0, 1.0), clipCenter.zw);\\n  ${extend}\\n}\\n\"","module.exports = \"precision highp float;\\n\\n/** This is the color of the ring */\\nvarying vec4 vertexColor;\\n/**\\n * This is how sharp the ring renders. For tiny rings, it's best to have\\n * less sharpness to better convey the shape of a circle. A good starter setting:\\n * edgeSharpness = mix(0.8, 0.01, min(gl_PointSize / 45.0, 1.0));\\n */\\nvarying float edgeSharpness;\\n/**\\n * This should be a value that sets the thickness of the ring in normal space\\n * relative to the PointSize\\n */\\nvarying float borderSize;\\n/**\\n * Since this is now a quad instead of a point sprite, this provides what gl_PointCoord\\n * used to provide.\\n */\\nvarying vec2 pointCoord;\\n\\nvarying float scale;\\n\\nfloat circle(vec2 coord, float radius){\\n  vec2 dist = coord - vec2(0.5);\\n\\n  return 1.0 - smoothstep(\\n    radius - (radius * edgeSharpness),\\n    radius,\\n    dot(dist, dist) * 4.0\\n  );\\n\\n}\\n\\n${extendHeader}\\n\\nvoid main() {\\n  float outer_step_factor = circle(pointCoord, 1.0);\\n  float inner_step_factor = circle(pointCoord, 1.0 - borderSize * scale);\\n\\n  setColor(mix(\\n    mix(                        // Select the outer color outside of the inner radius\\n      vec4(0.0, 0.0, 0.0, 0.0),    // Select invisible outside of inner and outer radius\\n      vertexColor,                  // Select outer color outside of inner, but inside outer\\n      outer_step_factor\\n    ),\\n    vec4(0.0, 0.0, 0.0, 0.0),                 // Select inner color inside inner\\n    inner_step_factor\\n  ));\\n\\n  ${extend}\\n}\\n\"","import { InstanceProvider } from \"../../instance-provider\";\nimport { Bounds } from \"../../primitives\";\nimport { ILayerProps, Layer } from \"../../surface/layer\";\nimport {\n  ILayerMaterialOptions,\n  InstanceAttributeSize,\n  IProjection,\n  IShaderInitialization,\n  IUniform,\n  UniformSize,\n  VertexAttributeSize\n} from \"../../types\";\nimport {\n  CommonMaterialOptions,\n  dot2,\n  IAutoEasingMethod,\n  subtract2,\n  Vec,\n  Vec2\n} from \"../../util\";\nimport { RingInstance } from \"./ring-instance\";\nconst { max } = Math;\n\nexport interface IRingLayerProps<T extends RingInstance>\n  extends ILayerProps<T> {\n  /** This sets a scaling factor for the circle's radius */\n  scaleFactor?(): number;\n  animate?: {\n    color?: IAutoEasingMethod<Vec>;\n    center?: IAutoEasingMethod<Vec>;\n    radius?: IAutoEasingMethod<Vec>;\n  };\n}\n\n/**\n * This layer displays circles and provides as many controls as possible for displaying\n * them in interesting ways.\n */\nexport class RingLayer<\n  T extends RingInstance,\n  U extends IRingLayerProps<T>\n> extends Layer<T, U> {\n  static defaultProps: IRingLayerProps<RingInstance> = {\n    key: \"\",\n    data: new InstanceProvider<RingInstance>(),\n    scene: \"default\"\n  };\n\n  static attributeNames = {\n    center: \"center\",\n    radius: \"radius\",\n    depth: \"depth\",\n    color: \"color\",\n    thickness: \"thickness\"\n  };\n\n  /**\n   * We provide bounds and hit test information for the instances for this layer to allow for mouse picking\n   * of elements\n   */\n  getInstancePickingMethods() {\n    return {\n      // Provide the calculated AABB world bounds for a given circle\n      boundsAccessor: (ring: RingInstance) =>\n        new Bounds({\n          height: ring.radius * 2,\n          width: ring.radius * 2,\n          x: ring.center[0] - ring.radius,\n          y: ring.center[1] - ring.radius\n        }),\n\n      // Provide a precise hit test for the ring\n      hitTest: (ring: RingInstance, point: Vec2, view: IProjection) => {\n        const r = ring.radius / max(...view.camera.scale);\n        const delta = subtract2(point, ring.center);\n\n        return dot2(delta, delta) < r * r;\n      }\n    };\n  }\n\n  /**\n   * Define our shader and it's inputs\n   */\n  initShader(): IShaderInitialization<RingInstance> {\n    const scaleFactor = this.props.scaleFactor || (() => 1);\n    const animations = this.props.animate || {};\n    const {\n      color: animateColor,\n      center: animateCenter,\n      radius: animateRadius\n    } = animations;\n\n    const vertexToNormal: { [key: number]: number } = {\n      0: 1,\n      1: 1,\n      2: -1,\n      3: 1,\n      4: -1,\n      5: -1\n    };\n\n    const vertexToSide: { [key: number]: number } = {\n      0: -1,\n      1: -1,\n      2: -1,\n      3: 1,\n      4: 1,\n      5: 1\n    };\n\n    return {\n      fs: require(\"./ring-layer.fs\"),\n      instanceAttributes: [\n        {\n          easing: animateCenter,\n          name: RingLayer.attributeNames.center,\n          size: InstanceAttributeSize.TWO,\n          update: o => o.center\n        },\n        {\n          easing: animateRadius,\n          name: RingLayer.attributeNames.radius,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.radius]\n        },\n        {\n          name: RingLayer.attributeNames.depth,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.depth]\n        },\n        {\n          easing: animateColor,\n          name: RingLayer.attributeNames.color,\n          size: InstanceAttributeSize.FOUR,\n          update: o => o.color\n        },\n        {\n          name: RingLayer.attributeNames.thickness,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.thickness]\n        }\n      ],\n      uniforms: [\n        {\n          name: \"scaleFactor\",\n          size: UniformSize.ONE,\n          update: (_: IUniform) => [scaleFactor()]\n        }\n      ],\n      vertexAttributes: [\n        {\n          name: \"normals\",\n          size: VertexAttributeSize.TWO,\n          update: (vertex: number) => [\n            // Normal\n            vertexToNormal[vertex],\n            // The side of the quad\n            vertexToSide[vertex]\n          ]\n        }\n      ],\n      vertexCount: 6,\n      vs: require(\"./ring-layer.vs\")\n    };\n  }\n\n  getMaterialOptions(): ILayerMaterialOptions {\n    return CommonMaterialOptions.transparentShapeBlending;\n  }\n}\n","import { IInstanceOptions, Instance } from \"../../instance-provider/instance\";\nimport { observable } from \"../../instance-provider/observable\";\nimport { Vec2 } from \"../../util\";\n\nexport interface IRingInstanceOptions extends IInstanceOptions {\n  /** The center of the ring */\n  center?: Vec2;\n  /** The color of this ring */\n  color?: [number, number, number, number];\n  /** The z depth of the ring (for draw ordering) */\n  depth?: number;\n  /** The outer radius of the ring */\n  radius?: number;\n  /** The thickness of the ring */\n  thickness?: number;\n}\n\nexport class RingInstance extends Instance {\n  @observable color: [number, number, number, number] = [1.0, 1.0, 1.0, 1.0];\n  @observable depth: number = 0;\n  @observable radius: number = 0;\n  @observable thickness: number = 1;\n  @observable center: Vec2 = [0, 0];\n\n  constructor(options: IRingInstanceOptions) {\n    super(options);\n\n    this.color = options.color || this.color;\n    this.depth = options.depth || this.depth;\n    this.radius = options.radius || this.radius;\n    this.thickness = options.thickness || this.thickness;\n    this.center = options.center || this.center;\n  }\n\n  get width() {\n    return this.radius * 2;\n  }\n\n  get height() {\n    return this.radius * 2;\n  }\n\n  get innerRadius() {\n    return this.radius - this.thickness;\n  }\n}\n","export * from \"./ring-instance\";\nexport * from \"./ring-layer\";\n","import { observable } from \"../../instance-provider\";\nimport { IInstanceOptions, Instance } from \"../../instance-provider/instance\";\nimport { Anchor, AnchorType, ScaleMode } from \"../types\";\n\nexport interface IRectangleInstanceOptions extends IInstanceOptions {\n  /**\n   * The point on the rectangle which will be placed in world space via the x, y coords. This is also the point\n   * which the rectangle will be scaled around.\n   */\n  anchor?: Anchor;\n  /** Depth sorting of the rectangle (or the z value of the lable) */\n  depth?: number;\n  /** The height of the rectangle as it is to be rendered in world space */\n  height?: number;\n  /** Sets the way the rectangle scales with the world */\n  scaling?: ScaleMode;\n  /** The color the rectangle should render as */\n  color: [number, number, number, number];\n  /** The width of the rectangle as it is to be rendered in world space */\n  width?: number;\n  /** The x coordinate where the rectangle will be anchored to in world space */\n  x?: number;\n  /** The y coordinate where the rectangle will be anchored to in world space */\n  y?: number;\n}\n\n/**\n * This is a lookup to quickly find the proper calculation for setting the correct anchor\n * position based on the anchor type.\n */\nconst anchorCalculator: {\n  [key: number]: (anchor: Anchor, rectangle: RectangleInstance) => void;\n} = {\n  [AnchorType.TopLeft]: (anchor: Anchor, _rectangle: RectangleInstance) => {\n    anchor.x = -anchor.padding;\n    anchor.y = -anchor.padding;\n  },\n  [AnchorType.TopMiddle]: (anchor: Anchor, rectangle: RectangleInstance) => {\n    anchor.x = rectangle.width / 2.0;\n    anchor.y = -anchor.padding;\n  },\n  [AnchorType.TopRight]: (anchor: Anchor, rectangle: RectangleInstance) => {\n    anchor.x = rectangle.width + anchor.padding;\n    anchor.y = -anchor.padding;\n  },\n  [AnchorType.MiddleLeft]: (anchor: Anchor, rectangle: RectangleInstance) => {\n    anchor.x = -anchor.padding;\n    anchor.y = rectangle.height / 2;\n  },\n  [AnchorType.Middle]: (anchor: Anchor, rectangle: RectangleInstance) => {\n    anchor.x = rectangle.width / 2.0;\n    anchor.y = rectangle.height / 2.0;\n  },\n  [AnchorType.MiddleRight]: (anchor: Anchor, rectangle: RectangleInstance) => {\n    anchor.x = rectangle.width + anchor.padding;\n    anchor.y = rectangle.height / 2.0;\n  },\n  [AnchorType.BottomLeft]: (anchor: Anchor, rectangle: RectangleInstance) => {\n    anchor.x = -anchor.padding;\n    anchor.y = rectangle.height + anchor.padding;\n  },\n  [AnchorType.BottomMiddle]: (anchor: Anchor, rectangle: RectangleInstance) => {\n    anchor.x = rectangle.width / 2.0;\n    anchor.y = rectangle.height + anchor.padding;\n  },\n  [AnchorType.BottomRight]: (anchor: Anchor, rectangle: RectangleInstance) => {\n    anchor.x = rectangle.width + anchor.padding;\n    anchor.y = rectangle.height + anchor.padding;\n  },\n  [AnchorType.Custom]: (anchor: Anchor, _rectangle: RectangleInstance) => {\n    anchor.x = anchor.x || 0;\n    anchor.y = anchor.y || 0;\n  }\n};\n\n/**\n * This generates a new rectangle instance which will render a single line of text for a given layer.\n * There are restrictions surrounding rectangles due to texture sizes and rendering limitations.\n *\n * Currently, we only support rendering a rectangle via canvas, then rendering it to an Atlas texture\n * which is used to render to cards in the world for rendering. This is highly performant, but means:\n *\n * - Rectangles should only be so long.\n * - Multiline is not supported inherently\n * - Once a rectangle is constructed, only SOME properties can be altered thereafter\n *\n * A rectangle that is constructed can only have some properties set upon creating the rectangle and are locked\n * thereafter. The only way to modify them would be to destroy the rectangle, then construct a new rectangle\n * with the modifications. This has to deal with performance regarding rasterizing the rectangle\n */\nexport class RectangleInstance extends Instance {\n  /** This is the rendered color of the rectangle */\n  @observable color: [number, number, number, number] = [0, 0, 0, 1];\n  /** Depth sorting of the rectangle (or the z value of the lable) */\n  @observable depth: number = 0;\n  /** The height of the rectangle as it is to be rendered in world space */\n  @observable height: number = 1;\n  /** When in BOUND_MAX mode, this allows the rectangle to scale up beyond it's max size */\n  @observable maxScale: number = 1;\n  /** Scales the rectangle uniformly */\n  @observable scale: number = 1;\n  /** Sets the way the rectangle scales with the world */\n  @observable scaling: ScaleMode = ScaleMode.BOUND_MAX;\n  /** The width of the rectangle as it is to be rendered in world space */\n  @observable width: number = 1;\n  /** The x coordinate where the rectangle will be anchored to in world space */\n  @observable x: number = 0;\n  /** The y coordinate where the rectangle will be anchored to in world space */\n  @observable y: number = 0;\n\n  // These are properties that can be altered, but have side effects from being changed\n\n  /** This is the anchor location on the  */\n  @observable\n  private _anchor: Anchor = {\n    padding: 0,\n    type: AnchorType.TopLeft,\n    x: 0,\n    y: 0\n  };\n\n  constructor(options: IRectangleInstanceOptions) {\n    super(options);\n\n    this.depth = options.depth || this.depth;\n    this.color = options.color || this.color;\n    this.scaling = options.scaling || this.scaling;\n    this.x = options.x || this.x;\n    this.y = options.y || this.y;\n    this.width = options.width || 1;\n    this.height = options.height || 1;\n\n    // Make sure the anchor is set to the appropriate location\n    options.anchor && this.setAnchor(options.anchor);\n  }\n\n  get anchor() {\n    return this._anchor;\n  }\n\n  /**\n   * This applies a new anchor to this rectangle and properly determines it's anchor position on the rectangle\n   */\n  setAnchor(anchor: Anchor) {\n    const newAnchor = {\n      padding: anchor.padding || 0,\n      type: anchor.type,\n      x: anchor.x || 0,\n      y: anchor.y || 0\n    };\n\n    // Calculate the new anchors position values\n    anchorCalculator[newAnchor.type](newAnchor, this);\n    // Apply the anchor\n    this._anchor = newAnchor;\n  }\n}\n","module.exports = \"${import: projection}\\n\\nprecision highp float;\\n\\nvarying vec4 vertexColor;\\n${extendHeader}\\n\\nvoid main() {\\n  ${attributes}\\n\\n  // Determine final screen size of label\\n  vec3 screenSize = cameraSpaceSize(vec3(size * scale / scaleFactor / maxScale, 1.0));\\n\\n  // Test whether the label is larger on the screen than the font size\\n  bool largerOnScreen = screenSize.y > size.y || screenSize.x > size.x;\\n\\n  // Determines if a scale mode should be used or not for the vertex\\n  float useScaleMode = float(\\n    (\\n      scaling == 3.0 ||                  // NEVER mode - keep the image the same size always\\n      (largerOnScreen && scaling == 2.0) // BOUND_MAX mode - only if we're larger than the font size do we scale down\\n    ) &&\\n    scaling != 1.0                       // ALWAYS mode - the image stays completely in world space allowing it to scale freely\\n  );\\n\\n  // Correct aspect ratio. Sufficient fix for most applications.\\n  // Will need another solution in the case of:\\n  // (cameraScale y != cameraScale.x) && (cameraScale.x != 1 && cameraScale.y != 1)\\n\\n  // If zooms are unequal, assume one is filtered to be 1.0\\n  float unequalZooms = float(cameraScale.x != cameraScale.y);\\n\\n  vec2 adjustedSize = mix(\\n    size,\\n    (size * cameraScale.yx),\\n    unequalZooms\\n  );\\n\\n  // Destructure threejs's bug with the position requirement\\n  float normal = normals.x;\\n  float side = normals.y;\\n\\n  vec2 scaledAnchor = anchor * scale;\\n\\n  // Get the location of the anchor in world space\\n  vec2 worldAnchor = location + scaledAnchor;\\n\\n  vec2 adjustedAnchor = mix(\\n    scaledAnchor,\\n    (scaledAnchor * cameraScale.yx),\\n    unequalZooms\\n  );\\n\\n  // Get the position of the current vertex\\n  vec2 vertex = vec2(side, float(normal == 1.0)) * scale * adjustedSize + location - adjustedAnchor;\\n\\n  // See how scaled the size on screen will be from the actual height of the label\\n  float labelScreenScale = mix(\\n    screenSize.y / adjustedSize.y,\\n    screenSize.x / adjustedSize.x,\\n    float((cameraScale.x != 1.0))\\n  );\\n\\n  float currentScale = labelScreenScale * scale;\\n\\n  // If our screen rendering is larger than the size the label is supposed to be, then we automagically\\n  // scale down our label to stay the correct size, centered on the anchor point\\n  vec2 anchorToVertex = vertex - location;\\n\\n  // We now choose between keeping the same image size or keeping it in world space\\n  vertex = mix(\\n    // This option keeps the image size in world space\\n    vertex,\\n    // This option counters the scaling of the image on the screen keeping it a static size\\n    (anchorToVertex / labelScreenScale) + location,\\n    // This is the flag determining if a scale mode should be applied to the vertex\\n    useScaleMode\\n  );\\n\\n  // --Texture and Color\\n  // Apply the label's color as a tint to the label (all labels are rendered white to the base texture)\\n  vertexColor = color;\\n\\n  gl_Position = clipSpace(vec3(vertex, depth));\\n  ${extend}\\n}\\n\"","module.exports = \"precision highp float;\\n\\nvarying vec4 vertexColor;\\n${extendHeader}\\n\\nvoid main() {\\n  setColor(vertexColor);\\n  ${extend}\\n}\\n\"","import { InstanceProvider } from \"../../instance-provider\";\nimport { Bounds } from \"../../primitives\";\nimport { ILayerProps, Layer } from \"../../surface/layer\";\nimport {\n  ILayerMaterialOptions,\n  InstanceAttributeSize,\n  IProjection,\n  IShaderInitialization,\n  UniformSize,\n  VertexAttributeSize\n} from \"../../types\";\nimport { CommonMaterialOptions, divide2, subtract2, Vec2 } from \"../../util\";\nimport { ScaleMode } from \"../types\";\nimport { RectangleInstance } from \"./rectangle-instance\";\n\nconst { min, max } = Math;\n\nexport interface IRectangleLayerProps<T extends RectangleInstance>\n  extends ILayerProps<T> {\n  /** Scale factor determining the scale size of the rectangle */\n  scaleFactor?(): number;\n}\n\n/**\n * This layer displays Rectangles and provides as many controls as possible for displaying\n * them in interesting ways.\n */\nexport class RectangleLayer<\n  T extends RectangleInstance,\n  U extends IRectangleLayerProps<T>\n> extends Layer<T, U> {\n  static defaultProps: IRectangleLayerProps<RectangleInstance> = {\n    key: \"\",\n    data: new InstanceProvider<RectangleInstance>(),\n    scene: \"default\"\n  };\n\n  static attributeNames = {\n    anchor: \"anchor\",\n    color: \"color\",\n    depth: \"depth\",\n    location: \"location\",\n    maxScale: \"maxScale\",\n    scale: \"scale\",\n    scaling: \"scaling\",\n    size: \"size\"\n  };\n\n  /**\n   * We provide bounds and hit test information for the instances for this layer to allow for mouse picking\n   * of elements\n   */\n  getInstancePickingMethods() {\n    return {\n      // Provide the calculated AABB world bounds for a given rectangle\n      boundsAccessor: (rectangle: RectangleInstance) => {\n        const anchorEffect = [0, 0];\n\n        if (rectangle.anchor) {\n          anchorEffect[0] = rectangle.anchor.x || 0;\n          anchorEffect[1] = rectangle.anchor.y || 0;\n        }\n        const topLeft = [\n          rectangle.x - anchorEffect[0],\n          rectangle.y - anchorEffect[1]\n        ];\n\n        return new Bounds({\n          height: rectangle.height,\n          width: rectangle.width,\n          x: topLeft[0],\n          y: topLeft[1]\n        });\n      },\n\n      // Provide a precise hit test for the circle\n      hitTest: (\n        rectangle: RectangleInstance,\n        point: Vec2,\n        projection: IProjection\n      ) => {\n        // The bounds of the rectangle is in world space, but it does not account for the scale mode of the rectangle.\n        // Here, we will apply the scale mode testing to the rectangle\n        const maxScale = max(...projection.camera.scale);\n        const minScale = min(...projection.camera.scale);\n\n        // If we scale always then the rectangle stays within it's initial world bounds at all times\n        if (rectangle.scaling === ScaleMode.ALWAYS) {\n          return true;\n        } else if (rectangle.scaling === ScaleMode.BOUND_MAX) {\n          // If we scale with bound max, then when the camera zooms in, the bounds will shrink to keep the\n          // Rectangle the same size. If the camera zooms out then the bounds === the world bounds.\n          // We are zooming out. the bounds will stay within the world bounds\n          if (minScale <= 1 && maxScale <= 1) {\n            return true;\n          } else {\n            // We are zooming in. The bounds will shrink to keep the rectangle at max font size\n            // The location is within the world, but we reverse project the anchor spread\n            const anchorEffect = [0, 0];\n\n            if (rectangle.anchor) {\n              anchorEffect[0] = rectangle.anchor.x || 0;\n              anchorEffect[1] = rectangle.anchor.y || 0;\n            }\n\n            const topLeft = [\n              rectangle.x - anchorEffect[0] / maxScale,\n              rectangle.y - anchorEffect[1] / maxScale\n            ];\n\n            // Reverse project the size and we should be within the distorted world coordinates\n            return new Bounds({\n              height: rectangle.height / maxScale,\n              width: rectangle.width / maxScale,\n              x: topLeft[0],\n              y: topLeft[1]\n            }).containsPoint(point);\n          }\n        } else if (rectangle.scaling === ScaleMode.NEVER) {\n          // If we never allow the rectangle to scale, then the bounds will grow and shrink to counter the effects\n          // Of the camera zoom\n          // The location is within the world, but we reverse project the anchor spread\n          const anchorEffect: Vec2 = [0, 0];\n\n          if (rectangle.anchor) {\n            anchorEffect[0] = rectangle.anchor.x || 0;\n            anchorEffect[1] = rectangle.anchor.y || 0;\n          }\n\n          const topLeft = subtract2(\n            [rectangle.x, rectangle.y],\n            divide2(anchorEffect, projection.camera.scale)\n          );\n\n          const screenPoint = projection.worldToScreen(point);\n\n          // Reverse project the size and we should be within the distorted world coordinates\n          return new Bounds({\n            height: rectangle.height,\n            width: rectangle.width,\n            x: topLeft[0],\n            y: topLeft[1]\n          }).containsPoint(screenPoint);\n        }\n\n        return true;\n      }\n    };\n  }\n\n  /**\n   * Define our shader and it's inputs\n   */\n  initShader(): IShaderInitialization<RectangleInstance> {\n    const vertexToNormal: { [key: number]: number } = {\n      0: 1,\n      1: 1,\n      2: -1,\n      3: 1,\n      4: -1,\n      5: -1\n    };\n\n    const vertexToSide: { [key: number]: number } = {\n      0: 0,\n      1: 0,\n      2: 0,\n      3: 1,\n      4: 1,\n      5: 1\n    };\n\n    const { scaleFactor = () => 1 } = this.props;\n\n    return {\n      fs: require(\"./rectangle-layer.fs\"),\n      instanceAttributes: [\n        {\n          name: RectangleLayer.attributeNames.location,\n          size: InstanceAttributeSize.TWO,\n          update: o => [o.x, o.y]\n        },\n        {\n          name: RectangleLayer.attributeNames.anchor,\n          size: InstanceAttributeSize.TWO,\n          update: o => [o.anchor.x || 0, o.anchor.y || 0]\n        },\n        {\n          name: RectangleLayer.attributeNames.size,\n          size: InstanceAttributeSize.TWO,\n          update: o => [o.width, o.height]\n        },\n        {\n          name: RectangleLayer.attributeNames.depth,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.depth]\n        },\n        {\n          name: RectangleLayer.attributeNames.scaling,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.scaling]\n        },\n        {\n          name: RectangleLayer.attributeNames.color,\n          size: InstanceAttributeSize.FOUR,\n          update: o => o.color\n        },\n        {\n          name: RectangleLayer.attributeNames.scale,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.scale]\n        },\n        {\n          name: RectangleLayer.attributeNames.maxScale,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.maxScale]\n        }\n      ],\n      uniforms: [\n        {\n          name: \"scaleFactor\",\n          size: UniformSize.ONE,\n          update: _u => [scaleFactor()]\n        }\n      ],\n      vertexAttributes: [\n        {\n          name: \"normals\",\n          size: VertexAttributeSize.TWO,\n          update: (vertex: number) => [\n            // Normal\n            vertexToNormal[vertex],\n            // The side of the quad\n            vertexToSide[vertex]\n          ]\n        }\n      ],\n      vertexCount: 6,\n      vs: require(\"./rectangle-layer.vs\")\n    };\n  }\n\n  getMaterialOptions(): ILayerMaterialOptions {\n    return CommonMaterialOptions.transparentShapeBlending;\n  }\n}\n","export * from \"./rectangle-layer\";\nexport * from \"./rectangle-instance\";\n","import { observable } from \"../../instance-provider\";\nimport { IInstanceOptions, Instance } from \"../../instance-provider/instance\";\nimport { isWhiteSpace, Size } from \"../../types\";\nimport { Vec2 } from \"../../util\";\nimport { Anchor, AnchorType } from \"../types\";\nimport { GlyphInstance } from \"./glyph-instance\";\nimport { TextAreaInstance } from \"./text-area-instance\";\n\nexport interface ILabelInstanceOptions extends IInstanceOptions {\n  /**\n   * The point on the label which will be placed in world space via the x, y coords. This is also the point\n   * which the label will be scaled around.\n   */\n  anchor?: Anchor;\n  /** The color the label should render as */\n  color: [number, number, number, number];\n  /** Depth sorting of the label (or the z value of the label) */\n  depth?: number;\n  /** The font size of the label in px */\n  fontSize?: number;\n  /** When this is set labels will only draw the label up to this size. If below, the label will automatically truncate with ellipses */\n  maxWidth?: number;\n  /** When in BOUND_MAX mode, this allows the label to scale up beyond it's max size */\n  maxScale?: number;\n  /** Scales the label uniformly */\n  scale?: number;\n  /** The text rendered by this label*/\n  text: string;\n  /** The x coordinate where the label will be anchored to in world space */\n  origin: Vec2;\n  /**\n   * Special flag for the instance that will cause the instance to not render any glyphs but will ensure the label's\n   * Kerning is calculated.\n   */\n  preload?: boolean;\n\n  /** Event when the label is completely ready to render all of it's glyphs */\n  onReady?(instance: LabelInstance): void;\n}\n\n/**\n * This generates a new label instance which will render a single line of text for a given layer.\n * There are restrictions surrounding labels due to texture sizes and rendering limitations.\n */\nexport class LabelInstance extends Instance {\n  /** This is the rendered color of the label */\n  @observable color: [number, number, number, number] = [0, 0, 0, 1];\n  /** Depth sorting of the label (or the z value of the label) */\n  @observable depth: number = 0;\n  /**\n   * Font size in pixels. This causes scaling relative to the base font resource available.\n   * IE- If the font resource is rendered at 32 and this is 16, then the output rendering will\n   *     be glyphs that are 50% the size of the rendered glyph in the font map. This can cause\n   *     artefacts based on the rendering strategy used.\n   */\n  @observable fontSize: number = 12;\n  /** When in BOUND_MAX mode, this allows the label to scale up beyond it's max size */\n  @observable maxScale: number = 1;\n  /**\n   * This is the maximum width the label can take up. If this is exceeded the label gets truncated.\n   * A max width of 0 or less is unbounded and will not truncate the text. When a max width is specified,\n   * there will always be a minimum requirement to show ellipses which inevitably causes a min width to\n   * arise and is dependent on the font in use.\n   */\n  @observable maxWidth: number = 0;\n  /** The x coordinate where the label will be anchored to in world space */\n  @observable origin: Vec2 = [0, 0];\n  /** Scales the label uniformly */\n  @observable scale: number = 1.0;\n  /** The rendered text for the label. */\n  @observable text: string = \"\";\n\n  /** This executes when the label is finished waiting for it's glyphs to be ready to render */\n  onReady?: (label: LabelInstance) => void;\n  /** The text area this label is associated with (may NOT be associated at all) */\n  parentTextArea?: TextAreaInstance;\n  /**\n   * Special flag for the instance that will cause the instance to not render any glyphs but will ensure the label's\n   * Kerning is calculated.\n   */\n  preload: boolean = false;\n  /**\n   * After the label has been rendered, this will be populated with all of the glyphs that\n   * have been created for the label. Using this you can manipulate each character very easily.\n   *\n   * NOTE: it helps to use nextFrame() to wait for this to be populated after the label has been mounted.\n   */\n  glyphs: GlyphInstance[] = [];\n  /**\n   * After the label has been rendered, this will be populated with the calculated width and height of the\n   * label.\n   */\n  size: Size = [0, 0];\n\n  /**\n   * If a maxWidth is specified, there is a chance the text will be truncated.\n   * This provides the calculated truncated text. If not populated, then no truncation\n   * has happened.\n   */\n  truncatedText: string = \"\";\n\n  /** This is the anchor location relative to the label's render space */\n  @observable\n  anchor: Anchor = {\n    padding: 0,\n    paddingDirection: [0, 0],\n    type: AnchorType.TopLeft,\n    x: 0,\n    y: 0\n  };\n\n  constructor(options: ILabelInstanceOptions) {\n    super(options);\n\n    this.anchor = options.anchor || this.anchor;\n    this.color = options.color || this.color;\n    this.depth = options.depth || this.depth;\n    this.fontSize = options.fontSize || this.fontSize;\n    this.maxScale = options.maxScale || this.maxScale;\n    this.maxWidth = options.maxWidth || 0;\n    this.onReady = options.onReady;\n    this.origin = options.origin;\n    this.preload = options.preload || false;\n    this.scale = options.scale || this.scale;\n    this.text = options.text || this.text;\n  }\n\n  /**\n   * Looks for the subtext provided, then provides the glyphs for that subtext if any.\n   */\n  subTextGlyphs(text: string): GlyphInstance[] {\n    const glyphs: GlyphInstance[] = [];\n    const index = this.text.indexOf(text);\n    // The substring must exist within the text.\n    if (index < 0) return glyphs;\n    // Current glyph index we are at as white space does not receive a glyph.\n    let glyphIndex = 0;\n\n    for (\n      let i = 0, iMax = Math.min(this.text.length, index + text.length);\n      i < iMax;\n      ++i\n    ) {\n      if (!isWhiteSpace(this.text[i])) {\n        glyphIndex++;\n\n        if (i >= index) {\n          glyphs.push(this.glyphs[glyphIndex]);\n        }\n      }\n    }\n\n    return glyphs;\n  }\n\n  /**\n   * Trigger for when resources are prepped for this instance\n   */\n  resourceTrigger() {\n    // No triggers are needed for the label instance as it's a wrapper for glyphs.\n    // The only trigger needed is when the active flag is altered by the manager.\n  }\n}\n","module.exports = \"${import: projection}\\n\\nvarying vec4 vertexColor;\\nvarying vec2 texCoord;\\n\\nvoid main() {\\n  ${attributes}\\n\\n  // Calculate in the anchor, the origin, glyph offset, and the quad pushout to make our quad geometry\\n  vec2 pushOut = normals * glyphSize * fontScale;\\n  vec3 position = vec3(origin + padding - anchor + offset + pushOut, depth);\\n  gl_Position = clipSpace(position);\\n\\n  // Get the atlas position of the texture information\\n  texCoord = texture.xy + (texture.zw - texture.xy) * normals;\\n  // Apply the color of the glyph\\n  vertexColor = color * color.a;\\n}\\n\"","module.exports = \"varying vec4 vertexColor;\\nvarying vec2 texCoord;\\n\\nvoid main() {\\n  vec4 texColor = texture2D(fontMap, texCoord);\\n  if (texColor.r <= 0.0) discard;\\n  texColor.a = texColor.r;\\n  gl_FragColor = texColor * vertexColor;\\n}\\n\"","module.exports = \"${import: projection}\\n\\nvarying vec4 vertexColor;\\nvarying vec2 texCoord;\\n\\nvoid main() {\\n  ${attributes}\\n\\n  // Calculate in the anchor, the origin, glyph offset, and the quad pushout to make our quad geometry\\n  vec2 pushOut = normals * glyphSize * fontScale;\\n  vec3 position = vec3(origin + padding + (-anchor + offset + pushOut) / cameraScale.xy, depth);\\n  gl_Position = clipSpace(position);\\n\\n  // Get the atlas position of the texture information\\n  texCoord = texture.xy + (texture.zw - texture.xy) * normals;\\n  // Apply the color of the glyph\\n  vertexColor = color * color.a;\\n}\\n\"","module.exports = \"varying vec4 vertexColor;\\nvarying vec2 texCoord;\\n\\nvoid main() {\\n  vec4 texColor = texture2D(fontMap, texCoord);\\n  if (texColor.r <= 0.0) discard;\\n  texColor.a = texColor.r;\\n  gl_FragColor = texColor * vertexColor;\\n}\\n\"","module.exports = \"${import: projection}\\n\\nvarying vec4 vertexColor;\\nvarying vec2 texCoord;\\n\\nvoid main() {\\n  ${attributes}\\n\\n  vec2 scale = fontScale * cameraScale.xy;\\n  float maxScale = max(scale.x, scale.y);\\n  vec2 pushOut = normals * glyphSize * fontScale;\\n\\n  float vx = mix(\\n    (-anchor.x + offset.x + pushOut.x),\\n    (-anchor.x + offset.x + pushOut.x) / maxScale,\\n    float(scale.x >= 1.0)\\n  );\\n\\n  float vy = mix(\\n    (-anchor.y + offset.y + pushOut.y),\\n    (-anchor.y + offset.y + pushOut.y) / maxScale,\\n    float(scale.y >= 1.0)\\n  );\\n\\n  // Calculate in the anchor, the origin, glyph offset, and the quad pushout to make our quad geometry\\n  vec3 position = vec3(origin + padding + vec2(vx, vy), depth);\\n  gl_Position = clipSpace(position);\\n\\n  // Get the atlas position of the texture information\\n  texCoord = texture.xy + (texture.zw - texture.xy) * normals;\\n  // Apply the color of the glyph\\n  vertexColor = color * color.a;\\n}\\n\"","module.exports = \"varying vec4 vertexColor;\\nvarying vec2 texCoord;\\n\\nvoid main() {\\n  vec4 texColor = texture2D(fontMap, texCoord);\\n  if (texColor.r <= 0.0) discard;\\n  texColor.a = texColor.r;\\n  gl_FragColor = texColor * vertexColor;\\n}\\n\"","import { InstanceProvider } from \"../../instance-provider/instance-provider\";\nimport { Bounds } from \"../../primitives\";\nimport { fontRequest, IFontResourceRequest } from \"../../resources\";\nimport { KernedLayout } from \"../../resources/text/font-map\";\nimport { ILayerProps, Layer } from \"../../surface/layer\";\nimport {\n  createLayer,\n  ILayerConstructionClass,\n  LayerInitializer\n} from \"../../surface/layer-surface\";\nimport { InstanceDiffType, IProjection, ResourceType } from \"../../types\";\nimport { IAutoEasingMethod } from \"../../util/auto-easing-method\";\nimport {\n  copy2,\n  copy4,\n  divide2,\n  dot2,\n  scale2,\n  subtract2,\n  Vec,\n  Vec2\n} from \"../../util/vector\";\nimport { Anchor, AnchorType, ScaleMode } from \"../types\";\nimport { GlyphInstance } from \"./glyph-instance\";\nimport { GlyphLayer, IGlyphLayerOptions } from \"./glyph-layer\";\nimport { LabelInstance } from \"./label-instance\";\n\n/**\n * Default characters for truncating a label.\n */\nconst DEFAULT_TRUNCATION = \"...\";\n\n/**\n * This is a lookup to quickly find the proper calculation for setting the correct anchor\n * position based on the anchor type.\n */\nconst anchorCalculator: {\n  [key: number]: (anchor: Anchor, label: LabelInstance) => void;\n} = {\n  [AnchorType.TopLeft]: (anchor: Anchor, _label: LabelInstance) => {\n    anchor.x = 0;\n    anchor.y = 0;\n  },\n  [AnchorType.TopMiddle]: (anchor: Anchor, label: LabelInstance) => {\n    anchor.x = label.size[0] / 2.0;\n    anchor.y = 0;\n  },\n  [AnchorType.TopRight]: (anchor: Anchor, label: LabelInstance) => {\n    anchor.x = label.size[0];\n    anchor.y = 0;\n  },\n  [AnchorType.MiddleLeft]: (anchor: Anchor, label: LabelInstance) => {\n    anchor.x = 0;\n    anchor.y = label.size[1] / 2;\n  },\n  [AnchorType.Middle]: (anchor: Anchor, label: LabelInstance) => {\n    anchor.x = label.size[0] / 2.0;\n    anchor.y = label.size[1] / 2.0;\n  },\n  [AnchorType.MiddleRight]: (anchor: Anchor, label: LabelInstance) => {\n    anchor.x = label.size[0];\n    anchor.y = label.size[1] / 2.0;\n  },\n  [AnchorType.BottomLeft]: (anchor: Anchor, label: LabelInstance) => {\n    anchor.x = 0;\n    anchor.y = label.size[1];\n  },\n  [AnchorType.BottomMiddle]: (anchor: Anchor, label: LabelInstance) => {\n    anchor.x = label.size[0] / 2.0;\n    anchor.y = label.size[1];\n  },\n  [AnchorType.BottomRight]: (anchor: Anchor, label: LabelInstance) => {\n    anchor.x = label.size[0];\n    anchor.y = label.size[1];\n  },\n  [AnchorType.Custom]: (anchor: Anchor, _label: LabelInstance) => {\n    anchor.x = anchor.x || 0;\n    anchor.y = anchor.y || 0;\n  }\n};\n\nconst directions: Vec2[] = [\n  [-1, -1],\n  [0, -1],\n  [1, -1],\n  [-1, 0],\n  [0, 0],\n  [1, 0],\n  [-1, 1],\n  [0, 1],\n  [1, 1]\n].map((dir: Vec2) => {\n  const mag = Math.sqrt(dot2(dir, dir));\n  return scale2(dir, 1 / -mag);\n});\n\n/**\n * Lookup to quickly calculate the padding direction based on the the provided anchor type.\n */\nconst paddingCalculator: {\n  [key: number]: (anchor: Anchor) => void;\n} = {\n  [AnchorType.TopLeft]: (anchor: Anchor) => {\n    anchor.paddingDirection = scale2(directions[0], anchor.padding);\n  },\n  [AnchorType.TopMiddle]: (anchor: Anchor) => {\n    anchor.paddingDirection = scale2(directions[1], anchor.padding);\n  },\n  [AnchorType.TopRight]: (anchor: Anchor) => {\n    anchor.paddingDirection = scale2(directions[2], anchor.padding);\n  },\n  [AnchorType.MiddleLeft]: (anchor: Anchor) => {\n    anchor.paddingDirection = scale2(directions[3], anchor.padding);\n  },\n  [AnchorType.Middle]: (anchor: Anchor) => {\n    anchor.paddingDirection = [0, 0];\n  },\n  [AnchorType.MiddleRight]: (anchor: Anchor) => {\n    anchor.paddingDirection = scale2(directions[5], anchor.padding);\n  },\n  [AnchorType.BottomLeft]: (anchor: Anchor) => {\n    anchor.paddingDirection = scale2(directions[6], anchor.padding);\n  },\n  [AnchorType.BottomMiddle]: (anchor: Anchor) => {\n    anchor.paddingDirection = scale2(directions[7], anchor.padding);\n  },\n  [AnchorType.BottomRight]: (anchor: Anchor) => {\n    anchor.paddingDirection = scale2(directions[8], anchor.padding);\n  },\n  [AnchorType.Custom]: (anchor: Anchor) => {\n    anchor.paddingDirection = anchor.paddingDirection;\n  }\n};\n\n/**\n * Constructor props for making a new label layer\n */\nexport interface ILabelLayerProps<T extends LabelInstance>\n  extends ILayerProps<T> {\n  /** Animation methods for various properties of the glyphs */\n  animate?: {\n    anchor?: IAutoEasingMethod<Vec>;\n    color?: IAutoEasingMethod<Vec>;\n    offset?: IAutoEasingMethod<Vec>;\n    origin?: IAutoEasingMethod<Vec>;\n  };\n  /** A custom layer to handle rendering glyph instances */\n  customGlyphLayer?: ILayerConstructionClass<\n    GlyphInstance,\n    IGlyphLayerOptions<GlyphInstance>\n  >;\n  /** String identifier of the resource font to use for the layer */\n  resourceKey?: string;\n  /** The scaling strategy the labels will use wheh scaling the scene up and down */\n  scaleMode?: ScaleMode;\n  /**\n   * This defines what characters to use to indicate truncation of labels when needed. This\n   * defaults to ellipses or three periods '...'\n   */\n  truncation?: string;\n}\n\n/**\n * This is a composite layer that will take in and manage Label Instances. The true instance\n * that will be rendered as a result of a Label Instance will simply be Glyph Instances. Hence\n * this is a composite layer that is merely a manager to split up the label's requested string\n * into Glyphs to render.\n */\nexport class LabelLayer<\n  T extends LabelInstance,\n  U extends ILabelLayerProps<T>\n> extends Layer<T, U> {\n  static defaultProps: ILabelLayerProps<LabelInstance> = {\n    key: \"\",\n    data: new InstanceProvider<LabelInstance>(),\n    scene: \"default\"\n  };\n\n  /** Provider for the glyph layer this layer manages */\n  glyphProvider = new InstanceProvider<GlyphInstance>();\n  /**\n   * These are the property ids for the instances that we need to know when they changed so we can adjust\n   * the underlying glyphs.\n   */\n  propertyIds: { [key: string]: number } | undefined;\n  /**\n   * When this is flagged, we must do a complete recomputation of all our label's glyphs positions and kernings.\n   * This event really only takes place when the font resource changes.\n   */\n  fullUpdate: boolean = false;\n  /**\n   * Tracks all assigned glyphs for the given label.\n   */\n  labelToGlyphs = new Map<LabelInstance, GlyphInstance[]>();\n  /**\n   * This maps a label to it's request made for all of the kerning information needed for the label.\n   */\n  labelToKerningRequest = new Map<LabelInstance, IFontResourceRequest>();\n  /**\n   * This stores all of the glyphs the label is waiting on to fire the onReady event.\n   */\n  labelWaitingOnGlyph = new Map<LabelInstance, Set<GlyphInstance>>();\n  /**\n   * This stores the kerning request for the truncation characters.\n   */\n  truncationKerningRequest?: IFontResourceRequest;\n  /**\n   * This is the width of the truncation glyphs.\n   */\n  truncationWidth: number = -1;\n\n  /**\n   * We provide bounds and hit test information for the instances for this layer to allow for mouse picking\n   * of elements\n   */\n  getInstancePickingMethods() {\n    return {\n      // Provide the calculated AABB world bounds for a given image\n      boundsAccessor: (label: T) => {\n        const anchorEffect: Vec2 = [0, 0];\n\n        if (label.anchor) {\n          anchorEffect[0] = label.anchor.x || 0;\n          anchorEffect[1] = label.anchor.y || 0;\n        }\n\n        const topLeft = subtract2(label.origin, anchorEffect);\n\n        return new Bounds({\n          height: label.size[1],\n          width: label.size[0],\n          x: topLeft[0],\n          y: topLeft[1]\n        });\n      },\n\n      // Provide a precise hit test for the circle\n      hitTest: (label: T, point: Vec2, view: IProjection) => {\n        // If we never allow the image to scale, then the bounds will grow and shrink to counter the effects\n        // Of the camera zoom\n        // The location is within the world, but we reverse project the anchor spread\n        const anchorEffect: Vec2 = [0, 0];\n\n        if (label.anchor) {\n          anchorEffect[0] = label.anchor.x || 0;\n          anchorEffect[1] = label.anchor.y || 0;\n        }\n\n        const topLeft = view.worldToScreen(\n          subtract2(label.origin, divide2(anchorEffect, view.camera.scale))\n        );\n\n        const screenPoint = view.worldToScreen(point);\n\n        // Reverse project the size and we should be within the distorted world coordinates\n        const bounds = new Bounds({\n          height: label.size[1],\n          width: label.size[0],\n          x: topLeft[0],\n          y: topLeft[1]\n        });\n\n        return bounds.containsPoint(screenPoint);\n      }\n    };\n  }\n\n  /**\n   * This provides the child layers that will render on behalf of this layer.\n   *\n   * For Labels, a label is simply a group of well placed glyphs. So we defer all of\n   * the labels changes by converting the label into glyphs and applying the changes to\n   * it's set of glyphs.\n   */\n  childLayers(): LayerInitializer[] {\n    return [\n      createLayer(this.props.customGlyphLayer || GlyphLayer, {\n        animate: this.props.animate,\n        data: this.glyphProvider,\n        key: `${this.id}.glyphs`,\n        resourceKey: this.props.resourceKey,\n        scene: this.props.scene,\n        scaleMode: this.props.scaleMode || ScaleMode.BOUND_MAX\n      })\n    ];\n  }\n\n  /**\n   * We override the draw method of the layer to handle the diffs of the provider in a\n   * custom fashion by delegating the changes of the provider to the child layers.\n   */\n  draw() {\n    // Retrieve changes properly\n    const changes = this.resolveChanges();\n    // No changes, nothing to be done\n    if (changes.length <= 0) return;\n\n    // Make sure our instance property ids are established for the instance type involved\n    // We want only the ids of changes that causes us to\n    if (!this.propertyIds) {\n      const instance = changes[0][0];\n      this.propertyIds = this.getInstanceObservableIds(instance, [\n        \"text\",\n        \"active\",\n        \"anchor\",\n        \"color\",\n        \"origin\",\n        \"fontSize\",\n        \"maxWidth\"\n      ]);\n    }\n\n    const {\n      text: textId,\n      active: activeId,\n      anchor: anchorId,\n      color: colorId,\n      origin: originId,\n      fontSize: fontSizeId,\n      maxWidth: maxWidthId\n    } = this.propertyIds;\n\n    for (let i = 0, iMax = changes.length; i < iMax; ++i) {\n      const [instance, diffType, changed] = changes[i];\n\n      switch (diffType) {\n        case InstanceDiffType.CHANGE:\n          // Perform the insert action instead of the change if the label has never been registered\n          if (!this.labelToGlyphs.get(instance)) {\n            this.insert(instance);\n            continue;\n          }\n\n          // If text was changed, the glyphs all need updating of their characters and\n          // possibly have glyphs added or removed to handle the issue.\n          if (changed[textId] !== undefined) {\n            this.invalidateRequest(instance);\n            this.layoutGlyphs(instance);\n          } else if (changed[activeId] !== undefined) {\n            if (instance.active) {\n              this.layoutGlyphs(instance);\n              this.showGlyphs(instance);\n            } else {\n              this.hideGlyphs(instance);\n            }\n          }\n\n          if (changed[anchorId]) {\n            this.updateAnchor(instance);\n          }\n\n          if (changed[colorId] !== undefined) {\n            this.updateGlyphColors(instance);\n          }\n\n          if (changed[originId] !== undefined) {\n            this.updateGlyphOrigins(instance);\n          }\n\n          if (changed[fontSizeId] !== undefined) {\n            this.invalidateRequest(instance);\n            this.layoutGlyphs(instance);\n          }\n\n          if (changed[maxWidthId] !== undefined) {\n            this.invalidateRequest(instance);\n            this.layoutGlyphs(instance);\n          }\n          break;\n\n        case InstanceDiffType.INSERT:\n          this.insert(instance);\n          break;\n\n        case InstanceDiffType.REMOVE:\n          const glyphs = this.labelToGlyphs.get(instance);\n\n          if (glyphs) {\n            for (let i = 0, iMax = glyphs.length; i < iMax; ++i) {\n              this.glyphProvider.remove(glyphs[i]);\n            }\n\n            this.labelToGlyphs.delete(instance);\n            this.labelToKerningRequest.delete(instance);\n            this.labelWaitingOnGlyph.delete(instance);\n          }\n          break;\n      }\n    }\n  }\n\n  /**\n   * Handles first insertion operation for the label\n   */\n  private insert(instance: T) {\n    // Our management flag is dependent on if the label has glyph storage or not\n    if (!instance.preload) {\n      const storage = this.labelToGlyphs.get(instance);\n      if (!storage) this.labelToGlyphs.set(instance, []);\n    }\n\n    // Make sure the instance is removed from the provider for preloads\n    else {\n      this.props.data.remove(instance);\n    }\n\n    // Insertions force a full update of all glyphs for the label\n    this.layoutGlyphs(instance);\n  }\n\n  /**\n   * When the glyph is ready to render this executes.\n   */\n  handleGlyphReady = (glyph: GlyphInstance) => {\n    // The glyph must be associated to have this work\n    if (!glyph.parentLabel) {\n      // If no parent label, we should not have this glyph returningfalse alarms to this method\n      delete glyph.onReady;\n\n      return;\n    }\n\n    // Get the label this glyph is a part of\n    const label = glyph.parentLabel;\n    // Get the list of glyphs the label is waiting on.\n    const waiting = this.labelWaitingOnGlyph.get(glyph.parentLabel);\n\n    if (!waiting) {\n      return;\n    }\n\n    // Clear this glyph from the waiting list\n    if (waiting.has(glyph)) {\n      waiting.delete(glyph);\n\n      if (waiting.size <= 0) {\n        // If the waiting list is empty we can get the label to execute it's ready handler\n        const onReady = label.onReady;\n        // Execute the callback if present\n        if (onReady) onReady(label);\n      }\n    }\n  };\n\n  /**\n   * Unmounts all of the glyphs that make the lable\n   */\n  hideGlyphs(instance: T) {\n    const glyphs = this.labelToGlyphs.get(instance);\n    if (!glyphs) return;\n\n    for (let i = 0, iMax = glyphs.length; i < iMax; ++i) {\n      this.glyphProvider.remove(glyphs[i]);\n    }\n  }\n\n  /**\n   * Tell the system this layer is not providing any rendering IO information for the GPU to render.\n   */\n  initShader() {\n    return null;\n  }\n\n  /**\n   * This invalidates the request for the instance thus requiring a new request to be made\n   * to trigger the layout of the label.\n   */\n  invalidateRequest(instance: T) {\n    this.labelToKerningRequest.delete(instance);\n  }\n\n  /**\n   * This uses calculated kerning information to place the glyph relative to it's left character neighbor.\n   * The first glyph will use metrics of the glyphs drop down amount to determine where the glyph\n   * will be placed.\n   */\n  layoutGlyphs(instance: T) {\n    // Make sure the kerning is ready\n    if (!this.updateKerning(instance)) return;\n    // Instance must be active\n    if (!instance.active) return;\n    // Get the kerning request for the instance\n    const kerningRequest = this.labelToKerningRequest.get(instance);\n    // We must have kerning calculated for the instance to be valid for laying out the glyphs\n    if (!kerningRequest || !kerningRequest.fontMap) return;\n    // See if our request provided the metrics for the text yet\n    const requestMetrics = kerningRequest.metrics;\n    if (!requestMetrics || !requestMetrics.layout) return;\n\n    // Get the layout that will be used for the request\n    const layout = requestMetrics.layout;\n    // Update the glyphs based on the provided layout\n    this.updateGlyphs(instance, layout);\n    // Get the glyphs of the label\n    const glyphs = instance.glyphs;\n    // Store the calculated size of the label\n    instance.size = layout.size;\n    // Update the calculated anchor for the label now that size is determined\n    anchorCalculator[instance.anchor.type](instance.anchor, instance);\n    paddingCalculator[instance.anchor.type](instance.anchor);\n\n    const anchor = instance.anchor;\n    const padding = instance.anchor.paddingDirection;\n\n    // Apply the offsets calculated to each glyph\n    for (\n      let i = 0, iMax = Math.min(layout.positions.length, glyphs.length);\n      i < iMax;\n      ++i\n    ) {\n      const offset = layout.positions[i];\n      const glyph = glyphs[i];\n\n      glyph.offset = offset;\n      glyph.fontScale = layout.fontScale;\n      glyph.anchor = [anchor.x || 0, anchor.y || 0];\n      glyph.origin = copy2(instance.origin);\n      glyph.padding = padding || [0, 0];\n    }\n  }\n\n  /**\n   * This layer does not have or use a buffer manager thus it must track management of an instance\n   * in it's own way.\n   */\n  managesInstance(instance: T) {\n    return Boolean(this.labelToGlyphs.get(instance));\n  }\n\n  /**\n   * This makes a label's glyphs visible by adding them to the glyph layer rendering the glyphs.\n   */\n  showGlyphs(instance: T) {\n    const glyphs = this.labelToGlyphs.get(instance);\n    if (!glyphs) return;\n\n    for (let i = 0, iMax = glyphs.length; i < iMax; ++i) {\n      this.glyphProvider.add(glyphs[i]);\n    }\n  }\n\n  /**\n   * Updates the anchor position of the instance when set\n   */\n  updateAnchor(instance: T) {\n    const glyphs = instance.glyphs;\n    if (!glyphs) return;\n\n    anchorCalculator[instance.anchor.type](instance.anchor, instance);\n    paddingCalculator[instance.anchor.type](instance.anchor);\n\n    const anchor = instance.anchor;\n    const padding = instance.anchor.paddingDirection;\n\n    for (let i = 0, iMax = glyphs.length; i < iMax; ++i) {\n      glyphs[i].anchor = [anchor.x || 0, anchor.y || 0];\n      glyphs[i].padding = padding || [0, 0];\n    }\n  }\n\n  /**\n   * This ensures the correct number of glyphs is being provided for the label indicated.\n   */\n  updateGlyphs(instance: T, layout: KernedLayout) {\n    // Get the current glyphs rendering for the label\n    let currentGlyphs = this.labelToGlyphs.get(instance);\n\n    // Make sure we have glyph storage\n    if (!currentGlyphs) {\n      currentGlyphs = [];\n      this.labelToGlyphs.set(instance, currentGlyphs);\n    }\n\n    // Get the current list of glyphs in the waiting queue\n    let waiting = this.labelWaitingOnGlyph.get(instance);\n\n    if (!waiting) {\n      waiting = new Set();\n      this.labelWaitingOnGlyph.set(instance, waiting);\n    }\n\n    // Update the character used by existing glyphs\n    for (\n      let i = 0, iMax = Math.min(currentGlyphs.length, layout.glyphs.length);\n      i < iMax;\n      ++i\n    ) {\n      const glyph = currentGlyphs[i];\n\n      if (glyph.character !== layout.glyphs[i]) {\n        glyph.character = layout.glyphs[i];\n\n        if (\n          !glyph.request ||\n          !glyph.request.fontMap ||\n          !glyph.request.fontMap.glyphMap[glyph.character]\n        ) {\n          waiting.add(glyph);\n        }\n      }\n    }\n\n    // Make any missing glyphs\n    if (currentGlyphs.length < layout.glyphs.length) {\n      let sourceIndex = 0;\n\n      for (\n        let i = currentGlyphs.length, iMax = layout.glyphs.length;\n        i < iMax;\n        ++i, ++sourceIndex\n      ) {\n        const char = layout.glyphs[i];\n        const glyph = new GlyphInstance({\n          character: char,\n          color: instance.color,\n          origin: instance.origin,\n          onReady: this.handleGlyphReady\n        });\n\n        glyph.parentLabel = instance;\n        currentGlyphs.push(glyph);\n\n        if (instance.active) {\n          this.glyphProvider.add(glyph);\n        }\n\n        waiting.add(glyph);\n      }\n    }\n\n    // Remove excess glyphs\n    else if (currentGlyphs.length > layout.glyphs.length) {\n      for (\n        let i = layout.glyphs.length, iMax = currentGlyphs.length;\n        i < iMax;\n        ++i\n      ) {\n        const glyph = currentGlyphs[i];\n        this.glyphProvider.remove(glyph);\n      }\n\n      // Remove the glyphs from the list the label utilizes\n      while (currentGlyphs.length > layout.glyphs.length) currentGlyphs.pop();\n    }\n\n    // Update the list of glyphs that are utilized for the label's rendering\n    instance.glyphs = currentGlyphs;\n  }\n\n  /**\n   * Updates the glyph colors to match the label's glyph colors\n   */\n  updateGlyphColors(instance: T) {\n    const glyphs = instance.glyphs;\n    if (!glyphs) return;\n\n    for (let i = 0, iMax = glyphs.length; i < iMax; ++i) {\n      glyphs[i].color = copy4(instance.color);\n    }\n  }\n\n  /**\n   * This updates all of the glyphs for the label to have the same position\n   * as the label.\n   */\n  updateGlyphOrigins(instance: T) {\n    const glyphs = instance.glyphs;\n    if (!glyphs) return;\n    const origin = instance.origin;\n\n    for (let i = 0, iMax = glyphs.length; i < iMax; ++i) {\n      glyphs[i].origin = [origin[0], origin[1]];\n    }\n  }\n\n  /**\n   * Checks the label to ensure calculated kerning supports the text specified.\n   *\n   * Returns true when the kerning information is already available\n   */\n  updateKerning(instance: T) {\n    // A change in glyphs requires a potential kerning request\n    let labelKerningRequest = this.labelToKerningRequest.get(instance);\n    // This is the text the label will be making for the request\n    const checkText = instance.text;\n\n    // If we have the label kerning request, we should check to see if the font map\n    // supports the contents of the label.\n    if (labelKerningRequest) {\n      // If the request already embodies the request for the text, we just see if the\n      // font map has been provided yet to indicate if the kerning information is ready\n      if (\n        labelKerningRequest.kerningPairs &&\n        labelKerningRequest.kerningPairs.indexOf(checkText) > -1\n      ) {\n        return Boolean(labelKerningRequest.fontMap);\n      }\n\n      // If the request exists for a different text, and the font map does not support\n      // the kerning needs of the text, then we must make a new request.\n      if (\n        labelKerningRequest.fontMap &&\n        !labelKerningRequest.fontMap.supportsKerning(\n          checkText.replace(/\\s/g, \"\")\n        )\n      ) {\n        this.labelToKerningRequest.delete(instance);\n        labelKerningRequest = undefined;\n      }\n\n      // Otherwise, nothing needs to happen and we can use the font map for kerning information\n      else {\n        return true;\n      }\n    }\n\n    // If no request is present we must make one\n    if (!labelKerningRequest) {\n      const metrics: IFontResourceRequest[\"metrics\"] = {\n        // We want the request to return all of the metrics for the text as well\n        fontSize: instance.fontSize,\n        text: instance.text\n      };\n\n      // Include truncation metrics if the text needs it\n      if (instance.maxWidth > 0) {\n        metrics.maxWidth = instance.maxWidth;\n        metrics.truncation = this.props.truncation || DEFAULT_TRUNCATION;\n      }\n\n      // Make the request for retrieving the kerning information.\n      labelKerningRequest = fontRequest({\n        character: \"\",\n        kerningPairs: [checkText],\n        metrics\n      });\n\n      // In order for the glyphs to be laid out, we need the font map to get the kerning information.\n      // So we send out a request to the font manager for the resource.\n      // Once the kerning information has been retrieved, the label active property will be triggered\n      // to true.\n      if (!instance.preload) {\n        this.resource.request(this, instance, labelKerningRequest, {\n          resource: {\n            type: ResourceType.FONT,\n            key: this.props.resourceKey || \"\"\n          }\n        });\n\n        this.labelToKerningRequest.set(instance, labelKerningRequest);\n      }\n\n      // For preload labels, simply make the request, but modify the resource trigger to fire off the ready\n      // event for the label\n      else {\n        instance.resourceTrigger = () => {\n          if (instance.onReady) instance.onReady(instance);\n        };\n\n        this.resource.request(this, instance, labelKerningRequest, {\n          resource: {\n            type: ResourceType.FONT,\n            key: this.props.resourceKey || \"\"\n          }\n        });\n      }\n\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * If our resource changes, we need a full update of all instances.\n   * If our provider changes, we probably want to ensure our property identifiers are correct.\n   */\n  willUpdateProps(newProps: U) {\n    if (newProps.data !== this.props.data) {\n      delete this.propertyIds;\n    }\n\n    // Scale mode change changes the shader needs of the underlying glyphs\n    if (newProps.scaleMode !== this.props.scaleMode) {\n      this.rebuildLayer();\n    }\n\n    if (newProps.resourceKey !== this.props.resourceKey) {\n      this.fullUpdate = true;\n    }\n  }\n}\n","export * from \"./label-layer\";\nexport * from \"./label-instance\";\nexport * from \"./glyph-instance\";\nexport * from \"./glyph-layer\";\n","import { observable } from \"../../instance-provider\";\nimport { IInstanceOptions, Instance } from \"../../instance-provider/instance\";\nimport { IAtlasResourceRequest } from \"../../resources\";\nimport { Vec2 } from \"../../util/vector\";\nimport { Anchor, AnchorType, ScaleMode } from \"../types\";\n\nconst { max } = Math;\n\nexport interface IImageInstanceOptions extends IInstanceOptions {\n  /**\n   * The point on the image which will be placed in world space via the x, y coords. This is also the point\n   * which the image will be scaled around.\n   */\n  anchor?: Anchor;\n  /** Depth sorting of the image (or the z value of the lable) */\n  depth?: number;\n  /** This is the HTMLImageElement that the image is to render. This element MUST be loaded completely before this instance is created. */\n  source: string | TexImageSource;\n  /** The height of the image as it is to be rendered in world space */\n  height?: number;\n  /** The coordinate where the image will be anchored to in world space */\n  origin?: Vec2;\n  /** Sets the way the image scales with the world */\n  scaling?: ScaleMode;\n  /** The color the image should render as */\n  tint: [number, number, number, number];\n  /** The width of the image as it is to be rendered in world space */\n  width?: number;\n\n  /** Triggered when the image has fully loaded it's resources */\n  onReady?(image: ImageInstance): void;\n}\n\n/**\n * This is a lookup to quickly find the proper calculation for setting the correct anchor\n * position based on the anchor type.\n */\nconst anchorCalculator: {\n  [key: number]: (anchor: Anchor, image: ImageInstance) => void;\n} = {\n  [AnchorType.TopLeft]: (anchor: Anchor, _image: ImageInstance) => {\n    anchor.x = -anchor.padding;\n    anchor.y = -anchor.padding;\n  },\n  [AnchorType.TopMiddle]: (anchor: Anchor, image: ImageInstance) => {\n    anchor.x = image.width / 2.0;\n    anchor.y = -anchor.padding;\n  },\n  [AnchorType.TopRight]: (anchor: Anchor, image: ImageInstance) => {\n    anchor.x = image.width + anchor.padding;\n    anchor.y = -anchor.padding;\n  },\n  [AnchorType.MiddleLeft]: (anchor: Anchor, image: ImageInstance) => {\n    anchor.x = -anchor.padding;\n    anchor.y = image.height / 2;\n  },\n  [AnchorType.Middle]: (anchor: Anchor, image: ImageInstance) => {\n    anchor.x = image.width / 2.0;\n    anchor.y = image.height / 2.0;\n  },\n  [AnchorType.MiddleRight]: (anchor: Anchor, image: ImageInstance) => {\n    anchor.x = image.width + anchor.padding;\n    anchor.y = image.height / 2.0;\n  },\n  [AnchorType.BottomLeft]: (anchor: Anchor, image: ImageInstance) => {\n    anchor.x = -anchor.padding;\n    anchor.y = image.height + anchor.padding;\n  },\n  [AnchorType.BottomMiddle]: (anchor: Anchor, image: ImageInstance) => {\n    anchor.x = image.width / 2.0;\n    anchor.y = image.height + anchor.padding;\n  },\n  [AnchorType.BottomRight]: (anchor: Anchor, image: ImageInstance) => {\n    anchor.x = image.width + anchor.padding;\n    anchor.y = image.height + anchor.padding;\n  },\n  [AnchorType.Custom]: (anchor: Anchor, _image: ImageInstance) => {\n    anchor.x = anchor.x || 0;\n    anchor.y = anchor.y || 0;\n  }\n};\n\n/**\n * This generates a new image instance.\n * There are restrictions surrounding images due to texture sizes and rendering limitations.\n *\n * Currently, we only support rendering a image via canvas, then rendering it to an Atlas texture\n * which is used to render to cards in the world for rendering. This is highly performant, but means:\n *\n * - Images should only be so large.\n * - Once a image is constructed, only SOME properties can be altered thereafter\n *\n * An image that is constructed can only have some properties set upon creating the image and are locked\n * thereafter. The only way to modify them would be to destroy the image, then construct a new image\n * with the modifications. This has to deal with performance regarding rasterizing the image.\n */\nexport class ImageInstance extends Instance {\n  /** This is the rendered color of the image */\n  @observable tint: [number, number, number, number] = [0, 0, 0, 1];\n  /** Depth sorting of the image (or the z value of the lable) */\n  @observable depth: number = 0;\n  /**\n   * The height of the image as it is to be rendered in world space.\n   * After onReady: this is immediately populated with the width and height of the image as it\n   * appears in the atlas.\n   */\n  @observable height: number = 1;\n  /** The coordinate where the image will be located in world space */\n  @observable origin: Vec2 = [0, 0];\n  /** Sets the way the image scales with the world */\n  @observable scaling: ScaleMode = ScaleMode.BOUND_MAX;\n  /** This is where the source of the image will come from */\n  @observable source: string | TexImageSource;\n  /**\n   * The width of the image as it is to be rendered in world space.\n   * After onReady: this is immediately populated with the width and height of the image as it\n   * appears in the atlas.\n   */\n  @observable width: number = 1;\n\n  /**\n   * This property reflects the maximum size a single dimension of the image will take up.\n   * This means if you set this value to 100 at least the width or the height will be 100\n   * depending on the aspect ratio of the image.\n   */\n  get maxSize() {\n    return max(this.width, this.height);\n  }\n  set maxSize(value: number) {\n    const aspect = this.width / this.height;\n    this.width = value * aspect;\n    this.height = value;\n  }\n\n  /** Event called when the instance has it's resource loaded and ready for use */\n  onReady?: (image: ImageInstance) => void;\n  /** This is the request generated for the instance to retrieve the correct resource */\n  request?: IAtlasResourceRequest;\n  /** After oneReady: This is populated with the width of the source image loaded into the Atlas */\n  sourceWidth: number = 0;\n  /** After oneReady: This is populated with the height of the source image loaded into the Atlas */\n  sourceHeight: number = 0;\n\n  /**\n   * This is a position relative to the image. This will align the image such that the anchor point on\n   * the image will be located at the origin in world space.\n   */\n  @observable\n  private _anchor: Anchor = {\n    padding: 0,\n    type: AnchorType.TopLeft,\n    x: 0,\n    y: 0\n  };\n\n  constructor(options: IImageInstanceOptions) {\n    super(options);\n\n    this.depth = options.depth || this.depth;\n    this.tint = options.tint || this.tint;\n    this.scaling = options.scaling || this.scaling;\n    this.origin = options.origin || this.origin;\n    this.width = options.width || 1;\n    this.height = options.height || 1;\n    this.source = options.source;\n    this.onReady = options.onReady;\n\n    // Make sure the anchor is set to the appropriate location\n    options.anchor && this.setAnchor(options.anchor);\n  }\n\n  get anchor() {\n    return this._anchor;\n  }\n\n  /** This is triggered after the request has been completed */\n  resourceTrigger() {\n    // Only the source needs to be triggered to get the texture info to update from the request\n    this.source = this.source;\n\n    if (this.request && this.request.texture) {\n      this.sourceWidth = this.request.texture.pixelWidth;\n      this.sourceHeight = this.request.texture.pixelHeight;\n    }\n\n    if (this.onReady) this.onReady(this);\n  }\n\n  /**\n   * This applies a new anchor to this image and properly determines it's anchor position on the image\n   */\n  setAnchor(anchor: Anchor) {\n    const newAnchor = {\n      padding: anchor.padding || 0,\n      type: anchor.type,\n      x: anchor.x || 0,\n      y: anchor.y || 0\n    };\n\n    // Calculate the new anchors position values\n    anchorCalculator[newAnchor.type](newAnchor, this);\n    // Apply the anchor\n    this._anchor = newAnchor;\n  }\n}\n","module.exports = \"precision highp float;\\n\\n${import: projection}\\n\\nvarying vec4 vertexColor;\\nvarying vec2 texCoord;\\n\\n${extendHeader}\\n\\nvoid main() {\\n  ${attributes}\\n\\n  // Figure out the size of the image as it'd show on the screen\\n  vec3 screenSize = cameraSpaceSize(vec3(size, 1.0));\\n  // Do the test for when the image is larger on the screen than the font size\\n  bool largerOnScreen = screenSize.y > size.y;\\n\\n  // Determines if a scale mode should be used or not for the vertex\\n  float useScaleMode = float(\\n    (\\n      scaling == 3.0 ||                  // NEVER mode - keep the image the same size always\\n      (largerOnScreen && scaling == 2.0) // BOUND_MAX mode - only if we're larger than the font size do we scale down\\n    ) &&\\n    scaling != 1.0                       // ALWAYS mode - the image stays completely in world space allowing it to scale freely\\n  );\\n  // If zooms are unequal, assume one is filtered to be 1.0\\n  float unequalZooms = float(cameraScale.x != cameraScale.y);\\n\\n  // Destructure the normal information\\n  float normal = normals.x;\\n  float side = normals.y;\\n\\n  // Get the location of the anchor in world space\\n  vec2 worldAnchor = location + anchor;\\n\\n  // Get the tex coord from our inject texture info\\n  texCoord = texture.xy + ((texture.zw - texture.xy) * vec2(side, float(normal == -1.0)));\\n  // Apply the image's tint as a tint to the image\\n  vertexColor = tint;\\n\\n  // Correct aspect ratio.\\n  vec2 adjustedSize = mix(\\n    size,\\n    (size * cameraScale.yx),\\n    unequalZooms\\n  );\\n\\n  vec2 adjustedAnchor = mix(\\n    anchor,\\n    (anchor * cameraScale.yx),\\n    unequalZooms\\n  );\\n\\n  vec2 vertex = vec2(side, float(normal == 1.0)) * adjustedSize + location - adjustedAnchor;\\n\\n  // See how scaled the size on screen will be from the actual height of the image\\n  float imageScreenScale = mix(\\n    screenSize.y / adjustedSize.y,\\n    screenSize.x / adjustedSize.x,\\n    float((cameraScale.x < 1.0) || (cameraScale.x > 1.0))\\n  );\\n\\n  // If our screen rendering is larger than the size the image is supposed to be, then we automagically\\n  // scale down our image to stay the correct size, centered on the anchor point\\n  vec2 anchorToVertex = vertex - location;\\n\\n  // We now choose between keeping the same image size or keeping it in world space\\n  vertex = mix(\\n    // This option keeps the image size in world space\\n    vertex,\\n    // This option counters the scaling of the image on the screen keeping it a static size\\n    (anchorToVertex / imageScreenScale) + location,\\n    // This is the flag determining if a scale mode should be applied to the vertex\\n    useScaleMode\\n  );\\n\\n  gl_Position = clipSpace(vec3(vertex, depth));\\n\\n  ${extend}\\n}\\n\"","module.exports = \"precision highp float;\\n\\nvarying vec4 vertexColor;\\nvarying vec2 texCoord;\\n${extendHeader}\\n\\nvoid main() {\\n  gl_FragColor = texture2D(imageAtlas, texCoord) * vertexColor;\\n  setColor(gl_FragColor * gl_FragColor.a);\\n\\n  ${extend}\\n}\\n\"","import { InstanceProvider } from \"../../instance-provider\";\nimport { Bounds } from \"../../primitives\";\nimport { atlasRequest } from \"../../resources/texture/atlas-resource-request\";\nimport { ILayerProps, Layer } from \"../../surface/layer\";\nimport {\n  ILayerMaterialOptions,\n  InstanceAttributeSize,\n  IProjection,\n  IShaderInitialization,\n  ResourceType,\n  UniformSize,\n  VertexAttributeSize\n} from \"../../types\";\nimport { divide2, IAutoEasingMethod, subtract2, Vec, Vec2 } from \"../../util\";\nimport { CommonMaterialOptions } from \"../../util/common-options\";\nimport { ScaleMode } from \"../types\";\nimport { ImageInstance } from \"./image-instance\";\n\nconst { min, max } = Math;\n\nexport interface IImageRenderLayerProps<T extends ImageInstance>\n  extends ILayerProps<T> {\n  /** The id of the atlas to load resources into */\n  atlas?: string;\n  /** The properties we wish to animate for the image */\n  animate?: {\n    tint?: IAutoEasingMethod<Vec>;\n    location?: IAutoEasingMethod<Vec>;\n    size?: IAutoEasingMethod<Vec>;\n  };\n  /**\n   * This is the scale resources for the images will be loaded into the atlas. A value of\n   * 0.5 will cause images to load at 50% their source size to the atlas.\n   */\n  rasterizationScale?: number;\n}\n\n/**\n * This layer displays Images and provides as many controls as possible for displaying\n * them in interesting ways.\n */\nexport class ImageRenderLayer<\n  T extends ImageInstance,\n  U extends IImageRenderLayerProps<T>\n> extends Layer<T, U> {\n  static defaultProps: IImageRenderLayerProps<any> = {\n    key: \"\",\n    data: new InstanceProvider<ImageInstance>(),\n    scene: \"default\"\n  };\n\n  /** Easy lookup of attribute names to aid in modifications to be applied to elements */\n  static attributeNames = {\n    location: \"location\",\n    anchor: \"anchor\",\n    size: \"size\",\n    depth: \"depth\",\n    scaling: \"scaling\",\n    texture: \"texture\",\n    tint: \"tint\"\n  };\n\n  /**\n   * We provide bounds and hit test information for the instances for this layer to allow for mouse picking\n   * of elements\n   */\n  getInstancePickingMethods() {\n    return {\n      // Provide the calculated AABB world bounds for a given image\n      boundsAccessor: (image: ImageInstance) => {\n        const anchorEffect: Vec2 = [0, 0];\n\n        if (image.anchor) {\n          anchorEffect[0] = image.anchor.x || 0;\n          anchorEffect[1] = image.anchor.y || 0;\n        }\n\n        const topLeft = subtract2(image.origin, anchorEffect);\n\n        return new Bounds({\n          height: image.height,\n          width: image.width,\n          x: topLeft[0],\n          y: topLeft[1]\n        });\n      },\n\n      // Provide a precise hit test for the circle\n      hitTest: (image: ImageInstance, point: Vec2, view: IProjection) => {\n        // The bounds of the image is in world space, but it does not account for the scale mode of the image.\n        // Here, we will apply the scale mode testing to the image\n        const maxScale = max(...view.camera.scale);\n        const minScale = min(...view.camera.scale);\n\n        // If we scale always then the image stays within it's initial world bounds at all times\n        if (image.scaling === ScaleMode.ALWAYS) {\n          return true;\n        } else if (image.scaling === ScaleMode.BOUND_MAX) {\n          // If we scale with bound max, then when the camera zooms in, the bounds will shrink to keep the\n          // Image the same size. If the camera zooms out then the bounds === the world bounds.\n          // We are zooming out. the bounds will stay within the world bounds\n          if (minScale <= 1 && maxScale <= 1) {\n            return true;\n          } else {\n            // We are zooming in. The bounds will shrink to keep the image at max font size\n            // The location is within the world, but we reverse project the anchor spread\n            const anchorEffect: Vec2 = [0, 0];\n\n            if (image.anchor) {\n              anchorEffect[0] = image.anchor.x || 0;\n              anchorEffect[1] = image.anchor.y || 0;\n            }\n\n            const topLeft = subtract2(\n              image.origin,\n              divide2(anchorEffect, view.camera.scale)\n            );\n\n            const screenPoint = view.worldToScreen(point);\n\n            // Reverse project the size and we should be within the distorted world coordinates\n            return new Bounds({\n              height: image.height,\n              width: image.width,\n              x: topLeft[0],\n              y: topLeft[1]\n            }).containsPoint(screenPoint);\n          }\n        } else if (image.scaling === ScaleMode.NEVER) {\n          // If we never allow the image to scale, then the bounds will grow and shrink to counter the effects\n          // Of the camera zoom\n          // The location is within the world, but we reverse project the anchor spread\n          const anchorEffect: Vec2 = [0, 0];\n\n          if (image.anchor) {\n            anchorEffect[0] = image.anchor.x || 0;\n            anchorEffect[1] = image.anchor.y || 0;\n          }\n\n          const topLeft = view.worldToScreen(\n            subtract2(image.origin, divide2(anchorEffect, view.camera.scale))\n          );\n\n          const screenPoint = view.worldToScreen(point);\n\n          // Reverse project the size and we should be within the distorted world coordinates\n          const bounds = new Bounds({\n            height: image.height,\n            width: image.width,\n            x: topLeft[0],\n            y: topLeft[1]\n          });\n\n          return bounds.containsPoint(screenPoint);\n        }\n\n        return true;\n      }\n    };\n  }\n\n  /**\n   * Define our shader and it's inputs\n   */\n  initShader(): IShaderInitialization<ImageInstance> {\n    const animations = this.props.animate || {};\n    const {\n      tint: animateTint,\n      location: animateLocation,\n      size: animateSize\n    } = animations;\n    const vertexToNormal: { [key: number]: number } = {\n      0: 1,\n      1: 1,\n      2: -1,\n      3: 1,\n      4: -1,\n      5: -1\n    };\n\n    const vertexToSide: { [key: number]: number } = {\n      0: 0,\n      1: 0,\n      2: 0,\n      3: 1,\n      4: 1,\n      5: 1\n    };\n\n    return {\n      fs: require(\"./image-layer.fs\"),\n      instanceAttributes: [\n        {\n          easing: animateLocation,\n          name: ImageRenderLayer.attributeNames.location,\n          size: InstanceAttributeSize.TWO,\n          update: o => o.origin\n        },\n        {\n          name: ImageRenderLayer.attributeNames.anchor,\n          size: InstanceAttributeSize.TWO,\n          update: o => [o.anchor.x || 0, o.anchor.y || 0]\n        },\n        {\n          easing: animateSize,\n          name: ImageRenderLayer.attributeNames.size,\n          size: InstanceAttributeSize.TWO,\n          update: o => [o.width, o.height]\n        },\n        {\n          name: ImageRenderLayer.attributeNames.depth,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.depth]\n        },\n        {\n          name: ImageRenderLayer.attributeNames.scaling,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.scaling]\n        },\n        {\n          name: ImageRenderLayer.attributeNames.texture,\n          resource: {\n            type: ResourceType.ATLAS,\n            key: this.props.atlas || \"\",\n            name: \"imageAtlas\"\n          },\n          update: o => {\n            const source = o.source;\n\n            if (!o.request) {\n              o.request = atlasRequest({\n                rasterizationScale: this.props.rasterizationScale,\n                source\n              });\n            }\n\n            const textureInfo = this.resource.request(this, o, o.request);\n            return textureInfo;\n          }\n        },\n        {\n          easing: animateTint,\n          name: ImageRenderLayer.attributeNames.tint,\n          size: InstanceAttributeSize.FOUR,\n          update: o => o.tint\n        }\n      ],\n      uniforms: [\n        {\n          name: \"scaleFactor\",\n          size: UniformSize.ONE,\n          update: _u => [1]\n        }\n      ],\n      vertexAttributes: [\n        {\n          name: \"normals\",\n          size: VertexAttributeSize.TWO,\n          update: (vertex: number) => [\n            // Normal\n            vertexToNormal[vertex],\n            // The side of the quad\n            vertexToSide[vertex]\n          ]\n        }\n      ],\n      vertexCount: 6,\n      vs: require(\"./image-layer.vs\")\n    };\n  }\n\n  getMaterialOptions(): ILayerMaterialOptions {\n    return CommonMaterialOptions.transparentImageBlending;\n  }\n}\n","import { Bounds } from \"../primitives/bounds\";\nimport { isVec2, Vec2 } from \"./vector\";\n\n// A configuration that controls how readily a quadtree will split to another level\n// Adjusting this number can improve or degrade your performance significantly and\n// Must be tested for specific use cases\nconst maxPopulation: number = 5;\nconst maxDepth: number = 10;\n\nexport interface IQuadItem {\n  area: number;\n  bottom: number;\n  height: number;\n  left: number;\n  location: Vec2;\n  mid: Vec2;\n  right: number;\n  top: number;\n  width: number;\n  x: number;\n  y: number;\n\n  containsPoint(point: Vec2): boolean;\n  encapsulate(item: IQuadItem): boolean;\n  fits(item: IQuadItem): 0 | 1 | 2;\n  hitBounds(item: IQuadItem): boolean;\n  isInside(item: IQuadItem): boolean;\n}\n\n/**\n * This filters a quad tree query by type\n *\n * @export\n * @template T\n */\nexport function filterQuery<T extends IQuadItem>(\n  type: Function[],\n  queryValues: IQuadItem[]\n): T[] {\n  const filtered: T[] = [];\n\n  queryValues.forEach((obj: IQuadItem) => {\n    if (type.find(t => obj instanceof t)) {\n      filtered.push(obj as T);\n    }\n  });\n\n  return filtered;\n}\n\n/**\n * Allows typing of a callback argument\n */\nexport interface IVisitFunction<T extends IQuadItem> {\n  /**\n   * A callback to use during add or query\n   *\n   * Called do provide aggregation or filtering like Array.reduce or\n   * Array.filter, but in a QuadTree instead.\n   *\n   * @param node  The node to effect the function upon\n   * @param child The child to add to the node\n   */\n  (node: Node<T>, child?: IQuadItem): void;\n}\n\n/**\n * This is a class used specifically by the quad tree nodes to indicate split space\n * within the quad tree.\n *\n * @class Quadrants\n */\nexport class Quadrants<T extends IQuadItem> {\n  TL: Node<T>;\n  TR: Node<T>;\n  BL: Node<T>;\n  BR: Node<T>;\n\n  /**\n   * Ensures all memory is released for all nodes and all references are removed\n   * to potentially high memory consumption items\n   *\n   * @memberOf Quadrants\n   */\n  destroy() {\n    this.TL.destroy();\n    this.TR.destroy();\n    this.BL.destroy();\n    this.BR.destroy();\n    delete this.TL;\n    delete this.TR;\n    delete this.BL;\n    delete this.BR;\n  }\n\n  /**\n   * Creates an instance of Quadrants.\n   *\n   * @param bounds The bounds this will create quandrants for\n   * @param depth  The child depth of this element\n   *\n   * @memberOf Quadrants\n   */\n  constructor(bounds: IQuadItem, depth: number) {\n    const mid = bounds.mid;\n    this.TL = new Node<T>(bounds.x, mid[0], bounds.y, mid[1], depth);\n    this.TR = new Node<T>(mid[0], bounds.right, bounds.y, mid[1], depth);\n    this.BL = new Node<T>(bounds.x, mid[0], mid[1], bounds.bottom, depth);\n    this.BR = new Node<T>(mid[0], bounds.right, mid[1], bounds.bottom, depth);\n  }\n}\n\n/**\n * The quad tree node. This Node will take in a certain population before dividing itself into\n * 4 quadrants which it will attempt to inject it's population into. If a member of the population\n * does not completely get injected into one of the quadrants it remains as a member of this node.\n *\n * @export\n * @class Node\n */\nexport class Node<T extends IQuadItem> {\n  bounds: Bounds;\n  children: T[] = [];\n  depth: number = 0;\n  nodes: Quadrants<T>;\n\n  /**\n   * Destroys this node and ensures all child nodes are destroyed as well.\n   *\n   * @memberOf Node\n   */\n  destroy() {\n    delete this.children;\n    delete this.bounds;\n\n    if (this.nodes) {\n      this.nodes.destroy();\n      delete this.nodes;\n    }\n  }\n\n  /**\n   * Creates an instance of Node.\n   *\n   * @param l     The bounding left wall of the space this node covers\n   * @param r     The bounding right wall of the space this node covers\n   * @param t     The bounding top wall of the space this node covers\n   * @param b     The bounding bottom wall of the space this node covers\n   * @param depth The depth within the quad tree this node resides\n   *\n   * @memberOf Node\n   */\n  constructor(\n    left: number,\n    right: number,\n    top: number,\n    bottom: number,\n    depth?: number\n  ) {\n    // If params insertted\n    if (arguments.length >= 4) {\n      this.bounds = new Bounds({\n        height: top - bottom,\n        width: right - left,\n        x: left,\n        y: top\n      });\n    } else {\n      // Otherwise, make tiny start area\n      this.bounds = new Bounds({\n        height: 1,\n        width: 1,\n        x: 0,\n        y: 0\n      });\n    }\n\n    // Ensure the depth is set\n    this.depth = depth || 0;\n  }\n\n  /**\n   * Adds an object that extends Bounds (or is Bounds) and properly injects it into this node\n   * or into a sub quadrant if this node is split already. If the child is outside the boundaries\n   * this quad tree spans (and this is the root node), the quad tree will expand to include\n   * the new child.\n   *\n   * @param child The Bounds type object to inject\n   * @param props Properties that can be retrieved with the child object if applicable\n   *\n   * @returns True if the insertion was successful\n   *\n   * @memberOf Node\n   */\n  add(child: T, props: any): boolean {\n    // This is the entry function for adding children, so we must first expand our top node\n    // To cover the area that the child is located.\n    // If we're in bounds, then let's just add the child\n    if (child.isInside(this.bounds)) {\n      return this.doAdd(child);\n    } else {\n      // Otherwise, we need to expand first\n      this.cover(child);\n      return this.add(child, props);\n    }\n  }\n\n  /**\n   * Adds a list of new children to this quad tree. It performs the same operations as\n   * addChild for each child in the list, however, it more efficiently recalculates the\n   * bounds necessary to cover the area the children cover.\n   *\n   * @param children      List of Bounds objects to inject\n   * @param childrenProps List of props to associate with each element\n   *\n   * @memberOf Node\n   */\n  addAll(children: T[], childrenProps?: any[]) {\n    // Ensure the properties are at least defined\n    childrenProps = childrenProps || [];\n\n    // Make sure we cover the entire area of all the children.\n    // We can speed this up a lot if we first calculate the total bounds the new children covers\n    let minX = Number.MAX_VALUE;\n    let minY = Number.MAX_VALUE;\n    let maxX = -Number.MAX_VALUE;\n    let maxY = -Number.MAX_VALUE;\n\n    // Get the dimensions of the new bounds\n    children.forEach(child => {\n      if (child.x < minX) {\n        minX = child.x;\n      }\n      if (child.right > maxX) {\n        maxX = child.right;\n      }\n      if (child.bottom > maxY) {\n        maxY = child.bottom;\n      }\n      if (child.y < minY) {\n        minY = child.y;\n      }\n    });\n\n    // Make sure our bounds includes the specified bounds\n    this.cover(\n      new Bounds({\n        height: maxY - minY,\n        width: maxX - minX,\n        x: minX,\n        y: minY\n      })\n    );\n\n    // Add all of the children into the tree\n    children.forEach(child => this.doAdd(child));\n  }\n\n  /**\n   * Ensures this quad tree includes the bounds specified in it's spatial coverage.\n   * This will cause all children to be re-injected into the tree.\n   *\n   * @param bounds The bounds to include in the tree's coverage\n   *\n   * @memberOf Node\n   */\n  cover(bounds: IQuadItem) {\n    // If we are already covering the area: abort\n    if (bounds.isInside(this.bounds)) {\n      return;\n    }\n\n    // Make our bounds cover the new area\n    this.bounds.encapsulate(bounds);\n    this.bounds.x -= 1;\n    this.bounds.y -= 1;\n    this.bounds.width += 2;\n    this.bounds.height += 4;\n    // Get all of the children underneath this node\n    const allChildren = this.gatherChildren([]);\n\n    // Destroy the split nodes\n    if (this.nodes) {\n      // Completely...destroy...\n      this.nodes.destroy();\n      delete this.nodes;\n    }\n\n    // Reinsert all children with the new dimensions in place\n    allChildren.forEach(child => this.doAdd(child));\n  }\n\n  /**\n   * When adding children, this performs the actual action of injecting the child into the tree\n   * without the process of seeing if the tree needs a spatial adjustment to account for the child.\n   *\n   * @param child The Bounds item to inject into the tree\n   * @param props The props to remain associated with the child\n   *\n   * @returns True if the injection was successful\n   *\n   * @memberOf Node\n   */\n  doAdd(child: T): boolean {\n    // If nodes are present, then we have already exceeded the population of this node\n    if (this.nodes) {\n      if (child.isInside(this.nodes.TL.bounds)) {\n        return this.nodes.TL.doAdd(child);\n      }\n\n      if (child.isInside(this.nodes.TR.bounds)) {\n        return this.nodes.TR.doAdd(child);\n      }\n\n      if (child.isInside(this.nodes.BL.bounds)) {\n        return this.nodes.BL.doAdd(child);\n      }\n\n      if (child.isInside(this.nodes.BR.bounds)) {\n        return this.nodes.BR.doAdd(child);\n      }\n\n      // Otherwise, this is a child overlapping this border\n      this.children.push(child);\n\n      return true;\n    } else if (child.isInside(this.bounds)) {\n      // Otherwise, we have not had a split due to population limits being exceeded\n      this.children.push(child);\n\n      // If we exceeded our population for this quadrant, it is time to split up\n      if (this.children.length > maxPopulation && this.depth < maxDepth) {\n        this.split();\n      }\n\n      return true;\n    }\n\n    // This is when there is something wrong with the insertted child. The bounds\n    // For the quad should have grown without issue, but in this case the bounds\n    // Could not grow to accomodate the child.\n    if (isNaN(child.width + child.height + child.x + child.y)) {\n      console.error(\n        \"Child did not fit into bounds because a dimension is NaN\",\n        child\n      );\n    } else if (child.area === 0) {\n      console.error(\n        \"Child did not fit into bounds because the area is zero\",\n        child\n      );\n    }\n\n    // Don't insert the child and continue\n    return true;\n  }\n\n  /**\n   * Collects all children of all the current and sub nodes into a single list.\n   *\n   * @param list The list we must aggregate children into\n   *\n   * @return The list specified as the list parameter\n   */\n  gatherChildren(list: T[]): T[] {\n    list = list.concat(this.children);\n\n    if (this.nodes) {\n      this.nodes.TL.gatherChildren(list);\n      this.nodes.TR.gatherChildren(list);\n      this.nodes.BL.gatherChildren(list);\n      this.nodes.BR.gatherChildren(list);\n    }\n\n    return list;\n  }\n\n  /**\n   * Entry query for determining query type based on input object\n   *\n   * @param bounds Can be a Bounds or a Point object\n   * @param visit  A callback function that will receive the Node as it is analyzed. This gives\n   *               information on a spatial scale, how a query reaches it's target intersections.\n   *\n   * @return An array of children that intersects with the query\n   */\n  query(bounds: IQuadItem | Vec2, visit?: IVisitFunction<T>): T[] {\n    // Query a rectangle\n    if (bounds instanceof Bounds) {\n      if (bounds.hitBounds(this.bounds)) {\n        return this.queryBounds(bounds, [], visit);\n      }\n\n      // Return an empty array when nothing is collided with\n      return [];\n    } else if (isVec2(bounds)) {\n      // Query a point\n      if (this.bounds.containsPoint(bounds)) {\n        return this.queryPoint(bounds, [], visit);\n      }\n    }\n\n    // Return an empty array when nothing is collided with\n    return [];\n  }\n\n  /**\n   * Queries children for intersection with a bounds object\n   *\n   * @param b     The Bounds to test children against\n   * @param list  The list of children to aggregate into the query\n   * @param visit A callback function that will receive the Node as it is analyzed. This gives\n   *              information on a spatial scale, how a query reaches it's target intersections.\n   *\n   * @return     Returns the exact same list that was input as the list param\n   */\n  queryBounds(b: IQuadItem, list: T[], visit?: IVisitFunction<T>): T[] {\n    this.children.forEach(c => {\n      if (c.hitBounds(b)) {\n        list.push(c);\n      }\n    });\n\n    if (visit) {\n      visit(this);\n    }\n\n    if (this.nodes) {\n      if (b.hitBounds(this.nodes.TL.bounds)) {\n        this.nodes.TL.queryBounds(b, list, visit);\n      }\n\n      if (b.hitBounds(this.nodes.TR.bounds)) {\n        this.nodes.TR.queryBounds(b, list, visit);\n      }\n\n      if (b.hitBounds(this.nodes.BL.bounds)) {\n        this.nodes.BL.queryBounds(b, list, visit);\n      }\n\n      if (b.hitBounds(this.nodes.BR.bounds)) {\n        this.nodes.BR.queryBounds(b, list, visit);\n      }\n    }\n\n    return list;\n  }\n\n  /**\n   * Queries children for intersection with a point\n   *\n   * @param p     The Point to test children against\n   * @param list  The list of children to aggregate into the query\n   * @param visit A callback function that will receive the Node as it is analyzed. This gives\n   *              information on a spatial scale, how a query reaches it's target intersections.\n   *\n   * @return      Returns the exact same list that was input as the list param\n   */\n  queryPoint(p: any, list: T[], visit?: IVisitFunction<T>): T[] {\n    this.children.forEach(c => {\n      if (c.containsPoint(p)) {\n        list.push(c);\n      }\n    });\n\n    if (visit) {\n      visit(this);\n    }\n\n    if (this.nodes) {\n      if (this.nodes.TL.bounds.containsPoint(p)) {\n        this.nodes.TL.queryPoint(p, list, visit);\n      }\n\n      if (this.nodes.TR.bounds.containsPoint(p)) {\n        this.nodes.TR.queryPoint(p, list, visit);\n      }\n\n      if (this.nodes.BL.bounds.containsPoint(p)) {\n        this.nodes.BL.queryPoint(p, list, visit);\n      }\n\n      if (this.nodes.BR.bounds.containsPoint(p)) {\n        this.nodes.BR.queryPoint(p, list, visit);\n      }\n    }\n\n    return list;\n  }\n\n  /**\n   * Creates four sub quadrants for this node.\n   */\n  split() {\n    // Gather all items to be handed down\n    const allChildren = this.gatherChildren([]);\n    // Gather all props for the children to be handed down as well\n    this.nodes = new Quadrants<T>(this.bounds, this.depth + 1);\n\n    this.children = [];\n\n    while (allChildren.length > 0) {\n      const child = allChildren.pop();\n      if (child) this.doAdd(child);\n    }\n  }\n\n  /**\n   * Traverses the quad tree returning every quadrant encountered\n   *\n   * @param cb A callback that has the parameter (node) which is a quadrant in the tree\n   */\n  visit(cb: IVisitFunction<T>): void {\n    const finished = Boolean(cb(this));\n\n    if (this.nodes && !finished) {\n      this.nodes.TL.visit(cb);\n      this.nodes.TR.visit(cb);\n      this.nodes.BL.visit(cb);\n      this.nodes.BR.visit(cb);\n    }\n  }\n}\n\nexport class QuadTree<T extends IQuadItem> extends Node<T> {}\n","import { Instance } from \"../../../instance-provider\";\nimport {\n  ShaderDeclarationStatements,\n  ShaderIOHeaderInjectionResult\n} from \"../../../shaders/processing/base-shader-io-injection\";\nimport { MetricsProcessing } from \"../../../shaders/processing/metrics-processing\";\nimport { ILayerProps, Layer } from \"../../../surface/layer\";\nimport {\n  FrameMetrics,\n  IEasingInstanceAttribute,\n  IEasingProps,\n  IInstanceAttribute,\n  InstanceAttributeSize,\n  InstanceIOValue,\n  IUniform,\n  IVertexAttribute,\n  ShaderInjectionTarget\n} from \"../../../types\";\nimport { AutoEasingLoopStyle } from \"../../../util/auto-easing-method\";\nimport { EasingProps } from \"../../../util/easing-props\";\nimport {\n  IShaderTemplateRequirements,\n  shaderTemplate\n} from \"../../../util/shader-templating\";\nimport { Vec, VecMath, VecMethods } from \"../../../util/vector\";\nimport { BaseIOExpansion, ShaderIOExpansion } from \"../base-io-expansion\";\n\nconst debugCtx = \"EasingIOExpansion\";\n\nconst { abs, max } = Math;\n\nconst BLANK_EASING_PROPS: IEasingProps = {\n  duration: 0,\n  start: [0],\n  end: [0],\n  startTime: 0\n};\n\n/** Converts a size to a shader type */\nconst sizeToType: { [key: number]: string } = {\n  1: \"float\",\n  2: \"vec2\",\n  3: \"vec3\",\n  4: \"vec4\",\n  9: \"mat3\",\n  16: \"mat4\",\n  /** This is the special case for instance attributes that want an atlas resource */\n  99: \"vec4\"\n};\n\n/**\n * These are the templating names used within Auto Easing gpu methods\n */\nconst templateVars = {\n  easingMethod: \"easingMethod\",\n  T: \"T\"\n};\n\n/**\n * Tests an attribute to see if it is an easing attribute\n */\nfunction isEasingAttribute<T extends Instance>(\n  attr: any\n): attr is IEasingInstanceAttribute<T> {\n  return Boolean(attr) && attr.easing && attr.size !== undefined;\n}\n\n/**\n * This is an expansion handler for easing attributes.\n */\nexport class EasingIOExpansion extends BaseIOExpansion {\n  /** This is used to make it easy to remember an easing attribute's original name */\n  private baseAttributeName = new Map<IInstanceAttribute<Instance>, string>();\n\n  /**\n   * Provides expanded IO for attributes with easing properties.\n   *\n   * Most of this process is hijacking the existing easing attribute to inject it's own\n   * update method to handle calculating current position to animate to a new position\n   * when a value is changed.\n   *\n   * This also provides new child attributes that must be changed when the original attributes\n   * value is changed.\n   */\n  expand<T extends Instance, U extends ILayerProps<T>>(\n    layer: Layer<T, U>,\n    instanceAttributes: IInstanceAttribute<T>[],\n    _vertexAttributes: IVertexAttribute[],\n    _uniforms: IUniform[]\n  ): ShaderIOExpansion<T> {\n    const usedInstanceAttributes = new Set<number>();\n    const easingAttributes: IEasingInstanceAttribute<T>[] = [];\n    const newAttributes: IInstanceAttribute<T>[] = [];\n\n    // We gather all of the easing attributes first so we can modify the attribute array\n    // On next pass\n    for (const attribute of instanceAttributes) {\n      if (isEasingAttribute(attribute)) {\n        easingAttributes.push(attribute);\n      }\n    }\n\n    const easingIds: { [key: string]: number } = {};\n    layer.easingId = easingIds;\n\n    // Now loop through each easing attribute and generate attributes needed for the easing method\n    for (let i = 0, iMax = easingAttributes.length; i < iMax; ++i) {\n      const attribute = easingAttributes[i];\n      const { cpu: easing, loop, uid: providedUID } = attribute.easing;\n      const { name, size, update } = attribute;\n      const easingUID = providedUID;\n\n      // The attribute that is the primary attribute that declares the easing attribute\n      // will become the \"_end\" attribute as whenever it is set, it will change the\n      // destination value of the easing method.\n      this.baseAttributeName.set(attribute, attribute.name);\n      attribute.name = `_${attribute.name}_end`;\n\n      // Make our easing ID lookup so instances can access their easing information for higher level\n      // animation control.\n      easingIds[attribute.name] = easingUID;\n\n      // Ensure the AutoEasing method is unique\n      if (usedInstanceAttributes.has(easingUID)) {\n        console.error(\n          \"Undefined behavior occurs if you reuse an IAutoEasingMethod. Please ensure you are using uid() from the util to give the IAutoEasingMethod its uid, or just use the default provided methods\"\n        );\n      }\n\n      // Flag the uid of the easing method as used\n      usedInstanceAttributes.add(easingUID);\n      // We keep this in a scope above the update as we utilize the fact that the attributes will update\n      // In the order they are declared for a single instance. The attributes will all share this information.\n      const attributeDataShare: { values: IEasingProps } = {\n        values: BLANK_EASING_PROPS\n      };\n\n      // Remove declaring any variables within the scope of the update method for speed\n      let delay: number,\n        attributeDelay: number,\n        attributeDuration: number,\n        duration: number,\n        easingValues: IEasingProps,\n        timeValue: number,\n        end: InstanceIOValue,\n        currentTime: number,\n        frameMetrics: FrameMetrics,\n        values: IEasingProps | undefined,\n        vecMethods: VecMethods<Vec>;\n\n      // Hijack the update from the attribute to a new update method which will\n      // Be able to interact with the values for the easing methodology\n      attribute.update = instance => {\n        frameMetrics = layer.surface.frameMetrics;\n        // We retrieve properties that we want to be dynamic from the easing equation\n        attributeDelay = attribute.easing.delay;\n        attributeDuration = attribute.easing.duration;\n        // First get the value that is to be our new destination\n        end = update(instance);\n        currentTime = frameMetrics.currentTime;\n        // Get the easing values specific to an instance.\n        values = instance.easing.get(easingUID);\n\n        // If the easing values do not exist yet, make them now\n        if (!values) {\n          // Get all of the vector methods that apply to the provided item\n          vecMethods = VecMath(end);\n\n          values = new EasingProps({\n            duration: attributeDuration,\n            end: vecMethods.copy(end),\n            start: vecMethods.copy(end),\n            startTime: currentTime\n          });\n\n          // Make sure the instance contains the current easing values\n          instance.easing.set(easingUID, values);\n        }\n\n        // Assign the established values\n        easingValues = values;\n        duration = attributeDuration;\n        delay = attributeDelay;\n\n        if (easingValues.isTimeSet) {\n          duration = easingValues.duration || attributeDuration;\n          delay = easingValues.delay || 0;\n        }\n\n        if (!easingValues.isManualStart) {\n          // Previous position time value\n          timeValue = 1;\n\n          switch (loop) {\n            // Continuous means we start at 0 and let the time go to infinity\n            case AutoEasingLoopStyle.CONTINUOUS:\n              timeValue = (currentTime - easingValues.startTime) / duration;\n              break;\n\n            // Repeat means going from 0 to 1 then 0 to 1 etc etc\n            case AutoEasingLoopStyle.REPEAT:\n              timeValue =\n                ((currentTime - easingValues.startTime) / duration) % 1;\n              break;\n\n            // Reflect means going from 0 to 1 then 1 to 0 then 0 to 1 etc etc\n            case AutoEasingLoopStyle.REFLECT:\n              const timePassed =\n                (currentTime - easingValues.startTime) / duration;\n              // This is a triangle wave for an input\n              timeValue = abs((timePassed / 2.0) % 1 - 0.5) * 2.0;\n              break;\n\n            // No loop means just linear time\n            case AutoEasingLoopStyle.NONE:\n            default:\n              timeValue = (currentTime - easingValues.startTime) / duration;\n              break;\n          }\n\n          // Now get the value of where our instance currently is located this frame\n          easingValues.start = easing(\n            easingValues.start,\n            easingValues.end,\n            timeValue\n          );\n        }\n\n        // Set the current time as the start time of our animation\n        easingValues.startTime = currentTime + delay;\n        // Set the provided value as our destination\n        easingValues.end = vecMethods.copy(end);\n        // Update the information shared between this attribute and it's children\n        attributeDataShare.values = easingValues;\n\n        /** Set layer's animation end time */\n        layer.animationEndTime = max(\n          layer.animationEndTime,\n          easingValues.startTime + duration + frameMetrics.frameDuration\n        );\n\n        return end;\n      };\n\n      // The attribute is going to generate some child attributes\n      // Making the additional attributes children of this attribute\n      // will force them to update when the parent attribute is updated.\n      attribute.childAttributes = [];\n\n      // Attribute for the start value of the animation\n      const startAttr: IInstanceAttribute<T> = {\n        name: `_${name}_start`,\n        parentAttribute: attribute,\n        size,\n        update: _o => attributeDataShare.values.start\n      };\n\n      attribute.childAttributes.push(startAttr);\n      newAttributes.push(startAttr);\n\n      // Attribute for the starting time of the animation\n      const startTimeAttr: IInstanceAttribute<T> = {\n        name: `_${name}_start_time`,\n        parentAttribute: attribute,\n        size: InstanceAttributeSize.ONE,\n        update: _o => [attributeDataShare.values.startTime]\n      };\n\n      attribute.childAttributes.push(startTimeAttr);\n      newAttributes.push(startTimeAttr);\n\n      // Attribute for how long the animation will run\n      const durationAttr: IInstanceAttribute<T> = {\n        name: `_${name}_duration`,\n        parentAttribute: attribute,\n        size: InstanceAttributeSize.ONE,\n        update: _o => [attributeDataShare.values.duration]\n      };\n\n      attribute.childAttributes.push(durationAttr);\n      newAttributes.push(durationAttr);\n    }\n\n    // Return all of the new attributes to work with\n    return {\n      instanceAttributes: newAttributes,\n      vertexAttributes: [],\n      uniforms: []\n    };\n  }\n\n  /**\n   * Validates the IO about to be expanded.\n   */\n  validate<T extends Instance, U extends ILayerProps<T>>(\n    _layer: Layer<T, U>,\n    instanceAttributes: IInstanceAttribute<T>[],\n    _vertexAttributes: IVertexAttribute[],\n    _uniforms: IUniform[]\n  ): boolean {\n    let foundError = false;\n\n    instanceAttributes.forEach(attribute => {\n      if (attribute.easing && attribute.resource) {\n        console.warn(\n          \"An instance attribute can not have both easing and resource properties. Undefined behavior will occur.\"\n        );\n        console.warn(attribute);\n\n        foundError = true;\n      }\n\n      if (attribute.easing) {\n        if (attribute.size === undefined) {\n          console.warn(\n            \"An Instance Attribute with easing MUST have a size declared\"\n          );\n        }\n      }\n    });\n\n    return !foundError;\n  }\n\n  /**\n   * Easing provides some unique destructuring for the packed in vertex information.\n   */\n  processAttributeDestructuring(\n    _layer: Layer<Instance, ILayerProps<Instance>>,\n    declarations: ShaderDeclarationStatements,\n    _metrics: MetricsProcessing,\n    _vertexAttributes: IVertexAttribute[],\n    instanceAttributes: IInstanceAttribute<Instance>[],\n    _uniforms: IUniform[]\n  ): string {\n    // We analyze our instance attributes for easing attributes. When we find an attribute with\n    // easing, we can make a quick assumption about the names of attributes provided that we can easily\n    // use to destructure a properly named attribute that contains the correct algorithm to produce\n    // the specified easing for the attribute.\n    const out = \"\";\n\n    for (let i = 0, iMax = instanceAttributes.length; i < iMax; ++i) {\n      const attribute = instanceAttributes[i];\n\n      // If this is the source easing attribute, we must add it in as an eased method along with a calculation for the\n      // Easing interpolation time value based on the current time and the injected start time of the change.\n      if (!attribute.easing || !attribute.size) continue;\n      // Get the base name of the attribute since the original name gets changed for the expansion process.\n      const baseName = this.baseAttributeName.get(attribute);\n\n      if (!baseName) {\n        console.warn(\n          \"Could not determine a base name for an easing attribute.\"\n        );\n        continue;\n      }\n\n      // Clear the basename out as it's only needed for this operation.\n      this.baseAttributeName.delete(attribute);\n\n      // We first write in the time calculation based on the loop style of the easing method\n      const time = `_${baseName}_time`;\n      const duration = `_${baseName}_duration`;\n      const startTime = `_${baseName}_start_time`;\n\n      switch (attribute.easing.loop) {\n        // Continuous means letting the time go from 0 to infinity\n        case AutoEasingLoopStyle.CONTINUOUS: {\n          this.setDeclaration(\n            declarations,\n            time,\n            `  float ${time} = (currentTime - ${startTime}) / ${duration};\\n`,\n            debugCtx\n          );\n          break;\n        }\n\n        // Repeat means going from 0 to 1 then 0 to 1 etc etc\n        case AutoEasingLoopStyle.REPEAT: {\n          this.setDeclaration(\n            declarations,\n            time,\n            `  float ${time} = clamp(fract((currentTime - ${startTime}) / ${duration}), 0.0, 1.0);\\n`,\n            debugCtx\n          );\n          break;\n        }\n\n        // Reflect means going from 0 to 1 then 1 to 0 then 0 to 1 etc etc\n        case AutoEasingLoopStyle.REFLECT: {\n          const timePassed = `_${baseName}_timePassed`;\n          const pingPong = `_${baseName}_pingPong`;\n\n          // Get the time passed in a linear fashion\n          this.setDeclaration(\n            declarations,\n            timePassed,\n            `  float ${timePassed} = (currentTime - ${startTime}) / ${duration};\\n`,\n            debugCtx\n          );\n          // Make a triangle wave from the time passed to ping pong the value\n          this.setDeclaration(\n            declarations,\n            pingPong,\n            `  float ${pingPong} = abs((fract(${timePassed} / 2.0)) - 0.5) * 2.0;\\n`,\n            debugCtx\n          );\n          // Ensure we're clamped to the right values\n          this.setDeclaration(\n            declarations,\n            time,\n            `  float ${time} = clamp(${pingPong}, 0.0, 1.0);\\n`,\n            debugCtx\n          );\n          break;\n        }\n\n        // No loop means just linear time\n        case AutoEasingLoopStyle.NONE:\n        default: {\n          this.setDeclaration(\n            declarations,\n            time,\n            `  float ${time} = clamp((currentTime - ${startTime}) / ${duration}, 0.0, 1.0);\\n`,\n            debugCtx\n          );\n          break;\n        }\n      }\n\n      // After the time calculation we inject the actual easing equation to calculate the value needed\n      // for the attribute in the shader\n      this.setDeclaration(\n        declarations,\n        baseName,\n        `  ${sizeToType[attribute.size]} ${baseName} = ${\n          attribute.easing.methodName\n        }(_${baseName}_start, _${baseName}_end, _${baseName}_time);\\n`,\n        debugCtx\n      );\n    }\n\n    return out;\n  }\n\n  /**\n   * For easing, the header must be populated with the easing method\n   */\n  processHeaderInjection(\n    target: ShaderInjectionTarget,\n    declarations: ShaderDeclarationStatements,\n    _layer: Layer<Instance, ILayerProps<Instance>>,\n    _metrics: MetricsProcessing,\n    _vertexAttributes: IVertexAttribute[],\n    instanceAttributes: IInstanceAttribute<Instance>[],\n    _uniforms: IUniform[]\n  ): ShaderIOHeaderInjectionResult {\n    const out = { injection: \"\" };\n\n    // Easing equations are only applicable to the vertex shader where attribute destructuring happens\n    if (target !== ShaderInjectionTarget.VERTEX) return out;\n\n    const methods = new Map<string, Map<InstanceAttributeSize, string>>();\n    out.injection = \"// Auto Easing Methods specified by the layer\\n\";\n\n    // First dedupe the methods needed by their method name\n    instanceAttributes.forEach(attribute => {\n      if (attribute.easing && attribute.size) {\n        let methodSizes = methods.get(attribute.easing.methodName);\n\n        if (!methodSizes) {\n          methodSizes = new Map<InstanceAttributeSize, string>();\n          methods.set(attribute.easing.methodName, methodSizes);\n        }\n\n        methodSizes.set(attribute.size, attribute.easing.gpu);\n      }\n    });\n\n    if (methods.size === 0) {\n      out.injection = \"\";\n      return out;\n    }\n\n    const required: IShaderTemplateRequirements = {\n      name: \"Easing Method Generation\",\n      values: [templateVars.easingMethod]\n    };\n\n    // Now generate the full blown method for each element. We create overloaded methods for\n    // Each method name for each vector size required\n    methods.forEach(\n      (methodSizes: Map<InstanceAttributeSize, string>, methodName: string) => {\n        methodSizes.forEach((method, size) => {\n          const sizeType = sizeToType[size];\n\n          const templateOptions: { [key: string]: string } = {\n            [templateVars.easingMethod]: `${sizeType} ${methodName}(${sizeType} start, ${sizeType} end, float t)`,\n            [templateVars.T]: `${sizeType}`\n          };\n\n          const results = shaderTemplate({\n            options: templateOptions,\n            required,\n            shader: method\n          });\n\n          this.setDeclaration(\n            declarations,\n            `${sizeType} ${methodName}`,\n            `${results.shader}\\n`,\n            debugCtx\n          );\n        });\n      }\n    );\n\n    return out;\n  }\n}\n","import { uniformBufferInstanceBufferName } from \"../../../constants\";\nimport { MaterialUniformType } from \"../../../gl/types\";\nimport { Instance } from \"../../../instance-provider/instance\";\nimport {\n  ShaderDeclarationStatements,\n  ShaderIOHeaderInjectionResult\n} from \"../../../shaders/processing/base-shader-io-injection\";\nimport { MetricsProcessing } from \"../../../shaders/processing/metrics-processing\";\nimport { ILayerProps, Layer } from \"../../../surface/layer\";\nimport { BaseIOExpansion } from \"../../../surface/layer-processing/base-io-expansion\";\nimport { LayerBufferType } from \"../../../surface/layer-processing/layer-buffer-type\";\nimport {\n  IInstanceAttribute,\n  InstanceAttributeSize,\n  IUniform,\n  IVertexAttribute,\n  PickType,\n  ShaderInjectionTarget\n} from \"../../../types\";\nimport { Vec4 } from \"../../../util/vector\";\n\n/** Provides a label for performance debugging */\nconst debugCtx = \"BasicIOExpansion\";\n/** Defines the elements for destructuring out of a vector */\nconst VECTOR_COMPONENTS = [\"x\", \"y\", \"z\", \"w\"];\n\n/** Converts a size to a shader type */\nconst sizeToType: { [key: number]: string } = {\n  1: \"float\",\n  2: \"vec2\",\n  3: \"vec3\",\n  4: \"vec4\",\n  9: \"mat3\",\n  16: \"mat4\",\n  /** This is the special case for instance attributes that want an atlas resource */\n  99: \"vec4\"\n};\n\n/**\n * This method properly provides a vector's chunk of data based on a swizzle. So a size of 2\n * provides vector.xy and a size of 4 provides vector.xyzw.\n */\nfunction makeVectorSwizzle(start: number, size: number) {\n  return VECTOR_COMPONENTS.slice(start, start + size).join(\"\");\n}\n\n/**\n * This is the basic needs of processing attributes and uniforms and injecting their declarations into the shader.\n * This will handle buffer management associated with normal hardware instancing, vertex packing, and\n * uniform packing.\n *\n * This will not expand the IO in any way, rather this forms the basis for the IO input declarations in the shader\n * and arranges these declarations to handle all of the base Buffer management systems provided in the\n * default DeltaV library.\n */\nexport class BasicIOExpansion extends BaseIOExpansion {\n  /**\n   * This is the special case where attributes are packed into a uniform buffer instead of into\n   * attributes. This is to maximize compatibility with hardware and maximize flexibility in creative approaches\n   * to utilizing shaders that need a lot of input.\n   */\n  private generateUniformAttributePacking(\n    declarations: ShaderDeclarationStatements,\n    metrics: MetricsProcessing\n  ): ShaderIOHeaderInjectionResult {\n    // Add the uniform buffer to the shader\n    this.setDeclaration(\n      declarations,\n      uniformBufferInstanceBufferName,\n      `\\n// Instance Attributes as a packed Uniform Buffer\\nuniform vec4 ${uniformBufferInstanceBufferName}[${\n        metrics.totalInstanceUniformBlocks\n      }];\\n`,\n      debugCtx\n    );\n    // Add the number of blocks an instance utilizes\n    this.setDeclaration(\n      declarations,\n      \"instanceSize\",\n      `int instanceSize = ${metrics.totalInstanceUniformBlocks};`,\n      debugCtx\n    );\n    // Add the block retrieval method to aid in the Destructuring process\n    this.setDeclaration(\n      declarations,\n      \"getBlock\",\n      `vec4 getBlock(int index, int instanceIndex) { return ${uniformBufferInstanceBufferName}[(instanceSize * instanceIndex) + index]; }`,\n      debugCtx\n    );\n\n    return {\n      injection: \"\",\n      material: {\n        uniforms: [\n          {\n            name: uniformBufferInstanceBufferName,\n            type: MaterialUniformType.VEC4_ARRAY,\n            value: new Array(metrics.totalInstanceUniformBlocks)\n              .fill(0)\n              .map<Vec4>(() => [0, 0, 0, 0])\n          }\n        ]\n      }\n    };\n  }\n\n  /**\n   * This properly handles any special case destructuring for making the decalred attribute names available\n   * after the ${attribute} declaration.\n   */\n  processAttributeDestructuring(\n    layer: Layer<Instance, ILayerProps<Instance>>,\n    declarations: ShaderDeclarationStatements,\n    metrics: MetricsProcessing,\n    _vertexAttributes: IVertexAttribute[],\n    instanceAttributes: IInstanceAttribute<Instance>[],\n    _uniforms: IUniform[]\n  ): string {\n    let out = \"\";\n\n    // Prevent mutating\n    const orderedAttributes = instanceAttributes.slice(0);\n\n    // See which buffer strategy our layer is using and produce a destructuring strategy that suits it\n    switch (layer.bufferType) {\n      case LayerBufferType.INSTANCE_ATTRIBUTE:\n        out = this.processDestructuringInstanceAttribute(\n          declarations,\n          orderedAttributes\n        );\n        break;\n\n      case LayerBufferType.INSTANCE_ATTRIBUTE_PACKING:\n        out = this.processDestructuringInstanceAttributePacking(\n          declarations,\n          orderedAttributes\n        );\n        break;\n\n      case LayerBufferType.UNIFORM:\n        out = this.processDestructuringUniformBuffer(\n          declarations,\n          orderedAttributes,\n          metrics.blocksPerInstance\n        );\n        break;\n    }\n\n    // For now we add in our picking varying assignment should it be needed\n    if (layer.picking.type === PickType.SINGLE) {\n      out +=\n        \"\\n// This portion is where the shader assigns the picking color that gets passed to the fragment shader\\n_picking_color_pass_ = _pickingColor;\\n\";\n    }\n\n    return out;\n  }\n\n  /**\n   * Destructuring for normal instancing via attributes with no packing\n   */\n  private processDestructuringInstanceAttribute(\n    _declarations: ShaderDeclarationStatements,\n    _orderedAttributes: IInstanceAttribute<Instance>[]\n  ) {\n    // No-op, the attributes for normal instance attribute destructuring will simply be used directly\n    // as they will not be packed in and will simply out\n    return \"\";\n  }\n\n  /**\n   * This generates all Destructuring needs for the Instance Attribute Packing strategy. For this scenario\n   * attributes are tighly packed into attribute blocks rather than explicitly named attributes, thus the blocks\n   * must be destructured into the proper names of the attributes.\n   *\n   * This will, as well, destructure the auto easing methods.\n   */\n  private processDestructuringInstanceAttributePacking<T extends Instance>(\n    declarations: ShaderDeclarationStatements,\n    orderedAttributes: IInstanceAttribute<T>[]\n  ) {\n    let out = \"\";\n\n    // The attributes are generated in blocks already. Thus all that need be done for this scenario\n    // is merely perform block destructuring\n    out += this.processDestructureBlocks(declarations, orderedAttributes);\n\n    return out;\n  }\n\n  /**\n   * This generates all Destructuring needs for the Uniform Packing strategy. For this scenario,\n   * attributes are tighly packed into uniform blocks rather than attributes, thus the blocks\n   * must be destructured into the proper names of the attributes.\n   *\n   * This will, as well, destructure the auto easing methods.\n   */\n  private processDestructuringUniformBuffer<T extends Instance>(\n    declarations: ShaderDeclarationStatements,\n    orderedAttributes: IInstanceAttribute<T>[],\n    blocksPerInstance: number\n  ) {\n    this.setDeclaration(\n      declarations,\n      \"instanceIndex\",\n      \"int instanceIndex = int(instance);\",\n      debugCtx\n    );\n\n    // Generate the blocks\n    for (let i = 0; i < blocksPerInstance; ++i) {\n      this.setDeclaration(\n        declarations,\n        `block${i}`,\n        `  vec4 block${i} = getBlock(${i}, instanceIndex);\\n`,\n        debugCtx\n      );\n    }\n\n    // Destructure the blocks\n    return this.processDestructureBlocks(declarations, orderedAttributes);\n  }\n\n  /**\n   * This produces the destructuring elements needed to utilize the attribute data stored in blocks with names\n   * like:\n   *\n   * vec4 block0;\n   * vec4 block1;\n   *\n   * etc\n   */\n  private processDestructureBlocks<T extends Instance>(\n    declarations: ShaderDeclarationStatements,\n    orderedAttributes: IInstanceAttribute<T>[]\n  ) {\n    const out = \"\";\n\n    orderedAttributes.forEach(attribute => {\n      const block = attribute.block;\n\n      if (attribute.size === InstanceAttributeSize.FOUR) {\n        // If we have a size the size of a block, then don't swizzle the vector\n        this.setDeclaration(\n          declarations,\n          attribute.name,\n          `  ${sizeToType[attribute.size]} ${\n            attribute.name\n          } = block${block};\\n`,\n          debugCtx\n        );\n      } else {\n        // Do normal destructuring with any other size and type\n        this.setDeclaration(\n          declarations,\n          attribute.name,\n          `  ${sizeToType[attribute.size || 1]} ${\n            attribute.name\n          } = block${block}.${makeVectorSwizzle(\n            attribute.blockIndex || 0,\n            attribute.size || 1\n          )};\\n`,\n          debugCtx\n        );\n      }\n    });\n\n    return out;\n  }\n\n  /**\n   * This processes the declarations needed to set up the Input for the shader from the layer.\n   *\n   * This handles the buffer strategies of:\n   *\n   * Vertex Attributes,\n   * Vertex Attribute Packing,\n   * Uniform Packing\n   */\n  processHeaderInjection(\n    target: ShaderInjectionTarget,\n    declarations: ShaderDeclarationStatements,\n    layer: Layer<Instance, ILayerProps<Instance>>,\n    metrics: MetricsProcessing,\n    vertexAttributes: IVertexAttribute[],\n    instanceAttributes: IInstanceAttribute<Instance>[],\n    uniforms: IUniform[]\n  ): ShaderIOHeaderInjectionResult {\n    let attributeDeclarations = {\n      injection: \"\"\n    };\n\n    // Attributes are only injected into the vertex shader\n    if (target === ShaderInjectionTarget.VERTEX) {\n      attributeDeclarations = this.processAttributeHeader(\n        declarations,\n        layer,\n        metrics,\n        vertexAttributes,\n        instanceAttributes\n      );\n    }\n\n    const uniformDeclaration = this.processUniformHeader(\n      declarations,\n      uniforms,\n      target\n    );\n\n    return {\n      ...attributeDeclarations,\n      injection: attributeDeclarations.injection + uniformDeclaration\n    };\n  }\n\n  /**\n   * Processes all IO for attribute declarations needed in the header of the shader.\n   */\n  private processAttributeHeader(\n    declarations: ShaderDeclarationStatements,\n    layer: Layer<Instance, ILayerProps<Instance>>,\n    metrics: MetricsProcessing,\n    vertexAttributes: IVertexAttribute[],\n    instanceAttributes: IInstanceAttribute<Instance>[]\n  ): ShaderIOHeaderInjectionResult {\n    let materialChanges = undefined;\n    let out = \"// Shader input\\n\";\n\n    // If we are in a uniform buffer type strategy. Then we generate a uniform buffer that will contain\n    // our instance attribute information along with some extras to help dereference from the buffer.\n    if (\n      layer.bufferType === LayerBufferType.UNIFORM &&\n      instanceAttributes.length > 0\n    ) {\n      const packing = this.generateUniformAttributePacking(\n        declarations,\n        metrics\n      );\n      materialChanges = packing.material;\n      out += packing.injection;\n    }\n\n    // Add in the vertex attributes input\n    out += this.processVertexAttributes(declarations, vertexAttributes);\n\n    // If we are in an instance attribute Buffer Type strategy, then we simply list out\n    // the attributes listed in our instance attributes as attributes.\n    if (\n      layer.bufferType === LayerBufferType.INSTANCE_ATTRIBUTE &&\n      instanceAttributes.length > 0\n    ) {\n      out += this.processInstanceAttributeBufferStrategy(\n        declarations,\n        instanceAttributes\n      );\n    }\n\n    // If we are in an instance attribute \"packing\" buffer type strategy, then the layer\n    // is expecting to have attributes that are \"blocks\" instead of explicitally named\n    // attributes. The layer will be utilizing the blocks to efficiently pack in our instance information\n    if (\n      layer.bufferType === LayerBufferType.INSTANCE_ATTRIBUTE_PACKING &&\n      instanceAttributes.length > 0\n    ) {\n      out += this.processInstanceAttributePackingBufferStrategy(\n        declarations,\n        metrics.instanceMaxBlock\n      );\n    }\n\n    return {\n      injection: out,\n      material: materialChanges\n    };\n  }\n\n  /**\n   * Processes all IO for uniform declarations needed in the header of the shader.\n   */\n  private processUniformHeader(\n    declarations: ShaderDeclarationStatements,\n    uniforms: IUniform[],\n    injectionType: ShaderInjectionTarget\n  ) {\n    const out = \"\";\n    const injection = injectionType || ShaderInjectionTarget.VERTEX;\n\n    uniforms.forEach(uniform => {\n      uniform.shaderInjection =\n        uniform.shaderInjection || ShaderInjectionTarget.VERTEX;\n\n      if (\n        uniform.shaderInjection === injection ||\n        uniform.shaderInjection === ShaderInjectionTarget.ALL\n      ) {\n        this.setDeclaration(\n          declarations,\n          uniform.name,\n          `uniform ${uniform.qualifier || \"\"}${uniform.qualifier ? \" \" : \"\"}${\n            sizeToType[uniform.size]\n          } ${uniform.name};\\n`,\n          debugCtx\n        );\n      }\n    });\n\n    return out;\n  }\n\n  /**\n   * Produces attributes that are explicitally named and set by the attribute itself.\n   */\n  private processInstanceAttributeBufferStrategy<T extends Instance>(\n    declarations: ShaderDeclarationStatements,\n    instanceAttributes: IInstanceAttribute<T>[]\n  ) {\n    instanceAttributes.forEach(attribute => {\n      this.setDeclaration(\n        declarations,\n        attribute.name,\n        `attribute ${sizeToType[attribute.size || 1]} ${attribute.qualifier ||\n          \"\"}${(attribute.qualifier && \" \") || \"\"} ${attribute.name};\\n`,\n        debugCtx\n      );\n    });\n\n    return \"\";\n  }\n\n  /**\n   * Produces attributes that are blocks instead of individual attributes. The system uses these\n   * blocks to pack attributes tightly together to maximize capabilities.\n   */\n  private processInstanceAttributePackingBufferStrategy(\n    declarations: ShaderDeclarationStatements,\n    maxBlock: number\n  ) {\n    // Now print out blocks up to that block\n    for (let i = 0, iMax = maxBlock + 1; i < iMax; ++i) {\n      this.setDeclaration(\n        declarations,\n        `block${i}`,\n        `attribute ${sizeToType[InstanceAttributeSize.FOUR]} block${i};\\n`,\n        debugCtx\n      );\n    }\n\n    return \"\";\n  }\n\n  /**\n   * Produces the vertex attributes without any bias or modification.\n   */\n  private processVertexAttributes(\n    declarations: ShaderDeclarationStatements,\n    vertexAttributes: IVertexAttribute[]\n  ) {\n    // No matter what, vertex attributes listed are strictly vertex attributes\n    vertexAttributes.forEach(attribute => {\n      this.setDeclaration(\n        declarations,\n        attribute.name,\n        `attribute ${sizeToType[attribute.size]} ${attribute.qualifier ||\n          \"\"}${(attribute.qualifier && \" \") || \"\"}${attribute.name};\\n`,\n        debugCtx\n      );\n    });\n\n    return \"\";\n  }\n}\n","import { IProjection, PickType } from \"../../types\";\nimport { Vec2 } from \"../../util\";\nimport { EventManager } from \"../event-manager\";\nimport { Layer } from \"../layer\";\nimport { LayerSurface } from \"../layer-surface\";\nimport {\n  IDragMetrics,\n  IMouseInteraction,\n  SceneView\n} from \"../mouse-event-manager\";\n\nfunction isDefined<T>(val: T | null | undefined): val is T {\n  return Boolean(val);\n}\n\n/**\n * This class is an injected event manager for the surface, it specifically handles taking in mouse events intended for view interactions\n * and broadcasts them to the layers that have picking enabled, thus allowing the layers to respond to\n * mouse view locations and broadcast Instance interactions based on the interaction with the View the layer is a part of\n *\n * In Summary: This is an adapter that takes in interactions to the views and injects those events into the layers associated with\n * the views so that the layers can translate the events to gestures.\n */\nexport class LayerMouseEvents extends EventManager {\n  /** This tracks which views have the mouse over them so we can properly broadcast view is out events */\n  isOver = new Map<SceneView, boolean>();\n  /** This is the surface this manager is aiding with broadcasting events to layers */\n  sceneViews: SceneView[];\n  /**\n   * This is the surface this LayerMouseEvent Controller is operating on behalf of. We use this to trigger,\n   * pre-layer processing items, such as color pick narrowing prior to the Layers receiving the event.\n   */\n  surface: LayerSurface;\n\n  constructor(surface: LayerSurface) {\n    super();\n    this.surface = surface;\n    this.sceneViews = surface.sceneViews;\n  }\n\n  getSceneViewsUnderMouse(e: IMouseInteraction) {\n    const sceneViewByViewId = new Map<string, SceneView>();\n\n    // Map the scene views by the view's identifiers\n    for (const sceneView of this.sceneViews) {\n      sceneViewByViewId.set(sceneView.view.id, sceneView);\n    }\n\n    // Now retrieve and convert each view under the mouse to the scene view it coincides with\n    return e.viewsUnderMouse\n      .map(viewItem => sceneViewByViewId.get(viewItem.view.id))\n      .filter(isDefined);\n  }\n\n  getMouseByViewId(e: IMouseInteraction) {\n    // This is the mouse position for the provided view in view space\n    const viewMouseByViewId = new Map<string, Vec2>();\n\n    for (const viewItem of e.viewsUnderMouse) {\n      viewMouseByViewId.set(viewItem.view.id, viewItem.mouse);\n    }\n\n    return viewMouseByViewId;\n  }\n\n  handleClick(e: IMouseInteraction, button: number) {\n    this.handleInteraction(e, (layer, view, mouse) => {\n      layer.interactions.handleMouseClick(view, mouse, button);\n    });\n  }\n\n  handleDrag(e: IMouseInteraction, _drag: IDragMetrics) {\n    this.handleInteraction(e, (layer, view, mouse) =>\n      layer.interactions.handleMouseDrag(view, mouse)\n    );\n  }\n\n  handleInteraction(\n    e: IMouseInteraction,\n    callback: (layer: Layer<any, any>, view: IProjection, mouse: Vec2) => void\n  ) {\n    // Get all of the scenes under the mouse\n    const sceneViews = this.getSceneViewsUnderMouse(e);\n    // Get a lookup of a view id to the mouse position in the view\n    const viewMouseByViewId = this.getMouseByViewId(e);\n\n    // For every view of every scene, we must tell it's layers it's world space is receiving mouse interactions\n    for (const sceneView of sceneViews) {\n      this.handleSceneView(sceneView, viewMouseByViewId, callback);\n    }\n\n    return sceneViews;\n  }\n\n  handleMouseDown(e: IMouseInteraction, button: number) {\n    this.handleInteraction(e, (layer, view, mouse) =>\n      layer.interactions.handleMouseDown(view, mouse, button)\n    );\n  }\n\n  handleMouseUp(e: IMouseInteraction, button: number) {\n    this.handleInteraction(e, (layer, view, mouse) =>\n      layer.interactions.handleMouseUp(view, mouse, button)\n    );\n  }\n\n  handleMouseOver(_e: IMouseInteraction) {\n    // We let the mouse move event handle the registration of moused over views\n  }\n\n  handleMouseOut(e: IMouseInteraction) {\n    // Get a lookup of a view id to the mouse position in the view\n    const viewMouseByViewId = this.getMouseByViewId(e);\n    const screen = e.screen.mouse;\n\n    // All views that are moused over should no longer be considered over and broadcast a mouse out\n    this.isOver.forEach((_flag, sceneView) => {\n      // Since we are leaving the view we must make the view relative cooridinates fromt he screen space coords\n      viewMouseByViewId.set(\n        sceneView.view.id,\n        sceneView.view.screenToView(screen)\n      );\n\n      this.handleSceneView(sceneView, viewMouseByViewId, (layer, view, mouse) =>\n        layer.interactions.handleMouseOut(view, mouse)\n      );\n    });\n\n    // Nothing is over anymore\n    this.isOver.clear();\n  }\n\n  handleMouseMove(e: IMouseInteraction) {\n    if (this.surface) {\n      this.surface.updateColorPickRange(\n        e.screen.mouse,\n        e.viewsUnderMouse.map(v => v.view)\n      );\n    }\n\n    // Get all of the scenes we have interacted with, and broadcast a move event for each\n    const allSceneViews = this.handleInteraction(e, (layer, view, mouse) =>\n      layer.interactions.handleMouseMove(view, mouse)\n    );\n    // Get a lookup of a view id to the mouse position in the view\n    const viewMouseByViewId = this.getMouseByViewId(e);\n    // Get the position of the mouse on the screen\n    const screen = e.screen.mouse;\n\n    // For quick lookups map all of the current SceneViews that are over\n    const currentSceneViews = new Map<SceneView, boolean>();\n    allSceneViews.forEach(v => currentSceneViews.set(v, true));\n\n    // Detect which of the views are no longer over\n    this.isOver.forEach((_flag, sceneView) => {\n      if (!currentSceneViews.get(sceneView)) {\n        // Since these views were not interacted with, we must create the mouse interaction position\n        viewMouseByViewId.set(\n          sceneView.view.id,\n          sceneView.view.screenToView(screen)\n        );\n\n        this.handleSceneView(\n          sceneView,\n          viewMouseByViewId,\n          (layer, view, mouse) => layer.interactions.handleMouseOut(view, mouse)\n        );\n      }\n    });\n\n    // Detect which of the views are newly over\n    currentSceneViews.forEach((_flag, sceneView) => {\n      if (!this.isOver.get(sceneView)) {\n        this.handleSceneView(\n          sceneView,\n          viewMouseByViewId,\n          (layer, view, mouse) =>\n            layer.interactions.handleMouseOver(view, mouse)\n        );\n      }\n    });\n\n    // Update the current views that are over to the currently over views for next event\n    this.isOver = currentSceneViews;\n  }\n\n  handleSceneView(\n    sceneView: SceneView,\n    viewMouseByViewId: Map<string, Vec2>,\n    callback: (layer: Layer<any, any>, view: IProjection, mouse: Vec2) => void\n  ) {\n    const view = sceneView.view;\n    const mouse = viewMouseByViewId.get(view.id);\n\n    if (mouse) {\n      for (const layer of sceneView.scene.layers) {\n        if (layer.picking && layer.picking.type !== PickType.NONE) {\n          callback(layer, view, mouse);\n        }\n      }\n    }\n  }\n\n  handleWheel(_e: IMouseInteraction) {\n    // TODO: This may need to be implemented. As of right now, there is no particular benefit\n  }\n}\n","import { Instance } from \"../instance-provider/instance\";\nimport { IInstanceAttribute, IUniform, IVertexAttribute } from \"../types\";\n\n/**\n * This provides the sorting methods to be applied to\n */\nexport class BaseIOSorting {\n  /**\n   * This sorts the attributes such that the attributes that MUST be updated first are put to the top.\n   * This is necessary for complex attributes like atlas and easing attributes who have other attributes\n   * that have dependent behaviors based on their source attribute.\n   */\n  sortInstanceAttributes<T extends Instance>(\n    a: IInstanceAttribute<T>,\n    b: IInstanceAttribute<T>\n  ) {\n    if (a.resource && !b.resource) return -1;\n    if (a.easing && !b.easing) return -1;\n    return 1;\n  }\n\n  /**\n   * This sorts the vertex attributes in the expected order of updating.\n   */\n  sortVertexAttributes(_a: IVertexAttribute, _b: IVertexAttribute) {\n    return 1;\n  }\n\n  /**\n   * This sorts the uniforms in the expected order of updating.\n   */\n  sortUniforms(_a: IUniform, _b: IUniform) {\n    return 1;\n  }\n}\n","import { IColorPickingData } from \"../types\";\nimport { Vec2, Vec4 } from \"./vector\";\n\n/**\n * This analyzes the rendered data for color picking and outputs the metrics and data needed\n * for the operation.\n */\nexport function analyzeColorPickingRendering(\n  mouse: Vec2,\n  data: Uint8Array,\n  width: number,\n  height: number\n) {\n  const pickingData: IColorPickingData = {\n    allColors: [],\n    colorData: data,\n    dataHeight: height,\n    dataWidth: width,\n    mouse,\n    nearestColor: 0,\n    nearestColorBytes: [0, 0, 0, 0]\n  };\n\n  const uniqueColors = new Map<number, boolean>();\n  let pixelIndex = 0;\n  const colors: number[][] = [];\n  const mouseX: number = width / 2;\n  const mouseY: number = height / 2;\n\n  let nearestColor = 0x000000;\n  let nearestColorBytes: Vec4 = [0, 0, 0, 0];\n  let distance = Number.MAX_SAFE_INTEGER;\n\n  for (let i = 0; i < height; ++i) {\n    const row: number[] = [];\n    colors.push(row);\n\n    for (let k = 0; k < width; ++k) {\n      const r = data[pixelIndex];\n      const g = data[pixelIndex + 1];\n      const b = data[pixelIndex + 2];\n      pixelIndex += 4;\n\n      const color = (r << 16) | (g << 8) | b;\n      uniqueColors.set(color, true);\n      row.push(color);\n\n      // If the color is not black, let's test the distance against currnet nearest color\n      if (color !== 0x000000) {\n        const dx = k - mouseX;\n        const dy = i - mouseY;\n        const testDistance = dx * dx + dy * dy;\n\n        if (testDistance < distance) {\n          distance = testDistance;\n          nearestColor = color;\n          nearestColorBytes = [r, g, b, 255];\n        }\n      }\n    }\n  }\n\n  // Apply all o fthe unique colors that were discovered within the rendering\n  pickingData.allColors = Array.from(uniqueColors.keys());\n  // The nearest color will be the element in the middle of the array of colors\n  pickingData.nearestColor = nearestColor;\n  // The nearest color in byte components\n  pickingData.nearestColorBytes = nearestColorBytes;\n\n  return pickingData;\n}\n","module.exports = \"\\n  // This is a special injected instance attribute. It lets the system\\n  // control specific instances ability to draw, which allows the backend\\n  // system greater control on how it optimizes draw calls and it's buffers.\\n  if (_active == 0.0) {\\n    gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\\n\\n    // Quick exit to prevent any geometry from arising from the instance\\n    return;\\n  }\\n\\n\"","import { activeAttributeName } from \"../../../constants\";\nimport { Instance } from \"../../../instance-provider/instance\";\nimport { ShaderDeclarationStatements } from \"../../../shaders/processing/base-shader-io-injection\";\nimport { MetricsProcessing } from \"../../../shaders/processing/metrics-processing\";\nimport { ILayerProps, Layer } from \"../../../surface/layer\";\nimport { BaseIOExpansion } from \"../../../surface/layer-processing/base-io-expansion\";\nimport { IInstanceAttribute, IUniform, IVertexAttribute } from \"../../../types\";\n\nconst debugCtx = \"ActiveIOExpansion\";\n\n/**\n * This is a special case io expander that handles detecting the _active attribute\n * and properly injecting the _active handler in the destructuring phase.\n *\n * Any IO expansion that writes destructuring logic will have it's destructuring logic\n */\nexport class ActiveIOExpansion extends BaseIOExpansion {\n  processAttributeDestructuring(\n    _layer: Layer<Instance, ILayerProps<Instance>>,\n    declarations: ShaderDeclarationStatements,\n    _metrics: MetricsProcessing,\n    _vertexAttributes: IVertexAttribute[],\n    instanceAttributes: IInstanceAttribute<Instance>[],\n    _uniforms: IUniform[]\n  ): string {\n    const out = \"\";\n\n    // Find the active attribute. If it exists we inject our active attribute handler\n    if (!instanceAttributes.find(attr => attr.name === activeAttributeName)) {\n      return out;\n    }\n\n    // The final item in the destructuring will always be the active attribute handler to ensure elements\n    // honor the active control\n    this.setDeclaration(\n      declarations,\n      \"__active_attribute_handler__\",\n      require(\"./fragments/active-attribute-handler.vs\"),\n      debugCtx\n    );\n\n    return out;\n  }\n}\n","import { Instance } from \"../instance-provider/instance\";\nimport { Bounds } from \"../primitives\";\nimport {\n  IColorPickingData,\n  InstanceHitTest,\n  IPickInfo,\n  IProjection,\n  PickType\n} from \"../types\";\nimport { TrackedQuadTree, Vec2 } from \"../util\";\nimport { UniformColorDiffProcessor } from \"./buffer-management/uniform-buffering/uniform-color-diff-processor\";\nimport { ILayerProps, Layer } from \"./layer\";\n\nfunction isColorProcessor<T extends Instance>(\n  val: any\n): val is UniformColorDiffProcessor<T> {\n  return val && val.colorPicking;\n}\n\n/**\n * This manages mouse gestures broadcast to the layer and handles appropriate actions such as determining\n * how to make the interaction translate to picking events for the layer's instances.\n *\n * This class, in summary, takes in the gestures to the view and converts them to gestures to the instances.\n */\nexport class LayerInteractionHandler<\n  T extends Instance,\n  U extends ILayerProps<T>\n> {\n  /** This is the color picking information most recently rendered */\n  colorPicking?: IColorPickingData;\n  /** This tracks the elements that have the mouse currently over them */\n  isMouseOver = new Map<T, boolean>();\n  /** This tracks the elements the mouse was down on */\n  isMouseDown = new Map<T, boolean>();\n  /** This is the layer the interaction handler manages events for */\n  layer: Layer<T, U>;\n\n  constructor(layer: Layer<T, U>) {\n    this.layer = layer;\n  }\n\n  /**\n   * Retrieves the color picking instance determined for the procedure.\n   */\n  getColorPickInstance() {\n    if (\n      this.colorPicking &&\n      this.layer.diffManager &&\n      isColorProcessor<T>(this.layer.diffManager.processor)\n    ) {\n      return this.layer.diffManager.processor.colorPicking.uidToInstance.get(\n        0xffffff - this.colorPicking.nearestColor\n      );\n    }\n\n    return null;\n  }\n\n  /**\n   * Handles mouse down gestures for a layer within a view\n   */\n  handleMouseOver(_view: IProjection, _mouse: Vec2) {\n    // This is the mouse over for the view itself. We should probably just let the mouse over events handle the interactions\n    // With the instances\n  }\n\n  /**\n   * Handles mouse down gestures for a layer within a view\n   */\n  handleMouseDown(view: IProjection, mouse: Vec2, button: number) {\n    // This handles interactions for PickType ALL layers\n    if (this.layer.picking && this.layer.picking.type !== PickType.NONE) {\n      const { onMouseDown } = this.layer.props;\n\n      // If we have a listener for either event we should continue to process the event in more detail\n      if (onMouseDown) {\n        const world = view.viewToWorld(mouse);\n        let hitTest: InstanceHitTest<T>;\n        let query: TrackedQuadTree<T>[\"query\"];\n        let querySpace;\n        let instances: T[] = [];\n\n        if (this.layer.picking.type === PickType.ALL) {\n          hitTest = this.layer.picking.hitTest;\n          query = this.layer.picking.quadTree.query.bind(\n            this.layer.picking.quadTree\n          );\n          querySpace = (check: Bounds | Vec2) =>\n            query(check).filter(o => hitTest(o, world, view));\n          instances = query(world).filter(o => hitTest(o, world, view));\n        } else if (this.layer.picking.type === PickType.SINGLE) {\n          // Get the instance for the nearest color\n          const instanceForColor = this.getColorPickInstance();\n\n          if (instanceForColor) {\n            instances.push(instanceForColor);\n          }\n        }\n\n        const info: IPickInfo<T> = {\n          button,\n          instances,\n          layer: this.layer.id,\n          projection: view,\n          querySpace,\n          screen: mouse,\n          world\n        };\n\n        onMouseDown(info);\n\n        // We track all the elements the mouse is currently down on\n        this.isMouseDown.clear();\n        instances.forEach(o => this.isMouseDown.set(o, true));\n      }\n    }\n  }\n\n  /**\n   * Handles mouse out events for a layer within the view\n   */\n  handleMouseOut(view: IProjection, mouse: Vec2) {\n    // This will fire an instance mouse out for any over instances in the queue since we left the view\n    // Thus no instances shall be considered 'over'\n    if (this.layer.picking && this.layer.picking.type !== PickType.NONE) {\n      const { onMouseOut } = this.layer.props;\n\n      if (onMouseOut) {\n        const world = view.viewToWorld(mouse);\n        let hitTest: InstanceHitTest<T>;\n        let query: TrackedQuadTree<T>[\"query\"];\n        let querySpace;\n\n        if (this.layer.picking.type === PickType.ALL) {\n          hitTest = this.layer.picking.hitTest;\n          query = this.layer.picking.quadTree.query.bind(\n            this.layer.picking.quadTree\n          );\n          querySpace = (check: Bounds | Vec2) =>\n            query(check).filter(o => hitTest(o, world, view));\n        }\n\n        const info: IPickInfo<T> = {\n          instances: Array.from(this.isMouseOver.keys()),\n          layer: this.layer.id,\n          projection: view,\n          querySpace,\n          screen: mouse,\n          world\n        };\n\n        onMouseOut(info);\n      }\n    }\n\n    // We clear as no instances are over anymore\n    this.isMouseOver.clear();\n    // We also clear all down elements as the mouse is no longer in proper context for the instances\n    // But since the mouse was never actually released, we do not fire an up\n    this.isMouseDown.clear();\n  }\n\n  /**\n   * Handles mouse up gestures for the layer within the provided view\n   */\n  handleMouseUp(view: IProjection, mouse: Vec2, button: number) {\n    // This handles interactions for PickType ALL layers\n    if (this.layer.picking && this.layer.picking.type !== PickType.NONE) {\n      const { onMouseUp } = this.layer.props;\n\n      // If we have a listener for either event we should continue to process the event in more detail\n      if (onMouseUp) {\n        const world = view.viewToWorld(mouse);\n        let hitTest: InstanceHitTest<T>;\n        let query: TrackedQuadTree<T>[\"query\"];\n        let querySpace;\n        let instances: T[] = [];\n\n        if (this.layer.picking.type === PickType.ALL) {\n          hitTest = this.layer.picking.hitTest;\n          query = this.layer.picking.quadTree.query.bind(\n            this.layer.picking.quadTree\n          );\n          querySpace = (check: Bounds | Vec2) =>\n            query(check).filter(o => hitTest(o, world, view));\n          instances = query(world).filter(o => hitTest(o, world, view));\n        } else if (this.layer.picking.type === PickType.SINGLE) {\n          // Get the instance for the nearest color\n          const instanceForColor = this.getColorPickInstance();\n\n          if (instanceForColor) {\n            instances.push(instanceForColor);\n          }\n        }\n\n        const info: IPickInfo<T> = {\n          button,\n          instances,\n          layer: this.layer.id,\n          projection: view,\n          querySpace,\n          screen: mouse,\n          world\n        };\n\n        onMouseUp(info);\n      }\n    }\n  }\n\n  /**\n   * Mouse move events on the layer will detect when instances have their item newly over or just moved on\n   */\n  handleMouseMove(view: IProjection, mouse: Vec2) {\n    // This handles interactions for PickType ALL layers\n    const { onMouseOver, onMouseMove, onMouseOut } = this.layer.props;\n\n    if (this.layer.picking && this.layer.picking.type !== PickType.NONE) {\n      // If we have a listener for either event we should continue to process the event in more detail\n      if (onMouseOver || onMouseMove || onMouseOut) {\n        let info: IPickInfo<T>;\n        const world = view.viewToWorld(mouse);\n        let hitTest: InstanceHitTest<T>;\n        let query: TrackedQuadTree<T>[\"query\"];\n        let querySpace;\n        let instances: T[] = [];\n\n        if (this.layer.picking.type === PickType.ALL) {\n          hitTest = this.layer.picking.hitTest;\n          query = this.layer.picking.quadTree.query.bind(\n            this.layer.picking.quadTree\n          );\n          querySpace = (check: Bounds | Vec2) =>\n            query(check).filter(o => hitTest(o, world, view));\n          instances = query(world).filter(o => hitTest(o, world, view));\n        } else if (this.layer.picking.type === PickType.SINGLE) {\n          // Get the instance for the nearest color\n          const instanceForColor = this.getColorPickInstance();\n\n          if (instanceForColor) {\n            instances.push(instanceForColor);\n          }\n        }\n\n        // Broadcast the picking info for newly over instances to any of the layers listeners if needed\n        if (onMouseOver) {\n          const notOverInstances = instances.filter(\n            o => !this.isMouseOver.get(o)\n          );\n          info = {\n            instances: notOverInstances,\n            layer: this.layer.id,\n            projection: view,\n            querySpace,\n            screen: mouse,\n            world\n          };\n\n          if (notOverInstances.length > 0) onMouseOver(info);\n        }\n\n        // Broadcast the the picking info for all instances that the mouse moved on\n        if (onMouseMove) {\n          // This is the pick info object we will broadcast from the layer\n          info = {\n            instances,\n            layer: this.layer.id,\n            projection: view,\n            querySpace,\n            screen: mouse,\n            world\n          };\n\n          onMouseMove(info);\n        }\n\n        // We take the hovered instances\n        const isCurrentlyOver = new Map<T, boolean>();\n        instances.forEach(o => isCurrentlyOver.set(o, true));\n\n        // Broadcast the the picking info for all instances that the mouse moved off of\n        if (onMouseOut) {\n          const noLongerOver = Array.from(this.isMouseOver.keys()).filter(\n            o => !isCurrentlyOver.get(o)\n          );\n\n          // This is the pick info object we will broadcast from the layer\n          info = {\n            instances: noLongerOver,\n            layer: this.layer.id,\n            projection: view,\n            querySpace,\n            screen: mouse,\n            world\n          };\n\n          if (noLongerOver.length > 0) onMouseOut(info);\n        }\n\n        // We store the current hovered over items as our over item list for next interaction\n        this.isMouseOver = isCurrentlyOver;\n      }\n    }\n  }\n\n  /**\n   * Handles click gestures on the layer within a view\n   */\n  handleMouseClick(view: IProjection, mouse: Vec2, button: number) {\n    // This handles interactions for PickType ALL layers\n    if (this.layer.picking && this.layer.picking.type !== PickType.NONE) {\n      const { onMouseClick } = this.layer.props;\n\n      // If we have a listener for either event we should continue to process the event in more detail\n      if (onMouseClick) {\n        const world = view.viewToWorld(mouse);\n        let hitTest: InstanceHitTest<T>;\n        let query: TrackedQuadTree<T>[\"query\"];\n        let querySpace;\n        let instances: T[] = [];\n\n        if (this.layer.picking.type === PickType.ALL) {\n          hitTest = this.layer.picking.hitTest;\n          query = this.layer.picking.quadTree.query.bind(\n            this.layer.picking.quadTree\n          );\n          querySpace = (check: Bounds | Vec2) =>\n            query(check).filter(o => hitTest(o, world, view));\n          instances = query(world).filter(o => hitTest(o, world, view));\n        } else if (this.layer.picking.type === PickType.SINGLE) {\n          // Get the instance for the nearest color\n          const instanceForColor = this.getColorPickInstance();\n\n          if (instanceForColor) {\n            instances.push(instanceForColor);\n          }\n        }\n\n        const info: IPickInfo<T> = {\n          button,\n          instances,\n          layer: this.layer.id,\n          projection: view,\n          querySpace,\n          screen: mouse,\n          world\n        };\n\n        onMouseClick(info);\n      }\n    }\n  }\n\n  /**\n   * Handles drag gestures for the layer within the view\n   */\n  handleMouseDrag(_view: IProjection, _mouse: Vec2) {\n    // We probably should not broadcast drag events for the sake of instances. Instance dragging should be handled on\n    // An instance by instance basis rather than coming from the view's gestures\n  }\n}\n","import { WebGLStat } from \"../../gl/webgl-stat\";\nimport { Instance } from \"../../instance-provider/instance\";\nimport { IInstanceAttribute, IUniform } from \"../../types\";\n\n/**\n * This handles processing some metrics that are commonly needed by other processors.\n */\nexport class MetricsProcessing {\n  /** This is an instance's max listed block */\n  instanceMaxBlock: number;\n  /** This is the number of blocks each instance will use */\n  blocksPerInstance: number;\n  /** This is how many uniform blocks the current device can utilize in a shader */\n  maxUniforms: number;\n  /** This reflects how many uniform blocks are available for instancing */\n  maxUniformsForInstancing: number;\n  /** Get the number of instances the client's system supports specifically for uniform instancing */\n  maxInstancesPerUniformBuffer: number;\n  /** This is the total blocks to be used in our uniform buffer for handling instances */\n  totalInstanceUniformBlocks: number;\n\n  /**\n   * This calculates how many uniform blocks are utilized based on the input uniforms\n   */\n  static calculateUniformBlockUseage(uniforms: IUniform[]) {\n    let count = 0;\n\n    for (let i = 0, end = uniforms.length; i < end; ++i) {\n      count += Math.ceil(uniforms[i].size / 4);\n    }\n\n    return count;\n  }\n\n  /**\n   * Calculates all of the metrics that will be needed in this processor.\n   */\n  process<T extends Instance>(\n    instanceAttributes: IInstanceAttribute<T>[],\n    uniforms: IUniform[]\n  ) {\n    this.instanceMaxBlock = 0;\n\n    // First find the max block to be utilized\n    instanceAttributes.forEach(attribute => {\n      this.instanceMaxBlock = Math.max(\n        this.instanceMaxBlock,\n        attribute.block || 0\n      );\n    });\n\n    this.blocksPerInstance = this.instanceMaxBlock + 1;\n    this.maxUniforms = WebGLStat.MAX_VERTEX_UNIFORMS;\n    this.maxUniformsForInstancing =\n      this.maxUniforms -\n      MetricsProcessing.calculateUniformBlockUseage(uniforms);\n    this.maxInstancesPerUniformBuffer = Math.floor(\n      this.maxUniformsForInstancing / this.blocksPerInstance\n    );\n    this.totalInstanceUniformBlocks =\n      this.maxInstancesPerUniformBuffer * this.blocksPerInstance;\n  }\n}\n","/**\n * The purpose of this file and processes is to take a layers attributes and\n * instance attributes and optimally pack them into blocks. As it should be known\n * an attribute and a uniform is limited by the hardware in 'blocks'. Each block\n * for webgl 1.0 is 4 floats. If you use a single float and not the rest, you have\n * used an entire block.\n *\n * Thus, we pack down the attributes into appropriate block indices and slots.\n */\n\nimport { Instance } from \"../../instance-provider/instance\";\nimport { IInstanceAttribute, InstanceAttributeSize } from \"../../types\";\n\n/**\n * A quick representation of an available block with a convenience method to easily apply\n * metrics to an attribute if it fits.\n */\nclass Block<T extends Instance> {\n  index: number = 0;\n  available: number = 4;\n\n  constructor(blockIndex: number) {\n    this.index = blockIndex;\n  }\n\n  setAttribute(attr: IInstanceAttribute<T>) {\n    if ((attr.size || 0) <= this.available) {\n      attr.block = this.index;\n      attr.blockIndex = 4 - this.available;\n      this.available -= attr.size || 0;\n\n      return true;\n    }\n\n    return false;\n  }\n}\n\n/**\n * This loops through all attributes and ensures each attribute is applied\n */\nfunction ensureSizes<T extends Instance>(attributes: IInstanceAttribute<T>[]) {\n  attributes.forEach(attr => {\n    if (attr.resource && attr.size === undefined) {\n      attr.size = InstanceAttributeSize.FOUR;\n    }\n\n    // If the size of the attribute is not determiend at this point, we do our best\n    // to find it by whatever means possible\n    if (!attr.size) {\n      try {\n        // We inject a very phoney instance, we don't need accurate data, we will be happy if we get\n        // an array of undefineds which should be in line with the size of the attribute.\n        const check = attr.update(new Instance({}) as T);\n\n        // We see if the output is sane\n        if (check.length > 0 && check.length <= InstanceAttributeSize.FOUR) {\n          attr.size = check.length;\n        }\n      } catch (err) {\n        console.warn(\n          \"The system could not determine the size of the provided attribute. Please provide the size of the attribute:\",\n          attr\n        );\n      }\n    }\n  });\n}\n\n/**\n * This is the packing method that calculates the block and block index best suited for an attribute\n * so a layer developer does not have to worry about it.\n */\nexport function packAttributes<T extends Instance>(\n  attributes: IInstanceAttribute<T>[]\n) {\n  // First make sure each attribute has a size\n  ensureSizes(attributes);\n  // Keep a list of the blocks we have decided needs to be in use\n  const blocks = [new Block(0)];\n\n  // Loop through all attributes and pack em' in\n  attributes.forEach(attr => {\n    // Look for a block that can fit our attribute\n    const block = blocks.find(block => {\n      if (block.setAttribute(attr)) {\n        return Boolean(block);\n      }\n\n      return false;\n    });\n\n    // If our attribute did not fit into any of the existing blocks, then we must create a new block\n    // to stuff our attribute into.\n    if (!block) {\n      const newBlock = new Block(blocks.length);\n      blocks.push(newBlock);\n\n      if (!newBlock.setAttribute(attr)) {\n        console.warn(\n          \"There was a problem packing an attribute into a block. No block would accommodate it:\",\n          attr\n        );\n      }\n    }\n  });\n}\n","import { Instance } from \"../../instance-provider/instance\";\nimport { BaseIOSorting } from \"../../surface/base-io-sorting\";\nimport { ILayerProps, Layer } from \"../../surface/layer\";\nimport { BaseIOExpansion } from \"../../surface/layer-processing/base-io-expansion\";\nimport { injectShaderIO } from \"../../surface/layer-processing/inject-shader-io\";\nimport { getLayerBufferType } from \"../../surface/layer-processing/layer-buffer-type\";\nimport {\n  IInstanceAttribute,\n  IInstancingUniform,\n  IShaderInitialization,\n  IShaders,\n  IUniformInternal,\n  IVertexAttributeInternal,\n  ShaderInjectionTarget\n} from \"../../types\";\nimport { shaderTemplate } from \"../../util/shader-templating\";\nimport { templateVars } from \"../template-vars\";\nimport { ShaderIOHeaderInjectionResult } from \"./base-shader-io-injection\";\nimport { MetricsProcessing } from \"./metrics-processing\";\nimport { ShaderModule } from \"./shader-module\";\nimport { ShaderModuleUnit } from \"./shader-module-unit\";\n\n/**\n * This is the expected results from processing the shader and it's layer's attributes.\n */\nexport interface IShaderProcessingResults<T extends Instance> {\n  /** The resulting fragment shader from processing the module */\n  fs: string;\n  /** Any additional system uniforms that arose from the processing */\n  materialUniforms: IInstancingUniform[];\n  /** Calculated max instances per buffer (mostly for uniform packing procedures) */\n  maxInstancesPerBuffer: number;\n  /** The modules that were included within the module processing */\n  modules: ShaderModuleUnit[];\n  /** The resulting vertex shader from processing the module */\n  vs: string;\n  /** All instance attributes that arise from module processing */\n  instanceAttributes: IInstanceAttribute<T>[];\n  /** All vertex attributes that arise from module processing */\n  vertexAttributes: IVertexAttributeInternal[];\n  /** All uniform attributes that arise from module processing */\n  uniforms: IUniformInternal[];\n}\n\n/** Expected results from processing shader imports */\nexport type ProcessShaderImportResults =\n  | (IShaders & { shaderModuleUnits: Set<ShaderModuleUnit> })\n  | null;\n\n/**\n * The intent of this processor is to analyze a layer's Shader IO elements and produce a functional\n * shader from those elements. This includes supporting a layer's capabilties with the client systems\n * capabilities and matching compatibilities.\n *\n * This inlcudes:\n *\n * Injecting needed module imports based on the layers specifications\n * Resolving Module imports and handling errors\n * Utilizing layer information to create attributes and uniforms based on attribute packing strategies\n * Destructuring attributes based on easing requirements or if attributes were packed\n * Swapping out miscellaneous template variables\n */\nexport class ShaderProcessor {\n  /** Processor that calculates shared metrics across all processors */\n  metricsProcessing: MetricsProcessing = new MetricsProcessing();\n\n  /**\n   * This processes a layer, it's Shader IO requirements, and it's shaders to produce a fully functional\n   * shader that is compatible with the client's system.\n   */\n  process<T extends Instance, U extends ILayerProps<T>>(\n    layer: Layer<T, U>,\n    shaderIO: IShaderInitialization<T>,\n    ioExpansion: BaseIOExpansion[],\n    sortIO: BaseIOSorting\n  ): IShaderProcessingResults<T> | null {\n    try {\n      // First process imports to retrieve the requested IO the shader modules would be requiring\n      const shadersWithImports = this.processImports(layer, shaderIO);\n      if (!shadersWithImports) return null;\n\n      // After processing our imports, we can now fully aggregate the needed shader IO to make our layer\n      // operate properly. Process all of the attributes and apply IO expansion to all of the discovered\n      // shader IO the layer will need to execute.\n      const { vertexAttributes, instanceAttributes, uniforms } = injectShaderIO(\n        layer.surface.gl,\n        layer,\n        shaderIO,\n        ioExpansion,\n        sortIO,\n        shadersWithImports\n      );\n      // After all of the shader IO is established, let's calculate the appropriate buffering strategy\n      // For the layer.\n      getLayerBufferType(\n        layer.surface.gl,\n        layer,\n        vertexAttributes,\n        instanceAttributes\n      );\n\n      // Calculate needed metrics that may be used by any of the processors\n      this.metricsProcessing.process(instanceAttributes, uniforms);\n\n      // We are going to gather headers for both vertex and fragment from our processors\n      let vsHeader = \"\";\n      let fsHeader = \"\";\n      // We will also gather the destructuring structure for the attributes from our processor\n      let destructuring = \"\";\n      // In processing, this may generate changes to the Material to accommodate features required\n      const materialChanges: ShaderIOHeaderInjectionResult[\"material\"] = {\n        uniforms: []\n      };\n\n      const vsHeaderDeclarations = new Map();\n      const fsHeaderDeclarations = new Map();\n      const destructureDeclarations = new Map();\n\n      // Loop through all of our processors that handle expanding all IO into headers for the shader\n      for (let i = 0, iMax = ioExpansion.length; i < iMax; ++i) {\n        const processor = ioExpansion[i];\n\n        // Generate vertex header declarations\n        const vsHeaderInfo = processor.processHeaderInjection(\n          ShaderInjectionTarget.VERTEX,\n          vsHeaderDeclarations,\n          layer,\n          this.metricsProcessing,\n          vertexAttributes,\n          instanceAttributes,\n          uniforms\n        );\n\n        vsHeader += vsHeaderInfo.injection;\n\n        if (vsHeaderInfo.material) {\n          materialChanges.uniforms = materialChanges.uniforms.concat(\n            vsHeaderInfo.material.uniforms || []\n          );\n        }\n\n        // Generate fragment header declarations\n        const fsHeaderInfo = processor.processHeaderInjection(\n          ShaderInjectionTarget.FRAGMENT,\n          fsHeaderDeclarations,\n          layer,\n          this.metricsProcessing,\n          vertexAttributes,\n          instanceAttributes,\n          uniforms\n        );\n\n        fsHeader += fsHeaderInfo.injection;\n\n        if (fsHeaderInfo.material) {\n          materialChanges.uniforms = materialChanges.uniforms.concat(\n            fsHeaderInfo.material.uniforms || []\n          );\n        }\n\n        // Destructure the elements\n        destructuring += processor.processAttributeDestructuring(\n          layer,\n          destructureDeclarations,\n          this.metricsProcessing,\n          vertexAttributes,\n          instanceAttributes,\n          uniforms\n        );\n      }\n\n      // After we have aggregated all of our declarations, we now piece them together\n      let declarations = \"\";\n\n      vsHeaderDeclarations.forEach(declaration => {\n        declarations += declaration;\n      });\n\n      vsHeader = declarations + vsHeader;\n      declarations = \"\";\n\n      fsHeaderDeclarations.forEach(declaration => {\n        declarations += declaration;\n      });\n\n      fsHeader = declarations + fsHeader;\n      declarations = \"\";\n\n      destructureDeclarations.forEach(declaration => {\n        declarations += declaration;\n      });\n\n      destructuring = declarations + destructuring;\n\n      // Create a default precision modifier for now\n      const precision = \"precision highp float;\\n\\n\";\n      // Now we concatenate the shader pieces into one glorious shader of compatibility and happiness\n      const fullShaderVS = precision + vsHeader + shadersWithImports.vs;\n      const fullShaderFS = precision + fsHeader + shadersWithImports.fs;\n\n      // Last we replace any templating variables with their relevant values\n      let templateOptions: { [key: string]: string } = {\n        [templateVars.attributes]: destructuring\n      };\n\n      const processedShaderVS = shaderTemplate({\n        options: templateOptions,\n        required: undefined,\n        shader: fullShaderVS\n      });\n\n      // We process the Fragment shader as well, currently with nothing to replace\n      // aside from removing any superfluous template requests\n      templateOptions = {};\n\n      const processShaderFS = shaderTemplate({\n        options: templateOptions,\n        required: undefined,\n        shader: fullShaderFS\n      });\n\n      const results = {\n        fs: processShaderFS.shader.trim(),\n        materialUniforms: materialChanges.uniforms,\n        maxInstancesPerBuffer: this.metricsProcessing\n          .maxInstancesPerUniformBuffer,\n        modules: Array.from(shadersWithImports.shaderModuleUnits),\n        vs: processedShaderVS.shader.trim(),\n        vertexAttributes,\n        instanceAttributes,\n        uniforms\n      };\n\n      return results;\n    } catch (err) {\n      console.warn(\n        \"An unknown error occurred while processing the shaders for layer:\",\n        layer.id\n      );\n      console.warn(\"Error:\");\n      console.warn(err && (err.stack || err.message));\n      return null;\n    }\n  }\n\n  /**\n   * This applies the imports for the specified layer and generates the appropriate shaders from the output.\n   * Upon failure, this will just return null.\n   *\n   * This also does some additional work to add in some modules based on the layer's preferences\n   */\n  private processImports<T extends Instance, U extends ILayerProps<T>>(\n    layer: Layer<T, U>,\n    shaders: IShaderInitialization<T>\n  ): ProcessShaderImportResults {\n    const shaderModuleUnits = new Set<ShaderModuleUnit>();\n    const baseModules = layer.baseShaderModules(shaders);\n\n    // Process imports for the vertex shader\n    const vs = ShaderModule.process(\n      layer.id,\n      shaders.vs,\n      ShaderInjectionTarget.VERTEX,\n      baseModules.vs\n    );\n\n    if (vs.errors.length > 0) {\n      console.warn(\n        \"Error processing imports for the vertex shader of layer:\",\n        layer.id,\n        \"Errors\",\n        ...vs.errors.reverse()\n      );\n\n      return null;\n    }\n\n    // Process imports for the fragment shader\n    const fs = ShaderModule.process(\n      layer.id,\n      shaders.fs,\n      ShaderInjectionTarget.FRAGMENT,\n      baseModules.fs\n    );\n\n    if (fs.errors.length > 0) {\n      console.warn(\n        \"Error processing imports for the fragment shader of layer:\",\n        layer.id,\n        \"Errors\",\n        ...fs.errors.reverse()\n      );\n\n      return null;\n    }\n\n    // Gather all discovered Shader Module Units\n    vs.shaderModuleUnits.forEach(moduleUnit =>\n      shaderModuleUnits.add(moduleUnit)\n    );\n    fs.shaderModuleUnits.forEach(moduleUnit =>\n      shaderModuleUnits.add(moduleUnit)\n    );\n\n    return {\n      fs: fs.shader || \"\",\n      vs: vs.shader || \"\",\n      shaderModuleUnits\n    };\n  }\n}\n","import { Attribute } from \"./attribute\";\nimport { Geometry } from \"./geometry\";\nimport { GLSettings } from \"./gl-settings\";\nimport { Material } from \"./material\";\nimport { Model } from \"./model\";\nimport { RenderTarget } from \"./render-target\";\nimport { Scene } from \"./scene\";\nimport { Texture } from \"./texture\";\nimport { MaterialUniformType } from \"./types\";\nimport { WebGLRenderer } from \"./webgl-renderer\";\n\nconst drawQuadVS = `\n  precision highp float;\n\n  uniform vec2 screenSize;\n  uniform vec4 bounds;\n\n  attribute vec2 position;\n  attribute vec2 texCoord;\n\n  varying vec2 _texCoord;\n\n  void main() {\n    vec2 mid = vec2(bounds.x + bounds.z / 2.0, screenSize.y - (bounds.y + bounds.w / 2.0));\n    vec2 _half = bounds.zw / 2.0;\n    vec2 pos = mid + _half * position;\n\n    pos.x = pos.x / screenSize.x * 2.0 - 1.0;\n    pos.y = pos.y / screenSize.y * 2.0 - 1.0;\n\n    _texCoord  = texCoord;\n    gl_Position = vec4(pos, 0.0, 1.0);\n    gl_PointSize = 10.0;\n  }\n`;\n\nconst drawQuadFS = `\n  precision highp float;\n\n  uniform sampler2D tex;\n  varying vec2 _texCoord;\n\n  void main() {\n    gl_FragColor = texture2D(tex, _texCoord);\n  }\n`;\n\nlet quadProgram: Material | null = null;\nconst emptyTexture = new Texture({\n  data: {\n    width: 2,\n    height: 2,\n    buffer: null\n  }\n});\n\nconst positionData = new Float32Array([\n  // Top tri\n  -1,\n  -1,\n  1,\n  -1,\n  -1,\n  1,\n\n  // Bottom tri\n  1,\n  -1,\n  1,\n  1,\n  -1,\n  1\n]);\n\nconst texCoordData = new Float32Array([0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1]);\n\n/**\n * Generate the geometry needed for rendering a quad\n */\nconst quadGeometry = new Geometry();\nconst position = new Attribute(positionData, 2, false, false);\nconst texCoord = new Attribute(texCoordData, 2, false, false);\nquadGeometry.addAttribute(\"position\", position);\nquadGeometry.addAttribute(\"texCoord\", texCoord);\n\n/** Model for drawing quads */\nlet quadModel: Model;\n/** The used scene for rendering */\nconst debugScene = new Scene();\n/** Height of each view that is rendered */\nconst debugViewHeight = 200;\n/** This stores deferred debug statements which will be emptied when flushDebug is called */\nconst debugQueue: [WebGLRenderer, RenderTarget | null, Function, any[]][] = [];\n\n/**\n * Compiles all small elements needed to make debugging resources work.\n */\nfunction compileDebugFragments() {\n  if (!quadProgram) {\n    quadProgram = new Material({\n      fragmentShader: drawQuadFS,\n      vertexShader: drawQuadVS,\n      culling: GLSettings.Material.CullSide.NONE,\n      uniforms: {\n        tex: { type: MaterialUniformType.TEXTURE, value: emptyTexture },\n        screenSize: { type: MaterialUniformType.VEC2, value: [0, 0] },\n        bounds: { type: MaterialUniformType.VEC4, value: [0, 0, 0, 0] }\n      }\n    });\n\n    quadModel = new Model(quadGeometry, quadProgram);\n    quadModel.drawMode = GLSettings.Model.DrawMode.TRIANGLES;\n    quadModel.vertexCount = 6;\n  }\n\n  debugScene.add(quadModel);\n\n  return true;\n}\n\nfunction makePlaceholder(\n  renderer: WebGLRenderer,\n  width: number,\n  height: number,\n  id: string\n) {\n  const container = getContainer(renderer.options.canvas);\n  if (!container.parentElement) return [0, 0, 0, 0];\n\n  let empty = document.getElementById(id);\n\n  if (!empty) {\n    const aspect = height / width;\n    empty = document.createElement(\"div\");\n    empty.style.height = `${debugViewHeight}px`;\n    empty.style.width = `${debugViewHeight / aspect}px`;\n    empty.style.marginLeft = \"4px\";\n    empty.id = id;\n    container.appendChild(empty);\n  }\n\n  const parentBox = container.parentElement.getBoundingClientRect();\n  const emptyBox = empty.getBoundingClientRect();\n\n  return [\n    (emptyBox.left - parentBox.left) * renderer.state.pixelRatio,\n    (emptyBox.top - parentBox.top) * renderer.state.pixelRatio,\n    emptyBox.width * renderer.state.pixelRatio,\n    emptyBox.height * renderer.state.pixelRatio\n  ];\n}\n\nfunction getContainer(context: HTMLCanvasElement) {\n  let container = document.getElementById(`__debug_read_pixels__`);\n\n  if (!container) {\n    container = document.createElement(\"div\");\n    if (!context.parentElement) return container;\n\n    const parent = context.parentElement;\n    parent.appendChild(container);\n    parent.style.position = \"relative\";\n    parent.style.width = context.style.width;\n    parent.style.height = context.style.height;\n    context.style.position = \"absolute\";\n    context.style.left = \"0px\";\n    context.style.right = \"0px\";\n    container.id = `__debug_read_pixels__`;\n    container.style.background = \"rgba(64, 64, 64, 0.0)\";\n    container.style.border = \"1px solid #FFFFFF\";\n    container.style.padding = \"4px\";\n    container.style.position = \"absolute\";\n    container.style.right = `10px`;\n    container.style.bottom = \"10px\";\n    container.style.zIndex = \"10\";\n  }\n\n  return container;\n}\n\n/**\n * This makes the contents of the render target appear in the bottom right of the screen.\n * This will only show the color buffer. If there are texture render targets, then you will\n * have to debug those separately.\n */\nexport function debugRenderTarget(\n  renderer: WebGLRenderer,\n  target: RenderTarget,\n  defer?: boolean\n) {\n  if (defer) {\n    debugQueue.push([\n      renderer,\n      renderer.state.currentRenderTarget,\n      debugRenderTarget,\n      Array.from(arguments).slice(0, -1)\n    ]);\n\n    return;\n  }\n\n  if (!renderer.glState.useRenderTarget(target)) return;\n  const debugId = `__debug_read_pixels__${target.uid}`;\n  let colorBuffer;\n\n  if (Array.isArray(target.buffers.color)) {\n    let foundTexture = false;\n\n    target.buffers.color.forEach(colorBuffer => {\n      if (colorBuffer instanceof Texture) {\n        debugTexture(renderer, colorBuffer, debugId);\n        foundTexture = true;\n      }\n    });\n\n    if (foundTexture) {\n      return;\n    }\n  } else {\n    colorBuffer = target.buffers.color;\n  }\n\n  if (colorBuffer instanceof Texture) {\n    debugTexture(renderer, colorBuffer, debugId);\n  } else {\n    const dataWidth = Math.floor(target.width);\n    const dataHeight = Math.floor(target.height);\n    const data = new Uint8Array(dataWidth * dataHeight * 4);\n    renderer.readPixels(0, 0, dataWidth, dataHeight, data);\n    renderer.setRenderTarget(null);\n    renderer.clear(false, true);\n    debugReadPixels(renderer, data, target.width, target.height, debugId);\n  }\n}\n\n/**\n * Makes a texture viewable in the bottom right of the screen.\n */\nexport function debugTexture(\n  renderer: WebGLRenderer,\n  texture: Texture,\n  id: string,\n  defer?: boolean\n) {\n  if (defer) {\n    debugQueue.push([\n      renderer,\n      renderer.state.currentRenderTarget,\n      debugTexture,\n      Array.from(arguments).slice(0, -1)\n    ]);\n\n    return;\n  }\n\n  // Make sure our debugging fragments are compiled so we can draw simple quads for our textures\n  if (!texture.data) return false;\n  if (!compileDebugFragments()) return false;\n  if (!quadProgram) return false;\n\n  // Make a container in the DOM\n  const bounds = makePlaceholder(\n    renderer,\n    texture.data.width,\n    texture.data.height,\n    id\n  );\n\n  // Apply the texture as the texture to be rendered then draw it\n  quadProgram.uniforms.tex.value = texture;\n  quadProgram.uniforms.screenSize.value = renderer.getRenderSize();\n  quadProgram.uniforms.bounds.value = bounds;\n\n  renderer.setRenderTarget(null);\n  renderer.setViewport(renderer.getFullViewport());\n  renderer.setScissor(renderer.getFullViewport());\n  renderer.clear(false, true, false);\n  renderer.render(debugScene);\n\n  return true;\n}\n\n/**\n * Makes a chunk of readPixel data viewable in the bottom right of the screen.\n */\nexport function debugReadPixels(\n  renderer: WebGLRenderer,\n  data: Uint8Array,\n  width: number,\n  height: number,\n  debugId: string,\n  defer?: boolean\n) {\n  if (defer) {\n    debugQueue.push([\n      renderer,\n      renderer.state.currentRenderTarget,\n      debugReadPixels,\n      Array.from(arguments).slice(0, -1)\n    ]);\n\n    return;\n  }\n\n  const container = getContainer(renderer.options.canvas);\n  const element: HTMLElement | null = document.getElementById(debugId);\n  let canvas: HTMLCanvasElement | undefined;\n\n  if (element && element instanceof HTMLCanvasElement) {\n    canvas = element;\n  }\n\n  if (!canvas) {\n    const aspect = height / width;\n    canvas = document.createElement(\"canvas\") as HTMLCanvasElement;\n    container.appendChild(canvas);\n    canvas.style.height = `${debugViewHeight}px`;\n    canvas.height = height;\n    canvas.width = width;\n    canvas.style.width = `${debugViewHeight / aspect}px`;\n    canvas.style.marginLeft = \"4px\";\n    canvas.id = debugId;\n  }\n\n  const imageData = new ImageData(Uint8ClampedArray.from(data), width, height);\n\n  // Make a temp canvas to fully render the data retrieved, then we'll render\n  // it down to the display debug canvas for the screen.\n  const ctx = canvas.getContext(\"2d\");\n\n  if (ctx) {\n    ctx.putImageData(imageData, 0, 0);\n  }\n}\n\n/**\n * This dequeues all debug operations\n */\nexport function flushDebug() {\n  debugQueue.forEach(debug => {\n    debug[0].setRenderTarget(debug[1]);\n    debug[2].apply(null, debug[3]);\n  });\n\n  debugQueue.splice(0);\n}\n","export * from \"./atlas-manager\";\nexport * from \"./atlas-resource-manager\";\nexport * from \"./atlas-resource-request\";\nexport * from \"./atlas\";\nexport * from \"./image-rasterizer\";\nexport * from \"./pack-node\";\nexport * from \"./sub-texture\";\nexport * from \"./texture-io-expansion\";\n","import { Instance } from \"../../instance-provider/instance\";\nimport {\n  SubTexture,\n  subTextureIOValue\n} from \"../../resources/texture/sub-texture\";\nimport { ILayerProps, Layer } from \"../../surface/layer\";\nimport { BaseIOExpansion } from \"../../surface/layer-processing/base-io-expansion\";\nimport {\n  InstanceIOValue,\n  IResourceContext,\n  IResourceInstanceAttribute,\n  Omit,\n  ResourceType\n} from \"../../types\";\nimport { nextFrame } from \"../../util\";\nimport {\n  BaseResourceManager,\n  BaseResourceOptions\n} from \"../base-resource-manager\";\nimport { TextureIOExpansion } from \"../texture/texture-io-expansion\";\nimport {\n  FontManager,\n  IFontResourceOptions,\n  isFontResource\n} from \"./font-manager\";\nimport { FontMap } from \"./font-map\";\nimport {\n  FontResourceRequestFetch,\n  IFontResourceRequest\n} from \"./font-resource-request\";\n\nconst debug = require(\"debug\")(\"performance\");\n\nexport interface IFontResourceRequestInternal extends IFontResourceRequest {\n  /**\n   * This is used to flag a request object as requested so that the same request object can be used for\n   * similar resources without generating two request lifecycles.\n   */\n  isRequested?: boolean;\n}\n\n/**\n * Wrapper method to create a font resource request to make typings and intellisense work better.\n */\nexport function fontRequest(\n  options: Omit<IFontResourceRequest, \"type\">\n): IFontResourceRequest {\n  return {\n    type: ResourceType.FONT,\n    ...options\n  };\n}\n\n/**\n * This manager controls and manages Font type resources that are requested for generation. This manager\n * will utilize the request given to it to provide the best possible solution in both load times and\n * run time performance available to the manager.\n *\n * This manager will have the ability to handle resources\n */\nexport class FontResourceManager extends BaseResourceManager<\n  IFontResourceOptions,\n  IFontResourceRequest\n> {\n  /** The current attribute that is making request calls */\n  private currentAttribute: IResourceInstanceAttribute<Instance>;\n  /**\n   * This tracks if a resource is already in the request queue. This also stores ALL instances awaiting the resource.\n   */\n  private requestLookup = new Map<\n    string,\n    Map<IFontResourceRequest, [Layer<any, any>, Instance][]>\n  >();\n\n  /** This stores all of the requests awaiting dequeueing */\n  private requestQueue = new Map<string, IFontResourceRequest[]>();\n  /** This is the lookup for generated font map resources */\n  private resourceLookup = new Map<string, FontMap>();\n  /** This is the manager that is used to create and update font resources */\n  private fontManager = new FontManager();\n\n  /**\n   * This is so the system can control when requests are made so this manager has the opportunity\n   * to verify and generate the resources the request requires.\n   */\n  async dequeueRequests(): Promise<boolean> {\n    // This flag will be modified to reflect if a dequeue operation has occurred\n    let didDequeue = false;\n    const resourceRequestsWithKey: [string, IFontResourceRequest[]][] = [];\n\n    this.requestQueue.forEach((requests, resourceKey) => {\n      resourceRequestsWithKey.push([resourceKey, requests]);\n    });\n\n    this.requestQueue.clear();\n\n    // Loop through all requests paired with their resource key context\n    for (let i = 0, iMax = resourceRequestsWithKey.length; i < iMax; ++i) {\n      const [fontResource, allRequests] = resourceRequestsWithKey[i];\n\n      if (allRequests.length > 0) {\n        // We did dequeue\n        didDequeue = true;\n        // Pull out all of the requests into a new array and empty the existing queue to allow the queue to register\n        // New requests while this dequeue is being processed\n        const requests = allRequests.slice(0);\n        // Empty the queue to begin taking in new requests as needed\n        allRequests.length = 0;\n\n        debug(\"Processing requests for resource '%s'\", fontResource);\n\n        // Tell the font manager to update with all of the requested resources\n        await this.fontManager.updateFontMap(fontResource, requests);\n        // Tell the manager to process all of the metrics requests for the text\n        await this.fontManager.calculateMetrics(fontResource, requests);\n        // Get the requests for the given font\n        const glyphRequests = this.requestLookup.get(fontResource);\n\n        debug(\"All requests for resource '%s' are processed\", fontResource);\n\n        if (glyphRequests) {\n          // Once the manager has been updated, we can now flag all of the instances waiting for the resources\n          // As active, which should thus trigger an update to the layers to perform a diff for each instance\n          requests.forEach(resource => {\n            const request = glyphRequests.get(resource);\n            glyphRequests.delete(resource);\n\n            if (request) {\n              for (let i = 0, iMax = request.length; i < iMax; ++i) {\n                const [layer, instance] = request[i];\n                // If the instance is still associated with buffer locations, then the instance can be activated. Having\n                // A buffer location is indicative the instance has not been deleted.\n                if (layer.managesInstance(instance)) {\n                  // Make sure the instance is active\n                  instance.active = true;\n                }\n              }\n\n              // Do a delay to next frame before we do our resource trigger so we can see any lingering updates get\n              // applied to the instance's rendering\n              nextFrame(() => {\n                const triggered = new Set();\n\n                for (let i = 0, iMax = request.length; i < iMax; ++i) {\n                  const instance = request[i][1];\n\n                  if (!triggered.has(instance)) {\n                    triggered.add(instance);\n                    instance.resourceTrigger();\n                  }\n                }\n              });\n            }\n          });\n        }\n      }\n    }\n\n    return didDequeue;\n  }\n\n  /**\n   * This will force this manager to free all of it's beloved resources that it manages should\n   * it be holding onto resources that can not be freed by lack of references.\n   */\n  destroy(): void {\n    this.fontManager.destroy();\n  }\n\n  /**\n   * This will provide the resource generated from the initResource operation.\n   */\n  getResource(resourceKey: string) {\n    return this.resourceLookup.get(resourceKey) || null;\n  }\n\n  /**\n   * Make the expander to handle making the attribute changes necessary to have the texture applied\n   * to a uniform when the attribute places a resource request with a key.\n   */\n  getIOExpansion(): BaseIOExpansion[] {\n    return [new TextureIOExpansion(ResourceType.FONT, this)];\n  }\n\n  /**\n   * This is a request to intiialize a resource by this manager.\n   */\n  async initResource(options: BaseResourceOptions) {\n    if (isFontResource(options)) {\n      const fontMap = await this.fontManager.createFontMap(options);\n\n      if (fontMap) {\n        this.resourceLookup.set(options.key, fontMap);\n      }\n    }\n  }\n\n  /**\n   * This is for attributes making a request for a resource of this type to create shader compatible info\n   * regarding the requests properties.\n   */\n  request<U extends Instance, V extends ILayerProps<U>>(\n    layer: Layer<U, V>,\n    instance: Instance,\n    req: IFontResourceRequest,\n    context?: IResourceContext\n  ): InstanceIOValue {\n    const request: IFontResourceRequestInternal = req;\n    const resourceContex = this.currentAttribute || context;\n    const fontMap = request.fontMap;\n    let texture: SubTexture | null = null;\n\n    // If the texture is ready and available, then we simply return the IO values\n    if (fontMap) {\n      // If this is a character request, then we output the texture desired. Kerning requests only needs\n      // the font map populated in the request.\n      if (request.character) {\n        texture = fontMap.getGlyphTexture(request.character);\n      }\n\n      if (texture) {\n        if (request.fetch === FontResourceRequestFetch.IMAGE_SIZE) {\n          return [texture.pixelWidth, texture.pixelHeight];\n        }\n\n        return subTextureIOValue(texture);\n      }\n\n      if (request.fetch === FontResourceRequestFetch.IMAGE_SIZE) {\n        return [0, 0];\n      }\n\n      return subTextureIOValue(null);\n    }\n\n    // This is the attributes resource key being requested\n    const resourceKey = resourceContex.resource.key;\n    // If a request is already made, then we must save the instance making the request for deactivation and\n    // Reactivation but without any additional atlas loading\n    let fontRequests = this.requestLookup.get(resourceKey);\n\n    if (fontRequests) {\n      const existingRequests = fontRequests.get(request);\n\n      if (existingRequests) {\n        existingRequests.push([layer, instance]);\n        instance.active = false;\n\n        if (request.fetch === FontResourceRequestFetch.IMAGE_SIZE) {\n          return [0, 0];\n        }\n\n        return subTextureIOValue(texture);\n      }\n    } else {\n      fontRequests = new Map();\n      this.requestLookup.set(resourceKey, fontRequests);\n    }\n\n    // If the texture is not available, then we must load the resource, deactivate the instance\n    // And wait for the resource to become available. Once the resource is available, the system\n    // Must activate the instance to render the resource.\n    instance.active = false;\n    let requests = this.requestQueue.get(resourceKey);\n\n    if (!requests) {\n      requests = [];\n      this.requestQueue.set(resourceKey, requests);\n    }\n\n    requests.push(request);\n    fontRequests.set(request, [[layer, instance]]);\n\n    // This returns essentially returns blank values for the resource lookup\n    if (request.fetch) {\n      return [0, 0];\n    }\n\n    return subTextureIOValue(texture);\n  }\n\n  /**\n   * Sets the attribute that is currently making requests.\n   */\n  setAttributeContext(attribute: IResourceInstanceAttribute<Instance>) {\n    this.currentAttribute = attribute;\n  }\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.parseContent = exports.resolvePseudoContent = exports.popCounters = exports.parseCounterReset = exports.TOKEN_TYPE = exports.PSEUDO_CONTENT_ITEM_TYPE = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _ListItem = require('./ListItem');\n\nvar _listStyle = require('./parsing/listStyle');\n\nvar PSEUDO_CONTENT_ITEM_TYPE = exports.PSEUDO_CONTENT_ITEM_TYPE = {\n    TEXT: 0,\n    IMAGE: 1\n};\n\nvar TOKEN_TYPE = exports.TOKEN_TYPE = {\n    STRING: 0,\n    ATTRIBUTE: 1,\n    URL: 2,\n    COUNTER: 3,\n    COUNTERS: 4,\n    OPENQUOTE: 5,\n    CLOSEQUOTE: 6\n};\n\nvar parseCounterReset = exports.parseCounterReset = function parseCounterReset(style, data) {\n    if (!style || !style.counterReset || style.counterReset === 'none') {\n        return [];\n    }\n\n    var counterNames = [];\n    var counterResets = style.counterReset.split(/\\s*,\\s*/);\n    var lenCounterResets = counterResets.length;\n\n    for (var i = 0; i < lenCounterResets; i++) {\n        var _counterResets$i$spli = counterResets[i].split(/\\s+/),\n            _counterResets$i$spli2 = _slicedToArray(_counterResets$i$spli, 2),\n            counterName = _counterResets$i$spli2[0],\n            initialValue = _counterResets$i$spli2[1];\n\n        counterNames.push(counterName);\n        var counter = data.counters[counterName];\n        if (!counter) {\n            counter = data.counters[counterName] = [];\n        }\n        counter.push(parseInt(initialValue || 0, 10));\n    }\n\n    return counterNames;\n};\n\nvar popCounters = exports.popCounters = function popCounters(counterNames, data) {\n    var lenCounters = counterNames.length;\n    for (var i = 0; i < lenCounters; i++) {\n        data.counters[counterNames[i]].pop();\n    }\n};\n\nvar resolvePseudoContent = exports.resolvePseudoContent = function resolvePseudoContent(node, style, data) {\n    if (!style || !style.content || style.content === 'none' || style.content === '-moz-alt-content' || style.display === 'none') {\n        return null;\n    }\n\n    var tokens = parseContent(style.content);\n\n    var len = tokens.length;\n    var contentItems = [];\n    var s = '';\n\n    // increment the counter (if there is a \"counter-increment\" declaration)\n    var counterIncrement = style.counterIncrement;\n    if (counterIncrement && counterIncrement !== 'none') {\n        var _counterIncrement$spl = counterIncrement.split(/\\s+/),\n            _counterIncrement$spl2 = _slicedToArray(_counterIncrement$spl, 2),\n            counterName = _counterIncrement$spl2[0],\n            incrementValue = _counterIncrement$spl2[1];\n\n        var counter = data.counters[counterName];\n        if (counter) {\n            counter[counter.length - 1] += incrementValue === undefined ? 1 : parseInt(incrementValue, 10);\n        }\n    }\n\n    // build the content string\n    for (var i = 0; i < len; i++) {\n        var token = tokens[i];\n        switch (token.type) {\n            case TOKEN_TYPE.STRING:\n                s += token.value || '';\n                break;\n\n            case TOKEN_TYPE.ATTRIBUTE:\n                if (node instanceof HTMLElement && token.value) {\n                    s += node.getAttribute(token.value) || '';\n                }\n                break;\n\n            case TOKEN_TYPE.COUNTER:\n                var _counter = data.counters[token.name || ''];\n                if (_counter) {\n                    s += formatCounterValue([_counter[_counter.length - 1]], '', token.format);\n                }\n                break;\n\n            case TOKEN_TYPE.COUNTERS:\n                var _counters = data.counters[token.name || ''];\n                if (_counters) {\n                    s += formatCounterValue(_counters, token.glue, token.format);\n                }\n                break;\n\n            case TOKEN_TYPE.OPENQUOTE:\n                s += getQuote(style, true, data.quoteDepth);\n                data.quoteDepth++;\n                break;\n\n            case TOKEN_TYPE.CLOSEQUOTE:\n                data.quoteDepth--;\n                s += getQuote(style, false, data.quoteDepth);\n                break;\n\n            case TOKEN_TYPE.URL:\n                if (s) {\n                    contentItems.push({ type: PSEUDO_CONTENT_ITEM_TYPE.TEXT, value: s });\n                    s = '';\n                }\n                contentItems.push({ type: PSEUDO_CONTENT_ITEM_TYPE.IMAGE, value: token.value || '' });\n                break;\n        }\n    }\n\n    if (s) {\n        contentItems.push({ type: PSEUDO_CONTENT_ITEM_TYPE.TEXT, value: s });\n    }\n\n    return contentItems;\n};\n\nvar parseContent = exports.parseContent = function parseContent(content, cache) {\n    if (cache && cache[content]) {\n        return cache[content];\n    }\n\n    var tokens = [];\n    var len = content.length;\n\n    var isString = false;\n    var isEscaped = false;\n    var isFunction = false;\n    var str = '';\n    var functionName = '';\n    var args = [];\n\n    for (var i = 0; i < len; i++) {\n        var c = content.charAt(i);\n\n        switch (c) {\n            case \"'\":\n            case '\"':\n                if (isEscaped) {\n                    str += c;\n                } else {\n                    isString = !isString;\n                    if (!isFunction && !isString) {\n                        tokens.push({ type: TOKEN_TYPE.STRING, value: str });\n                        str = '';\n                    }\n                }\n                break;\n\n            case '\\\\':\n                if (isEscaped) {\n                    str += c;\n                    isEscaped = false;\n                } else {\n                    isEscaped = true;\n                }\n                break;\n\n            case '(':\n                if (isString) {\n                    str += c;\n                } else {\n                    isFunction = true;\n                    functionName = str;\n                    str = '';\n                    args = [];\n                }\n                break;\n\n            case ')':\n                if (isString) {\n                    str += c;\n                } else if (isFunction) {\n                    if (str) {\n                        args.push(str);\n                    }\n\n                    switch (functionName) {\n                        case 'attr':\n                            if (args.length > 0) {\n                                tokens.push({ type: TOKEN_TYPE.ATTRIBUTE, value: args[0] });\n                            }\n                            break;\n\n                        case 'counter':\n                            if (args.length > 0) {\n                                var counter = {\n                                    type: TOKEN_TYPE.COUNTER,\n                                    name: args[0]\n                                };\n                                if (args.length > 1) {\n                                    counter.format = args[1];\n                                }\n                                tokens.push(counter);\n                            }\n                            break;\n\n                        case 'counters':\n                            if (args.length > 0) {\n                                var _counters2 = {\n                                    type: TOKEN_TYPE.COUNTERS,\n                                    name: args[0]\n                                };\n                                if (args.length > 1) {\n                                    _counters2.glue = args[1];\n                                }\n                                if (args.length > 2) {\n                                    _counters2.format = args[2];\n                                }\n                                tokens.push(_counters2);\n                            }\n                            break;\n\n                        case 'url':\n                            if (args.length > 0) {\n                                tokens.push({ type: TOKEN_TYPE.URL, value: args[0] });\n                            }\n                            break;\n                    }\n\n                    isFunction = false;\n                    str = '';\n                }\n                break;\n\n            case ',':\n                if (isString) {\n                    str += c;\n                } else if (isFunction) {\n                    args.push(str);\n                    str = '';\n                }\n                break;\n\n            case ' ':\n            case '\\t':\n                if (isString) {\n                    str += c;\n                } else if (str) {\n                    addOtherToken(tokens, str);\n                    str = '';\n                }\n                break;\n\n            default:\n                str += c;\n        }\n\n        if (c !== '\\\\') {\n            isEscaped = false;\n        }\n    }\n\n    if (str) {\n        addOtherToken(tokens, str);\n    }\n\n    if (cache) {\n        cache[content] = tokens;\n    }\n\n    return tokens;\n};\n\nvar addOtherToken = function addOtherToken(tokens, identifier) {\n    switch (identifier) {\n        case 'open-quote':\n            tokens.push({ type: TOKEN_TYPE.OPENQUOTE });\n            break;\n        case 'close-quote':\n            tokens.push({ type: TOKEN_TYPE.CLOSEQUOTE });\n            break;\n    }\n};\n\nvar getQuote = function getQuote(style, isOpening, quoteDepth) {\n    var quotes = style.quotes ? style.quotes.split(/\\s+/) : [\"'\\\"'\", \"'\\\"'\"];\n    var idx = quoteDepth * 2;\n    if (idx >= quotes.length) {\n        idx = quotes.length - 2;\n    }\n    if (!isOpening) {\n        ++idx;\n    }\n    return quotes[idx].replace(/^[\"']|[\"']$/g, '');\n};\n\nvar formatCounterValue = function formatCounterValue(counter, glue, format) {\n    var len = counter.length;\n    var result = '';\n\n    for (var i = 0; i < len; i++) {\n        if (i > 0) {\n            result += glue || '';\n        }\n        result += (0, _ListItem.createCounterText)(counter[i], (0, _listStyle.parseListStyleType)(format || 'decimal'), false);\n    }\n\n    return result;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ResourceStore = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Feature = require('./Feature');\n\nvar _Feature2 = _interopRequireDefault(_Feature);\n\nvar _Proxy = require('./Proxy');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ResourceLoader = function () {\n    function ResourceLoader(options, logger, window) {\n        _classCallCheck(this, ResourceLoader);\n\n        this.options = options;\n        this._window = window;\n        this.origin = this.getOrigin(window.location.href);\n        this.cache = {};\n        this.logger = logger;\n        this._index = 0;\n    }\n\n    _createClass(ResourceLoader, [{\n        key: 'loadImage',\n        value: function loadImage(src) {\n            var _this = this;\n\n            if (this.hasResourceInCache(src)) {\n                return src;\n            }\n\n            if (!isSVG(src) || _Feature2.default.SUPPORT_SVG_DRAWING) {\n                if (this.options.allowTaint === true || isInlineImage(src) || this.isSameOrigin(src)) {\n                    return this.addImage(src, src, false);\n                } else if (!this.isSameOrigin(src)) {\n                    if (typeof this.options.proxy === 'string') {\n                        this.cache[src] = (0, _Proxy.Proxy)(src, this.options).then(function (src) {\n                            return _loadImage(src, _this.options.imageTimeout || 0);\n                        });\n                        return src;\n                    } else if (this.options.useCORS === true && _Feature2.default.SUPPORT_CORS_IMAGES) {\n                        return this.addImage(src, src, true);\n                    }\n                }\n            }\n        }\n    }, {\n        key: 'inlineImage',\n        value: function inlineImage(src) {\n            var _this2 = this;\n\n            if (isInlineImage(src)) {\n                return _loadImage(src, this.options.imageTimeout || 0);\n            }\n            if (this.hasResourceInCache(src)) {\n                return this.cache[src];\n            }\n            if (!this.isSameOrigin(src) && typeof this.options.proxy === 'string') {\n                return this.cache[src] = (0, _Proxy.Proxy)(src, this.options).then(function (src) {\n                    return _loadImage(src, _this2.options.imageTimeout || 0);\n                });\n            }\n\n            return this.xhrImage(src);\n        }\n    }, {\n        key: 'xhrImage',\n        value: function xhrImage(src) {\n            var _this3 = this;\n\n            this.cache[src] = new Promise(function (resolve, reject) {\n                var xhr = new XMLHttpRequest();\n                xhr.onreadystatechange = function () {\n                    if (xhr.readyState === 4) {\n                        if (xhr.status !== 200) {\n                            reject('Failed to fetch image ' + src.substring(0, 256) + ' with status code ' + xhr.status);\n                        } else {\n                            var reader = new FileReader();\n                            reader.addEventListener('load', function () {\n                                // $FlowFixMe\n                                var result = reader.result;\n                                resolve(result);\n                            }, false);\n                            reader.addEventListener('error', function (e) {\n                                return reject(e);\n                            }, false);\n                            reader.readAsDataURL(xhr.response);\n                        }\n                    }\n                };\n                xhr.responseType = 'blob';\n                if (_this3.options.imageTimeout) {\n                    var timeout = _this3.options.imageTimeout;\n                    xhr.timeout = timeout;\n                    xhr.ontimeout = function () {\n                        return reject(process.env.NODE_ENV !== 'production' ? 'Timed out (' + timeout + 'ms) fetching ' + src.substring(0, 256) : '');\n                    };\n                }\n                xhr.open('GET', src, true);\n                xhr.send();\n            }).then(function (src) {\n                return _loadImage(src, _this3.options.imageTimeout || 0);\n            });\n\n            return this.cache[src];\n        }\n    }, {\n        key: 'loadCanvas',\n        value: function loadCanvas(node) {\n            var key = String(this._index++);\n            this.cache[key] = Promise.resolve(node);\n            return key;\n        }\n    }, {\n        key: 'hasResourceInCache',\n        value: function hasResourceInCache(key) {\n            return typeof this.cache[key] !== 'undefined';\n        }\n    }, {\n        key: 'addImage',\n        value: function addImage(key, src, useCORS) {\n            var _this4 = this;\n\n            if (process.env.NODE_ENV !== 'production') {\n                this.logger.log('Added image ' + key.substring(0, 256));\n            }\n\n            var imageLoadHandler = function imageLoadHandler(supportsDataImages) {\n                return new Promise(function (resolve, reject) {\n                    var img = new Image();\n                    img.onload = function () {\n                        return resolve(img);\n                    };\n                    //ios safari 10.3 taints canvas with data urls unless crossOrigin is set to anonymous\n                    if (!supportsDataImages || useCORS) {\n                        img.crossOrigin = 'anonymous';\n                    }\n\n                    img.onerror = reject;\n                    img.src = src;\n                    if (img.complete === true) {\n                        // Inline XML images may fail to parse, throwing an Error later on\n                        setTimeout(function () {\n                            resolve(img);\n                        }, 500);\n                    }\n                    if (_this4.options.imageTimeout) {\n                        var timeout = _this4.options.imageTimeout;\n                        setTimeout(function () {\n                            return reject(process.env.NODE_ENV !== 'production' ? 'Timed out (' + timeout + 'ms) fetching ' + src.substring(0, 256) : '');\n                        }, timeout);\n                    }\n                });\n            };\n\n            this.cache[key] = isInlineBase64Image(src) && !isSVG(src) ? // $FlowFixMe\n            _Feature2.default.SUPPORT_BASE64_DRAWING(src).then(imageLoadHandler) : imageLoadHandler(true);\n            return key;\n        }\n    }, {\n        key: 'isSameOrigin',\n        value: function isSameOrigin(url) {\n            return this.getOrigin(url) === this.origin;\n        }\n    }, {\n        key: 'getOrigin',\n        value: function getOrigin(url) {\n            var link = this._link || (this._link = this._window.document.createElement('a'));\n            link.href = url;\n            link.href = link.href; // IE9, LOL! - http://jsfiddle.net/niklasvh/2e48b/\n            return link.protocol + link.hostname + link.port;\n        }\n    }, {\n        key: 'ready',\n        value: function ready() {\n            var _this5 = this;\n\n            var keys = Object.keys(this.cache);\n            var values = keys.map(function (str) {\n                return _this5.cache[str].catch(function (e) {\n                    if (process.env.NODE_ENV !== 'production') {\n                        _this5.logger.log('Unable to load image', e);\n                    }\n                    return null;\n                });\n            });\n            return Promise.all(values).then(function (images) {\n                if (process.env.NODE_ENV !== 'production') {\n                    _this5.logger.log('Finished loading ' + images.length + ' images', images);\n                }\n                return new ResourceStore(keys, images);\n            });\n        }\n    }]);\n\n    return ResourceLoader;\n}();\n\nexports.default = ResourceLoader;\n\nvar ResourceStore = exports.ResourceStore = function () {\n    function ResourceStore(keys, resources) {\n        _classCallCheck(this, ResourceStore);\n\n        this._keys = keys;\n        this._resources = resources;\n    }\n\n    _createClass(ResourceStore, [{\n        key: 'get',\n        value: function get(key) {\n            var index = this._keys.indexOf(key);\n            return index === -1 ? null : this._resources[index];\n        }\n    }]);\n\n    return ResourceStore;\n}();\n\nvar INLINE_SVG = /^data:image\\/svg\\+xml/i;\nvar INLINE_BASE64 = /^data:image\\/.*;base64,/i;\nvar INLINE_IMG = /^data:image\\/.*/i;\n\nvar isInlineImage = function isInlineImage(src) {\n    return INLINE_IMG.test(src);\n};\nvar isInlineBase64Image = function isInlineBase64Image(src) {\n    return INLINE_BASE64.test(src);\n};\n\nvar isSVG = function isSVG(src) {\n    return src.substr(-3).toLowerCase() === 'svg' || INLINE_SVG.test(src);\n};\n\nvar _loadImage = function _loadImage(src, timeout) {\n    return new Promise(function (resolve, reject) {\n        var img = new Image();\n        img.onload = function () {\n            return resolve(img);\n        };\n        img.onerror = reject;\n        img.src = src;\n        if (img.complete === true) {\n            // Inline XML images may fail to parse, throwing an Error later on\n            setTimeout(function () {\n                resolve(img);\n            }, 500);\n        }\n        if (timeout) {\n            setTimeout(function () {\n                return reject(process.env.NODE_ENV !== 'production' ? 'Timed out (' + timeout + 'ms) loading image' : '');\n            }, timeout);\n        }\n    });\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.cloneWindow = exports.DocumentCloner = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Bounds = require('./Bounds');\n\nvar _Proxy = require('./Proxy');\n\nvar _ResourceLoader = require('./ResourceLoader');\n\nvar _ResourceLoader2 = _interopRequireDefault(_ResourceLoader);\n\nvar _Util = require('./Util');\n\nvar _background = require('./parsing/background');\n\nvar _CanvasRenderer = require('./renderer/CanvasRenderer');\n\nvar _CanvasRenderer2 = _interopRequireDefault(_CanvasRenderer);\n\nvar _PseudoNodeContent = require('./PseudoNodeContent');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar IGNORE_ATTRIBUTE = 'data-html2canvas-ignore';\n\nvar DocumentCloner = exports.DocumentCloner = function () {\n    function DocumentCloner(element, options, logger, copyInline, renderer) {\n        _classCallCheck(this, DocumentCloner);\n\n        this.referenceElement = element;\n        this.scrolledElements = [];\n        this.copyStyles = copyInline;\n        this.inlineImages = copyInline;\n        this.logger = logger;\n        this.options = options;\n        this.renderer = renderer;\n        this.resourceLoader = new _ResourceLoader2.default(options, logger, window);\n        this.pseudoContentData = {\n            counters: {},\n            quoteDepth: 0\n        };\n        // $FlowFixMe\n        this.documentElement = this.cloneNode(element.ownerDocument.documentElement);\n    }\n\n    _createClass(DocumentCloner, [{\n        key: 'inlineAllImages',\n        value: function inlineAllImages(node) {\n            var _this = this;\n\n            if (this.inlineImages && node) {\n                var style = node.style;\n                Promise.all((0, _background.parseBackgroundImage)(style.backgroundImage).map(function (backgroundImage) {\n                    if (backgroundImage.method === 'url') {\n                        return _this.resourceLoader.inlineImage(backgroundImage.args[0]).then(function (img) {\n                            return img && typeof img.src === 'string' ? 'url(\"' + img.src + '\")' : 'none';\n                        }).catch(function (e) {\n                            if (process.env.NODE_ENV !== 'production') {\n                                _this.logger.log('Unable to load image', e);\n                            }\n                        });\n                    }\n                    return Promise.resolve('' + backgroundImage.prefix + backgroundImage.method + '(' + backgroundImage.args.join(',') + ')');\n                })).then(function (backgroundImages) {\n                    if (backgroundImages.length > 1) {\n                        // TODO Multiple backgrounds somehow broken in Chrome\n                        style.backgroundColor = '';\n                    }\n                    style.backgroundImage = backgroundImages.join(',');\n                });\n\n                if (node instanceof HTMLImageElement) {\n                    this.resourceLoader.inlineImage(node.src).then(function (img) {\n                        if (img && node instanceof HTMLImageElement && node.parentNode) {\n                            var parentNode = node.parentNode;\n                            var clonedChild = (0, _Util.copyCSSStyles)(node.style, img.cloneNode(false));\n                            parentNode.replaceChild(clonedChild, node);\n                        }\n                    }).catch(function (e) {\n                        if (process.env.NODE_ENV !== 'production') {\n                            _this.logger.log('Unable to load image', e);\n                        }\n                    });\n                }\n            }\n        }\n    }, {\n        key: 'inlineFonts',\n        value: function inlineFonts(document) {\n            var _this2 = this;\n\n            return Promise.all(Array.from(document.styleSheets).map(function (sheet) {\n                if (sheet.href) {\n                    return fetch(sheet.href).then(function (res) {\n                        return res.text();\n                    }).then(function (text) {\n                        return createStyleSheetFontsFromText(text, sheet.href);\n                    }).catch(function (e) {\n                        if (process.env.NODE_ENV !== 'production') {\n                            _this2.logger.log('Unable to load stylesheet', e);\n                        }\n                        return [];\n                    });\n                }\n                return getSheetFonts(sheet, document);\n            })).then(function (fonts) {\n                return fonts.reduce(function (acc, font) {\n                    return acc.concat(font);\n                }, []);\n            }).then(function (fonts) {\n                return Promise.all(fonts.map(function (font) {\n                    return fetch(font.formats[0].src).then(function (response) {\n                        return response.blob();\n                    }).then(function (blob) {\n                        return new Promise(function (resolve, reject) {\n                            var reader = new FileReader();\n                            reader.onerror = reject;\n                            reader.onload = function () {\n                                // $FlowFixMe\n                                var result = reader.result;\n                                resolve(result);\n                            };\n                            reader.readAsDataURL(blob);\n                        });\n                    }).then(function (dataUri) {\n                        font.fontFace.setProperty('src', 'url(\"' + dataUri + '\")');\n                        return '@font-face {' + font.fontFace.cssText + ' ';\n                    });\n                }));\n            }).then(function (fontCss) {\n                var style = document.createElement('style');\n                style.textContent = fontCss.join('\\n');\n                _this2.documentElement.appendChild(style);\n            });\n        }\n    }, {\n        key: 'createElementClone',\n        value: function createElementClone(node) {\n            var _this3 = this;\n\n            if (this.copyStyles && node instanceof HTMLCanvasElement) {\n                var img = node.ownerDocument.createElement('img');\n                try {\n                    img.src = node.toDataURL();\n                    return img;\n                } catch (e) {\n                    if (process.env.NODE_ENV !== 'production') {\n                        this.logger.log('Unable to clone canvas contents, canvas is tainted');\n                    }\n                }\n            }\n\n            if (node instanceof HTMLIFrameElement) {\n                var tempIframe = node.cloneNode(false);\n                var iframeKey = generateIframeKey();\n                tempIframe.setAttribute('data-html2canvas-internal-iframe-key', iframeKey);\n\n                var _parseBounds = (0, _Bounds.parseBounds)(node, 0, 0),\n                    width = _parseBounds.width,\n                    height = _parseBounds.height;\n\n                this.resourceLoader.cache[iframeKey] = getIframeDocumentElement(node, this.options).then(function (documentElement) {\n                    return _this3.renderer(documentElement, {\n                        async: _this3.options.async,\n                        allowTaint: _this3.options.allowTaint,\n                        backgroundColor: '#ffffff',\n                        canvas: null,\n                        imageTimeout: _this3.options.imageTimeout,\n                        logging: _this3.options.logging,\n                        proxy: _this3.options.proxy,\n                        removeContainer: _this3.options.removeContainer,\n                        scale: _this3.options.scale,\n                        foreignObjectRendering: _this3.options.foreignObjectRendering,\n                        useCORS: _this3.options.useCORS,\n                        target: new _CanvasRenderer2.default(),\n                        width: width,\n                        height: height,\n                        x: 0,\n                        y: 0,\n                        windowWidth: documentElement.ownerDocument.defaultView.innerWidth,\n                        windowHeight: documentElement.ownerDocument.defaultView.innerHeight,\n                        scrollX: documentElement.ownerDocument.defaultView.pageXOffset,\n                        scrollY: documentElement.ownerDocument.defaultView.pageYOffset\n                    }, _this3.logger.child(iframeKey));\n                }).then(function (canvas) {\n                    return new Promise(function (resolve, reject) {\n                        var iframeCanvas = document.createElement('img');\n                        iframeCanvas.onload = function () {\n                            return resolve(canvas);\n                        };\n                        iframeCanvas.onerror = reject;\n                        iframeCanvas.src = canvas.toDataURL();\n                        if (tempIframe.parentNode) {\n                            tempIframe.parentNode.replaceChild((0, _Util.copyCSSStyles)(node.ownerDocument.defaultView.getComputedStyle(node), iframeCanvas), tempIframe);\n                        }\n                    });\n                });\n                return tempIframe;\n            }\n\n            return node.cloneNode(false);\n        }\n    }, {\n        key: 'cloneNode',\n        value: function cloneNode(node) {\n            var clone = node.nodeType === Node.TEXT_NODE ? document.createTextNode(node.nodeValue) : this.createElementClone(node);\n\n            var window = node.ownerDocument.defaultView;\n            var style = node instanceof window.HTMLElement ? window.getComputedStyle(node) : null;\n            var styleBefore = node instanceof window.HTMLElement ? window.getComputedStyle(node, ':before') : null;\n            var styleAfter = node instanceof window.HTMLElement ? window.getComputedStyle(node, ':after') : null;\n\n            if (this.referenceElement === node && clone instanceof window.HTMLElement) {\n                this.clonedReferenceElement = clone;\n            }\n\n            if (clone instanceof window.HTMLBodyElement) {\n                createPseudoHideStyles(clone);\n            }\n\n            var counters = (0, _PseudoNodeContent.parseCounterReset)(style, this.pseudoContentData);\n            var contentBefore = (0, _PseudoNodeContent.resolvePseudoContent)(node, styleBefore, this.pseudoContentData);\n\n            for (var child = node.firstChild; child; child = child.nextSibling) {\n                if (child.nodeType !== Node.ELEMENT_NODE ||\n                // $FlowFixMe\n                child.nodeName !== 'SCRIPT' && !child.hasAttribute(IGNORE_ATTRIBUTE)) {\n                    if (!this.copyStyles || child.nodeName !== 'STYLE') {\n                        clone.appendChild(this.cloneNode(child));\n                    }\n                }\n            }\n\n            var contentAfter = (0, _PseudoNodeContent.resolvePseudoContent)(node, styleAfter, this.pseudoContentData);\n            (0, _PseudoNodeContent.popCounters)(counters, this.pseudoContentData);\n\n            if (node instanceof window.HTMLElement && clone instanceof window.HTMLElement) {\n                if (styleBefore) {\n                    this.inlineAllImages(inlinePseudoElement(node, clone, styleBefore, contentBefore, PSEUDO_BEFORE));\n                }\n                if (styleAfter) {\n                    this.inlineAllImages(inlinePseudoElement(node, clone, styleAfter, contentAfter, PSEUDO_AFTER));\n                }\n                if (style && this.copyStyles && !(node instanceof HTMLIFrameElement)) {\n                    (0, _Util.copyCSSStyles)(style, clone);\n                }\n                this.inlineAllImages(clone);\n                if (node.scrollTop !== 0 || node.scrollLeft !== 0) {\n                    this.scrolledElements.push([clone, node.scrollLeft, node.scrollTop]);\n                }\n                switch (node.nodeName) {\n                    case 'CANVAS':\n                        if (!this.copyStyles) {\n                            cloneCanvasContents(node, clone);\n                        }\n                        break;\n                    case 'TEXTAREA':\n                    case 'SELECT':\n                        clone.value = node.value;\n                        break;\n                }\n            }\n            return clone;\n        }\n    }]);\n\n    return DocumentCloner;\n}();\n\nvar getSheetFonts = function getSheetFonts(sheet, document) {\n    // $FlowFixMe\n    return (sheet.cssRules ? Array.from(sheet.cssRules) : []).filter(function (rule) {\n        return rule.type === CSSRule.FONT_FACE_RULE;\n    }).map(function (rule) {\n        var src = (0, _background.parseBackgroundImage)(rule.style.getPropertyValue('src'));\n        var formats = [];\n        for (var i = 0; i < src.length; i++) {\n            if (src[i].method === 'url' && src[i + 1] && src[i + 1].method === 'format') {\n                var a = document.createElement('a');\n                a.href = src[i].args[0];\n                if (document.body) {\n                    document.body.appendChild(a);\n                }\n\n                var font = {\n                    src: a.href,\n                    format: src[i + 1].args[0]\n                };\n                formats.push(font);\n            }\n        }\n\n        return {\n            // TODO select correct format for browser),\n\n            formats: formats.filter(function (font) {\n                return (/^woff/i.test(font.format)\n                );\n            }),\n            fontFace: rule.style\n        };\n    }).filter(function (font) {\n        return font.formats.length;\n    });\n};\n\nvar createStyleSheetFontsFromText = function createStyleSheetFontsFromText(text, baseHref) {\n    var doc = document.implementation.createHTMLDocument('');\n    var base = document.createElement('base');\n    // $FlowFixMe\n    base.href = baseHref;\n    var style = document.createElement('style');\n\n    style.textContent = text;\n    if (doc.head) {\n        doc.head.appendChild(base);\n    }\n    if (doc.body) {\n        doc.body.appendChild(style);\n    }\n\n    return style.sheet ? getSheetFonts(style.sheet, doc) : [];\n};\n\nvar restoreOwnerScroll = function restoreOwnerScroll(ownerDocument, x, y) {\n    if (ownerDocument.defaultView && (x !== ownerDocument.defaultView.pageXOffset || y !== ownerDocument.defaultView.pageYOffset)) {\n        ownerDocument.defaultView.scrollTo(x, y);\n    }\n};\n\nvar cloneCanvasContents = function cloneCanvasContents(canvas, clonedCanvas) {\n    try {\n        if (clonedCanvas) {\n            clonedCanvas.width = canvas.width;\n            clonedCanvas.height = canvas.height;\n            var ctx = canvas.getContext('2d');\n            var clonedCtx = clonedCanvas.getContext('2d');\n            if (ctx) {\n                clonedCtx.putImageData(ctx.getImageData(0, 0, canvas.width, canvas.height), 0, 0);\n            } else {\n                clonedCtx.drawImage(canvas, 0, 0);\n            }\n        }\n    } catch (e) {}\n};\n\nvar inlinePseudoElement = function inlinePseudoElement(node, clone, style, contentItems, pseudoElt) {\n    if (!style || !style.content || style.content === 'none' || style.content === '-moz-alt-content' || style.display === 'none') {\n        return;\n    }\n\n    var anonymousReplacedElement = clone.ownerDocument.createElement('html2canvaspseudoelement');\n    (0, _Util.copyCSSStyles)(style, anonymousReplacedElement);\n\n    if (contentItems) {\n        var len = contentItems.length;\n        for (var i = 0; i < len; i++) {\n            var item = contentItems[i];\n            switch (item.type) {\n                case _PseudoNodeContent.PSEUDO_CONTENT_ITEM_TYPE.IMAGE:\n                    var img = clone.ownerDocument.createElement('img');\n                    img.src = (0, _background.parseBackgroundImage)('url(' + item.value + ')')[0].args[0];\n                    img.style.opacity = '1';\n                    anonymousReplacedElement.appendChild(img);\n                    break;\n                case _PseudoNodeContent.PSEUDO_CONTENT_ITEM_TYPE.TEXT:\n                    anonymousReplacedElement.appendChild(clone.ownerDocument.createTextNode(item.value));\n                    break;\n            }\n        }\n    }\n\n    anonymousReplacedElement.className = PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + ' ' + PSEUDO_HIDE_ELEMENT_CLASS_AFTER;\n    clone.className += pseudoElt === PSEUDO_BEFORE ? ' ' + PSEUDO_HIDE_ELEMENT_CLASS_BEFORE : ' ' + PSEUDO_HIDE_ELEMENT_CLASS_AFTER;\n    if (pseudoElt === PSEUDO_BEFORE) {\n        clone.insertBefore(anonymousReplacedElement, clone.firstChild);\n    } else {\n        clone.appendChild(anonymousReplacedElement);\n    }\n\n    return anonymousReplacedElement;\n};\n\nvar URL_REGEXP = /^url\\((.+)\\)$/i;\nvar PSEUDO_BEFORE = ':before';\nvar PSEUDO_AFTER = ':after';\nvar PSEUDO_HIDE_ELEMENT_CLASS_BEFORE = '___html2canvas___pseudoelement_before';\nvar PSEUDO_HIDE_ELEMENT_CLASS_AFTER = '___html2canvas___pseudoelement_after';\n\nvar PSEUDO_HIDE_ELEMENT_STYLE = '{\\n    content: \"\" !important;\\n    display: none !important;\\n}';\n\nvar createPseudoHideStyles = function createPseudoHideStyles(body) {\n    createStyles(body, '.' + PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + PSEUDO_BEFORE + PSEUDO_HIDE_ELEMENT_STYLE + '\\n         .' + PSEUDO_HIDE_ELEMENT_CLASS_AFTER + PSEUDO_AFTER + PSEUDO_HIDE_ELEMENT_STYLE);\n};\n\nvar createStyles = function createStyles(body, styles) {\n    var style = body.ownerDocument.createElement('style');\n    style.innerHTML = styles;\n    body.appendChild(style);\n};\n\nvar initNode = function initNode(_ref) {\n    var _ref2 = _slicedToArray(_ref, 3),\n        element = _ref2[0],\n        x = _ref2[1],\n        y = _ref2[2];\n\n    element.scrollLeft = x;\n    element.scrollTop = y;\n};\n\nvar generateIframeKey = function generateIframeKey() {\n    return Math.ceil(Date.now() + Math.random() * 10000000).toString(16);\n};\n\nvar DATA_URI_REGEXP = /^data:text\\/(.+);(base64)?,(.*)$/i;\n\nvar getIframeDocumentElement = function getIframeDocumentElement(node, options) {\n    try {\n        return Promise.resolve(node.contentWindow.document.documentElement);\n    } catch (e) {\n        return options.proxy ? (0, _Proxy.Proxy)(node.src, options).then(function (html) {\n            var match = html.match(DATA_URI_REGEXP);\n            if (!match) {\n                return Promise.reject();\n            }\n\n            return match[2] === 'base64' ? window.atob(decodeURIComponent(match[3])) : decodeURIComponent(match[3]);\n        }).then(function (html) {\n            return createIframeContainer(node.ownerDocument, (0, _Bounds.parseBounds)(node, 0, 0)).then(function (cloneIframeContainer) {\n                var cloneWindow = cloneIframeContainer.contentWindow;\n                var documentClone = cloneWindow.document;\n\n                documentClone.open();\n                documentClone.write(html);\n                var iframeLoad = iframeLoader(cloneIframeContainer).then(function () {\n                    return documentClone.documentElement;\n                });\n\n                documentClone.close();\n                return iframeLoad;\n            });\n        }) : Promise.reject();\n    }\n};\n\nvar createIframeContainer = function createIframeContainer(ownerDocument, bounds) {\n    var cloneIframeContainer = ownerDocument.createElement('iframe');\n\n    cloneIframeContainer.className = 'html2canvas-container';\n    cloneIframeContainer.style.visibility = 'hidden';\n    cloneIframeContainer.style.position = 'fixed';\n    cloneIframeContainer.style.left = '-10000px';\n    cloneIframeContainer.style.top = '0px';\n    cloneIframeContainer.style.border = '0';\n    cloneIframeContainer.width = bounds.width.toString();\n    cloneIframeContainer.height = bounds.height.toString();\n    cloneIframeContainer.scrolling = 'no'; // ios won't scroll without it\n    cloneIframeContainer.setAttribute(IGNORE_ATTRIBUTE, 'true');\n    if (!ownerDocument.body) {\n        return Promise.reject(process.env.NODE_ENV !== 'production' ? 'Body element not found in Document that is getting rendered' : '');\n    }\n\n    ownerDocument.body.appendChild(cloneIframeContainer);\n\n    return Promise.resolve(cloneIframeContainer);\n};\n\nvar iframeLoader = function iframeLoader(cloneIframeContainer) {\n    var cloneWindow = cloneIframeContainer.contentWindow;\n    var documentClone = cloneWindow.document;\n\n    return new Promise(function (resolve, reject) {\n        cloneWindow.onload = cloneIframeContainer.onload = documentClone.onreadystatechange = function () {\n            var interval = setInterval(function () {\n                if (documentClone.body.childNodes.length > 0 && documentClone.readyState === 'complete') {\n                    clearInterval(interval);\n                    resolve(cloneIframeContainer);\n                }\n            }, 50);\n        };\n    });\n};\n\nvar cloneWindow = exports.cloneWindow = function cloneWindow(ownerDocument, bounds, referenceElement, options, logger, renderer) {\n    var cloner = new DocumentCloner(referenceElement, options, logger, false, renderer);\n    var scrollX = ownerDocument.defaultView.pageXOffset;\n    var scrollY = ownerDocument.defaultView.pageYOffset;\n\n    return createIframeContainer(ownerDocument, bounds).then(function (cloneIframeContainer) {\n        var cloneWindow = cloneIframeContainer.contentWindow;\n        var documentClone = cloneWindow.document;\n\n        /* Chrome doesn't detect relative background-images assigned in inline <style> sheets when fetched through getComputedStyle\n             if window url is about:blank, we can assign the url to current by writing onto the document\n             */\n\n        var iframeLoad = iframeLoader(cloneIframeContainer).then(function () {\n            cloner.scrolledElements.forEach(initNode);\n            cloneWindow.scrollTo(bounds.left, bounds.top);\n            if (/(iPad|iPhone|iPod)/g.test(navigator.userAgent) && (cloneWindow.scrollY !== bounds.top || cloneWindow.scrollX !== bounds.left)) {\n                documentClone.documentElement.style.top = -bounds.top + 'px';\n                documentClone.documentElement.style.left = -bounds.left + 'px';\n                documentClone.documentElement.style.position = 'absolute';\n            }\n            return cloner.clonedReferenceElement instanceof cloneWindow.HTMLElement || cloner.clonedReferenceElement instanceof ownerDocument.defaultView.HTMLElement || cloner.clonedReferenceElement instanceof HTMLElement ? Promise.resolve([cloneIframeContainer, cloner.clonedReferenceElement, cloner.resourceLoader]) : Promise.reject(process.env.NODE_ENV !== 'production' ? 'Error finding the ' + referenceElement.nodeName + ' in the cloned document' : '');\n        });\n\n        documentClone.open();\n        documentClone.write(serializeDoctype(document.doctype) + '<html></html>');\n        // Chrome scrolls the parent document for some reason after the write to the cloned window???\n        restoreOwnerScroll(referenceElement.ownerDocument, scrollX, scrollY);\n        documentClone.replaceChild(documentClone.adoptNode(cloner.documentElement), documentClone.documentElement);\n        documentClone.close();\n\n        return iframeLoad;\n    });\n};\n\nvar serializeDoctype = function serializeDoctype(doctype) {\n    var str = '';\n    if (doctype) {\n        str += '<!DOCTYPE ';\n        if (doctype.name) {\n            str += doctype.name;\n        }\n\n        if (doctype.internalSubset) {\n            str += doctype.internalSubset;\n        }\n\n        if (doctype.publicId) {\n            str += '\"' + doctype.publicId + '\"';\n        }\n\n        if (doctype.systemId) {\n            str += '\"' + doctype.systemId + '\"';\n        }\n\n        str += '>';\n    }\n\n    return str;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar ANGLE = /([+-]?\\d*\\.?\\d+)(deg|grad|rad|turn)/i;\n\nvar parseAngle = exports.parseAngle = function parseAngle(angle) {\n    var match = angle.match(ANGLE);\n\n    if (match) {\n        var value = parseFloat(match[1]);\n        switch (match[2].toLowerCase()) {\n            case 'deg':\n                return Math.PI * value / 180;\n            case 'grad':\n                return Math.PI / 200 * value;\n            case 'rad':\n                return value;\n            case 'turn':\n                return Math.PI * 2 * value;\n        }\n    }\n\n    return null;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.transformWebkitRadialGradientArgs = exports.parseGradient = exports.RadialGradient = exports.LinearGradient = exports.RADIAL_GRADIENT_SHAPE = exports.GRADIENT_TYPE = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _NodeContainer = require('./NodeContainer');\n\nvar _NodeContainer2 = _interopRequireDefault(_NodeContainer);\n\nvar _Angle = require('./Angle');\n\nvar _Color = require('./Color');\n\nvar _Color2 = _interopRequireDefault(_Color);\n\nvar _Length = require('./Length');\n\nvar _Length2 = _interopRequireDefault(_Length);\n\nvar _Util = require('./Util');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar SIDE_OR_CORNER = /^(to )?(left|top|right|bottom)( (left|top|right|bottom))?$/i;\nvar PERCENTAGE_ANGLES = /^([+-]?\\d*\\.?\\d+)% ([+-]?\\d*\\.?\\d+)%$/i;\nvar ENDS_WITH_LENGTH = /(px)|%|( 0)$/i;\nvar FROM_TO_COLORSTOP = /^(from|to|color-stop)\\((?:([\\d.]+)(%)?,\\s*)?(.+?)\\)$/i;\nvar RADIAL_SHAPE_DEFINITION = /^\\s*(circle|ellipse)?\\s*((?:([\\d.]+)(px|r?em|%)\\s*(?:([\\d.]+)(px|r?em|%))?)|closest-side|closest-corner|farthest-side|farthest-corner)?\\s*(?:at\\s*(?:(left|center|right)|([\\d.]+)(px|r?em|%))\\s+(?:(top|center|bottom)|([\\d.]+)(px|r?em|%)))?(?:\\s|$)/i;\n\nvar GRADIENT_TYPE = exports.GRADIENT_TYPE = {\n    LINEAR_GRADIENT: 0,\n    RADIAL_GRADIENT: 1\n};\n\nvar RADIAL_GRADIENT_SHAPE = exports.RADIAL_GRADIENT_SHAPE = {\n    CIRCLE: 0,\n    ELLIPSE: 1\n};\n\nvar LENGTH_FOR_POSITION = {\n    left: new _Length2.default('0%'),\n    top: new _Length2.default('0%'),\n    center: new _Length2.default('50%'),\n    right: new _Length2.default('100%'),\n    bottom: new _Length2.default('100%')\n};\n\nvar LinearGradient = exports.LinearGradient = function LinearGradient(colorStops, direction) {\n    _classCallCheck(this, LinearGradient);\n\n    this.type = GRADIENT_TYPE.LINEAR_GRADIENT;\n    this.colorStops = colorStops;\n    this.direction = direction;\n};\n\nvar RadialGradient = exports.RadialGradient = function RadialGradient(colorStops, shape, center, radius) {\n    _classCallCheck(this, RadialGradient);\n\n    this.type = GRADIENT_TYPE.RADIAL_GRADIENT;\n    this.colorStops = colorStops;\n    this.shape = shape;\n    this.center = center;\n    this.radius = radius;\n};\n\nvar parseGradient = exports.parseGradient = function parseGradient(container, _ref, bounds) {\n    var args = _ref.args,\n        method = _ref.method,\n        prefix = _ref.prefix;\n\n    if (method === 'linear-gradient') {\n        return parseLinearGradient(args, bounds, !!prefix);\n    } else if (method === 'gradient' && args[0] === 'linear') {\n        // TODO handle correct angle\n        return parseLinearGradient(['to bottom'].concat(transformObsoleteColorStops(args.slice(3))), bounds, !!prefix);\n    } else if (method === 'radial-gradient') {\n        return parseRadialGradient(container, prefix === '-webkit-' ? transformWebkitRadialGradientArgs(args) : args, bounds);\n    } else if (method === 'gradient' && args[0] === 'radial') {\n        return parseRadialGradient(container, transformObsoleteColorStops(transformWebkitRadialGradientArgs(args.slice(1))), bounds);\n    }\n};\n\nvar parseColorStops = function parseColorStops(args, firstColorStopIndex, lineLength) {\n    var colorStops = [];\n\n    for (var i = firstColorStopIndex; i < args.length; i++) {\n        var value = args[i];\n        var HAS_LENGTH = ENDS_WITH_LENGTH.test(value);\n        var lastSpaceIndex = value.lastIndexOf(' ');\n        var _color = new _Color2.default(HAS_LENGTH ? value.substring(0, lastSpaceIndex) : value);\n        var _stop = HAS_LENGTH ? new _Length2.default(value.substring(lastSpaceIndex + 1)) : i === firstColorStopIndex ? new _Length2.default('0%') : i === args.length - 1 ? new _Length2.default('100%') : null;\n        colorStops.push({ color: _color, stop: _stop });\n    }\n\n    var absoluteValuedColorStops = colorStops.map(function (_ref2) {\n        var color = _ref2.color,\n            stop = _ref2.stop;\n\n        var absoluteStop = lineLength === 0 ? 0 : stop ? stop.getAbsoluteValue(lineLength) / lineLength : null;\n\n        return {\n            color: color,\n            // $FlowFixMe\n            stop: absoluteStop\n        };\n    });\n\n    var previousColorStop = absoluteValuedColorStops[0].stop;\n    for (var _i = 0; _i < absoluteValuedColorStops.length; _i++) {\n        if (previousColorStop !== null) {\n            var _stop2 = absoluteValuedColorStops[_i].stop;\n            if (_stop2 === null) {\n                var n = _i;\n                while (absoluteValuedColorStops[n].stop === null) {\n                    n++;\n                }\n                var steps = n - _i + 1;\n                var nextColorStep = absoluteValuedColorStops[n].stop;\n                var stepSize = (nextColorStep - previousColorStop) / steps;\n                for (; _i < n; _i++) {\n                    previousColorStop = absoluteValuedColorStops[_i].stop = previousColorStop + stepSize;\n                }\n            } else {\n                previousColorStop = _stop2;\n            }\n        }\n    }\n\n    return absoluteValuedColorStops;\n};\n\nvar parseLinearGradient = function parseLinearGradient(args, bounds, hasPrefix) {\n    var angle = (0, _Angle.parseAngle)(args[0]);\n    var HAS_SIDE_OR_CORNER = SIDE_OR_CORNER.test(args[0]);\n    var HAS_DIRECTION = HAS_SIDE_OR_CORNER || angle !== null || PERCENTAGE_ANGLES.test(args[0]);\n    var direction = HAS_DIRECTION ? angle !== null ? calculateGradientDirection(\n    // if there is a prefix, the 0° angle points due East (instead of North per W3C)\n    hasPrefix ? angle - Math.PI * 0.5 : angle, bounds) : HAS_SIDE_OR_CORNER ? parseSideOrCorner(args[0], bounds) : parsePercentageAngle(args[0], bounds) : calculateGradientDirection(Math.PI, bounds);\n    var firstColorStopIndex = HAS_DIRECTION ? 1 : 0;\n\n    // TODO: Fix some inaccuracy with color stops with px values\n    var lineLength = Math.min((0, _Util.distance)(Math.abs(direction.x0) + Math.abs(direction.x1), Math.abs(direction.y0) + Math.abs(direction.y1)), bounds.width * 2, bounds.height * 2);\n\n    return new LinearGradient(parseColorStops(args, firstColorStopIndex, lineLength), direction);\n};\n\nvar parseRadialGradient = function parseRadialGradient(container, args, bounds) {\n    var m = args[0].match(RADIAL_SHAPE_DEFINITION);\n    var shape = m && (m[1] === 'circle' || // explicit shape specification\n    m[3] !== undefined && m[5] === undefined) // only one radius coordinate\n    ? RADIAL_GRADIENT_SHAPE.CIRCLE : RADIAL_GRADIENT_SHAPE.ELLIPSE;\n    var radius = {};\n    var center = {};\n\n    if (m) {\n        // Radius\n        if (m[3] !== undefined) {\n            radius.x = (0, _Length.calculateLengthFromValueWithUnit)(container, m[3], m[4]).getAbsoluteValue(bounds.width);\n        }\n\n        if (m[5] !== undefined) {\n            radius.y = (0, _Length.calculateLengthFromValueWithUnit)(container, m[5], m[6]).getAbsoluteValue(bounds.height);\n        }\n\n        // Position\n        if (m[7]) {\n            center.x = LENGTH_FOR_POSITION[m[7].toLowerCase()];\n        } else if (m[8] !== undefined) {\n            center.x = (0, _Length.calculateLengthFromValueWithUnit)(container, m[8], m[9]);\n        }\n\n        if (m[10]) {\n            center.y = LENGTH_FOR_POSITION[m[10].toLowerCase()];\n        } else if (m[11] !== undefined) {\n            center.y = (0, _Length.calculateLengthFromValueWithUnit)(container, m[11], m[12]);\n        }\n    }\n\n    var gradientCenter = {\n        x: center.x === undefined ? bounds.width / 2 : center.x.getAbsoluteValue(bounds.width),\n        y: center.y === undefined ? bounds.height / 2 : center.y.getAbsoluteValue(bounds.height)\n    };\n    var gradientRadius = calculateRadius(m && m[2] || 'farthest-corner', shape, gradientCenter, radius, bounds);\n\n    return new RadialGradient(parseColorStops(args, m ? 1 : 0, Math.min(gradientRadius.x, gradientRadius.y)), shape, gradientCenter, gradientRadius);\n};\n\nvar calculateGradientDirection = function calculateGradientDirection(radian, bounds) {\n    var width = bounds.width;\n    var height = bounds.height;\n    var HALF_WIDTH = width * 0.5;\n    var HALF_HEIGHT = height * 0.5;\n    var lineLength = Math.abs(width * Math.sin(radian)) + Math.abs(height * Math.cos(radian));\n    var HALF_LINE_LENGTH = lineLength / 2;\n\n    var x0 = HALF_WIDTH + Math.sin(radian) * HALF_LINE_LENGTH;\n    var y0 = HALF_HEIGHT - Math.cos(radian) * HALF_LINE_LENGTH;\n    var x1 = width - x0;\n    var y1 = height - y0;\n\n    return { x0: x0, x1: x1, y0: y0, y1: y1 };\n};\n\nvar parseTopRight = function parseTopRight(bounds) {\n    return Math.acos(bounds.width / 2 / ((0, _Util.distance)(bounds.width, bounds.height) / 2));\n};\n\nvar parseSideOrCorner = function parseSideOrCorner(side, bounds) {\n    switch (side) {\n        case 'bottom':\n        case 'to top':\n            return calculateGradientDirection(0, bounds);\n        case 'left':\n        case 'to right':\n            return calculateGradientDirection(Math.PI / 2, bounds);\n        case 'right':\n        case 'to left':\n            return calculateGradientDirection(3 * Math.PI / 2, bounds);\n        case 'top right':\n        case 'right top':\n        case 'to bottom left':\n        case 'to left bottom':\n            return calculateGradientDirection(Math.PI + parseTopRight(bounds), bounds);\n        case 'top left':\n        case 'left top':\n        case 'to bottom right':\n        case 'to right bottom':\n            return calculateGradientDirection(Math.PI - parseTopRight(bounds), bounds);\n        case 'bottom left':\n        case 'left bottom':\n        case 'to top right':\n        case 'to right top':\n            return calculateGradientDirection(parseTopRight(bounds), bounds);\n        case 'bottom right':\n        case 'right bottom':\n        case 'to top left':\n        case 'to left top':\n            return calculateGradientDirection(2 * Math.PI - parseTopRight(bounds), bounds);\n        case 'top':\n        case 'to bottom':\n        default:\n            return calculateGradientDirection(Math.PI, bounds);\n    }\n};\n\nvar parsePercentageAngle = function parsePercentageAngle(angle, bounds) {\n    var _angle$split$map = angle.split(' ').map(parseFloat),\n        _angle$split$map2 = _slicedToArray(_angle$split$map, 2),\n        left = _angle$split$map2[0],\n        top = _angle$split$map2[1];\n\n    var ratio = left / 100 * bounds.width / (top / 100 * bounds.height);\n\n    return calculateGradientDirection(Math.atan(isNaN(ratio) ? 1 : ratio) + Math.PI / 2, bounds);\n};\n\nvar findCorner = function findCorner(bounds, x, y, closest) {\n    var corners = [{ x: 0, y: 0 }, { x: 0, y: bounds.height }, { x: bounds.width, y: 0 }, { x: bounds.width, y: bounds.height }];\n\n    // $FlowFixMe\n    return corners.reduce(function (stat, corner) {\n        var d = (0, _Util.distance)(x - corner.x, y - corner.y);\n        if (closest ? d < stat.optimumDistance : d > stat.optimumDistance) {\n            return {\n                optimumCorner: corner,\n                optimumDistance: d\n            };\n        }\n\n        return stat;\n    }, {\n        optimumDistance: closest ? Infinity : -Infinity,\n        optimumCorner: null\n    }).optimumCorner;\n};\n\nvar calculateRadius = function calculateRadius(extent, shape, center, radius, bounds) {\n    var x = center.x;\n    var y = center.y;\n    var rx = 0;\n    var ry = 0;\n\n    switch (extent) {\n        case 'closest-side':\n            // The ending shape is sized so that that it exactly meets the side of the gradient box closest to the gradient’s center.\n            // If the shape is an ellipse, it exactly meets the closest side in each dimension.\n            if (shape === RADIAL_GRADIENT_SHAPE.CIRCLE) {\n                rx = ry = Math.min(Math.abs(x), Math.abs(x - bounds.width), Math.abs(y), Math.abs(y - bounds.height));\n            } else if (shape === RADIAL_GRADIENT_SHAPE.ELLIPSE) {\n                rx = Math.min(Math.abs(x), Math.abs(x - bounds.width));\n                ry = Math.min(Math.abs(y), Math.abs(y - bounds.height));\n            }\n            break;\n\n        case 'closest-corner':\n            // The ending shape is sized so that that it passes through the corner of the gradient box closest to the gradient’s center.\n            // If the shape is an ellipse, the ending shape is given the same aspect-ratio it would have if closest-side were specified.\n            if (shape === RADIAL_GRADIENT_SHAPE.CIRCLE) {\n                rx = ry = Math.min((0, _Util.distance)(x, y), (0, _Util.distance)(x, y - bounds.height), (0, _Util.distance)(x - bounds.width, y), (0, _Util.distance)(x - bounds.width, y - bounds.height));\n            } else if (shape === RADIAL_GRADIENT_SHAPE.ELLIPSE) {\n                // Compute the ratio ry/rx (which is to be the same as for \"closest-side\")\n                var c = Math.min(Math.abs(y), Math.abs(y - bounds.height)) / Math.min(Math.abs(x), Math.abs(x - bounds.width));\n                var corner = findCorner(bounds, x, y, true);\n                rx = (0, _Util.distance)(corner.x - x, (corner.y - y) / c);\n                ry = c * rx;\n            }\n            break;\n\n        case 'farthest-side':\n            // Same as closest-side, except the ending shape is sized based on the farthest side(s)\n            if (shape === RADIAL_GRADIENT_SHAPE.CIRCLE) {\n                rx = ry = Math.max(Math.abs(x), Math.abs(x - bounds.width), Math.abs(y), Math.abs(y - bounds.height));\n            } else if (shape === RADIAL_GRADIENT_SHAPE.ELLIPSE) {\n                rx = Math.max(Math.abs(x), Math.abs(x - bounds.width));\n                ry = Math.max(Math.abs(y), Math.abs(y - bounds.height));\n            }\n            break;\n\n        case 'farthest-corner':\n            // Same as closest-corner, except the ending shape is sized based on the farthest corner.\n            // If the shape is an ellipse, the ending shape is given the same aspect ratio it would have if farthest-side were specified.\n            if (shape === RADIAL_GRADIENT_SHAPE.CIRCLE) {\n                rx = ry = Math.max((0, _Util.distance)(x, y), (0, _Util.distance)(x, y - bounds.height), (0, _Util.distance)(x - bounds.width, y), (0, _Util.distance)(x - bounds.width, y - bounds.height));\n            } else if (shape === RADIAL_GRADIENT_SHAPE.ELLIPSE) {\n                // Compute the ratio ry/rx (which is to be the same as for \"farthest-side\")\n                var _c = Math.max(Math.abs(y), Math.abs(y - bounds.height)) / Math.max(Math.abs(x), Math.abs(x - bounds.width));\n                var _corner = findCorner(bounds, x, y, false);\n                rx = (0, _Util.distance)(_corner.x - x, (_corner.y - y) / _c);\n                ry = _c * rx;\n            }\n            break;\n\n        default:\n            // pixel or percentage values\n            rx = radius.x || 0;\n            ry = radius.y !== undefined ? radius.y : rx;\n            break;\n    }\n\n    return {\n        x: rx,\n        y: ry\n    };\n};\n\nvar transformWebkitRadialGradientArgs = exports.transformWebkitRadialGradientArgs = function transformWebkitRadialGradientArgs(args) {\n    var shape = '';\n    var radius = '';\n    var extent = '';\n    var position = '';\n    var idx = 0;\n\n    var POSITION = /^(left|center|right|\\d+(?:px|r?em|%)?)(?:\\s+(top|center|bottom|\\d+(?:px|r?em|%)?))?$/i;\n    var SHAPE_AND_EXTENT = /^(circle|ellipse)?\\s*(closest-side|closest-corner|farthest-side|farthest-corner|contain|cover)?$/i;\n    var RADIUS = /^\\d+(px|r?em|%)?(?:\\s+\\d+(px|r?em|%)?)?$/i;\n\n    var matchStartPosition = args[idx].match(POSITION);\n    if (matchStartPosition) {\n        idx++;\n    }\n\n    var matchShapeExtent = args[idx].match(SHAPE_AND_EXTENT);\n    if (matchShapeExtent) {\n        shape = matchShapeExtent[1] || '';\n        extent = matchShapeExtent[2] || '';\n        if (extent === 'contain') {\n            extent = 'closest-side';\n        } else if (extent === 'cover') {\n            extent = 'farthest-corner';\n        }\n        idx++;\n    }\n\n    var matchStartRadius = args[idx].match(RADIUS);\n    if (matchStartRadius) {\n        idx++;\n    }\n\n    var matchEndPosition = args[idx].match(POSITION);\n    if (matchEndPosition) {\n        idx++;\n    }\n\n    var matchEndRadius = args[idx].match(RADIUS);\n    if (matchEndRadius) {\n        idx++;\n    }\n\n    var matchPosition = matchEndPosition || matchStartPosition;\n    if (matchPosition && matchPosition[1]) {\n        position = matchPosition[1] + (/^\\d+$/.test(matchPosition[1]) ? 'px' : '');\n        if (matchPosition[2]) {\n            position += ' ' + matchPosition[2] + (/^\\d+$/.test(matchPosition[2]) ? 'px' : '');\n        }\n    }\n\n    var matchRadius = matchEndRadius || matchStartRadius;\n    if (matchRadius) {\n        radius = matchRadius[0];\n        if (!matchRadius[1]) {\n            radius += 'px';\n        }\n    }\n\n    if (position && !shape && !radius && !extent) {\n        radius = position;\n        position = '';\n    }\n\n    if (position) {\n        position = 'at ' + position;\n    }\n\n    return [[shape, extent, radius, position].filter(function (s) {\n        return !!s;\n    }).join(' ')].concat(args.slice(idx));\n};\n\nvar transformObsoleteColorStops = function transformObsoleteColorStops(args) {\n    return args.map(function (color) {\n        return color.match(FROM_TO_COLORSTOP);\n    })\n    // $FlowFixMe\n    .map(function (v, index) {\n        if (!v) {\n            return args[index];\n        }\n\n        switch (v[1]) {\n            case 'from':\n                return v[4] + ' 0%';\n            case 'to':\n                return v[4] + ' 100%';\n            case 'color-stop':\n                if (v[3] === '%') {\n                    return v[4] + ' ' + v[2];\n                }\n                return v[4] + ' ' + parseFloat(v[2]) * 100 + '%';\n        }\n    });\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Bounds = require('./Bounds');\n\nvar _Font = require('./Font');\n\nvar _Gradient = require('./Gradient');\n\nvar _TextContainer = require('./TextContainer');\n\nvar _TextContainer2 = _interopRequireDefault(_TextContainer);\n\nvar _background = require('./parsing/background');\n\nvar _border = require('./parsing/border');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Renderer = function () {\n    function Renderer(target, options) {\n        _classCallCheck(this, Renderer);\n\n        this.target = target;\n        this.options = options;\n        target.render(options);\n    }\n\n    _createClass(Renderer, [{\n        key: 'renderNode',\n        value: function renderNode(container) {\n            if (container.isVisible()) {\n                this.renderNodeBackgroundAndBorders(container);\n                this.renderNodeContent(container);\n            }\n        }\n    }, {\n        key: 'renderNodeContent',\n        value: function renderNodeContent(container) {\n            var _this = this;\n\n            var callback = function callback() {\n                if (container.childNodes.length) {\n                    container.childNodes.forEach(function (child) {\n                        if (child instanceof _TextContainer2.default) {\n                            var style = child.parent.style;\n                            _this.target.renderTextNode(child.bounds, style.color, style.font, style.textDecoration, style.textShadow);\n                        } else {\n                            _this.target.drawShape(child, container.style.color);\n                        }\n                    });\n                }\n\n                if (container.image) {\n                    var _image = _this.options.imageStore.get(container.image);\n                    if (_image) {\n                        var contentBox = (0, _Bounds.calculateContentBox)(container.bounds, container.style.padding, container.style.border);\n                        var _width = typeof _image.width === 'number' && _image.width > 0 ? _image.width : contentBox.width;\n                        var _height = typeof _image.height === 'number' && _image.height > 0 ? _image.height : contentBox.height;\n                        if (_width > 0 && _height > 0) {\n                            _this.target.clip([(0, _Bounds.calculatePaddingBoxPath)(container.curvedBounds)], function () {\n                                _this.target.drawImage(_image, new _Bounds.Bounds(0, 0, _width, _height), contentBox);\n                            });\n                        }\n                    }\n                }\n            };\n            var paths = container.getClipPaths();\n            if (paths.length) {\n                this.target.clip(paths, callback);\n            } else {\n                callback();\n            }\n        }\n    }, {\n        key: 'renderNodeBackgroundAndBorders',\n        value: function renderNodeBackgroundAndBorders(container) {\n            var _this2 = this;\n\n            var HAS_BACKGROUND = !container.style.background.backgroundColor.isTransparent() || container.style.background.backgroundImage.length;\n\n            var hasRenderableBorders = container.style.border.some(function (border) {\n                return border.borderStyle !== _border.BORDER_STYLE.NONE && !border.borderColor.isTransparent();\n            });\n\n            var callback = function callback() {\n                var backgroundPaintingArea = (0, _background.calculateBackgroungPaintingArea)(container.curvedBounds, container.style.background.backgroundClip);\n\n                if (HAS_BACKGROUND) {\n                    _this2.target.clip([backgroundPaintingArea], function () {\n                        if (!container.style.background.backgroundColor.isTransparent()) {\n                            _this2.target.fill(container.style.background.backgroundColor);\n                        }\n\n                        _this2.renderBackgroundImage(container);\n                    });\n                }\n\n                container.style.border.forEach(function (border, side) {\n                    if (border.borderStyle !== _border.BORDER_STYLE.NONE && !border.borderColor.isTransparent()) {\n                        _this2.renderBorder(border, side, container.curvedBounds);\n                    }\n                });\n            };\n\n            if (HAS_BACKGROUND || hasRenderableBorders) {\n                var paths = container.parent ? container.parent.getClipPaths() : [];\n                if (paths.length) {\n                    this.target.clip(paths, callback);\n                } else {\n                    callback();\n                }\n            }\n        }\n    }, {\n        key: 'renderBackgroundImage',\n        value: function renderBackgroundImage(container) {\n            var _this3 = this;\n\n            container.style.background.backgroundImage.slice(0).reverse().forEach(function (backgroundImage) {\n                if (backgroundImage.source.method === 'url' && backgroundImage.source.args.length) {\n                    _this3.renderBackgroundRepeat(container, backgroundImage);\n                } else if (/gradient/i.test(backgroundImage.source.method)) {\n                    _this3.renderBackgroundGradient(container, backgroundImage);\n                }\n            });\n        }\n    }, {\n        key: 'renderBackgroundRepeat',\n        value: function renderBackgroundRepeat(container, background) {\n            var image = this.options.imageStore.get(background.source.args[0]);\n            if (image) {\n                var backgroundPositioningArea = (0, _background.calculateBackgroungPositioningArea)(container.style.background.backgroundOrigin, container.bounds, container.style.padding, container.style.border);\n                var backgroundImageSize = (0, _background.calculateBackgroundSize)(background, image, backgroundPositioningArea);\n                var position = (0, _background.calculateBackgroundPosition)(background.position, backgroundImageSize, backgroundPositioningArea);\n                var _path = (0, _background.calculateBackgroundRepeatPath)(background, position, backgroundImageSize, backgroundPositioningArea, container.bounds);\n\n                var _offsetX = Math.round(backgroundPositioningArea.left + position.x);\n                var _offsetY = Math.round(backgroundPositioningArea.top + position.y);\n                this.target.renderRepeat(_path, image, backgroundImageSize, _offsetX, _offsetY);\n            }\n        }\n    }, {\n        key: 'renderBackgroundGradient',\n        value: function renderBackgroundGradient(container, background) {\n            var backgroundPositioningArea = (0, _background.calculateBackgroungPositioningArea)(container.style.background.backgroundOrigin, container.bounds, container.style.padding, container.style.border);\n            var backgroundImageSize = (0, _background.calculateGradientBackgroundSize)(background, backgroundPositioningArea);\n            var position = (0, _background.calculateBackgroundPosition)(background.position, backgroundImageSize, backgroundPositioningArea);\n            var gradientBounds = new _Bounds.Bounds(Math.round(backgroundPositioningArea.left + position.x), Math.round(backgroundPositioningArea.top + position.y), backgroundImageSize.width, backgroundImageSize.height);\n\n            var gradient = (0, _Gradient.parseGradient)(container, background.source, gradientBounds);\n            if (gradient) {\n                switch (gradient.type) {\n                    case _Gradient.GRADIENT_TYPE.LINEAR_GRADIENT:\n                        // $FlowFixMe\n                        this.target.renderLinearGradient(gradientBounds, gradient);\n                        break;\n                    case _Gradient.GRADIENT_TYPE.RADIAL_GRADIENT:\n                        // $FlowFixMe\n                        this.target.renderRadialGradient(gradientBounds, gradient);\n                        break;\n                }\n            }\n        }\n    }, {\n        key: 'renderBorder',\n        value: function renderBorder(border, side, curvePoints) {\n            this.target.drawShape((0, _Bounds.parsePathForBorder)(curvePoints, side), border.borderColor);\n        }\n    }, {\n        key: 'renderStack',\n        value: function renderStack(stack) {\n            var _this4 = this;\n\n            if (stack.container.isVisible()) {\n                var _opacity = stack.getOpacity();\n                if (_opacity !== this._opacity) {\n                    this.target.setOpacity(stack.getOpacity());\n                    this._opacity = _opacity;\n                }\n\n                var _transform = stack.container.style.transform;\n                if (_transform !== null) {\n                    this.target.transform(stack.container.bounds.left + _transform.transformOrigin[0].value, stack.container.bounds.top + _transform.transformOrigin[1].value, _transform.transform, function () {\n                        return _this4.renderStackContent(stack);\n                    });\n                } else {\n                    this.renderStackContent(stack);\n                }\n            }\n        }\n    }, {\n        key: 'renderStackContent',\n        value: function renderStackContent(stack) {\n            var _splitStackingContext = splitStackingContexts(stack),\n                _splitStackingContext2 = _slicedToArray(_splitStackingContext, 5),\n                negativeZIndex = _splitStackingContext2[0],\n                zeroOrAutoZIndexOrTransformedOrOpacity = _splitStackingContext2[1],\n                positiveZIndex = _splitStackingContext2[2],\n                nonPositionedFloats = _splitStackingContext2[3],\n                nonPositionedInlineLevel = _splitStackingContext2[4];\n\n            var _splitDescendants = splitDescendants(stack),\n                _splitDescendants2 = _slicedToArray(_splitDescendants, 2),\n                inlineLevel = _splitDescendants2[0],\n                nonInlineLevel = _splitDescendants2[1];\n\n            // https://www.w3.org/TR/css-position-3/#painting-order\n            // 1. the background and borders of the element forming the stacking context.\n\n\n            this.renderNodeBackgroundAndBorders(stack.container);\n            // 2. the child stacking contexts with negative stack levels (most negative first).\n            negativeZIndex.sort(sortByZIndex).forEach(this.renderStack, this);\n            // 3. For all its in-flow, non-positioned, block-level descendants in tree order:\n            this.renderNodeContent(stack.container);\n            nonInlineLevel.forEach(this.renderNode, this);\n            // 4. All non-positioned floating descendants, in tree order. For each one of these,\n            // treat the element as if it created a new stacking context, but any positioned descendants and descendants\n            // which actually create a new stacking context should be considered part of the parent stacking context,\n            // not this new one.\n            nonPositionedFloats.forEach(this.renderStack, this);\n            // 5. the in-flow, inline-level, non-positioned descendants, including inline tables and inline blocks.\n            nonPositionedInlineLevel.forEach(this.renderStack, this);\n            inlineLevel.forEach(this.renderNode, this);\n            // 6. All positioned, opacity or transform descendants, in tree order that fall into the following categories:\n            //  All positioned descendants with 'z-index: auto' or 'z-index: 0', in tree order.\n            //  For those with 'z-index: auto', treat the element as if it created a new stacking context,\n            //  but any positioned descendants and descendants which actually create a new stacking context should be\n            //  considered part of the parent stacking context, not this new one. For those with 'z-index: 0',\n            //  treat the stacking context generated atomically.\n            //\n            //  All opacity descendants with opacity less than 1\n            //\n            //  All transform descendants with transform other than none\n            zeroOrAutoZIndexOrTransformedOrOpacity.forEach(this.renderStack, this);\n            // 7. Stacking contexts formed by positioned descendants with z-indices greater than or equal to 1 in z-index\n            // order (smallest first) then tree order.\n            positiveZIndex.sort(sortByZIndex).forEach(this.renderStack, this);\n        }\n    }, {\n        key: 'render',\n        value: function render(stack) {\n            var _this5 = this;\n\n            if (this.options.backgroundColor) {\n                this.target.rectangle(this.options.x, this.options.y, this.options.width, this.options.height, this.options.backgroundColor);\n            }\n            this.renderStack(stack);\n            var target = this.target.getTarget();\n            if (process.env.NODE_ENV !== 'production') {\n                return target.then(function (output) {\n                    _this5.options.logger.log('Render completed');\n                    return output;\n                });\n            }\n            return target;\n        }\n    }]);\n\n    return Renderer;\n}();\n\nexports.default = Renderer;\n\n\nvar splitDescendants = function splitDescendants(stack) {\n    var inlineLevel = [];\n    var nonInlineLevel = [];\n\n    var length = stack.children.length;\n    for (var i = 0; i < length; i++) {\n        var child = stack.children[i];\n        if (child.isInlineLevel()) {\n            inlineLevel.push(child);\n        } else {\n            nonInlineLevel.push(child);\n        }\n    }\n    return [inlineLevel, nonInlineLevel];\n};\n\nvar splitStackingContexts = function splitStackingContexts(stack) {\n    var negativeZIndex = [];\n    var zeroOrAutoZIndexOrTransformedOrOpacity = [];\n    var positiveZIndex = [];\n    var nonPositionedFloats = [];\n    var nonPositionedInlineLevel = [];\n    var length = stack.contexts.length;\n    for (var i = 0; i < length; i++) {\n        var child = stack.contexts[i];\n        if (child.container.isPositioned() || child.container.style.opacity < 1 || child.container.isTransformed()) {\n            if (child.container.style.zIndex.order < 0) {\n                negativeZIndex.push(child);\n            } else if (child.container.style.zIndex.order > 0) {\n                positiveZIndex.push(child);\n            } else {\n                zeroOrAutoZIndexOrTransformedOrOpacity.push(child);\n            }\n        } else {\n            if (child.container.isFloating()) {\n                nonPositionedFloats.push(child);\n            } else {\n                nonPositionedInlineLevel.push(child);\n            }\n        }\n    }\n    return [negativeZIndex, zeroOrAutoZIndexOrTransformedOrOpacity, positiveZIndex, nonPositionedFloats, nonPositionedInlineLevel];\n};\n\nvar sortByZIndex = function sortByZIndex(a, b) {\n    if (a.container.style.zIndex.order > b.container.style.zIndex.order) {\n        return 1;\n    } else if (a.container.style.zIndex.order < b.container.style.zIndex.order) {\n        return -1;\n    }\n\n    return a.container.index > b.container.index ? 1 : -1;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Path = require('./Path');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Circle = function Circle(x, y, radius) {\n    _classCallCheck(this, Circle);\n\n    this.type = _Path.PATH.CIRCLE;\n    this.x = x;\n    this.y = y;\n    this.radius = radius;\n    if (process.env.NODE_ENV !== 'production') {\n        if (isNaN(x)) {\n            console.error('Invalid x value given for Circle');\n        }\n        if (isNaN(y)) {\n            console.error('Invalid y value given for Circle');\n        }\n        if (isNaN(radius)) {\n            console.error('Invalid radius value given for Circle');\n        }\n    }\n};\n\nexports.default = Circle;","'use strict';\n\nmodule.exports = 'KwAAAAAAAAAACA4AIDoAAPAfAAACAAAAAAAIABAAGABAAEgAUABYAF4AZgBeAGYAYABoAHAAeABeAGYAfACEAIAAiACQAJgAoACoAK0AtQC9AMUAXgBmAF4AZgBeAGYAzQDVAF4AZgDRANkA3gDmAOwA9AD8AAQBDAEUARoBIgGAAIgAJwEvATcBPwFFAU0BTAFUAVwBZAFsAXMBewGDATAAiwGTAZsBogGkAawBtAG8AcIBygHSAdoB4AHoAfAB+AH+AQYCDgIWAv4BHgImAi4CNgI+AkUCTQJTAlsCYwJrAnECeQKBAk0CiQKRApkCoQKoArACuALAAsQCzAIwANQC3ALkAjAA7AL0AvwCAQMJAxADGAMwACADJgMuAzYDPgOAAEYDSgNSA1IDUgNaA1oDYANiA2IDgACAAGoDgAByA3YDfgOAAIQDgACKA5IDmgOAAIAAogOqA4AAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAK8DtwOAAIAAvwPHA88D1wPfAyAD5wPsA/QD/AOAAIAABAQMBBIEgAAWBB4EJgQuBDMEIAM7BEEEXgBJBCADUQRZBGEEaQQwADAAcQQ+AXkEgQSJBJEEgACYBIAAoASoBK8EtwQwAL8ExQSAAIAAgACAAIAAgACgAM0EXgBeAF4AXgBeAF4AXgBeANUEXgDZBOEEXgDpBPEE+QQBBQkFEQUZBSEFKQUxBTUFPQVFBUwFVAVcBV4AYwVeAGsFcwV7BYMFiwWSBV4AmgWgBacFXgBeAF4AXgBeAKsFXgCyBbEFugW7BcIFwgXIBcIFwgXQBdQF3AXkBesF8wX7BQMGCwYTBhsGIwYrBjMGOwZeAD8GRwZNBl4AVAZbBl4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAGMGXgBqBnEGXgBeAF4AXgBeAF4AXgBeAF4AXgB5BoAG4wSGBo4GkwaAAIADHgR5AF4AXgBeAJsGgABGA4AAowarBrMGswagALsGwwbLBjAA0wbaBtoG3QbaBtoG2gbaBtoG2gblBusG8wb7BgMHCwcTBxsHCwcjBysHMAc1BzUHOgdCB9oGSgdSB1oHYAfaBloHaAfaBlIH2gbaBtoG2gbaBtoG2gbaBjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHbQdeAF4ANQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQd1B30HNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B4MH2gaKB68EgACAAIAAgACAAIAAgACAAI8HlwdeAJ8HpweAAIAArwe3B14AXgC/B8UHygcwANAH2AfgB4AA6AfwBz4B+AcACFwBCAgPCBcIogEYAR8IJwiAAC8INwg/CCADRwhPCFcIXwhnCEoDGgSAAIAAgABvCHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIhAiLCI4IMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAANQc1BzUHNQc1BzUHNQc1BzUHNQc1B54INQc1B6II2gaqCLIIugiAAIAAvgjGCIAAgACAAIAAgACAAIAAgACAAIAAywiHAYAA0wiAANkI3QjlCO0I9Aj8CIAAgACAAAIJCgkSCRoJIgknCTYHLwk3CZYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiAAIAAAAFAAXgBeAGAAcABeAHwAQACQAKAArQC9AJ4AXgBeAE0A3gBRAN4A7AD8AMwBGgEAAKcBNwEFAUwBXAF4QkhCmEKnArcCgAHHAsABz4LAAcABwAHAAd+C6ABoAG+C/4LAAcABwAHAAc+DF4MAAcAB54M3gweDV4Nng3eDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEeDqABVg6WDqABoQ6gAaABoAHXDvcONw/3DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DncPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB7cPPwlGCU4JMACAAIAAgABWCV4JYQmAAGkJcAl4CXwJgAkwADAAMAAwAIgJgACLCZMJgACZCZ8JowmrCYAAswkwAF4AXgB8AIAAuwkABMMJyQmAAM4JgADVCTAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAqwYWBNkIMAAwADAAMADdCeAJ6AnuCR4E9gkwAP4JBQoNCjAAMACAABUK0wiAAB0KJAosCjQKgAAwADwKQwqAAEsKvQmdCVMKWwowADAAgACAALcEMACAAGMKgABrCjAAMAAwADAAMAAwADAAMAAwADAAMAAeBDAAMAAwADAAMAAwADAAMAAwADAAMAAwAIkEPQFzCnoKiQSCCooKkAqJBJgKoAqkCokEGAGsCrQKvArBCjAAMADJCtEKFQHZCuEK/gHpCvEKMAAwADAAMACAAIwE+QowAIAAPwEBCzAAMAAwADAAMACAAAkLEQswAIAAPwEZCyELgAAOCCkLMAAxCzkLMAAwADAAMAAwADAAXgBeAEELMAAwADAAMAAwADAAMAAwAEkLTQtVC4AAXAtkC4AAiQkwADAAMAAwADAAMAAwADAAbAtxC3kLgAuFC4sLMAAwAJMLlwufCzAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAApwswADAAMACAAIAAgACvC4AAgACAAIAAgACAALcLMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAvwuAAMcLgACAAIAAgACAAIAAyguAAIAAgACAAIAA0QswADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAANkLgACAAIAA4AswADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACJCR4E6AswADAAhwHwC4AA+AsADAgMEAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMACAAIAAGAwdDCUMMAAwAC0MNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQw1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHPQwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADUHNQc1BzUHNQc1BzUHNQc2BzAAMAA5DDUHNQc1BzUHNQc1BzUHNQc1BzUHNQdFDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAATQxSDFoMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAF4AXgBeAF4AXgBeAF4AYgxeAGoMXgBxDHkMfwxeAIUMXgBeAI0MMAAwADAAMAAwAF4AXgCVDJ0MMAAwADAAMABeAF4ApQxeAKsMswy7DF4Awgy9DMoMXgBeAF4AXgBeAF4AXgBeAF4AXgDRDNkMeQBqCeAM3Ax8AOYM7Az0DPgMXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgCgAAANoAAHDQ4NFg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAeDSYNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAC4NMABeAF4ANg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAD4NRg1ODVYNXg1mDTAAbQ0wADAAMAAwADAAMAAwADAA2gbaBtoG2gbaBtoG2gbaBnUNeg3CBYANwgWFDdoGjA3aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gaUDZwNpA2oDdoG2gawDbcNvw3HDdoG2gbPDdYN3A3fDeYN2gbsDfMN2gbaBvoN/g3aBgYODg7aBl4AXgBeABYOXgBeACUG2gYeDl4AJA5eACwO2w3aBtoGMQ45DtoG2gbaBtoGQQ7aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B1EO2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQdZDjUHNQc1BzUHNQc1B2EONQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHaA41BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B3AO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B2EO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBkkOeA6gAKAAoAAwADAAMAAwAKAAoACgAKAAoACgAKAAgA4wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAD//wQABAAEAAQABAAEAAQABAAEAA0AAwABAAEAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAKABMAFwAeABsAGgAeABcAFgASAB4AGwAYAA8AGAAcAEsASwBLAEsASwBLAEsASwBLAEsAGAAYAB4AHgAeABMAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAFgAbABIAHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYADQARAB4ABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkAFgAaABsAGwAbAB4AHQAdAB4ATwAXAB4ADQAeAB4AGgAbAE8ATwAOAFAAHQAdAB0ATwBPABcATwBPAE8AFgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwArAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAAQABAANAA0ASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAUAArACsAKwArACsAKwArACsABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAGgAaAFAAUABQAFAAUABMAB4AGwBQAB4AKwArACsABAAEAAQAKwBQAFAAUABQAFAAUAArACsAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUAArAFAAUAArACsABAArAAQABAAEAAQABAArACsAKwArAAQABAArACsABAAEAAQAKwArACsABAArACsAKwArACsAKwArAFAAUABQAFAAKwBQACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwAEAAQAUABQAFAABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQAKwArAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeABsAKwArACsAKwArACsAKwBQAAQABAAEAAQABAAEACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAKwArACsAKwArACsAKwArAAQABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwAEAFAAKwBQAFAAUABQAFAAUAArACsAKwBQAFAAUAArAFAAUABQAFAAKwArACsAUABQACsAUAArAFAAUAArACsAKwBQAFAAKwArACsAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQAKwArACsABAAEAAQAKwAEAAQABAAEACsAKwBQACsAKwArACsAKwArAAQAKwArACsAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAB4AHgAeAB4AHgAeABsAHgArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArAFAAUABQACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAB4AUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArACsAKwArACsAKwArAFAAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwArAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAKwBcAFwAKwBcACsAKwBcACsAKwArACsAKwArAFwAXABcAFwAKwBcAFwAXABcAFwAXABcACsAXABcAFwAKwBcACsAXAArACsAXABcACsAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgArACoAKgBcACsAKwBcAFwAXABcAFwAKwBcACsAKgAqACoAKgAqACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAFwAXABcAFwAUAAOAA4ADgAOAB4ADgAOAAkADgAOAA0ACQATABMAEwATABMACQAeABMAHgAeAB4ABAAEAB4AHgAeAB4AHgAeAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUAANAAQAHgAEAB4ABAAWABEAFgARAAQABABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAAQABAAEAAQABAANAAQABABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsADQANAB4AHgAeAB4AHgAeAAQAHgAeAB4AHgAeAB4AKwAeAB4ADgAOAA0ADgAeAB4AHgAeAB4ACQAJACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgAeAB4AHgBcAFwAXABcAFwAXAAqACoAKgAqAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAKgAqACoAKgAqACoAKgBcAFwAXAAqACoAKgAqAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAXAAqAEsASwBLAEsASwBLAEsASwBLAEsAKgAqACoAKgAqACoAUABQAFAAUABQAFAAKwBQACsAKwArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQACsAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwAEAAQABAAeAA0AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAEQArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAADQANAA0AUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAA0ADQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoADQANABUAXAANAB4ADQAbAFwAKgArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAB4AHgATABMADQANAA4AHgATABMAHgAEAAQABAAJACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAUABQAFAAUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwAeACsAKwArABMAEwBLAEsASwBLAEsASwBLAEsASwBLAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwBcAFwAXABcAFwAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcACsAKwArACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwAeAB4AXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsABABLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKgAqACoAKgAqACoAKgBcACoAKgAqACoAKgAqACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAUABQAFAAUABQAFAAUAArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4ADQANAA0ADQAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAHgAeAB4AHgBQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwANAA0ADQANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwBQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsABAAEAAQAHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAABABQAFAAUABQAAQABAAEAFAAUAAEAAQABAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAKwBQACsAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAKwArAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAKwAeAB4AHgAeAB4AHgAeAA4AHgArAA0ADQANAA0ADQANAA0ACQANAA0ADQAIAAQACwAEAAQADQAJAA0ADQAMAB0AHQAeABcAFwAWABcAFwAXABYAFwAdAB0AHgAeABQAFAAUAA0AAQABAAQABAAEAAQABAAJABoAGgAaABoAGgAaABoAGgAeABcAFwAdABUAFQAeAB4AHgAeAB4AHgAYABYAEQAVABUAFQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgANAB4ADQANAA0ADQAeAA0ADQANAAcAHgAeAB4AHgArAAQABAAEAAQABAAEAAQABAAEAAQAUABQACsAKwBPAFAAUABQAFAAUAAeAB4AHgAWABEATwBQAE8ATwBPAE8AUABQAFAAUABQAB4AHgAeABYAEQArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGgAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgBQABoAHgAdAB4AUAAeABoAHgAeAB4AHgAeAB4AHgAeAB4ATwAeAFAAGwAeAB4AUABQAFAAUABQAB4AHgAeAB0AHQAeAFAAHgBQAB4AUAAeAFAATwBQAFAAHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AUABQAFAAUABPAE8AUABQAFAAUABQAE8AUABQAE8AUABPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAE8ATwBPAE8ATwBPAE8ATwBPAE8AUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAATwAeAB4AKwArACsAKwAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB0AHQAeAB4AHgAdAB0AHgAeAB0AHgAeAB4AHQAeAB0AGwAbAB4AHQAeAB4AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB0AHgAdAB4AHQAdAB0AHQAdAB0AHgAdAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAdAB0AHQAdAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAlACUAHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB0AHQAeAB4AHgAeAB0AHQAdAB4AHgAdAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB0AHQAeAB4AHQAeAB4AHgAeAB0AHQAeAB4AHgAeACUAJQAdAB0AJQAeACUAJQAlACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHQAdAB0AHgAdACUAHQAdAB4AHQAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHQAdAB0AHQAlAB4AJQAlACUAHQAlACUAHQAdAB0AJQAlAB0AHQAlAB0AHQAlACUAJQAeAB0AHgAeAB4AHgAdAB0AJQAdAB0AHQAdAB0AHQAlACUAJQAlACUAHQAlACUAIAAlAB0AHQAlACUAJQAlACUAJQAlACUAHgAeAB4AJQAlACAAIAAgACAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeABcAFwAXABcAFwAXAB4AEwATACUAHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACUAJQBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwArACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAE8ATwBPAE8ATwBPAE8ATwAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeACsAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUAArACsAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQBQAFAAUABQACsAKwArACsAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAABAAEAAQAKwAEAAQAKwArACsAKwArAAQABAAEAAQAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsABAAEAAQAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsADQANAA0ADQANAA0ADQANAB4AKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAUABQAFAAUABQAA0ADQANAA0ADQANABQAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwANAA0ADQANAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAeAAQABAAEAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLACsADQArAB4AKwArAAQABAAEAAQAUABQAB4AUAArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwAEAAQABAAEAAQABAAEAAQABAAOAA0ADQATABMAHgAeAB4ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0AUABQAFAAUAAEAAQAKwArAAQADQANAB4AUAArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXABcAA0ADQANACoASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUAArACsAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANACsADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEcARwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwAeAAQABAANAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAEAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUAArACsAUAArACsAUABQACsAKwBQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAeAB4ADQANAA0ADQAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAArAAQABAArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAEAAQABAAEAAQABAAEACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAFgAWAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAKwBQACsAKwArACsAKwArAFAAKwArACsAKwBQACsAUAArAFAAKwBQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQACsAUAArAFAAKwBQACsAUABQACsAUAArACsAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAUABQAFAAUAArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUAArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAlACUAJQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeACUAJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeACUAJQAlACUAJQAeACUAJQAlACUAJQAgACAAIAAlACUAIAAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIQAhACEAIQAhACUAJQAgACAAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAIAAlACUAJQAlACAAJQAgACAAIAAgACAAIAAgACAAIAAlACUAJQAgACUAJQAlACUAIAAgACAAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeACUAHgAlAB4AJQAlACUAJQAlACAAJQAlACUAJQAeACUAHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAIAAgACAAIAAgAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFwAXABcAFQAVABUAHgAeAB4AHgAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAlACAAIAAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsA';","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Trie = exports.createTrieFromBase64 = exports.UTRIE2_INDEX_2_MASK = exports.UTRIE2_INDEX_2_BLOCK_LENGTH = exports.UTRIE2_OMITTED_BMP_INDEX_1_LENGTH = exports.UTRIE2_INDEX_1_OFFSET = exports.UTRIE2_UTF8_2B_INDEX_2_LENGTH = exports.UTRIE2_UTF8_2B_INDEX_2_OFFSET = exports.UTRIE2_INDEX_2_BMP_LENGTH = exports.UTRIE2_LSCP_INDEX_2_LENGTH = exports.UTRIE2_DATA_MASK = exports.UTRIE2_DATA_BLOCK_LENGTH = exports.UTRIE2_LSCP_INDEX_2_OFFSET = exports.UTRIE2_SHIFT_1_2 = exports.UTRIE2_INDEX_SHIFT = exports.UTRIE2_SHIFT_1 = exports.UTRIE2_SHIFT_2 = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Util = require('./Util');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/** Shift size for getting the index-2 table offset. */\nvar UTRIE2_SHIFT_2 = exports.UTRIE2_SHIFT_2 = 5;\n\n/** Shift size for getting the index-1 table offset. */\nvar UTRIE2_SHIFT_1 = exports.UTRIE2_SHIFT_1 = 6 + 5;\n\n/**\n * Shift size for shifting left the index array values.\n * Increases possible data size with 16-bit index values at the cost\n * of compactability.\n * This requires data blocks to be aligned by UTRIE2_DATA_GRANULARITY.\n */\nvar UTRIE2_INDEX_SHIFT = exports.UTRIE2_INDEX_SHIFT = 2;\n\n/**\n * Difference between the two shift sizes,\n * for getting an index-1 offset from an index-2 offset. 6=11-5\n */\nvar UTRIE2_SHIFT_1_2 = exports.UTRIE2_SHIFT_1_2 = UTRIE2_SHIFT_1 - UTRIE2_SHIFT_2;\n\n/**\n * The part of the index-2 table for U+D800..U+DBFF stores values for\n * lead surrogate code _units_ not code _points_.\n * Values for lead surrogate code _points_ are indexed with this portion of the table.\n * Length=32=0x20=0x400>>UTRIE2_SHIFT_2. (There are 1024=0x400 lead surrogates.)\n */\nvar UTRIE2_LSCP_INDEX_2_OFFSET = exports.UTRIE2_LSCP_INDEX_2_OFFSET = 0x10000 >> UTRIE2_SHIFT_2;\n\n/** Number of entries in a data block. 32=0x20 */\nvar UTRIE2_DATA_BLOCK_LENGTH = exports.UTRIE2_DATA_BLOCK_LENGTH = 1 << UTRIE2_SHIFT_2;\n/** Mask for getting the lower bits for the in-data-block offset. */\nvar UTRIE2_DATA_MASK = exports.UTRIE2_DATA_MASK = UTRIE2_DATA_BLOCK_LENGTH - 1;\n\nvar UTRIE2_LSCP_INDEX_2_LENGTH = exports.UTRIE2_LSCP_INDEX_2_LENGTH = 0x400 >> UTRIE2_SHIFT_2;\n/** Count the lengths of both BMP pieces. 2080=0x820 */\nvar UTRIE2_INDEX_2_BMP_LENGTH = exports.UTRIE2_INDEX_2_BMP_LENGTH = UTRIE2_LSCP_INDEX_2_OFFSET + UTRIE2_LSCP_INDEX_2_LENGTH;\n/**\n * The 2-byte UTF-8 version of the index-2 table follows at offset 2080=0x820.\n * Length 32=0x20 for lead bytes C0..DF, regardless of UTRIE2_SHIFT_2.\n */\nvar UTRIE2_UTF8_2B_INDEX_2_OFFSET = exports.UTRIE2_UTF8_2B_INDEX_2_OFFSET = UTRIE2_INDEX_2_BMP_LENGTH;\nvar UTRIE2_UTF8_2B_INDEX_2_LENGTH = exports.UTRIE2_UTF8_2B_INDEX_2_LENGTH = 0x800 >> 6; /* U+0800 is the first code point after 2-byte UTF-8 */\n/**\n * The index-1 table, only used for supplementary code points, at offset 2112=0x840.\n * Variable length, for code points up to highStart, where the last single-value range starts.\n * Maximum length 512=0x200=0x100000>>UTRIE2_SHIFT_1.\n * (For 0x100000 supplementary code points U+10000..U+10ffff.)\n *\n * The part of the index-2 table for supplementary code points starts\n * after this index-1 table.\n *\n * Both the index-1 table and the following part of the index-2 table\n * are omitted completely if there is only BMP data.\n */\nvar UTRIE2_INDEX_1_OFFSET = exports.UTRIE2_INDEX_1_OFFSET = UTRIE2_UTF8_2B_INDEX_2_OFFSET + UTRIE2_UTF8_2B_INDEX_2_LENGTH;\n\n/**\n * Number of index-1 entries for the BMP. 32=0x20\n * This part of the index-1 table is omitted from the serialized form.\n */\nvar UTRIE2_OMITTED_BMP_INDEX_1_LENGTH = exports.UTRIE2_OMITTED_BMP_INDEX_1_LENGTH = 0x10000 >> UTRIE2_SHIFT_1;\n\n/** Number of entries in an index-2 block. 64=0x40 */\nvar UTRIE2_INDEX_2_BLOCK_LENGTH = exports.UTRIE2_INDEX_2_BLOCK_LENGTH = 1 << UTRIE2_SHIFT_1_2;\n/** Mask for getting the lower bits for the in-index-2-block offset. */\nvar UTRIE2_INDEX_2_MASK = exports.UTRIE2_INDEX_2_MASK = UTRIE2_INDEX_2_BLOCK_LENGTH - 1;\n\nvar createTrieFromBase64 = exports.createTrieFromBase64 = function createTrieFromBase64(base64) {\n    var buffer = (0, _Util.decode)(base64);\n    var view32 = Array.isArray(buffer) ? (0, _Util.polyUint32Array)(buffer) : new Uint32Array(buffer);\n    var view16 = Array.isArray(buffer) ? (0, _Util.polyUint16Array)(buffer) : new Uint16Array(buffer);\n    var headerLength = 24;\n\n    var index = view16.slice(headerLength / 2, view32[4] / 2);\n    var data = view32[5] === 2 ? view16.slice((headerLength + view32[4]) / 2) : view32.slice(Math.ceil((headerLength + view32[4]) / 4));\n\n    return new Trie(view32[0], view32[1], view32[2], view32[3], index, data);\n};\n\nvar Trie = exports.Trie = function () {\n    function Trie(initialValue, errorValue, highStart, highValueIndex, index, data) {\n        _classCallCheck(this, Trie);\n\n        this.initialValue = initialValue;\n        this.errorValue = errorValue;\n        this.highStart = highStart;\n        this.highValueIndex = highValueIndex;\n        this.index = index;\n        this.data = data;\n    }\n\n    /**\n     * Get the value for a code point as stored in the Trie.\n     *\n     * @param codePoint the code point\n     * @return the value\n     */\n\n\n    _createClass(Trie, [{\n        key: 'get',\n        value: function get(codePoint) {\n            var ix = void 0;\n            if (codePoint >= 0) {\n                if (codePoint < 0x0d800 || codePoint > 0x0dbff && codePoint <= 0x0ffff) {\n                    // Ordinary BMP code point, excluding leading surrogates.\n                    // BMP uses a single level lookup.  BMP index starts at offset 0 in the Trie2 index.\n                    // 16 bit data is stored in the index array itself.\n                    ix = this.index[codePoint >> UTRIE2_SHIFT_2];\n                    ix = (ix << UTRIE2_INDEX_SHIFT) + (codePoint & UTRIE2_DATA_MASK);\n                    return this.data[ix];\n                }\n\n                if (codePoint <= 0xffff) {\n                    // Lead Surrogate Code Point.  A Separate index section is stored for\n                    // lead surrogate code units and code points.\n                    //   The main index has the code unit data.\n                    //   For this function, we need the code point data.\n                    // Note: this expression could be refactored for slightly improved efficiency, but\n                    //       surrogate code points will be so rare in practice that it's not worth it.\n                    ix = this.index[UTRIE2_LSCP_INDEX_2_OFFSET + (codePoint - 0xd800 >> UTRIE2_SHIFT_2)];\n                    ix = (ix << UTRIE2_INDEX_SHIFT) + (codePoint & UTRIE2_DATA_MASK);\n                    return this.data[ix];\n                }\n\n                if (codePoint < this.highStart) {\n                    // Supplemental code point, use two-level lookup.\n                    ix = UTRIE2_INDEX_1_OFFSET - UTRIE2_OMITTED_BMP_INDEX_1_LENGTH + (codePoint >> UTRIE2_SHIFT_1);\n                    ix = this.index[ix];\n                    ix += codePoint >> UTRIE2_SHIFT_2 & UTRIE2_INDEX_2_MASK;\n                    ix = this.index[ix];\n                    ix = (ix << UTRIE2_INDEX_SHIFT) + (codePoint & UTRIE2_DATA_MASK);\n                    return this.data[ix];\n                }\n                if (codePoint <= 0x10ffff) {\n                    return this.data[this.highValueIndex];\n                }\n            }\n\n            // Fall through.  The code point is outside of the legal range of 0..0x10ffff.\n            return this.errorValue;\n        }\n    }]);\n\n    return Trie;\n}();","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.LineBreaker = exports.inlineBreakOpportunities = exports.lineBreakAtIndex = exports.codePointsToCharacterClasses = exports.UnicodeTrie = exports.BREAK_ALLOWED = exports.BREAK_NOT_ALLOWED = exports.BREAK_MANDATORY = exports.classes = exports.LETTER_NUMBER_MODIFIER = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _Trie = require('./Trie');\n\nvar _linebreakTrie = require('./linebreak-trie');\n\nvar _linebreakTrie2 = _interopRequireDefault(_linebreakTrie);\n\nvar _Util = require('./Util');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LETTER_NUMBER_MODIFIER = exports.LETTER_NUMBER_MODIFIER = 50;\n\n// Non-tailorable Line Breaking Classes\nvar BK = 1; //  Cause a line break (after)\nvar CR = 2; //  Cause a line break (after), except between CR and LF\nvar LF = 3; //  Cause a line break (after)\nvar CM = 4; //  Prohibit a line break between the character and the preceding character\nvar NL = 5; //  Cause a line break (after)\nvar SG = 6; //  Do not occur in well-formed text\nvar WJ = 7; //  Prohibit line breaks before and after\nvar ZW = 8; //  Provide a break opportunity\nvar GL = 9; //  Prohibit line breaks before and after\nvar SP = 10; // Enable indirect line breaks\nvar ZWJ = 11; // Prohibit line breaks within joiner sequences\n// Break Opportunities\nvar B2 = 12; //  Provide a line break opportunity before and after the character\nvar BA = 13; //  Generally provide a line break opportunity after the character\nvar BB = 14; //  Generally provide a line break opportunity before the character\nvar HY = 15; //  Provide a line break opportunity after the character, except in numeric context\nvar CB = 16; //   Provide a line break opportunity contingent on additional information\n// Characters Prohibiting Certain Breaks\nvar CL = 17; //  Prohibit line breaks before\nvar CP = 18; //  Prohibit line breaks before\nvar EX = 19; //  Prohibit line breaks before\nvar IN = 20; //  Allow only indirect line breaks between pairs\nvar NS = 21; //  Allow only indirect line breaks before\nvar OP = 22; //  Prohibit line breaks after\nvar QU = 23; //  Act like they are both opening and closing\n// Numeric Context\nvar IS = 24; //  Prevent breaks after any and before numeric\nvar NU = 25; //  Form numeric expressions for line breaking purposes\nvar PO = 26; //  Do not break following a numeric expression\nvar PR = 27; //  Do not break in front of a numeric expression\nvar SY = 28; //  Prevent a break before; and allow a break after\n// Other Characters\nvar AI = 29; //  Act like AL when the resolvedEAW is N; otherwise; act as ID\nvar AL = 30; //  Are alphabetic characters or symbols that are used with alphabetic characters\nvar CJ = 31; //  Treat as NS or ID for strict or normal breaking.\nvar EB = 32; //  Do not break from following Emoji Modifier\nvar EM = 33; //  Do not break from preceding Emoji Base\nvar H2 = 34; //  Form Korean syllable blocks\nvar H3 = 35; //  Form Korean syllable blocks\nvar HL = 36; //  Do not break around a following hyphen; otherwise act as Alphabetic\nvar ID = 37; //  Break before or after; except in some numeric context\nvar JL = 38; //  Form Korean syllable blocks\nvar JV = 39; //  Form Korean syllable blocks\nvar JT = 40; //  Form Korean syllable blocks\nvar RI = 41; //  Keep pairs together. For pairs; break before and after other classes\nvar SA = 42; //  Provide a line break opportunity contingent on additional, language-specific context analysis\nvar XX = 43; //  Have as yet unknown line breaking behavior or unassigned code positions\n\nvar classes = exports.classes = {\n    BK: BK,\n    CR: CR,\n    LF: LF,\n    CM: CM,\n    NL: NL,\n    SG: SG,\n    WJ: WJ,\n    ZW: ZW,\n    GL: GL,\n    SP: SP,\n    ZWJ: ZWJ,\n    B2: B2,\n    BA: BA,\n    BB: BB,\n    HY: HY,\n    CB: CB,\n    CL: CL,\n    CP: CP,\n    EX: EX,\n    IN: IN,\n    NS: NS,\n    OP: OP,\n    QU: QU,\n    IS: IS,\n    NU: NU,\n    PO: PO,\n    PR: PR,\n    SY: SY,\n    AI: AI,\n    AL: AL,\n    CJ: CJ,\n    EB: EB,\n    EM: EM,\n    H2: H2,\n    H3: H3,\n    HL: HL,\n    ID: ID,\n    JL: JL,\n    JV: JV,\n    JT: JT,\n    RI: RI,\n    SA: SA,\n    XX: XX\n};\n\nvar BREAK_MANDATORY = exports.BREAK_MANDATORY = '!';\nvar BREAK_NOT_ALLOWED = exports.BREAK_NOT_ALLOWED = '×';\nvar BREAK_ALLOWED = exports.BREAK_ALLOWED = '÷';\nvar UnicodeTrie = exports.UnicodeTrie = (0, _Trie.createTrieFromBase64)(_linebreakTrie2.default);\n\nvar ALPHABETICS = [AL, HL];\nvar HARD_LINE_BREAKS = [BK, CR, LF, NL];\nvar SPACE = [SP, ZW];\nvar PREFIX_POSTFIX = [PR, PO];\nvar LINE_BREAKS = HARD_LINE_BREAKS.concat(SPACE);\nvar KOREAN_SYLLABLE_BLOCK = [JL, JV, JT, H2, H3];\nvar HYPHEN = [HY, BA];\n\nvar codePointsToCharacterClasses = exports.codePointsToCharacterClasses = function codePointsToCharacterClasses(codePoints) {\n    var lineBreak = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'strict';\n\n    var types = [];\n    var indicies = [];\n    var categories = [];\n    codePoints.forEach(function (codePoint, index) {\n        var classType = UnicodeTrie.get(codePoint);\n        if (classType > LETTER_NUMBER_MODIFIER) {\n            categories.push(true);\n            classType -= LETTER_NUMBER_MODIFIER;\n        } else {\n            categories.push(false);\n        }\n\n        if (['normal', 'auto', 'loose'].indexOf(lineBreak) !== -1) {\n            // U+2010, – U+2013, 〜 U+301C, ゠ U+30A0\n            if ([0x2010, 0x2013, 0x301c, 0x30a0].indexOf(codePoint) !== -1) {\n                indicies.push(index);\n                return types.push(CB);\n            }\n        }\n\n        if (classType === CM || classType === ZWJ) {\n            // LB10 Treat any remaining combining mark or ZWJ as AL.\n            if (index === 0) {\n                indicies.push(index);\n                return types.push(AL);\n            }\n\n            // LB9 Do not break a combining character sequence; treat it as if it has the line breaking class of\n            // the base character in all of the following rules. Treat ZWJ as if it were CM.\n            var prev = types[index - 1];\n            if (LINE_BREAKS.indexOf(prev) === -1) {\n                indicies.push(indicies[index - 1]);\n                return types.push(prev);\n            }\n            indicies.push(index);\n            return types.push(AL);\n        }\n\n        indicies.push(index);\n\n        if (classType === CJ) {\n            return types.push(lineBreak === 'strict' ? NS : ID);\n        }\n\n        if (classType === SA) {\n            return types.push(AL);\n        }\n\n        if (classType === AI) {\n            return types.push(AL);\n        }\n\n        // For supplementary characters, a useful default is to treat characters in the range 10000..1FFFD as AL\n        // and characters in the ranges 20000..2FFFD and 30000..3FFFD as ID, until the implementation can be revised\n        // to take into account the actual line breaking properties for these characters.\n        if (classType === XX) {\n            if (codePoint >= 0x20000 && codePoint <= 0x2fffd || codePoint >= 0x30000 && codePoint <= 0x3fffd) {\n                return types.push(ID);\n            } else {\n                return types.push(AL);\n            }\n        }\n\n        types.push(classType);\n    });\n\n    return [indicies, types, categories];\n};\n\nvar isAdjacentWithSpaceIgnored = function isAdjacentWithSpaceIgnored(a, b, currentIndex, classTypes) {\n    var current = classTypes[currentIndex];\n    if (Array.isArray(a) ? a.indexOf(current) !== -1 : a === current) {\n        var i = currentIndex;\n        while (i <= classTypes.length) {\n            i++;\n            var next = classTypes[i];\n\n            if (next === b) {\n                return true;\n            }\n\n            if (next !== SP) {\n                break;\n            }\n        }\n    }\n\n    if (current === SP) {\n        var _i = currentIndex;\n\n        while (_i > 0) {\n            _i--;\n            var prev = classTypes[_i];\n\n            if (Array.isArray(a) ? a.indexOf(prev) !== -1 : a === prev) {\n                var n = currentIndex;\n                while (n <= classTypes.length) {\n                    n++;\n                    var _next = classTypes[n];\n\n                    if (_next === b) {\n                        return true;\n                    }\n\n                    if (_next !== SP) {\n                        break;\n                    }\n                }\n            }\n\n            if (prev !== SP) {\n                break;\n            }\n        }\n    }\n    return false;\n};\n\nvar previousNonSpaceClassType = function previousNonSpaceClassType(currentIndex, classTypes) {\n    var i = currentIndex;\n    while (i >= 0) {\n        var type = classTypes[i];\n        if (type === SP) {\n            i--;\n        } else {\n            return type;\n        }\n    }\n    return 0;\n};\n\nvar _lineBreakAtIndex = function _lineBreakAtIndex(codePoints, classTypes, indicies, index, forbiddenBreaks) {\n    if (indicies[index] === 0) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    var currentIndex = index - 1;\n    if (Array.isArray(forbiddenBreaks) && forbiddenBreaks[currentIndex] === true) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    var beforeIndex = currentIndex - 1;\n    var afterIndex = currentIndex + 1;\n    var current = classTypes[currentIndex];\n\n    // LB4 Always break after hard line breaks.\n    // LB5 Treat CR followed by LF, as well as CR, LF, and NL as hard line breaks.\n    var before = beforeIndex >= 0 ? classTypes[beforeIndex] : 0;\n    var next = classTypes[afterIndex];\n\n    if (current === CR && next === LF) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    if (HARD_LINE_BREAKS.indexOf(current) !== -1) {\n        return BREAK_MANDATORY;\n    }\n\n    // LB6 Do not break before hard line breaks.\n    if (HARD_LINE_BREAKS.indexOf(next) !== -1) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB7 Do not break before spaces or zero width space.\n    if (SPACE.indexOf(next) !== -1) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB8 Break before any character following a zero-width space, even if one or more spaces intervene.\n    if (previousNonSpaceClassType(currentIndex, classTypes) === ZW) {\n        return BREAK_ALLOWED;\n    }\n\n    // LB8a Do not break between a zero width joiner and an ideograph, emoji base or emoji modifier.\n    if (UnicodeTrie.get(codePoints[currentIndex]) === ZWJ && (next === ID || next === EB || next === EM)) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB11 Do not break before or after Word joiner and related characters.\n    if (current === WJ || next === WJ) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB12 Do not break after NBSP and related characters.\n    if (current === GL) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB12a Do not break before NBSP and related characters, except after spaces and hyphens.\n    if ([SP, BA, HY].indexOf(current) === -1 && next === GL) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB13 Do not break before ‘]’ or ‘!’ or ‘;’ or ‘/’, even after spaces.\n    if ([CL, CP, EX, IS, SY].indexOf(next) !== -1) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB14 Do not break after ‘[’, even after spaces.\n    if (previousNonSpaceClassType(currentIndex, classTypes) === OP) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB15 Do not break within ‘”[’, even with intervening spaces.\n    if (isAdjacentWithSpaceIgnored(QU, OP, currentIndex, classTypes)) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB16 Do not break between closing punctuation and a nonstarter (lb=NS), even with intervening spaces.\n    if (isAdjacentWithSpaceIgnored([CL, CP], NS, currentIndex, classTypes)) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB17 Do not break within ‘——’, even with intervening spaces.\n    if (isAdjacentWithSpaceIgnored(B2, B2, currentIndex, classTypes)) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB18 Break after spaces.\n    if (current === SP) {\n        return BREAK_ALLOWED;\n    }\n\n    // LB19 Do not break before or after quotation marks, such as ‘ ” ’.\n    if (current === QU || next === QU) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB20 Break before and after unresolved CB.\n    if (next === CB || current === CB) {\n        return BREAK_ALLOWED;\n    }\n\n    // LB21 Do not break before hyphen-minus, other hyphens, fixed-width spaces, small kana, and other non-starters, or after acute accents.\n    if ([BA, HY, NS].indexOf(next) !== -1 || current === BB) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB21a Don't break after Hebrew + Hyphen.\n    if (before === HL && HYPHEN.indexOf(current) !== -1) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB21b Don’t break between Solidus and Hebrew letters.\n    if (current === SY && next === HL) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB22 Do not break between two ellipses, or between letters, numbers or exclamations and ellipsis.\n    if (next === IN && ALPHABETICS.concat(IN, EX, NU, ID, EB, EM).indexOf(current) !== -1) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB23 Do not break between digits and letters.\n    if (ALPHABETICS.indexOf(next) !== -1 && current === NU || ALPHABETICS.indexOf(current) !== -1 && next === NU) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB23a Do not break between numeric prefixes and ideographs, or between ideographs and numeric postfixes.\n    if (current === PR && [ID, EB, EM].indexOf(next) !== -1 || [ID, EB, EM].indexOf(current) !== -1 && next === PO) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB24 Do not break between numeric prefix/postfix and letters, or between letters and prefix/postfix.\n    if (ALPHABETICS.indexOf(current) !== -1 && PREFIX_POSTFIX.indexOf(next) !== -1 || PREFIX_POSTFIX.indexOf(current) !== -1 && ALPHABETICS.indexOf(next) !== -1) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB25 Do not break between the following pairs of classes relevant to numbers:\n    if (\n    // (PR | PO) × ( OP | HY )? NU\n    [PR, PO].indexOf(current) !== -1 && (next === NU || [OP, HY].indexOf(next) !== -1 && classTypes[afterIndex + 1] === NU) ||\n    // ( OP | HY ) × NU\n    [OP, HY].indexOf(current) !== -1 && next === NU ||\n    // NU ×\t(NU | SY | IS)\n    current === NU && [NU, SY, IS].indexOf(next) !== -1) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // NU (NU | SY | IS)* × (NU | SY | IS | CL | CP)\n    if ([NU, SY, IS, CL, CP].indexOf(next) !== -1) {\n        var prevIndex = currentIndex;\n        while (prevIndex >= 0) {\n            var type = classTypes[prevIndex];\n            if (type === NU) {\n                return BREAK_NOT_ALLOWED;\n            } else if ([SY, IS].indexOf(type) !== -1) {\n                prevIndex--;\n            } else {\n                break;\n            }\n        }\n    }\n\n    // NU (NU | SY | IS)* (CL | CP)? × (PO | PR))\n    if ([PR, PO].indexOf(next) !== -1) {\n        var _prevIndex = [CL, CP].indexOf(current) !== -1 ? beforeIndex : currentIndex;\n        while (_prevIndex >= 0) {\n            var _type = classTypes[_prevIndex];\n            if (_type === NU) {\n                return BREAK_NOT_ALLOWED;\n            } else if ([SY, IS].indexOf(_type) !== -1) {\n                _prevIndex--;\n            } else {\n                break;\n            }\n        }\n    }\n\n    // LB26 Do not break a Korean syllable.\n    if (JL === current && [JL, JV, H2, H3].indexOf(next) !== -1 || [JV, H2].indexOf(current) !== -1 && [JV, JT].indexOf(next) !== -1 || [JT, H3].indexOf(current) !== -1 && next === JT) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB27 Treat a Korean Syllable Block the same as ID.\n    if (KOREAN_SYLLABLE_BLOCK.indexOf(current) !== -1 && [IN, PO].indexOf(next) !== -1 || KOREAN_SYLLABLE_BLOCK.indexOf(next) !== -1 && current === PR) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB28 Do not break between alphabetics (“at”).\n    if (ALPHABETICS.indexOf(current) !== -1 && ALPHABETICS.indexOf(next) !== -1) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB29 Do not break between numeric punctuation and alphabetics (“e.g.”).\n    if (current === IS && ALPHABETICS.indexOf(next) !== -1) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB30 Do not break between letters, numbers, or ordinary symbols and opening or closing parentheses.\n    if (ALPHABETICS.concat(NU).indexOf(current) !== -1 && next === OP || ALPHABETICS.concat(NU).indexOf(next) !== -1 && current === CP) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB30a Break between two regional indicator symbols if and only if there are an even number of regional\n    // indicators preceding the position of the break.\n    if (current === RI && next === RI) {\n        var i = indicies[currentIndex];\n        var count = 1;\n        while (i > 0) {\n            i--;\n            if (classTypes[i] === RI) {\n                count++;\n            } else {\n                break;\n            }\n        }\n        if (count % 2 !== 0) {\n            return BREAK_NOT_ALLOWED;\n        }\n    }\n\n    // LB30b Do not break between an emoji base and an emoji modifier.\n    if (current === EB && next === EM) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    return BREAK_ALLOWED;\n};\n\nvar lineBreakAtIndex = exports.lineBreakAtIndex = function lineBreakAtIndex(codePoints, index) {\n    // LB2 Never break at the start of text.\n    if (index === 0) {\n        return BREAK_NOT_ALLOWED;\n    }\n\n    // LB3 Always break at the end of text.\n    if (index >= codePoints.length) {\n        return BREAK_MANDATORY;\n    }\n\n    var _codePointsToCharacte = codePointsToCharacterClasses(codePoints),\n        _codePointsToCharacte2 = _slicedToArray(_codePointsToCharacte, 2),\n        indicies = _codePointsToCharacte2[0],\n        classTypes = _codePointsToCharacte2[1];\n\n    return _lineBreakAtIndex(codePoints, classTypes, indicies, index);\n};\n\nvar cssFormattedClasses = function cssFormattedClasses(codePoints, options) {\n    if (!options) {\n        options = { lineBreak: 'normal', wordBreak: 'normal' };\n    }\n\n    var _codePointsToCharacte3 = codePointsToCharacterClasses(codePoints, options.lineBreak),\n        _codePointsToCharacte4 = _slicedToArray(_codePointsToCharacte3, 3),\n        indicies = _codePointsToCharacte4[0],\n        classTypes = _codePointsToCharacte4[1],\n        isLetterNumber = _codePointsToCharacte4[2];\n\n    if (options.wordBreak === 'break-all' || options.wordBreak === 'break-word') {\n        classTypes = classTypes.map(function (type) {\n            return [NU, AL, SA].indexOf(type) !== -1 ? ID : type;\n        });\n    }\n\n    var forbiddenBreakpoints = options.wordBreak === 'keep-all' ? isLetterNumber.map(function (isLetterNumber, i) {\n        return isLetterNumber && codePoints[i] >= 0x4e00 && codePoints[i] <= 0x9fff;\n    }) : null;\n\n    return [indicies, classTypes, forbiddenBreakpoints];\n};\n\nvar inlineBreakOpportunities = exports.inlineBreakOpportunities = function inlineBreakOpportunities(str, options) {\n    var codePoints = (0, _Util.toCodePoints)(str);\n    var output = BREAK_NOT_ALLOWED;\n\n    var _cssFormattedClasses = cssFormattedClasses(codePoints, options),\n        _cssFormattedClasses2 = _slicedToArray(_cssFormattedClasses, 3),\n        indicies = _cssFormattedClasses2[0],\n        classTypes = _cssFormattedClasses2[1],\n        forbiddenBreakpoints = _cssFormattedClasses2[2];\n\n    codePoints.forEach(function (codePoint, i) {\n        output += (0, _Util.fromCodePoint)(codePoint) + (i >= codePoints.length - 1 ? BREAK_MANDATORY : _lineBreakAtIndex(codePoints, classTypes, indicies, i + 1, forbiddenBreakpoints));\n    });\n\n    return output;\n};\n\nvar Break = function () {\n    function Break(codePoints, lineBreak, start, end) {\n        _classCallCheck(this, Break);\n\n        this._codePoints = codePoints;\n        this.required = lineBreak === BREAK_MANDATORY;\n        this.start = start;\n        this.end = end;\n    }\n\n    _createClass(Break, [{\n        key: 'slice',\n        value: function slice() {\n            return _Util.fromCodePoint.apply(undefined, _toConsumableArray(this._codePoints.slice(this.start, this.end)));\n        }\n    }]);\n\n    return Break;\n}();\n\nvar LineBreaker = exports.LineBreaker = function LineBreaker(str, options) {\n    var codePoints = (0, _Util.toCodePoints)(str);\n\n    var _cssFormattedClasses3 = cssFormattedClasses(codePoints, options),\n        _cssFormattedClasses4 = _slicedToArray(_cssFormattedClasses3, 3),\n        indicies = _cssFormattedClasses4[0],\n        classTypes = _cssFormattedClasses4[1],\n        forbiddenBreakpoints = _cssFormattedClasses4[2];\n\n    var length = codePoints.length;\n    var lastEnd = 0;\n    var nextIndex = 0;\n\n    return {\n        next: function next() {\n            if (nextIndex >= length) {\n                return { done: true };\n            }\n            var lineBreak = BREAK_NOT_ALLOWED;\n            while (nextIndex < length && (lineBreak = _lineBreakAtIndex(codePoints, classTypes, indicies, ++nextIndex, forbiddenBreakpoints)) === BREAK_NOT_ALLOWED) {}\n\n            if (lineBreak !== BREAK_NOT_ALLOWED || nextIndex === length) {\n                var value = new Break(codePoints, lineBreak, lastEnd, nextIndex);\n                lastEnd = nextIndex;\n                return { value: value, done: false };\n            }\n\n            return { done: true };\n        }\n    };\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _Util = require('./Util');\n\nObject.defineProperty(exports, 'toCodePoints', {\n  enumerable: true,\n  get: function get() {\n    return _Util.toCodePoints;\n  }\n});\nObject.defineProperty(exports, 'fromCodePoint', {\n  enumerable: true,\n  get: function get() {\n    return _Util.fromCodePoint;\n  }\n});\n\nvar _LineBreak = require('./LineBreak');\n\nObject.defineProperty(exports, 'LineBreaker', {\n  enumerable: true,\n  get: function get() {\n    return _LineBreak.LineBreaker;\n  }\n});","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar parseZIndex = exports.parseZIndex = function parseZIndex(zIndex) {\n    var auto = zIndex === 'auto';\n    return {\n        auto: auto,\n        order: auto ? 0 : parseInt(zIndex, 10)\n    };\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar WORD_BREAK = exports.WORD_BREAK = {\n    NORMAL: 'normal',\n    BREAK_ALL: 'break-all',\n    KEEP_ALL: 'keep-all'\n};\n\nvar parseWordBreak = exports.parseWordBreak = function parseWordBreak(wordBreak) {\n    switch (wordBreak) {\n        case 'break-all':\n            return WORD_BREAK.BREAK_ALL;\n        case 'keep-all':\n            return WORD_BREAK.KEEP_ALL;\n        case 'normal':\n        default:\n            return WORD_BREAK.NORMAL;\n    }\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar VISIBILITY = exports.VISIBILITY = {\n    VISIBLE: 0,\n    HIDDEN: 1,\n    COLLAPSE: 2\n};\n\nvar parseVisibility = exports.parseVisibility = function parseVisibility(visibility) {\n    switch (visibility) {\n        case 'hidden':\n            return VISIBILITY.HIDDEN;\n        case 'collapse':\n            return VISIBILITY.COLLAPSE;\n        case 'visible':\n        default:\n            return VISIBILITY.VISIBLE;\n    }\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.parseTransform = undefined;\n\nvar _Length = require('../Length');\n\nvar _Length2 = _interopRequireDefault(_Length);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar toFloat = function toFloat(s) {\n    return parseFloat(s.trim());\n};\n\nvar MATRIX = /(matrix|matrix3d)\\((.+)\\)/;\n\nvar parseTransform = exports.parseTransform = function parseTransform(style) {\n    var transform = parseTransformMatrix(style.transform || style.webkitTransform || style.mozTransform ||\n    // $FlowFixMe\n    style.msTransform ||\n    // $FlowFixMe\n    style.oTransform);\n    if (transform === null) {\n        return null;\n    }\n\n    return {\n        transform: transform,\n        transformOrigin: parseTransformOrigin(style.transformOrigin || style.webkitTransformOrigin || style.mozTransformOrigin ||\n        // $FlowFixMe\n        style.msTransformOrigin ||\n        // $FlowFixMe\n        style.oTransformOrigin)\n    };\n};\n\n// $FlowFixMe\nvar parseTransformOrigin = function parseTransformOrigin(origin) {\n    if (typeof origin !== 'string') {\n        var v = new _Length2.default('0');\n        return [v, v];\n    }\n    var values = origin.split(' ').map(_Length2.default.create);\n    return [values[0], values[1]];\n};\n\n// $FlowFixMe\nvar parseTransformMatrix = function parseTransformMatrix(transform) {\n    if (transform === 'none' || typeof transform !== 'string') {\n        return null;\n    }\n\n    var match = transform.match(MATRIX);\n    if (match) {\n        if (match[1] === 'matrix') {\n            var matrix = match[2].split(',').map(toFloat);\n            return [matrix[0], matrix[1], matrix[2], matrix[3], matrix[4], matrix[5]];\n        } else {\n            var matrix3d = match[2].split(',').map(toFloat);\n            return [matrix3d[0], matrix3d[1], matrix3d[4], matrix3d[5], matrix3d[12], matrix3d[13]];\n        }\n    }\n    return null;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.parseTextShadow = undefined;\n\nvar _Color = require('../Color');\n\nvar _Color2 = _interopRequireDefault(_Color);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar NUMBER = /^([+-]|\\d|\\.)$/i;\n\nvar parseTextShadow = exports.parseTextShadow = function parseTextShadow(textShadow) {\n    if (textShadow === 'none' || typeof textShadow !== 'string') {\n        return null;\n    }\n\n    var currentValue = '';\n    var isLength = false;\n    var values = [];\n    var shadows = [];\n    var numParens = 0;\n    var color = null;\n\n    var appendValue = function appendValue() {\n        if (currentValue.length) {\n            if (isLength) {\n                values.push(parseFloat(currentValue));\n            } else {\n                color = new _Color2.default(currentValue);\n            }\n        }\n        isLength = false;\n        currentValue = '';\n    };\n\n    var appendShadow = function appendShadow() {\n        if (values.length && color !== null) {\n            shadows.push({\n                color: color,\n                offsetX: values[0] || 0,\n                offsetY: values[1] || 0,\n                blur: values[2] || 0\n            });\n        }\n        values.splice(0, values.length);\n        color = null;\n    };\n\n    for (var i = 0; i < textShadow.length; i++) {\n        var c = textShadow[i];\n        switch (c) {\n            case '(':\n                currentValue += c;\n                numParens++;\n                break;\n            case ')':\n                currentValue += c;\n                numParens--;\n                break;\n            case ',':\n                if (numParens === 0) {\n                    appendValue();\n                    appendShadow();\n                } else {\n                    currentValue += c;\n                }\n                break;\n            case ' ':\n                if (numParens === 0) {\n                    appendValue();\n                } else {\n                    currentValue += c;\n                }\n                break;\n            default:\n                if (currentValue.length === 0 && NUMBER.test(c)) {\n                    isLength = true;\n                }\n                currentValue += c;\n        }\n    }\n\n    appendValue();\n    appendShadow();\n\n    if (shadows.length === 0) {\n        return null;\n    }\n\n    return shadows;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar OVERFLOW = exports.OVERFLOW = {\n    VISIBLE: 0,\n    HIDDEN: 1,\n    SCROLL: 2,\n    AUTO: 3\n};\n\nvar parseOverflow = exports.parseOverflow = function parseOverflow(overflow) {\n    switch (overflow) {\n        case 'hidden':\n            return OVERFLOW.HIDDEN;\n        case 'scroll':\n            return OVERFLOW.SCROLL;\n        case 'auto':\n            return OVERFLOW.AUTO;\n        case 'visible':\n        default:\n            return OVERFLOW.VISIBLE;\n    }\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.parseMargin = undefined;\n\nvar _Length = require('../Length');\n\nvar _Length2 = _interopRequireDefault(_Length);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar SIDES = ['top', 'right', 'bottom', 'left'];\n\nvar parseMargin = exports.parseMargin = function parseMargin(style) {\n    return SIDES.map(function (side) {\n        return new _Length2.default(style.getPropertyValue('margin-' + side));\n    });\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar LINE_BREAK = exports.LINE_BREAK = {\n    NORMAL: 'normal',\n    STRICT: 'strict'\n};\n\nvar parseLineBreak = exports.parseLineBreak = function parseLineBreak(wordBreak) {\n    switch (wordBreak) {\n        case 'strict':\n            return LINE_BREAK.STRICT;\n        case 'normal':\n        default:\n            return LINE_BREAK.NORMAL;\n    }\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar parseLetterSpacing = exports.parseLetterSpacing = function parseLetterSpacing(letterSpacing) {\n    if (letterSpacing === 'normal') {\n        return 0;\n    }\n    var value = parseFloat(letterSpacing);\n    return isNaN(value) ? 0 : value;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\n\nvar parseFontWeight = function parseFontWeight(weight) {\n    switch (weight) {\n        case 'normal':\n            return 400;\n        case 'bold':\n            return 700;\n    }\n\n    var value = parseInt(weight, 10);\n    return isNaN(value) ? 400 : value;\n};\n\nvar parseFont = exports.parseFont = function parseFont(style) {\n    var fontFamily = style.fontFamily;\n    var fontSize = style.fontSize;\n    var fontStyle = style.fontStyle;\n    var fontVariant = style.fontVariant;\n    var fontWeight = parseFontWeight(style.fontWeight);\n\n    return {\n        fontFamily: fontFamily,\n        fontSize: fontSize,\n        fontStyle: fontStyle,\n        fontVariant: fontVariant,\n        fontWeight: fontWeight\n    };\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar FLOAT = exports.FLOAT = {\n    NONE: 0,\n    LEFT: 1,\n    RIGHT: 2,\n    INLINE_START: 3,\n    INLINE_END: 4\n};\n\nvar parseCSSFloat = exports.parseCSSFloat = function parseCSSFloat(float) {\n    switch (float) {\n        case 'left':\n            return FLOAT.LEFT;\n        case 'right':\n            return FLOAT.RIGHT;\n        case 'inline-start':\n            return FLOAT.INLINE_START;\n        case 'inline-end':\n            return FLOAT.INLINE_END;\n    }\n    return FLOAT.NONE;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar DISPLAY = exports.DISPLAY = {\n    NONE: 1 << 0,\n    BLOCK: 1 << 1,\n    INLINE: 1 << 2,\n    RUN_IN: 1 << 3,\n    FLOW: 1 << 4,\n    FLOW_ROOT: 1 << 5,\n    TABLE: 1 << 6,\n    FLEX: 1 << 7,\n    GRID: 1 << 8,\n    RUBY: 1 << 9,\n    SUBGRID: 1 << 10,\n    LIST_ITEM: 1 << 11,\n    TABLE_ROW_GROUP: 1 << 12,\n    TABLE_HEADER_GROUP: 1 << 13,\n    TABLE_FOOTER_GROUP: 1 << 14,\n    TABLE_ROW: 1 << 15,\n    TABLE_CELL: 1 << 16,\n    TABLE_COLUMN_GROUP: 1 << 17,\n    TABLE_COLUMN: 1 << 18,\n    TABLE_CAPTION: 1 << 19,\n    RUBY_BASE: 1 << 20,\n    RUBY_TEXT: 1 << 21,\n    RUBY_BASE_CONTAINER: 1 << 22,\n    RUBY_TEXT_CONTAINER: 1 << 23,\n    CONTENTS: 1 << 24,\n    INLINE_BLOCK: 1 << 25,\n    INLINE_LIST_ITEM: 1 << 26,\n    INLINE_TABLE: 1 << 27,\n    INLINE_FLEX: 1 << 28,\n    INLINE_GRID: 1 << 29\n};\n\nvar parseDisplayValue = function parseDisplayValue(display) {\n    switch (display) {\n        case 'block':\n            return DISPLAY.BLOCK;\n        case 'inline':\n            return DISPLAY.INLINE;\n        case 'run-in':\n            return DISPLAY.RUN_IN;\n        case 'flow':\n            return DISPLAY.FLOW;\n        case 'flow-root':\n            return DISPLAY.FLOW_ROOT;\n        case 'table':\n            return DISPLAY.TABLE;\n        case 'flex':\n            return DISPLAY.FLEX;\n        case 'grid':\n            return DISPLAY.GRID;\n        case 'ruby':\n            return DISPLAY.RUBY;\n        case 'subgrid':\n            return DISPLAY.SUBGRID;\n        case 'list-item':\n            return DISPLAY.LIST_ITEM;\n        case 'table-row-group':\n            return DISPLAY.TABLE_ROW_GROUP;\n        case 'table-header-group':\n            return DISPLAY.TABLE_HEADER_GROUP;\n        case 'table-footer-group':\n            return DISPLAY.TABLE_FOOTER_GROUP;\n        case 'table-row':\n            return DISPLAY.TABLE_ROW;\n        case 'table-cell':\n            return DISPLAY.TABLE_CELL;\n        case 'table-column-group':\n            return DISPLAY.TABLE_COLUMN_GROUP;\n        case 'table-column':\n            return DISPLAY.TABLE_COLUMN;\n        case 'table-caption':\n            return DISPLAY.TABLE_CAPTION;\n        case 'ruby-base':\n            return DISPLAY.RUBY_BASE;\n        case 'ruby-text':\n            return DISPLAY.RUBY_TEXT;\n        case 'ruby-base-container':\n            return DISPLAY.RUBY_BASE_CONTAINER;\n        case 'ruby-text-container':\n            return DISPLAY.RUBY_TEXT_CONTAINER;\n        case 'contents':\n            return DISPLAY.CONTENTS;\n        case 'inline-block':\n            return DISPLAY.INLINE_BLOCK;\n        case 'inline-list-item':\n            return DISPLAY.INLINE_LIST_ITEM;\n        case 'inline-table':\n            return DISPLAY.INLINE_TABLE;\n        case 'inline-flex':\n            return DISPLAY.INLINE_FLEX;\n        case 'inline-grid':\n            return DISPLAY.INLINE_GRID;\n    }\n\n    return DISPLAY.NONE;\n};\n\nvar setDisplayBit = function setDisplayBit(bit, display) {\n    return bit | parseDisplayValue(display);\n};\n\nvar parseDisplay = exports.parseDisplay = function parseDisplay(display) {\n    return display.split(' ').reduce(setDisplayBit, 0);\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.parseBorderRadius = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _Length = require('../Length');\n\nvar _Length2 = _interopRequireDefault(_Length);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar SIDES = ['top-left', 'top-right', 'bottom-right', 'bottom-left'];\n\nvar parseBorderRadius = exports.parseBorderRadius = function parseBorderRadius(style) {\n    return SIDES.map(function (side) {\n        var value = style.getPropertyValue('border-' + side + '-radius');\n\n        var _value$split$map = value.split(' ').map(_Length2.default.create),\n            _value$split$map2 = _slicedToArray(_value$split$map, 2),\n            horizontal = _value$split$map2[0],\n            vertical = _value$split$map2[1];\n\n        return typeof vertical === 'undefined' ? [horizontal, horizontal] : [horizontal, vertical];\n    });\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Path = require('./Path');\n\nvar _Vector = require('./Vector');\n\nvar _Vector2 = _interopRequireDefault(_Vector);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar lerp = function lerp(a, b, t) {\n    return new _Vector2.default(a.x + (b.x - a.x) * t, a.y + (b.y - a.y) * t);\n};\n\nvar BezierCurve = function () {\n    function BezierCurve(start, startControl, endControl, end) {\n        _classCallCheck(this, BezierCurve);\n\n        this.type = _Path.PATH.BEZIER_CURVE;\n        this.start = start;\n        this.startControl = startControl;\n        this.endControl = endControl;\n        this.end = end;\n    }\n\n    _createClass(BezierCurve, [{\n        key: 'subdivide',\n        value: function subdivide(t, firstHalf) {\n            var ab = lerp(this.start, this.startControl, t);\n            var bc = lerp(this.startControl, this.endControl, t);\n            var cd = lerp(this.endControl, this.end, t);\n            var abbc = lerp(ab, bc, t);\n            var bccd = lerp(bc, cd, t);\n            var dest = lerp(abbc, bccd, t);\n            return firstHalf ? new BezierCurve(this.start, ab, abbc, dest) : new BezierCurve(dest, bccd, cd, this.end);\n        }\n    }, {\n        key: 'reverse',\n        value: function reverse() {\n            return new BezierCurve(this.end, this.endControl, this.startControl, this.start);\n        }\n    }]);\n\n    return BezierCurve;\n}();\n\nexports.default = BezierCurve;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Size = function Size(width, height) {\n    _classCallCheck(this, Size);\n\n    this.width = width;\n    this.height = height;\n};\n\nexports.default = Size;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _NodeContainer = require('./NodeContainer');\n\nvar _NodeContainer2 = _interopRequireDefault(_NodeContainer);\n\nvar _position = require('./parsing/position');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar StackingContext = function () {\n    function StackingContext(container, parent, treatAsRealStackingContext) {\n        _classCallCheck(this, StackingContext);\n\n        this.container = container;\n        this.parent = parent;\n        this.contexts = [];\n        this.children = [];\n        this.treatAsRealStackingContext = treatAsRealStackingContext;\n    }\n\n    _createClass(StackingContext, [{\n        key: 'getOpacity',\n        value: function getOpacity() {\n            return this.parent ? this.container.style.opacity * this.parent.getOpacity() : this.container.style.opacity;\n        }\n    }, {\n        key: 'getRealParentStackingContext',\n        value: function getRealParentStackingContext() {\n            return !this.parent || this.treatAsRealStackingContext ? this : this.parent.getRealParentStackingContext();\n        }\n    }]);\n\n    return StackingContext;\n}();\n\nexports.default = StackingContext;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.NodeParser = undefined;\n\nvar _StackingContext = require('./StackingContext');\n\nvar _StackingContext2 = _interopRequireDefault(_StackingContext);\n\nvar _NodeContainer = require('./NodeContainer');\n\nvar _NodeContainer2 = _interopRequireDefault(_NodeContainer);\n\nvar _TextContainer = require('./TextContainer');\n\nvar _TextContainer2 = _interopRequireDefault(_TextContainer);\n\nvar _Input = require('./Input');\n\nvar _ListItem = require('./ListItem');\n\nvar _listStyle = require('./parsing/listStyle');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar NodeParser = exports.NodeParser = function NodeParser(node, resourceLoader, logger) {\n    if (process.env.NODE_ENV !== 'production') {\n        logger.log('Starting node parsing');\n    }\n\n    var index = 0;\n\n    var container = new _NodeContainer2.default(node, null, resourceLoader, index++);\n    var stack = new _StackingContext2.default(container, null, true);\n\n    parseNodeTree(node, container, stack, resourceLoader, index);\n\n    if (process.env.NODE_ENV !== 'production') {\n        logger.log('Finished parsing node tree');\n    }\n\n    return stack;\n};\n\nvar IGNORED_NODE_NAMES = ['SCRIPT', 'HEAD', 'TITLE', 'OBJECT', 'BR', 'OPTION'];\n\nvar parseNodeTree = function parseNodeTree(node, parent, stack, resourceLoader, index) {\n    if (process.env.NODE_ENV !== 'production' && index > 50000) {\n        throw new Error('Recursion error while parsing node tree');\n    }\n\n    for (var childNode = node.firstChild, nextNode; childNode; childNode = nextNode) {\n        nextNode = childNode.nextSibling;\n        var defaultView = childNode.ownerDocument.defaultView;\n        if (childNode instanceof defaultView.Text || childNode instanceof Text || defaultView.parent && childNode instanceof defaultView.parent.Text) {\n            if (childNode.data.trim().length > 0) {\n                parent.childNodes.push(_TextContainer2.default.fromTextNode(childNode, parent));\n            }\n        } else if (childNode instanceof defaultView.HTMLElement || childNode instanceof HTMLElement || defaultView.parent && childNode instanceof defaultView.parent.HTMLElement) {\n            if (IGNORED_NODE_NAMES.indexOf(childNode.nodeName) === -1) {\n                var container = new _NodeContainer2.default(childNode, parent, resourceLoader, index++);\n                if (container.isVisible()) {\n                    if (childNode.tagName === 'INPUT') {\n                        // $FlowFixMe\n                        (0, _Input.inlineInputElement)(childNode, container);\n                    } else if (childNode.tagName === 'TEXTAREA') {\n                        // $FlowFixMe\n                        (0, _Input.inlineTextAreaElement)(childNode, container);\n                    } else if (childNode.tagName === 'SELECT') {\n                        // $FlowFixMe\n                        (0, _Input.inlineSelectElement)(childNode, container);\n                    } else if (container.style.listStyle && container.style.listStyle.listStyleType !== _listStyle.LIST_STYLE_TYPE.NONE) {\n                        (0, _ListItem.inlineListItemElement)(childNode, container, resourceLoader);\n                    }\n\n                    var SHOULD_TRAVERSE_CHILDREN = childNode.tagName !== 'TEXTAREA';\n                    var treatAsRealStackingContext = createsRealStackingContext(container, childNode);\n                    if (treatAsRealStackingContext || createsStackingContext(container)) {\n                        // for treatAsRealStackingContext:false, any positioned descendants and descendants\n                        // which actually create a new stacking context should be considered part of the parent stacking context\n                        var parentStack = treatAsRealStackingContext || container.isPositioned() ? stack.getRealParentStackingContext() : stack;\n                        var childStack = new _StackingContext2.default(container, parentStack, treatAsRealStackingContext);\n                        parentStack.contexts.push(childStack);\n                        if (SHOULD_TRAVERSE_CHILDREN) {\n                            parseNodeTree(childNode, container, childStack, resourceLoader, index);\n                        }\n                    } else {\n                        stack.children.push(container);\n                        if (SHOULD_TRAVERSE_CHILDREN) {\n                            parseNodeTree(childNode, container, stack, resourceLoader, index);\n                        }\n                    }\n                }\n            }\n        } else if (childNode instanceof defaultView.SVGSVGElement || childNode instanceof SVGSVGElement || defaultView.parent && childNode instanceof defaultView.parent.SVGSVGElement) {\n            var _container = new _NodeContainer2.default(childNode, parent, resourceLoader, index++);\n            var _treatAsRealStackingContext = createsRealStackingContext(_container, childNode);\n            if (_treatAsRealStackingContext || createsStackingContext(_container)) {\n                // for treatAsRealStackingContext:false, any positioned descendants and descendants\n                // which actually create a new stacking context should be considered part of the parent stacking context\n                var _parentStack = _treatAsRealStackingContext || _container.isPositioned() ? stack.getRealParentStackingContext() : stack;\n                var _childStack = new _StackingContext2.default(_container, _parentStack, _treatAsRealStackingContext);\n                _parentStack.contexts.push(_childStack);\n            } else {\n                stack.children.push(_container);\n            }\n        }\n    }\n};\n\nvar createsRealStackingContext = function createsRealStackingContext(container, node) {\n    return container.isRootElement() || container.isPositionedWithZIndex() || container.style.opacity < 1 || container.isTransformed() || isBodyWithTransparentRoot(container, node);\n};\n\nvar createsStackingContext = function createsStackingContext(container) {\n    return container.isPositioned() || container.isFloating();\n};\n\nvar isBodyWithTransparentRoot = function isBodyWithTransparentRoot(container, node) {\n    return node.nodeName === 'BODY' && container.parent instanceof _NodeContainer2.default && container.parent.style.background.backgroundColor.isTransparent();\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.renderElement = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _Logger = require('./Logger');\n\nvar _Logger2 = _interopRequireDefault(_Logger);\n\nvar _NodeParser = require('./NodeParser');\n\nvar _Renderer = require('./Renderer');\n\nvar _Renderer2 = _interopRequireDefault(_Renderer);\n\nvar _ForeignObjectRenderer = require('./renderer/ForeignObjectRenderer');\n\nvar _ForeignObjectRenderer2 = _interopRequireDefault(_ForeignObjectRenderer);\n\nvar _Feature = require('./Feature');\n\nvar _Feature2 = _interopRequireDefault(_Feature);\n\nvar _Bounds = require('./Bounds');\n\nvar _Clone = require('./Clone');\n\nvar _Font = require('./Font');\n\nvar _Color = require('./Color');\n\nvar _Color2 = _interopRequireDefault(_Color);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar renderElement = exports.renderElement = function renderElement(element, options, logger) {\n    var ownerDocument = element.ownerDocument;\n\n    var windowBounds = new _Bounds.Bounds(options.scrollX, options.scrollY, options.windowWidth, options.windowHeight);\n\n    // http://www.w3.org/TR/css3-background/#special-backgrounds\n    var documentBackgroundColor = ownerDocument.documentElement ? new _Color2.default(getComputedStyle(ownerDocument.documentElement).backgroundColor) : _Color.TRANSPARENT;\n    var bodyBackgroundColor = ownerDocument.body ? new _Color2.default(getComputedStyle(ownerDocument.body).backgroundColor) : _Color.TRANSPARENT;\n\n    var backgroundColor = element === ownerDocument.documentElement ? documentBackgroundColor.isTransparent() ? bodyBackgroundColor.isTransparent() ? options.backgroundColor ? new _Color2.default(options.backgroundColor) : null : bodyBackgroundColor : documentBackgroundColor : options.backgroundColor ? new _Color2.default(options.backgroundColor) : null;\n\n    return (options.foreignObjectRendering ? // $FlowFixMe\n    _Feature2.default.SUPPORT_FOREIGNOBJECT_DRAWING : Promise.resolve(false)).then(function (supportForeignObject) {\n        return supportForeignObject ? function (cloner) {\n            if (process.env.NODE_ENV !== 'production') {\n                logger.log('Document cloned, using foreignObject rendering');\n            }\n\n            return cloner.inlineFonts(ownerDocument).then(function () {\n                return cloner.resourceLoader.ready();\n            }).then(function () {\n                var renderer = new _ForeignObjectRenderer2.default(cloner.documentElement);\n                return renderer.render({\n                    backgroundColor: backgroundColor,\n                    logger: logger,\n                    scale: options.scale,\n                    x: options.x,\n                    y: options.y,\n                    width: options.width,\n                    height: options.height,\n                    windowWidth: options.windowWidth,\n                    windowHeight: options.windowHeight,\n                    scrollX: options.scrollX,\n                    scrollY: options.scrollY\n                });\n            });\n        }(new _Clone.DocumentCloner(element, options, logger, true, renderElement)) : (0, _Clone.cloneWindow)(ownerDocument, windowBounds, element, options, logger, renderElement).then(function (_ref) {\n            var _ref2 = _slicedToArray(_ref, 3),\n                container = _ref2[0],\n                clonedElement = _ref2[1],\n                resourceLoader = _ref2[2];\n\n            if (process.env.NODE_ENV !== 'production') {\n                logger.log('Document cloned, using computed rendering');\n            }\n\n            var stack = (0, _NodeParser.NodeParser)(clonedElement, resourceLoader, logger);\n            var clonedDocument = clonedElement.ownerDocument;\n\n            if (backgroundColor === stack.container.style.background.backgroundColor) {\n                stack.container.style.background.backgroundColor = _Color.TRANSPARENT;\n            }\n\n            return resourceLoader.ready().then(function (imageStore) {\n                var fontMetrics = new _Font.FontMetrics(clonedDocument);\n                if (process.env.NODE_ENV !== 'production') {\n                    logger.log('Starting renderer');\n                }\n\n                var renderOptions = {\n                    backgroundColor: backgroundColor,\n                    fontMetrics: fontMetrics,\n                    imageStore: imageStore,\n                    logger: logger,\n                    scale: options.scale,\n                    x: options.x,\n                    y: options.y,\n                    width: options.width,\n                    height: options.height\n                };\n\n                if (Array.isArray(options.target)) {\n                    return Promise.all(options.target.map(function (target) {\n                        var renderer = new _Renderer2.default(target, renderOptions);\n                        return renderer.render(stack);\n                    }));\n                } else {\n                    var renderer = new _Renderer2.default(options.target, renderOptions);\n                    var canvas = renderer.render(stack);\n                    if (options.removeContainer === true) {\n                        if (container.parentNode) {\n                            container.parentNode.removeChild(container);\n                        } else if (process.env.NODE_ENV !== 'production') {\n                            logger.log('Cannot detach cloned iframe as it is not in the DOM anymore');\n                        }\n                    }\n\n                    return canvas;\n                }\n            });\n        });\n    });\n};","'use strict';\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _CanvasRenderer = require('./renderer/CanvasRenderer');\n\nvar _CanvasRenderer2 = _interopRequireDefault(_CanvasRenderer);\n\nvar _Logger = require('./Logger');\n\nvar _Logger2 = _interopRequireDefault(_Logger);\n\nvar _Window = require('./Window');\n\nvar _Bounds = require('./Bounds');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar html2canvas = function html2canvas(element, conf) {\n    // eslint-disable-next-line no-console\n    if ((typeof console === 'undefined' ? 'undefined' : _typeof(console)) === 'object' && typeof console.log === 'function') {\n        // eslint-disable-next-line no-console\n        console.log('html2canvas ' + \"$npm_package_version\");\n    }\n\n    var config = conf || {};\n    var logger = new _Logger2.default(typeof config.logging === 'boolean' ? config.logging : true);\n\n    if (process.env.NODE_ENV !== 'production' && typeof config.onrendered === 'function') {\n        logger.error('onrendered option is deprecated, html2canvas returns a Promise with the canvas as the value');\n    }\n\n    var ownerDocument = element.ownerDocument;\n    if (!ownerDocument) {\n        return Promise.reject('Provided element is not within a Document');\n    }\n    var defaultView = ownerDocument.defaultView;\n\n    var scrollX = defaultView.pageXOffset;\n    var scrollY = defaultView.pageYOffset;\n\n    var isDocument = element.tagName === 'HTML' || element.tagName === 'BODY';\n\n    var _ref = isDocument ? (0, _Bounds.parseDocumentSize)(ownerDocument) : (0, _Bounds.parseBounds)(element, scrollX, scrollY),\n        width = _ref.width,\n        height = _ref.height,\n        left = _ref.left,\n        top = _ref.top;\n\n    var defaultOptions = {\n        async: true,\n        allowTaint: false,\n        backgroundColor: '#ffffff',\n        imageTimeout: 15000,\n        logging: true,\n        proxy: null,\n        removeContainer: true,\n        foreignObjectRendering: false,\n        scale: defaultView.devicePixelRatio || 1,\n        target: new _CanvasRenderer2.default(config.canvas),\n        useCORS: false,\n        x: left,\n        y: top,\n        width: Math.ceil(width),\n        height: Math.ceil(height),\n        windowWidth: defaultView.innerWidth,\n        windowHeight: defaultView.innerHeight,\n        scrollX: defaultView.pageXOffset,\n        scrollY: defaultView.pageYOffset\n    };\n\n    var result = (0, _Window.renderElement)(element, _extends({}, defaultOptions, config), logger);\n\n    if (process.env.NODE_ENV !== 'production') {\n        return result.catch(function (e) {\n            logger.error(e);\n            throw e;\n        });\n    }\n    return result;\n};\n\nhtml2canvas.CanvasRenderer = _CanvasRenderer2.default;\n\nmodule.exports = html2canvas;","import { dot2, subtract2, Vec2 } from \"../../util/vector\";\n\nconst { ceil, max, log2, pow, sqrt } = Math;\n\n/** This is the pixel that  */\nconst NO_DATA: Vec2 = [-1, -1];\n\n/**\n * Gets the seed array for the JFA\n */\nfunction getSeed(canvas: HTMLCanvasElement, imageData: Uint8ClampedArray) {\n  const { width, height } = canvas;\n  let a;\n  const buffer: Vec2[][] = [];\n  const inverse: Vec2[][] = [];\n\n  for (let i = 0; i < width; ++i) {\n    buffer[i] = [];\n    inverse[i] = [];\n\n    for (let k = 0; k < height; ++k) {\n      const redIndex = k * (width * 4) + i * 4;\n      a = imageData[redIndex + 3];\n\n      // Any non-transparent pixel is a seed\n      if (a) {\n        buffer[i][k] = [i, k];\n        inverse[i][k] = NO_DATA;\n      } else {\n        buffer[i][k] = NO_DATA;\n        inverse[i][k] = [i, k];\n      }\n    }\n  }\n\n  return {\n    seed: buffer,\n    inverse\n  };\n}\n\n/**\n * Makes a buffer the same size as the input buffer. This assumes that the\n * input buffer is N x M in size, meaning each row is the same size.\n */\nfunction makeEmptyBuffer(buffer: Vec2[][]) {\n  const newBuffer: Vec2[][] = [];\n\n  for (let i = 0, iMax = buffer.length; i < iMax; ++i) {\n    newBuffer[i] = [];\n  }\n\n  return newBuffer;\n}\n\n/**\n * Takes a positional buffer and converts it to a distance field that is normalized to 0 - 255\n */\nfunction normalizedDistanceField(\n  buffer: Vec2[][],\n  noData: Vec2,\n  negate: boolean = false\n) {\n  const sign = negate ? -1 : 1;\n  let position: Vec2, current: Vec2, direction: Vec2;\n  let distance;\n  const distanceBuffer: number[][] = [];\n  let maxDistance: number = -1;\n\n  // Calculate the distances and get the max distance so we can normalize the output\n  for (let x = 0, xMax = buffer.length; x < xMax; ++x) {\n    const col = buffer[x];\n    distanceBuffer[x] = [];\n\n    for (let y = 0, yMax = col.length; y < yMax; ++y) {\n      position = col[y];\n\n      if (position === noData) {\n        distance = 256;\n      } else {\n        current = [x, y];\n        direction = subtract2(position, current);\n        distance = sqrt(dot2(direction, direction));\n      }\n\n      // Store the distance in our buffer for when we generate the canvas rendering\n      distanceBuffer[x][y] = distance;\n      // Update our max distance found so we can normalize the values\n      maxDistance = max(distance, maxDistance);\n    }\n  }\n\n  // Convert our distance buffer to our canvas buffer\n  for (let x = 0, xMax = buffer.length; x < xMax; ++x) {\n    const col = buffer[x];\n\n    for (let y = 0, yMax = col.length; y < yMax; ++y) {\n      distance = distanceBuffer[x][y];\n      distanceBuffer[x][y] = distance / maxDistance * 255 * sign;\n    }\n  }\n\n  return distanceBuffer;\n}\n\n/**\n * Takes the positional buffer of JFA and maps it to an Image Data buffer to be rendered as the canvas\n */\nfunction mapToDistanceField(\n  toSeedBuffer: Vec2[][],\n  fromSeedBuffer: Vec2[][],\n  noData: Vec2,\n  outBuffer: Uint8ClampedArray\n) {\n  let outColor;\n  // This is the distance field repsenting our distance to the seed values\n  const toSeedDistance = normalizedDistanceField(toSeedBuffer, noData, true);\n  // This is the negated distance field from the seed to the nearest non-seed slot\n  const fromSeedDistance = normalizedDistanceField(\n    fromSeedBuffer,\n    noData,\n    false\n  );\n\n  const width = toSeedDistance.length;\n  const outputDistance = toSeedDistance;\n\n  // Combine the buffers to get our font SDF\n  for (let x = 0, xMax = toSeedDistance.length; x < xMax; ++x) {\n    const toSeedCol = toSeedDistance[x];\n    const fromSeedCol = fromSeedDistance[x];\n\n    for (let y = 0, yMax = toSeedCol.length; y < yMax; ++y) {\n      const toSeed = toSeedCol[y];\n      const fromSeed = fromSeedCol[y];\n\n      toSeedCol[y] = toSeed + fromSeed;\n    }\n  }\n\n  for (let x = 0, xMax = outputDistance.length; x < xMax; ++x) {\n    const toSeedCol = outputDistance[x];\n\n    for (let y = 0, yMax = toSeedCol.length; y < yMax; ++y) {\n      outColor = toSeedCol[y];\n      // We use the 1 - signed distance (images are more human happy and algo happy)\n      outColor = outColor;\n\n      const redIndex = y * (width * 4) + x * 4;\n      outBuffer[redIndex] = outColor;\n      outBuffer[redIndex + 1] = outColor;\n      outBuffer[redIndex + 2] = outColor;\n      outBuffer[redIndex + 3] = 255;\n    }\n  }\n}\n\n/**\n * This contains the JFA pass logic portion of the algorithm. This requires the seedBuffer\n * and the number of passes to execute.\n */\nfunction jfaPasses(seedBuffer: Vec2[][], passes: number) {\n  const width = seedBuffer.length;\n  const height = seedBuffer[0].length;\n  // Set the current out to the seed as the each pass places the out into the read as the first step\n  let readBuffer: Vec2[][] = makeEmptyBuffer(seedBuffer);\n  let outBuffer: Vec2[][] = seedBuffer;\n  let c: Vec2;\n  let delta: Vec2;\n  let samples: Vec2[];\n  let nearestValue: number;\n  let nearestIndex: number;\n  let distance;\n  let x, y, i;\n\n  // We run the JFA passes over the buffers until complete\n  for (let pass = 0; pass < passes; ++pass) {\n    // We dont want to destroy the old read buffer as we will just write over the old data\n    // so we don't allocate a new buffer for each pass.\n    const temp = readBuffer;\n    // Swap the out buffer from last pass to the read buffer of this pass\n    readBuffer = outBuffer;\n    // We now write to the other buffer\n    outBuffer = temp;\n    // Next make a new out buffer to write into\n    const offset = pow(2, passes - pass - 1);\n\n    // Now loop through all of the buffer 'pixels' and take the JFA sampling\n    for (x = 0; x < width; ++x) {\n      for (y = 0; y < height; ++y) {\n        c = [x, y];\n        samples = [\n          (readBuffer[x - offset] || [])[y - offset] || NO_DATA,\n          (readBuffer[x] || [])[y - offset] || NO_DATA,\n          (readBuffer[x + offset] || [])[y - offset] || NO_DATA,\n          (readBuffer[x - offset] || [])[y] || NO_DATA,\n          (readBuffer[x] || [])[y] || NO_DATA,\n          (readBuffer[x + offset] || [])[y] || NO_DATA,\n          (readBuffer[x - offset] || [])[y + offset] || NO_DATA,\n          (readBuffer[x] || [])[y + offset] || NO_DATA,\n          (readBuffer[x + offset] || [])[y + offset] || NO_DATA\n        ];\n\n        nearestIndex = 0;\n        nearestValue = Number.MAX_VALUE;\n\n        for (i = 0; i < 9; ++i) {\n          const s = samples[i];\n\n          // NO_DATA does not require analysis\n          if (s !== NO_DATA) {\n            delta = subtract2(s, c);\n            distance = dot2(delta, delta);\n\n            if (distance < nearestValue) {\n              nearestValue = distance;\n              nearestIndex = i;\n            }\n          }\n        }\n\n        // We write to the buffer with our result which will either be NO_DATA or a pixel location\n        outBuffer[x][y] = samples[nearestIndex];\n      }\n    }\n  }\n\n  return outBuffer;\n}\n\n/**\n * Redraws the contents of the provided canvas as a signed distance field.\n * Signed distance fields are great for many techniques.\n *\n * As of right now this SDF merely represents distance to nearest occupied\n * pixel.\n *\n * This  particular SDF calculation utilizes JFA\n *\n * This algortihm follows the following:\n * Make a buffer that is the size of the canvas and seed it with values equal to the pixel position of filled pixels\n * Next calculate how many passes JFA will need to run based on the size of the canvas: log_2(max dimension of the canvas)\n * Next sample the buffer in a 3x3 grid with each having an offset that is 2^(number of passes - current pass - 1). The center\n * sample is the current pixel.\n * Each sample will contain either NO DATA or will contain the pixel position of the nearest filled pixel.\n * Each sample will calculate the distance of the sample to the current pixel position, the nearest sample will fill the buffer at\n * that position.\n *\n * After all passes, the buffer should be filled with the nearest pixel positions. You can take that and map it to either distances\n * or use other techniques desired.\n */\nexport function convertToSDF(\n  canvas: HTMLCanvasElement,\n  mapMethod: (\n    toSeedBuffer: Vec2[][],\n    fromSeedBuffer: Vec2[][],\n    noDataObject: Vec2,\n    outData: Uint8ClampedArray\n  ) => void = mapToDistanceField\n) {\n  const { width, height } = canvas;\n  const context = canvas.getContext(\"2d\");\n  if (!context) return;\n\n  const imageData = context.getImageData(0, 0, width, height).data;\n\n  // This gets the dimension to use as our max dimension for the JFA algorithm pass calculation\n  const maxDimension = max(width, height);\n  // Determine how many passes to execute\n  const passes = ceil(log2(maxDimension));\n  // This is the initial seed buffer for the JFA\n  const seedBuffer = getSeed(canvas, imageData);\n  // Runt he passes on the initial seed buffer to make the positional buffer\n  const positionBuffer = jfaPasses(seedBuffer.seed, passes);\n  const inversePositionBuffer = jfaPasses(seedBuffer.inverse, passes);\n  // Make an image data object that we can manipulate and apply to the canvas\n  const outImageData = new ImageData(width, height);\n  // Map the positional buffer to something that can be rendered to a canvas. By default, this will\n  // be a distance field.\n  mapMethod(positionBuffer, inversePositionBuffer, NO_DATA, outImageData.data);\n  // Render the out data to the input canvas\n  context.putImageData(outImageData, 0, 0);\n}\n\n/**\n * Makes a SDF of the input font specified\n */\nexport function makeFontSDF(_canvas: HTMLCanvasElement) {\n  // TODO\n}\n","export * from \"./cpu-sdf\";\nexport * from \"./font-manager\";\nexport * from \"./font-map\";\nexport * from \"./font-renderer\";\nexport * from \"./font-resource-manager\";\nexport * from \"./font-resource-request\";\nexport * from \"./glyph-renderer\";\n","import { WebGLRenderer } from \"../gl\";\nimport { Instance } from \"../instance-provider/instance\";\nimport { ILayerProps, Layer } from \"../surface/layer\";\nimport { BaseIOExpansion } from \"../surface/layer-processing/base-io-expansion\";\nimport {\n  InstanceIOValue,\n  IResourceContext,\n  IResourceInstanceAttribute,\n  IResourceType\n} from \"../types\";\nimport {\n  BaseResourceManager,\n  INVALID_RESOURCE_MANAGER\n} from \"./base-resource-manager\";\n\nconst debug = require(\"debug\")(\"performance\");\n\n/**\n * This is the manager of all Resource Managers. This handles registering managers for various resource types\n * and delegates resource requests to the appropriate manager.\n */\nexport class ResourceManager {\n  /** This is the list of managers for handling resource requests */\n  managers = new Map<number, BaseResourceManager<any, any>>();\n  /** This is the webgl renderer that is passed to the resource managers */\n  webGLRenderer?: WebGLRenderer;\n\n  /**\n   * This is called by the system to cause the managers to dequeue their requests in an asynchronous fashion\n   */\n  async dequeueRequests() {\n    let didUpdate = false;\n    const managers = Array.from(this.managers.values());\n\n    for (let i = 0, iMax = managers.length; i < iMax; ++i) {\n      const manager = managers[i];\n      const update = await manager.dequeueRequests();\n      didUpdate = didUpdate || update;\n    }\n\n    return didUpdate;\n  }\n\n  /**\n   * Destroys all managers managed by this manager.\n   */\n  destroy() {\n    this.managers.forEach(manager => manager.destroy());\n  }\n\n  /**\n   * Retrieves the Shader IO Expansion controllers that may be provided by resource managers.\n   */\n  getIOExpansion() {\n    let all: BaseIOExpansion[] = [];\n\n    this.managers.forEach(manager => {\n      all = all.concat(manager.getIOExpansion());\n    });\n\n    return all;\n  }\n\n  /**\n   * Gets the manager for the provided resource type\n   */\n  getManager(resourceType: number): BaseResourceManager<any, any> {\n    const manager = this.managers.get(resourceType);\n\n    if (!manager) {\n      console.warn(\n        `A manager was requested that does not exist for type ${resourceType}`\n      );\n      return INVALID_RESOURCE_MANAGER;\n    }\n\n    return manager;\n  }\n\n  /**\n   * This hands the initialization of a resource to the correct Resource Manager.\n   */\n  async initResource<T extends IResourceType>(resource: T & { key: string }) {\n    const manager = this.managers.get(resource.type);\n\n    if (!manager) {\n      console.warn(\n        `A Resource is trying to be created but has no manager to facilitate the operation: ${\n          resource.type\n        }`\n      );\n\n      return;\n    }\n\n    return await manager.initResource(resource);\n  }\n\n  /**\n   * This is called by layers to request resources being generated.\n   */\n  request<\n    T extends Instance,\n    U extends ILayerProps<T>,\n    V extends IResourceType\n  >(\n    layer: Layer<T, U>,\n    instance: Instance,\n    resource: V,\n    context?: IResourceContext\n  ): InstanceIOValue {\n    const manager = this.managers.get(resource.type);\n\n    if (!manager) {\n      console.warn(\n        `A Layer is requesting a resource for which there is no manager set. Please make sure a Resource Manager is set for resource of type: ${\n          resource.type\n        }`\n      );\n      return [-1, -1, -1, -1];\n    }\n\n    return manager.request(layer, instance, resource, context);\n  }\n\n  /**\n   * This places an attribute as the current context for the managers to operate within.\n   * This will cause the attributes requested resource (if existing) to set the attribute\n   * as it's current context while performing tasks.\n   */\n  setAttributeContext(\n    attribute: IResourceInstanceAttribute<Instance>,\n    resourceType: number\n  ) {\n    (\n      this.managers.get(resourceType) || INVALID_RESOURCE_MANAGER\n    ).setAttributeContext(attribute);\n  }\n\n  /**\n   * Every resource type needs a manager associated with it so it can have requests processed. This\n   * allows a manager to be set for a resource type.\n   */\n  setManager(resourceType: number, manager: BaseResourceManager<any, any>) {\n    const currentManager = this.managers.get(resourceType);\n\n    if (currentManager) {\n      debug(\n        `A manager was assigned to a resource type: ${resourceType} that overrides another manager already set to that type.`\n      );\n    }\n\n    this.managers.set(resourceType, manager);\n    manager.webGLRenderer = this.webGLRenderer;\n  }\n\n  /**\n   * This sets the current gl renderer used for handling GL operations.\n   */\n  setWebGLRenderer(renderer: WebGLRenderer) {\n    this.webGLRenderer = renderer;\n    this.managers.forEach(manager => (manager.webGLRenderer = renderer));\n  }\n}\n","import { InstanceProvider } from \"../../instance-provider\";\nimport { atlasRequest, IAtlasResourceRequest } from \"../../resources\";\nimport { Layer } from \"../../surface/layer\";\nimport { createLayer, LayerInitializer } from \"../../surface/layer-surface\";\nimport { InstanceDiffType } from \"../../types\";\nimport { ImageInstance } from \"./image-instance\";\nimport { IImageRenderLayerProps, ImageRenderLayer } from \"./image-render-layer\";\n\nexport interface IImageLayerProps<T extends ImageInstance>\n  extends IImageRenderLayerProps<T> {}\n\n/**\n * This layer displays Images and provides as many controls as possible for displaying\n * them in interesting ways. This is the primary handler for image instances.\n */\nexport class ImageLayer<\n  T extends ImageInstance,\n  U extends IImageLayerProps<T>\n> extends Layer<T, U> {\n  static defaultProps: IImageLayerProps<any> = {\n    atlas: \"default\",\n    key: \"\",\n    data: new InstanceProvider<ImageInstance>(),\n    scene: \"default\"\n  };\n\n  /** Internal provider for child layers for this layer to hand off to */\n  childProvider = new InstanceProvider<ImageInstance>();\n  /**\n   * This tracks which resource this image is associated with This allows us to know what resource an image\n   * moves on from, thus allowing us to dispatch a disposal request of the resource.\n   */\n  imageToResource = new Map<ImageInstance, ImageInstance[\"source\"]>();\n  /** The cached property ids of the instances so they are not processed every draw */\n  propertyIds?: { [key: string]: number };\n  /** We can consolidate requests at this layer level to reduce memory footprint of requests */\n  sourceToRequest = new Map<ImageInstance[\"source\"], IAtlasResourceRequest>();\n\n  /**\n   * The image layer will manage the resources for the images, and the child layer will concern itself\n   * with rendering.\n   */\n  childLayers(): LayerInitializer[] {\n    return [\n      createLayer(ImageRenderLayer, {\n        ...this.props,\n        key: `${this.props.key}.child`\n      })\n    ];\n  }\n\n  /**\n   * Hijack the draw method to control changes to the source so we can send the manager dispose requests\n   * of a given image.\n   */\n  draw() {\n    // Get the changes we need to handle. We make sure the provider's changes remain in tact for\n    // the child layer to process them.\n    const changes = this.resolveChanges(true);\n    // No changes, do nadda\n    if (changes.length <= 0) return;\n\n    if (!this.propertyIds) {\n      this.propertyIds = this.getInstanceObservableIds(changes[0][0], [\n        \"source\"\n      ]);\n    }\n\n    // Destructure the ids to work with\n    const { source: sourceId } = this.propertyIds;\n\n    for (let i = 0, iMax = changes.length; i < iMax; ++i) {\n      const [instance, diffType, changed] = changes[i];\n\n      switch (diffType) {\n        case InstanceDiffType.CHANGE:\n          // Indicates changes took place\n          if (changed[sourceId] !== undefined) {\n            // We get the previously stored resource\n            const previous = this.imageToResource.get(instance);\n            // Nothing needs to happen if the resource didn't change\n            if (instance.source === previous) break;\n            // We set the new resource\n            this.imageToResource.set(instance, instance.source);\n            // We make a disposal request to the resource manager\n            this.resource.request(\n              this,\n              instance,\n              atlasRequest({\n                disposeResource: true,\n                source: previous\n              })\n            );\n\n            // Look for similar requests for resources and consolidate\n            if (instance.source) {\n              let request = this.sourceToRequest.get(instance.source);\n\n              if (!request || (request.texture && !request.texture.isValid)) {\n                request = atlasRequest({\n                  source: instance.source,\n                  rasterizationScale: this.props.rasterizationScale\n                });\n\n                this.sourceToRequest.set(instance.source, request);\n              }\n\n              instance.request = request;\n            }\n          }\n          break;\n\n        case InstanceDiffType.INSERT:\n          // Look for similar requests for resources and consolidate\n          if (instance.source) {\n            let request = this.sourceToRequest.get(instance.source);\n\n            if (!request || (request.texture && !request.texture.isValid)) {\n              request = atlasRequest({\n                source: instance.source,\n                rasterizationScale: this.props.rasterizationScale\n              });\n\n              this.sourceToRequest.set(instance.source, request);\n            }\n\n            instance.request = request;\n          }\n\n          break;\n\n        case InstanceDiffType.REMOVE:\n          // We make a disposal request here\n          this.resource.request(\n            this,\n            instance,\n            atlasRequest({\n              disposeResource: true,\n              source: instance.source\n            })\n          );\n          break;\n      }\n    }\n  }\n\n  /**\n   * Parent layer has no rendering needs\n   */\n  initShader() {\n    return null;\n  }\n}\n","export * from \"./image-layer\";\nexport * from \"./image-instance\";\n","import { IInstanceOptions, Instance } from \"../../instance-provider/instance\";\nimport { observable } from \"../../instance-provider/observable\";\n\nexport interface IEdgeInstanceOptions extends IInstanceOptions {\n  /** The color of this edge at the start point. */\n  colorStart?: [number, number, number, number];\n  /** The color of this edge at the end point. */\n  colorEnd?: [number, number, number, number];\n  /** This is the list of control points  */\n  control?: [number, number][];\n  /** The z depth of the edge (for draw ordering) */\n  depth?: number;\n  /** End point of the edge. */\n  end: [number, number];\n  /** Beginning point of the edge. */\n  start: [number, number];\n  /** Start width of the edge. */\n  widthStart?: number;\n  /** End width of the edge */\n  widthEnd?: number;\n}\n\nexport type EdgeColor = [number, number, number, number];\n\nexport class EdgeInstance extends Instance {\n  @observable colorStart: EdgeColor = [1.0, 1.0, 1.0, 1.0];\n  @observable colorEnd: EdgeColor = [1.0, 1.0, 1.0, 1.0];\n  @observable control: [number, number][] = [[0, 0], [0, 0]];\n  @observable depth: number = 0;\n  @observable end: [number, number] = [0, 0];\n  @observable start: [number, number] = [0, 0];\n  @observable widthStart: number = 1.0;\n  @observable widthEnd: number = 1.0;\n\n  get length() {\n    const delta = [this.end[0] - this.start[0], this.end[1] - this.start[1]];\n\n    return Math.sqrt(delta[0] * delta[0] + delta[1] * delta[1]);\n  }\n\n  /**\n   * Calculates the midpoint of the edge\n   */\n  get midpoint() {\n    return 0;\n  }\n\n  /**\n   * Calculates a perpendicular direction vector to the edge\n   */\n  get perpendicular(): [number, number] {\n    const length = this.length;\n\n    return [\n      (this.end[1] - this.start[1]) / length,\n      -(this.end[0] - this.start[0]) / length\n    ];\n  }\n\n  /**\n   * Applies the edge width to the start and end\n   */\n  setEdgeWidth(width: number) {\n    if (width) {\n      this.widthEnd = width;\n      this.widthStart = width;\n    }\n  }\n\n  /**\n   * Applies the color to the start and end\n   */\n  setColor(color: EdgeColor) {\n    this.colorStart = color;\n    this.colorEnd = color;\n  }\n\n  constructor(options: IEdgeInstanceOptions) {\n    super(options);\n    this.colorStart = options.colorStart || this.colorStart;\n    this.colorEnd = options.colorEnd || this.colorEnd;\n    this.control = options.control || this.control;\n    this.depth = options.depth || this.depth;\n    this.end = options.end || this.end;\n    this.widthStart = options.widthStart || this.widthStart;\n    this.widthEnd = options.widthEnd || this.widthEnd;\n    this.start = options.start || this.start;\n  }\n}\n","module.exports = \"precision highp float;\\n\\nvarying vec4 vertexColor;\\n${extendHeader}\\n\\nvoid main() {\\n  setColor(vertexColor);\\n  ${extend}\\n}\\n\"","module.exports = \"/**\\n  This vertex shader calculates edges based in world space to make an edge based on\\n  bezier curves with 0, 1, and 2 control points.\\n**/\\nprecision highp float;\\n\\n${import: projection}\\n\\nvarying vec4 vertexColor;\\n\\n// Interpolation type injection\\n${interpolation}\\n\\n${extendHeader}\\n\\nvoid main() {\\n  ${attributes}\\n\\n  // Destructure threejs's bug with the position requirement\\n  float normal = vertex.x;\\n  float interpolationTime = vertex.y;\\n  float interpolationIncrement = 1.0 / vertex.z;\\n\\n  // Convert our world points to screen space\\n  vec4 startClip = clipSpace(vec3(start, depth));\\n  vec4 endClip = clipSpace(vec3(end, depth));\\n  vec2 startScreen = (startClip.xy + vec2(1.0, 1.0)) * vec2(0.5, 0.5) * viewSize;\\n  vec2 endScreen = (endClip.xy + vec2(1.0, 1.0)) * vec2(0.5, 0.5) * viewSize;\\n  // Controls for this mode are screen space deltas from the end points\\n  vec2 control1 = startScreen + vec2(control.x, -control.y) * scaleFactor;\\n  vec2 control2 = endScreen + vec2(control.z, -control.w) * scaleFactor;\\n\\n  // Get the position of the current vertex\\n  vec2 currentPosition = interpolation(interpolationTime, startScreen, endScreen, control1, control2);\\n  // Calculate the next and previous segment's location on the line\\n  vec2 prePosition = interpolation(interpolationTime - interpolationIncrement, startScreen, endScreen, control1, control2);\\n  vec2 nextPosition = interpolation(interpolationTime + interpolationIncrement, startScreen, endScreen, control1, control2);\\n\\n  vec2 preLine = prePosition - currentPosition;\\n  vec2 nextLine = nextPosition - currentPosition;\\n\\n  // Get a spliced nromal at the joining of two segments to make a crisper curve\\n  vec2 currentNormal = mix(\\n    // Pick this value if we're at the beginning of the line\\n    normalize(vec2(preLine.y, -preLine.x)),\\n    mix(\\n      // Pick this value when we're between the ends\\n      normalize(vec2(preLine.y, -preLine.x) + vec2(-nextLine.y, nextLine.x)),\\n      // Pick this value if we're at the end of the line\\n      normalize(vec2(-nextLine.y, nextLine.x)),\\n      float(vertex.x >= 1.0)\\n    ),\\n    float(vertex.x > 0.0)\\n  );\\n\\n  // Get the thickness based on the side we're on\\n  float lineThickness = mix(widthStart, widthEnd, interpolationTime) / 2.0;\\n  // Start on the calculated line and push out by the normal's value\\n  vec2 vertexPos = currentPosition + currentNormal * (-normal * lineThickness * scaleFactor);\\n  // Get the color based on where we are on the line\\n  vertexColor = mix(colorStart, colorEnd, interpolationTime);\\n\\n  gl_Position = vec4((vertexPos / viewSize) * vec2(2.0, 2.0) - vec2(1.0, 1.0), startClip.zw);\\n  gl_PointSize = 5.0;\\n\\n  ${extend}\\n}\\n\"","module.exports = \"${import: projection}\\n\\nprecision highp float;\\n\\n/**\\n  This vertex shader calculates edges whose curve and width is in screen space where the curve is\\n  bezier curves with 0, 1, and 2 control points.\\n**/\\nvarying vec4 vertexColor;\\n\\n// Interpolation type injection\\n${interpolation}\\n\\n${extendHeader}\\n\\nvoid main() {\\n  ${attributes}\\n\\n  // Destructure threejs's bug with the position requirement\\n  float normal = vertex.x;\\n  float interpolationTime = vertex.y;\\n  float interpolationIncrement = 1.0 / vertex.z;\\n  // Get the position of the current vertex\\n  vec2 currentPosition = interpolation(interpolationTime, start, end, control.xy, control.zw);\\n  // Calculate the next and previous segment's location on the line\\n  vec2 prePosition = interpolation(interpolationTime - interpolationIncrement, start, end, control.xy, control.zw);\\n  vec2 nextPosition = interpolation(interpolationTime + interpolationIncrement, start, end, control.xy, control.zw);\\n\\n  vec2 preLine = prePosition - currentPosition;\\n  vec2 nextLine = nextPosition - currentPosition;\\n\\n  // Get a spliced nromal at the joining of two segments to make a crisper curve\\n  vec2 currentNormal = mix(\\n    // Pick this value if we're at the beginning of the line\\n    normalize(vec2(preLine.y, -preLine.x)),\\n    mix(\\n      // Pick this value when we're between the ends\\n      normalize(vec2(preLine.y, -preLine.x) + vec2(-nextLine.y, nextLine.x)),\\n      // Pick this value if we're at the end of the line\\n      normalize(vec2(-nextLine.y, nextLine.x)),\\n      float(vertex.x >= 1.0)\\n    ),\\n    float(vertex.x > 0.0)\\n  );\\n\\n  // Get the thickness based on the side we're on\\n  float lineThickness = mix(widthStart, widthEnd, interpolationTime) / 2.0;\\n  // Start on the calculated line and push out by the normal's value\\n  vec2 vertexPos = currentPosition + currentNormal * (normal * lineThickness);\\n  // Get the color based on where we are on the line\\n  vertexColor = mix(colorStart, colorEnd, interpolationTime);\\n\\n  gl_Position = clipSpace(vec3(vertexPos, depth));\\n  gl_PointSize = 5.0;\\n\\n  ${extend}\\n}\\n\"","module.exports = \"/**\\n * Makes a linear interpolation between two points\\n *\\n * @param {vec2} s The start point\\n * @param {vec2} e The end point\\n * @param {vec2} c The bezier control point\\n * @param {float} t The interpolation value [0, 1]\\n *\\n * @returns {vec2} A point interpolated between the two provided points\\n */\\nvec2 interpolation(float t, vec2 p1, vec2 p2, vec2 c1, vec2 c2) {\\n  float t1 = 1.0 - t;\\n  return pow(t1, 3.0) * p1 + 3.0 * t * pow(t1, 2.0) * c1 + 3.0 * pow(t, 2.0) * t1 * c2 + pow(t, 3.0) * p2;\\n}\\n\"","module.exports = \"/**\\n * Makes a linear interpolation between two points\\n *\\n * @param {vec2} s The start point\\n * @param {vec2} e The end point\\n * @param {vec2} c The bezier control point\\n * @param {float} t The interpolation value [0, 1]\\n *\\n * @returns {vec2} A point interpolated between the two provided points\\n */\\nvec2 interpolation(float t, vec2 p1, vec2 p2, vec2 c1, vec2 c2) {\\n  return (1.0 - t) * (1.0 - t) * p1 + 2.0 * t * (1.0 - t) * c1 + t * t * p2;\\n}\\n\"","module.exports = \"/**\\n * Makes a linear interpolation between two points\\n *\\n * @param {vec2} s The start point\\n * @param {vec2} e The end point\\n * @param {vec2} c The bezier control point\\n * @param {float} t The interpolation value [0, 1]\\n *\\n * @returns {vec2} A point interpolated between the two provided points\\n */\\nvec2 interpolation(float t, vec2 p1, vec2 p2, vec2 c1, vec2 c2) {\\n  return p1 + (p2 - p1) * t;\\n}\\n\"","/**\n * This file contains the logic for handling edge picking via quad tree and hit tests.\n * The methods involved are fairly robust and would clutter the layer's code file.\n */\nimport { Bounds } from \"../../primitives/bounds\";\nimport { IPickingMethods } from \"../../surface/layer\";\nimport { IProjection } from \"../../types\";\nimport {\n  add2,\n  copy2,\n  dot2,\n  length2,\n  scale2,\n  subtract2,\n  Vec2\n} from \"../../util/vector\";\nimport { EdgeInstance } from \"./edge-instance\";\nimport { IEdgeLayerProps } from \"./edge-layer\";\nimport { EdgeBroadphase, EdgeScaleType, EdgeType } from \"./types\";\nconst { pow } = Math;\n\ntype InterpolationMethod = (\n  t: number,\n  p1: Vec2,\n  p2: Vec2,\n  c1: Vec2,\n  c2: Vec2\n) => Vec2;\n\n/** This is an interpolation across a line */\nfunction linear(t: number, p1: Vec2, p2: Vec2, _c1: Vec2, _c2: Vec2): Vec2 {\n  return add2(scale2(subtract2(p2, p1), t), p1);\n}\n\n/** This is an interpolation across a bezier curve, single control */\nfunction bezier(t: number, p1: Vec2, p2: Vec2, c1: Vec2, _c2: Vec2): Vec2 {\n  return [\n    (1.0 - t) * (1.0 - t) * p1[0] + 2.0 * t * (1.0 - t) * c1[0] + t * t * p2[0],\n    (1.0 - t) * (1.0 - t) * p1[1] + 2.0 * t * (1.0 - t) * c1[1] + t * t * p2[1]\n  ];\n}\n\n/** This is an interpolation across a bezier curve, double control */\nfunction bezier2(t: number, p1: Vec2, p2: Vec2, c1: Vec2, c2: Vec2): Vec2 {\n  const t1 = 1.0 - t;\n\n  return [\n    pow(t1, 3.0) * p1[0] +\n      3.0 * t * pow(t1, 2.0) * c1[0] +\n      3.0 * pow(t, 2.0) * t1 * c2[0] +\n      pow(t, 3.0) * p2[0],\n    pow(t1, 3.0) * p1[1] +\n      3.0 * t * pow(t1, 2.0) * c1[1] +\n      3.0 * pow(t, 2.0) * t1 * c2[1] +\n      pow(t, 3.0) * p2[1]\n  ];\n}\n\n/** A quick lookup for an interpolation method based on Edge Type */\nconst interpolation: { [key: number]: InterpolationMethod } = {\n  [EdgeType.LINE]: linear,\n  [EdgeType.BEZIER]: bezier,\n  [EdgeType.BEZIER2]: bezier2\n};\n\n/** Takes two points that forms a line then calculates the nearest distance from that line to the third point */\nfunction distanceTo(start: Vec2, end: Vec2, p: Vec2) {\n  // Make a vector from a line point to the indicated point\n  const vector: Vec2 = subtract2(start, p);\n  const lineDirection: Vec2 = subtract2(end, start);\n  const lineNormal: Vec2 = [lineDirection[1], -lineDirection[0]];\n  const distance: number =\n    Math.abs(dot2(vector, lineNormal)) / length2(lineDirection);\n\n  // The distance is d = |v . r| where v is a unit perpendicular vector to the Line\n  return distance;\n}\n\n// This sets the number of iterations along a curve we sample to test collisions with\nconst TEST_RESOLUTION = 50;\n\n/**\n * This generates the picking methods needed for managing PickType.ALL for the edge layer.\n */\nexport function edgePicking<T extends EdgeInstance>(\n  props: IEdgeLayerProps<T>\n): IPickingMethods<EdgeInstance> {\n  const { broadphase, minPickDistance = 0, scaleType, type } = props;\n  const interpolate = interpolation[props.type];\n\n  const boundsAccessor = (edge: EdgeInstance) => {\n    const edgeWidthStart = edge.widthStart / 2 + minPickDistance;\n    const edgeWidthEnd = edge.widthEnd / 2 + minPickDistance;\n    // Encapsulate the endpoints as they are guaranteed to be included in the shape\n    // Each endpoint will be a box that includes the endpoint thickness\n    const bounds = new Bounds({\n      height: edge.widthStart,\n      width: edge.widthStart,\n      x: edge.start[0] - edgeWidthStart,\n      y: edge.start[1] - edgeWidthStart\n    });\n\n    bounds.encapsulate(\n      new Bounds({\n        height: edge.widthEnd,\n        width: edge.widthEnd,\n        x: edge.end[0] - edgeWidthEnd,\n        y: edge.end[1] - edgeWidthEnd\n      })\n    );\n\n    // Encapsulating the bezier control points is enough of a broadphase for beziers\n    if (props.type === EdgeType.BEZIER) {\n      bounds.encapsulate(edge.control[0]);\n    } else if (props.type === EdgeType.BEZIER2) {\n      // Encapsulating the bezier control points is enough of a broadphase for beziers\n      bounds.encapsulate(edge.control[0]);\n      bounds.encapsulate(edge.control[1]);\n    }\n\n    if (broadphase === EdgeBroadphase.PASS_X) {\n      bounds.x = Number.MIN_SAFE_INTEGER / 2;\n      bounds.width = Number.MAX_SAFE_INTEGER;\n    }\n\n    if (broadphase === EdgeBroadphase.PASS_Y) {\n      bounds.y = Number.MIN_SAFE_INTEGER / 2;\n      bounds.height = Number.MAX_SAFE_INTEGER;\n    }\n\n    return bounds;\n  };\n\n  if (scaleType === EdgeScaleType.SCREEN_CURVE) {\n    return {\n      // Provide the calculated AABB world bounds for a given circle\n      boundsAccessor,\n\n      // Provide a precise hit test for the edge. This method performs all of the rendering\n      // And hit tests within screen space as opposed to world space.\n      hitTest: (edge: EdgeInstance, point: Vec2, view: IProjection) => {\n        point = view.worldToScreen(point);\n        const mouse: Vec2 = point;\n        let closestIndex = 0;\n        let closestDistance = Number.MAX_VALUE;\n        let secondClosestIndex = 0;\n        let secondClosestDistance = Number.MAX_VALUE;\n\n        const start = view.worldToScreen(edge.start);\n        const end = view.worldToScreen(edge.end);\n        let control1: Vec2 = [0, 0];\n        let control2: Vec2 = [0, 0];\n\n        if (type === EdgeType.BEZIER) {\n          control1 = add2(start, edge.control[0]);\n        } else if (type === EdgeType.BEZIER2) {\n          control1 = add2(start, edge.control[0]);\n          control2 = add2(end, edge.control[1]);\n        }\n\n        const startPoint = copy2(start);\n        const endPoint = copy2(end);\n\n        control1 = edge.control.length > 0 ? control1 : [0, 0];\n        control2 = edge.control.length > 1 ? control2 : [0, 0];\n\n        // Loop through sample points on the line and find one that is closest to the mouse point as possible\n        for (let i = 0; i < TEST_RESOLUTION; ++i) {\n          const linePoint = interpolate(\n            i / TEST_RESOLUTION,\n            startPoint,\n            endPoint,\n            control1,\n            control2\n          );\n          const distance = length2(subtract2(mouse, linePoint));\n\n          if (distance < closestDistance) {\n            secondClosestIndex = closestIndex;\n            secondClosestDistance = closestDistance;\n            closestIndex = i;\n            closestDistance = distance;\n          } else if (distance < secondClosestDistance) {\n            secondClosestIndex = i;\n            closestDistance = distance;\n          }\n        }\n\n        const t = closestIndex / TEST_RESOLUTION;\n        const lineWidth =\n          (edge.widthEnd - edge.widthStart) * t + edge.widthStart;\n\n        if (closestIndex === secondClosestIndex) {\n          return false;\n        }\n\n        const startSegment = interpolate(\n          closestIndex / TEST_RESOLUTION,\n          startPoint,\n          endPoint,\n          control1,\n          control2\n        );\n\n        const endSegment = interpolate(\n          secondClosestIndex / TEST_RESOLUTION,\n          startPoint,\n          endPoint,\n          control1,\n          control2\n        );\n\n        // See how close the mouse is to the line between the two closest points for a more accurate\n        // Test\n        closestDistance = distanceTo(startSegment, endSegment, mouse);\n\n        // This helps determine if the mouse is beyond the end point\n        if (\n          dot2(\n            subtract2(endSegment, startSegment),\n            subtract2(mouse, startSegment)\n          ) < 0\n        ) {\n          return false;\n        }\n\n        return closestDistance < lineWidth / 2.0 + minPickDistance;\n      }\n    };\n  }\n\n  return {\n    // Provide the calculated AABB world bounds for a given circle\n    boundsAccessor,\n\n    // Provide a precise hit test for the edge\n    hitTest: (edge: EdgeInstance, point: Vec2, _view: IProjection) => {\n      const mouse: Vec2 = point;\n      let closestIndex = 0;\n      let closestDistance = Number.MAX_VALUE;\n\n      // Loop through sample points on the line and find one that is closest to the mouse point as possible\n      for (let i = 0; i < TEST_RESOLUTION; ++i) {\n        const linePoint = interpolate(\n          i / TEST_RESOLUTION,\n          edge.start,\n          edge.end,\n          edge.control.length > 0 ? edge.control[0] : [0, 0],\n          edge.control.length > 1 ? edge.control[1] : [0, 0]\n        );\n        const distance = length2(subtract2(mouse, linePoint));\n\n        if (distance < closestDistance) {\n          closestIndex = i;\n          closestDistance = distance;\n        }\n      }\n\n      const t = closestIndex / TEST_RESOLUTION;\n      const lineWidth = (edge.widthEnd - edge.widthStart) * t + edge.widthStart;\n\n      return closestDistance < lineWidth / 2.0;\n    }\n  };\n}\n","import { InstanceProvider } from \"../../instance-provider\";\nimport { ILayerProps, IPickingMethods, Layer } from \"../../surface/layer\";\nimport {\n  ILayerMaterialOptions,\n  InstanceAttributeSize,\n  InstanceIOValue,\n  IShaderInitialization,\n  IUniform,\n  UniformSize,\n  VertexAttributeSize\n} from \"../../types\";\nimport {\n  CommonMaterialOptions,\n  IAutoEasingMethod,\n  shaderTemplate,\n  Vec\n} from \"../../util\";\nimport { EdgeInstance } from \"./edge-instance\";\nimport { edgePicking } from \"./edge-picking\";\nimport { EdgeBroadphase, EdgeScaleType, EdgeType } from \"./types\";\n\nexport interface IEdgeLayerProps<T extends EdgeInstance>\n  extends ILayerProps<T> {\n  /** Properties for animating attributes */\n  animate?: {\n    end?: IAutoEasingMethod<Vec>;\n    start?: IAutoEasingMethod<Vec>;\n    colorStart?: IAutoEasingMethod<Vec>;\n    colorEnd?: IAutoEasingMethod<Vec>;\n    control?: IAutoEasingMethod<Vec>;\n  };\n  /** Allows adjustments for broadphase interactions for an edge */\n  broadphase?: EdgeBroadphase;\n  /** Any distance to the mouse from an edge that is less than this distance will be picked */\n  minPickDistance?: number;\n  /** The transparency of the layer as a whole. (Makes for very efficient fading of all elements) */\n  opacity?: number;\n  /** This sets a scaling factor for the edge's line width and curve  */\n  scaleFactor?(): number;\n  /**\n   * If this is set, then the thickness of the line and the curvature of the line exists in screen space\n   * rather than world space.\n   */\n  scaleType?: EdgeScaleType;\n  /** Specifies how the edge is formed */\n  type: EdgeType;\n}\n\nexport interface IEdgeLayerState {}\n\n/** Converts a control list to an IO value */\nfunction toInstanceIOValue(value: [number, number][]): InstanceIOValue {\n  return [value[0][0], value[0][1], value[1][0], value[1][1]];\n}\n\n/** This picks the appropriate shader for the edge type desired */\nconst pickVS = {\n  [EdgeType.LINE]: require(\"./shader/edge-layer-line.vs\"),\n  [EdgeType.BEZIER]: require(\"./shader/edge-layer-bezier.vs\"),\n  [EdgeType.BEZIER2]: require(\"./shader/edge-layer-bezier2.vs\")\n};\n\n/** This is the base edge layer which is a template that can be filled with the needed specifics for a given line type */\nconst baseVS = require(\"./shader/edge-layer.vs\");\nconst screenVS = require(\"./shader/edge-layer-screen-curve.vs\");\nconst edgeFS = require(\"./shader/edge-layer.fs\");\n\n/**\n * This layer displays edges and provides as many controls as possible for displaying\n * them in interesting ways.\n */\nexport class EdgeLayer<\n  T extends EdgeInstance,\n  U extends IEdgeLayerProps<T>\n> extends Layer<T, U> {\n  // Set default props for the layer\n  static defaultProps: IEdgeLayerProps<EdgeInstance> = {\n    broadphase: EdgeBroadphase.ALL,\n    data: new InstanceProvider<EdgeInstance>(),\n    key: \"none\",\n    scaleType: EdgeScaleType.NONE,\n    scene: \"default\",\n    type: EdgeType.LINE\n  };\n\n  static attributeNames = {\n    start: \"start\",\n    end: \"end\",\n    widthStart: \"widthStart\",\n    widthEnd: \"widthEnd\",\n    depth: \"depth\",\n    colorStart: \"colorStart\",\n    colorEnd: \"colorEnd\",\n    control: \"control\"\n  };\n\n  /**\n   * We provide bounds and hit test information for the instances for this layer to allow for mouse picking\n   * of elements\n   */\n  getInstancePickingMethods(): IPickingMethods<EdgeInstance> {\n    return edgePicking(this.props);\n  }\n\n  /**\n   * Define our shader and it's inputs\n   */\n  initShader(): IShaderInitialization<EdgeInstance> {\n    const {\n      animate = {},\n      scaleFactor = () => 1,\n      type,\n      scaleType = EdgeScaleType.NONE\n    } = this.props;\n\n    const {\n      end: animateEnd,\n      start: animateStart,\n      colorStart: animateColorStart,\n      colorEnd: animateColorEnd,\n      control: animateControl\n    } = animate;\n\n    const MAX_SEGMENTS = type === EdgeType.LINE ? 2 : 50;\n\n    // Calculate the normals and interpolations for our vertices\n    const vertexToNormal: { [key: number]: number } = {\n      0: 1,\n      [MAX_SEGMENTS * 2 + 2]: -1\n    };\n\n    const vertexInterpolation: { [key: number]: number } = {\n      0: 0,\n      [MAX_SEGMENTS * 2 + 2]: 1\n    };\n\n    let sign = 1;\n    for (let i = 0; i < MAX_SEGMENTS * 2; ++i) {\n      vertexToNormal[i + 1] = sign;\n      vertexInterpolation[i + 1] = Math.floor(i / 2) / (MAX_SEGMENTS - 1);\n      sign *= -1;\n    }\n\n    const templateOptions = {\n      interpolation: pickVS[type]\n    };\n\n    const vs = shaderTemplate({\n      options: templateOptions,\n      required: {\n        name: \"Edge Layer\",\n        values: [\"interpolation\"]\n      },\n      shader: scaleType === EdgeScaleType.NONE ? baseVS : screenVS,\n\n      // We do not want to remove any other templating options present\n      onToken: (token, replace) => {\n        if (!(token in templateOptions)) {\n          return `$\\{${token}}`;\n        }\n\n        return replace;\n      }\n    });\n\n    return {\n      fs: edgeFS,\n      instanceAttributes: [\n        {\n          easing: animateStart,\n          name: EdgeLayer.attributeNames.start,\n          size: InstanceAttributeSize.TWO,\n          update: o => o.start\n        },\n        {\n          easing: animateEnd,\n          name: EdgeLayer.attributeNames.end,\n          size: InstanceAttributeSize.TWO,\n          update: o => o.end\n        },\n        {\n          name: EdgeLayer.attributeNames.widthStart,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.widthStart]\n        },\n        {\n          name: EdgeLayer.attributeNames.widthEnd,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.widthEnd]\n        },\n        {\n          name: EdgeLayer.attributeNames.depth,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.depth]\n        },\n        {\n          easing: animateColorStart,\n          name: EdgeLayer.attributeNames.colorStart,\n          size: InstanceAttributeSize.FOUR,\n          update: o => o.colorStart\n        },\n        {\n          easing: animateColorEnd,\n          name: EdgeLayer.attributeNames.colorEnd,\n          size: InstanceAttributeSize.FOUR,\n          update: o => o.colorEnd\n        },\n        type === EdgeType.LINE\n          ? {\n              easing: animateControl,\n              name: EdgeLayer.attributeNames.control,\n              size: InstanceAttributeSize.FOUR,\n              update: _o => [0, 0, 0, 0]\n            }\n          : null,\n        type === EdgeType.BEZIER\n          ? {\n              easing: animateControl,\n              name: EdgeLayer.attributeNames.control,\n              size: InstanceAttributeSize.FOUR,\n              update: o => [o.control[0][0], o.control[0][1], 0, 0]\n            }\n          : null,\n        type === EdgeType.BEZIER2\n          ? {\n              easing: animateControl,\n              name: EdgeLayer.attributeNames.control,\n              size: InstanceAttributeSize.FOUR,\n              update: o => toInstanceIOValue(o.control)\n            }\n          : null\n      ],\n      uniforms: [\n        {\n          name: \"scaleFactor\",\n          size: UniformSize.ONE,\n          update: (_uniform: IUniform) => [scaleFactor()]\n        },\n        {\n          name: \"layerOpacity\",\n          size: UniformSize.ONE,\n          update: (_uniform: IUniform) => [\n            this.props.opacity === undefined ? 1.0 : this.props.opacity\n          ]\n        }\n      ],\n      vertexAttributes: [\n        {\n          name: \"vertex\",\n          size: VertexAttributeSize.THREE,\n          update: (vertex: number) => [\n            // Normal\n            vertexToNormal[vertex],\n            // The side of the quad\n            vertexInterpolation[vertex],\n            // The number of vertices\n            MAX_SEGMENTS * 2\n          ]\n        }\n      ],\n      vertexCount: MAX_SEGMENTS * 2 + 2,\n      vs: vs.shader\n    };\n  }\n\n  getMaterialOptions(): ILayerMaterialOptions {\n    return CommonMaterialOptions.transparentShapeBlending;\n  }\n}\n","export * from \"./edge-layer\";\nexport * from \"./edge-instance\";\nexport * from \"./types\";\n","import { observable } from \"../../instance-provider\";\nimport { IInstanceOptions, Instance } from \"../../instance-provider/instance\";\nimport { Vec2 } from \"../../util\";\n\nexport interface ICircleInstanceOptions extends IInstanceOptions {\n  /** Center x position of the circle */\n  center: Vec2;\n  /** The radius of the circle */\n  radius: number;\n  /** The color of this circle */\n  color?: [number, number, number, number];\n  /** The z depth of the circle (for draw ordering) */\n  depth?: number;\n}\n\nexport class CircleInstance extends Instance {\n  @observable color: [number, number, number, number] = [1.0, 1.0, 1.0, 1.0];\n  @observable depth: number = 0;\n  @observable radius: number = 0;\n  @observable center: Vec2 = [0, 0];\n\n  constructor(options: ICircleInstanceOptions) {\n    super(options);\n\n    this.color = options.color || this.color;\n    this.radius = options.radius || this.radius;\n    this.center = options.center || this.center;\n    this.depth = options.depth || this.depth;\n  }\n\n  get width() {\n    return this.radius * 2;\n  }\n\n  get height() {\n    return this.radius * 2;\n  }\n}\n","module.exports = \"precision highp float;\\n\\n${import: projection}\\n\\nvarying vec4 vertexColor;\\nvarying float edgeSharpness;\\nvarying float edgeSharpnessBase;\\nvarying vec2 pointCoord;\\n\\n${extendHeader}\\n\\nvoid main() {\\n  ${attributes}\\n\\n  vertexColor = color;\\n  float size = radius * scaleFactor;\\n  edgeSharpness = mix(0.8, 0.0, min((size * 6.0 * pixelRatio) / (45.0 * pixelRatio), 1.0));\\n  edgeSharpnessBase = mix(0.1, 0.0, min((size * 6.0 * pixelRatio) / (45.0 * pixelRatio), 1.0));\\n  pointCoord = (normals.xy + vec2(1.0, 1.0)) / 2.0;\\n\\n  // Center within clip space\\n  vec4 clipCenter = clipSpace(vec3(center, depth));\\n  // Center in screen space\\n  vec2 screenCenter = (clipCenter.xy + vec2(1.0, 1.0)) * vec2(0.5, 0.5) * viewSize;\\n  // Position in screen space\\n  vec2 vertex = (normals.xy * size) + screenCenter;\\n  // Position back to clip space\\n  gl_Position = vec4((vertex / viewSize) * vec2(2.0, 2.0) - vec2(1.0, 1.0), clipCenter.zw);\\n\\n  ${extend}\\n}\\n\"","module.exports = \"precision highp float;\\n\\nvarying vec4 vertexColor;\\nvarying float edgeSharpness;\\nvarying float edgeSharpnessBase;\\nvarying vec2 pointCoord;\\n\\nfloat circle(vec2 coord, float radius){\\n  vec2 dist = coord - vec2(0.5);\\n\\n  return 1.0 - smoothstep(\\n    radius - (radius * edgeSharpness),\\n    radius + (radius * edgeSharpnessBase),\\n    dot(dist, dist) * 4.0\\n  );\\n}\\n\\n${extendHeader}\\n\\nvoid main() {\\n  float step_factor = circle(pointCoord.xy, 1.0);\\n\\n  setColor(mix(\\n    vec4(0.0, 0.0, 0.0, 0.0),\\n    vertexColor,\\n    step_factor\\n  ));\\n\\n  ${extend}\\n}\\n\"","import { add2, scale2, subtract2, Vec2 } from \"../util\";\n\n/**\n * Calculates the distance between two points, but keeps the distance in dquared form\n * thus performing Math.sqrt() on the output of this distance would provide the true\n * distance between the points.\n *\n * It is often faster and all that is needed to compare squared distances vs real distances\n * thus eliminating multiple Math.sqrt operations\n *\n * NOTE: For vectors this is the same as (pseudo code):\n * let vector3 = vector2.subtract(vector1)\n * return vector3.dot(vector3)\n *\n * @param p1 The point to find the distance from the second point\n * @param p2 The point to find the distance from the first point\n *\n * @return {number} The distance * distance between the two points\n */\nfunction squareDistance(p1: Vec2, p2: Vec2): number {\n  const delta = subtract2(p1, p2);\n  const dx = delta[0];\n  const dy = delta[1];\n\n  return dx * dx + dy * dy;\n}\n\n/**\n * Contains methods for managing or manipulating points\n *\n * @export\n * @class Point\n */\nexport class Point {\n  /**\n   * Adds two points together\n   *\n   * @static\n   * @param p1\n   * @param p2\n   * @param out If this is specified, the results will be placed into this rather than allocate a new object\n   *\n   * @return The two points added together\n   */\n  static add(p1: Vec2, p2: Vec2, out?: Vec2): Vec2 {\n    const total = add2(p1, p2);\n\n    if (out) {\n      out[0] = total[0];\n      out[1] = total[1];\n      return out;\n    }\n\n    return total;\n  }\n\n  /**\n   * @static\n   * This analyzes a test point against a list of points and determines which of the points is\n   * the closest to the test point. If there are equi-distant points in the list, this will return\n   * the first found in the list.\n   *\n   * @param testPoint The point to compare against other points\n   * @param points The list of points to be compared against\n   *\n   * @return The closest point to the test point\n   */\n  static getClosest(testPoint: Vec2, points: Vec2[]): Vec2 {\n    let closestDistance = Number.MAX_VALUE;\n    let closestPoint: Vec2 = testPoint;\n    let distance: number;\n\n    const findClosest = function(point: Vec2) {\n      distance = squareDistance(point, testPoint);\n\n      if (distance < closestDistance) {\n        closestDistance = distance;\n        closestPoint = point;\n      }\n    };\n\n    points.forEach(findClosest);\n\n    return closestPoint;\n  }\n\n  /**\n   * @static\n   * This analyzes a test point against a list of points and determines which of the points is\n   * the closest to the test point. If there are equi-distant points in the list, this will return\n   * the first found in the list.\n   *\n   * This just returns the index of the found point and not the point itself\n   *\n   * @param testPoint The point to compare against other points\n   * @param points The list of points to be compared against\n   *\n   * @return The index of the closest point to the test point\n   */\n  static getClosestIndex(testPoint: Vec2, points: Vec2[]): number {\n    let closestDistance = Number.MAX_VALUE;\n    let closestPoint: number = 0;\n    let distance: number;\n\n    const findClosest = function(point: Vec2, i: number) {\n      distance = squareDistance(point, testPoint);\n\n      if (distance < closestDistance) {\n        closestDistance = distance;\n        closestPoint = i;\n      }\n    };\n\n    points.forEach(findClosest);\n\n    return closestPoint;\n  }\n\n  /**\n   * @static\n   * This will calculate a direction vector between two points that points toward p2\n   *\n   * @param amount The start of the direction\n   * @param from The direction to point the vector towards\n   * @param normalize If true, this will make the vector have a magnitude of 1\n   */\n  static subtract(amount: Vec2, from: Vec2, normalize: boolean = false): Vec2 {\n    const delta = subtract2(from, amount);\n    let dx = delta[0];\n    let dy = delta[1];\n\n    if (normalize) {\n      const magnitude = Math.sqrt(dx * dx + dy * dy);\n      dx /= magnitude;\n      dy /= magnitude;\n    }\n\n    return [dx, dy];\n  }\n\n  /**\n   * @static\n   * Gets the distance between two points\n   *\n   * @param p1\n   * @param p2\n   * @param squared If set to true, returns the distance * distance (performs faster)\n   */\n  static getDistance(p1: Vec2, p2: Vec2, squared: boolean = false): number {\n    if (squared) {\n      return squareDistance(p1, p2);\n    }\n\n    return Math.sqrt(squareDistance(p1, p2));\n  }\n\n  /**\n   * @static\n   * Gets a point perfectly between two points\n   *\n   * @param p1\n   * @param p2\n   *\n   * @returns The point between the two provided points\n   */\n  static getMidpoint(p1: Vec2, p2: Vec2) {\n    const mid = scale2(subtract2(p2, p1), 0.5);\n\n    return add2(mid, p1);\n  }\n\n  static make(x: number, y: number) {\n    return { x, y };\n  }\n\n  /**\n   * Scales a point by a given amount\n   *\n   * @static\n   * @param p1\n   * @param s The amount to scale the point by\n   * @param out If this is specified, the results will be placed into this rather than allocate a new object\n   */\n  static scale(p1: Vec2, s: number, out?: Vec2): Vec2 {\n    if (out) {\n      out[0] = p1[0] * s;\n      out[1] = p1[1] * s;\n      return out;\n    }\n\n    return [p1[0] * s, p1[1] * s];\n  }\n\n  /**\n   * Makes a new point initialized to {0,0}\n   *\n   * @static\n   * @returns A new point object at {0,0}\n   */\n  static zero(): Vec2 {\n    return [0, 0];\n  }\n}\n","import { InstanceProvider } from \"../../instance-provider\";\nimport { Bounds } from \"../../primitives\";\nimport { ILayerProps, Layer } from \"../../surface/layer\";\nimport {\n  ILayerMaterialOptions,\n  InstanceAttributeSize,\n  IProjection,\n  IShaderInitialization,\n  IUniform,\n  UniformSize,\n  VertexAttributeSize\n} from \"../../types\";\nimport { CommonMaterialOptions, subtract2, Vec, Vec2 } from \"../../util\";\nimport { IAutoEasingMethod } from \"../../util/auto-easing-method\";\nimport { CircleInstance } from \"./circle-instance\";\n\nexport interface ICircleLayerProps<T extends CircleInstance>\n  extends ILayerProps<T> {\n  /** This sets the  */\n  fadeOutOversized?: number;\n  /** This sets a scaling factor for the circle's radius */\n  scaleFactor?(): number;\n  /** Opacity of the layer as a whole */\n  opacity?: number;\n  /**\n   * This is the properties that can toggle on animations.\n   *\n   * NOTE: The more properties declared as animated will reduce the performance of the layer.\n   * if animated properties are created, it can be beneficial to have other layers with no\n   * animations be available for the Instances to 'rest' in when not moving.\n   */\n  animate?: {\n    center?: IAutoEasingMethod<Vec>;\n    radius?: IAutoEasingMethod<Vec>;\n    color?: IAutoEasingMethod<Vec>;\n  };\n}\n\n/**\n * This layer displays circles and provides as many controls as possible for displaying\n * them in interesting ways.\n */\nexport class CircleLayer<\n  T extends CircleInstance,\n  U extends ICircleLayerProps<T>\n> extends Layer<T, U> {\n  static defaultProps: ICircleLayerProps<CircleInstance> = {\n    data: new InstanceProvider<CircleInstance>(),\n    fadeOutOversized: -1,\n    key: \"\",\n    scaleFactor: () => 1,\n    scene: \"default\"\n  };\n\n  static attributeNames = {\n    center: \"center\",\n    color: \"color\",\n    depth: \"depth\",\n    radius: \"radius\"\n  };\n\n  /**\n   * We provide bounds and hit test information for the instances for this layer to allow for mouse picking\n   * of elements\n   */\n  getInstancePickingMethods() {\n    const noScaleFactor = () => 1;\n\n    return {\n      // Provide the calculated AABB world bounds for a given circle\n      boundsAccessor: (circle: CircleInstance) =>\n        new Bounds({\n          height: circle.radius * 2,\n          width: circle.radius * 2,\n          x: circle.center[0] - circle.radius,\n          y: circle.center[1] - circle.radius\n        }),\n\n      // Provide a precise hit test for the circle\n      hitTest: (circle: CircleInstance, point: Vec2, view: IProjection) => {\n        const circleScreenCenter = view.worldToScreen(circle.center);\n        const mouseScreen = view.worldToScreen(point);\n        const r = circle.radius * (this.props.scaleFactor || noScaleFactor)();\n        const delta = subtract2(mouseScreen, circleScreenCenter);\n\n        return delta[0] * delta[0] + delta[1] * delta[1] < r * r;\n      }\n    };\n  }\n\n  /**\n   * Define our shader and it's inputs\n   */\n  initShader(): IShaderInitialization<CircleInstance> {\n    const scaleFactor = this.props.scaleFactor || (() => 1);\n    const animations = this.props.animate || {};\n    const {\n      center: animateCenter,\n      radius: animateRadius,\n      color: animateColor\n    } = animations;\n\n    const vertexToNormal: { [key: number]: number } = {\n      0: 1,\n      1: 1,\n      2: -1,\n      3: 1,\n      4: -1,\n      5: -1\n    };\n\n    const vertexToSide: { [key: number]: number } = {\n      0: -1,\n      1: -1,\n      2: -1,\n      3: 1,\n      4: 1,\n      5: 1\n    };\n\n    return {\n      fs: require(\"./circle-layer.fs\"),\n      instanceAttributes: [\n        {\n          easing: animateCenter,\n          name: CircleLayer.attributeNames.center,\n          size: InstanceAttributeSize.TWO,\n          update: circle => circle.center\n        },\n        {\n          easing: animateRadius,\n          name: CircleLayer.attributeNames.radius,\n          size: InstanceAttributeSize.ONE,\n          update: circle => [circle.radius]\n        },\n        {\n          name: CircleLayer.attributeNames.depth,\n          size: InstanceAttributeSize.ONE,\n          update: circle => [circle.depth]\n        },\n        {\n          easing: animateColor,\n          name: CircleLayer.attributeNames.color,\n          size: InstanceAttributeSize.FOUR,\n          update: circle => circle.color\n        }\n      ],\n      uniforms: [\n        {\n          name: \"scaleFactor\",\n          size: UniformSize.ONE,\n          update: (_uniform: IUniform) => [scaleFactor()]\n        },\n        {\n          name: \"layerOpacity\",\n          size: UniformSize.ONE,\n          update: (_uniform: IUniform) => [\n            this.props.opacity === undefined ? 1.0 : this.props.opacity\n          ]\n        }\n      ],\n      vertexAttributes: [\n        {\n          name: \"normals\",\n          size: VertexAttributeSize.TWO,\n          update: (vertex: number) => [\n            // Normal\n            vertexToNormal[vertex],\n            // The side of the quad\n            vertexToSide[vertex]\n          ]\n        }\n      ],\n      vertexCount: 6,\n      vs: require(\"./circle-layer.vs\")\n    };\n  }\n\n  getMaterialOptions(): ILayerMaterialOptions {\n    return CommonMaterialOptions.transparentShapeBlending;\n  }\n}\n","export * from \"./circle-layer\";\nexport * from \"./circle-instance\";\n","import { observable } from \"../../instance-provider\";\nimport { IInstanceOptions, Instance } from \"../../instance-provider/instance\";\nimport { Vec2, Vec4 } from \"../../util\";\n\nexport interface IArcInstanceOptions extends IInstanceOptions {\n  /** The start and end angle of the arc */\n  angle: Vec2;\n  /** The center point where the arc wraps around */\n  center: Vec2;\n  /** This is the end color of the arc */\n  colorEnd: Vec4;\n  /** This is the start color of the arc */\n  colorStart: Vec4;\n  /** Depth sorting of the arc (or the z value of the lable) */\n  depth: number;\n  /** The radius of how far the middle of the arc is from the center point */\n  radius: number;\n  /** The start to end thickness of the arc */\n  thickness: Vec2;\n}\n\n/**\n * This generates a new arc instance. An arc is a shape with a center and an angle that\n * is spans. This effectively can be used for a 'pie slice' or just the edge line on the pie\n * slice.\n */\nexport class ArcInstance extends Instance {\n  /** The start and end angle of the arc */\n  @observable angle: Vec2 = [0, Math.PI];\n  /** This is the end color of the arc */\n  @observable colorEnd: Vec4 = [0, 0, 0, 1];\n  /** This is the start color of the arc */\n  @observable colorStart: Vec4 = [0, 0, 0, 1];\n  /** The center point where the arc wraps around */\n  @observable center: Vec2 = [0, 0];\n  /** Depth sorting of the arc (or the z value of the lable) */\n  @observable depth: number = 0;\n  /** The radius of how far the middle of the arc is from the center point */\n  @observable radius: number = 1;\n  /** The start to end thickness of the arc */\n  @observable thickness: Vec2 = [1, 1];\n\n  constructor(options: IArcInstanceOptions) {\n    super(options);\n\n    this.angle = options.angle || this.angle;\n    this.colorEnd = options.colorEnd || this.colorEnd;\n    this.colorStart = options.colorStart || this.colorStart;\n    this.center = options.center || this.center;\n    this.depth = options.depth || this.depth;\n    this.radius = options.radius || this.radius;\n    this.thickness = options.thickness || this.thickness;\n  }\n}\n","module.exports = \"precision highp float;\\n\\nvarying vec4 vertexColor;\\n${extendHeader}\\n\\nvoid main() {\\n  setColor(vertexColor);\\n  ${extend}\\n}\\n\"","module.exports = \"precision highp float;\\n\\n/**\\n  This vertex shader calculates edges whose curve and width is in screen space where the curve is\\n  bezier curves with 0, 1, and 2 control points.\\n**/\\nvarying vec4 vertexColor;\\n\\nvec2 interpolation(float t, vec2 center, float radius, float start, float end) {\\n  float angle = (end - start) * t + start;\\n  return center + vec2(cos(angle) * radius, sin(angle) * radius);\\n}\\n\\n${extendHeader}\\n\\nvoid main() {\\n  ${attributes}\\n\\n  // Destructure some of the vec injections\\n  float startAngle = angle.x;\\n  float endAngle = angle.y;\\n  float widthStart = thickness.x;\\n  float widthEnd = thickness.y;\\n\\n  // Convert world points to screen space\\n  vec4 centerClip = clipSpace(vec3(center, depth));\\n  vec2 centerScreen = (centerClip.xy + vec2(1.0, 1.0)) * vec2(0.5, 0.5) * viewSize;\\n  // Destructure threejs's bug with the position requirement\\n  float normal = position.x;\\n  float interpolationTime = position.y;\\n  float interpolationIncrement = 1.0 / position.z;\\n  // Get the position of the current vertex\\n  vec2 currentPosition = interpolation(interpolationTime, centerScreen, radius, startAngle, endAngle);\\n  // Get normal with currentPosition and center\\n  vec2 currentNormal = normalize(currentPosition - centerScreen);\\n  // Get the thickness based on the side we're on\\n  float lineThickness = mix(widthStart, widthEnd, interpolationTime) / 2.0;\\n  // Start on the calculated line and push out by the normal's value\\n  vec2 vertex = currentPosition + currentNormal * (normal * lineThickness);\\n  // Get the color based on where we are on the line\\n  vertexColor = mix(colorStart, colorEnd, interpolationTime);\\n  vertexColor *= vertexColor.a;\\n\\n  gl_Position = vec4((vertex / viewSize) * vec2(2.0, 2.0) - vec2(1.0, 1.0), centerClip.zw);\\n  gl_PointSize = 5.0;\\n\\n  ${extend}\\n}\\n\"","module.exports = \"${import: arc, projection}\\nprecision highp float;\\n\\n/**\\n  This vertex shader calculates edges whose curve and width is in screen space where the curve is\\n  bezier curves with 0, 1, and 2 control points.\\n**/\\nvarying vec4 vertexColor;\\n\\n${extendHeader}\\n\\nvoid main() {\\n  ${attributes}\\n\\n  // Destructure some of the vec injections\\n  float startAngle = angle.x;\\n  float endAngle = angle.y;\\n  float widthStart = thickness.x;\\n  float widthEnd = thickness.y;\\n  // Destructure threejs's bug with the position requirement\\n  float normal = vertex.x;\\n  float interpolationTime = vertex.y;\\n  float interpolationIncrement = 1.0 / vertex.z;\\n  // Get the position of the current vertex\\n  vec2 currentPosition = arc(interpolationTime, center, radius, startAngle, endAngle);\\n  // Get normal with currentPosition and center\\n  vec2 currentNormal = normalize(currentPosition - center);\\n  // Get the thickness based on the side we're on\\n  float lineThickness = mix(widthStart, widthEnd, interpolationTime) / 2.0;\\n  // Start on the calculated line and push out by the normal's value\\n  vec2 vertex = currentPosition + currentNormal * (normal * lineThickness);\\n  // Get the color based on where we are on the line\\n  vertexColor = mix(colorStart, colorEnd, interpolationTime);\\n\\n  gl_Position = clipSpace(vec3(vertex, depth));\\n\\n  ${extend}\\n}\\n\"","import { Instance } from \"../../../instance-provider\";\nimport { IQuadTreePickingMetrics, PickType } from \"../../../types\";\nimport { BufferManagerBase, IBufferLocation } from \"../buffer-manager-base\";\nimport { IInstanceDiffManagerTarget } from \"../instance-diff-manager\";\nimport {\n  isUniformBufferLocation,\n  IUniformBufferLocation\n} from \"./uniform-buffer-manager\";\nimport { UniformDiffProcessor } from \"./uniform-diff-processor\";\n\nconst EMPTY: number[] = [];\n\n/**\n * Manages diffs for layers that are utilizing the base uniform instancing buffer strategy.\n */\nexport class UniformQuadDiffProcessor<\n  T extends Instance\n> extends UniformDiffProcessor<T> {\n  quadPicking: IQuadTreePickingMetrics<T>;\n\n  constructor(\n    layer: IInstanceDiffManagerTarget<T>,\n    bufferManager: BufferManagerBase<T, IBufferLocation>\n  ) {\n    super(layer, bufferManager);\n\n    if (layer.picking.type === PickType.ALL) {\n      this.quadPicking = layer.picking;\n    } else {\n      console.warn(\n        \"Diff Processing Error: A layer has a diff processor requesting Quad Processing but the picking type is not valid.\"\n      );\n    }\n  }\n\n  /**\n   * This processes add operations from changes in the instancing data and manages the layer's quad tree\n   * with the instance as well.\n   */\n  addInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    uniformCluster?: IUniformBufferLocation\n  ) {\n    // If the uniform cluster already exists, then we swap over to a change update\n    if (uniformCluster) {\n      manager.changeInstance(manager, instance, EMPTY, uniformCluster);\n    } else {\n      // Otherwise, we DO need to perform an add and we link a Uniform cluster to our instance\n      const uniforms = manager.layer.bufferManager.add(instance);\n\n      if (isUniformBufferLocation(uniforms)) {\n        instance.active = true;\n        instance.easingId = manager.layer.easingId;\n        manager.updateInstance(manager.layer, instance, uniforms);\n\n        // Ensure the instance has an updated injection in the quad tree\n        manager.quadPicking.quadTree.remove(instance);\n        manager.quadPicking.quadTree.add(instance);\n      }\n    }\n  }\n\n  /**\n   * This processes change operations from changes in the instancing data\n   */\n  changeInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    uniformCluster?: IUniformBufferLocation\n  ) {\n    // If there is an existing uniform cluster for this instance, then we can update the uniforms\n    if (uniformCluster) {\n      manager.updateInstance(manager.layer, instance, uniformCluster);\n\n      // Ensure the instance has an updated injection in the quad tree\n      manager.quadPicking.quadTree.remove(instance);\n      manager.quadPicking.quadTree.add(instance);\n    } else {\n      // If we don't have existing uniforms, then we must remove the instance\n      manager.addInstance(manager, instance, EMPTY, uniformCluster);\n    }\n  }\n\n  /**\n   * This processes remove operations from changes in the instancing data\n   */\n  removeInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    uniformCluster?: IUniformBufferLocation\n  ) {\n    if (uniformCluster) {\n      // We deactivate the instance so it does not render anymore\n      instance.active = false;\n      // Remove the easing information the instance gained from being apart of the layer\n      instance.clearEasing();\n      // We do one last update on the instance to update to it's deactivated state\n      manager.updateInstance(manager.layer, instance, uniformCluster);\n      // Unlink the instance from the uniform cluster\n      manager.layer.bufferManager.remove(instance);\n      // Remove the instance from our quad tree\n      manager.quadPicking.quadTree.remove(instance);\n    }\n  }\n}\n","import { Instance } from \"../../../instance-provider\";\nimport { ISinglePickingMetrics, PickType } from \"../../../types\";\nimport { BufferManagerBase, IBufferLocation } from \"../buffer-manager-base\";\nimport { IInstanceDiffManagerTarget } from \"../instance-diff-manager\";\nimport {\n  isUniformBufferLocation,\n  IUniformBufferLocation\n} from \"./uniform-buffer-manager\";\nimport { UniformDiffProcessor } from \"./uniform-diff-processor\";\n\nconst EMPTY: number[] = [];\n\n/**\n * Manages diffs for layers that are utilizing the base uniform instancing buffer strategy.\n */\nexport class UniformColorDiffProcessor<\n  T extends Instance\n> extends UniformDiffProcessor<T> {\n  colorPicking: ISinglePickingMetrics<T>;\n\n  constructor(\n    layer: IInstanceDiffManagerTarget<T>,\n    bufferManager: BufferManagerBase<T, IBufferLocation>\n  ) {\n    super(layer, bufferManager);\n\n    if (layer.picking.type === PickType.SINGLE) {\n      this.colorPicking = layer.picking;\n      this.colorPicking.uidToInstance = new Map<number, T>();\n    } else {\n      console.warn(\n        \"Diff Processing Error: A layer has a diff processor requesting Color Processing but the picking type is not valid.\"\n      );\n    }\n  }\n\n  /**\n   * This processes add operations from changes in the instancing data and manages the layer's matching of\n   * color / UID to Instance\n   */\n  addInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    uniformCluster: IUniformBufferLocation\n  ) {\n    // If the uniform cluster already exists, then we swap over to a change update\n    if (uniformCluster) {\n      manager.changeInstance(manager, instance, EMPTY, uniformCluster);\n    } else {\n      // Otherwise, we DO need to perform an add and we link a Uniform cluster to our instance\n      const uniforms = manager.layer.bufferManager.add(instance);\n\n      if (isUniformBufferLocation(uniforms)) {\n        instance.active = true;\n        instance.easingId = manager.layer.easingId;\n        manager.updateInstance(manager.layer, instance, uniforms);\n\n        // Make sure the instance is mapped to it's UID\n        manager.colorPicking.uidToInstance.set(instance.uid, instance);\n      } else {\n        console.warn(\n          \"A data cluster was not provided by the manager to associate an instance with.\"\n        );\n      }\n    }\n  }\n\n  /**\n   * This processes change operations from changes in the instancing data\n   */\n  changeInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    uniformCluster: IUniformBufferLocation\n  ) {\n    // If there is an existing uniform cluster for this instance, then we can update the uniforms\n    if (uniformCluster) {\n      manager.updateInstance(manager.layer, instance, uniformCluster);\n    } else {\n      // If we don't have existing uniforms, then we must remove the instance\n      manager.addInstance(manager, instance, EMPTY, uniformCluster);\n    }\n  }\n\n  /**\n   * This processes remove operations from changes in the instancing data\n   */\n  removeInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    uniformCluster: IUniformBufferLocation\n  ) {\n    if (uniformCluster) {\n      // We deactivate the instance so it does not render anymore\n      instance.active = false;\n      // Remove the easing information the instance gained from being apart of the layer\n      instance.clearEasing();\n      // We do one last update on the instance to update to it's deactivated state\n      manager.updateInstance(manager.layer, instance, uniformCluster);\n      // Unlink the instance from the uniform cluster\n      manager.layer.bufferManager.remove(instance);\n      // Remove the instance from our quad tree\n      manager.colorPicking.uidToInstance.delete(instance.uid);\n    }\n  }\n}\n","import { Instance } from \"../../../instance-provider\";\nimport { IQuadTreePickingMetrics, PickType } from \"../../../types\";\nimport {\n  BufferManagerBase,\n  IBufferLocation,\n  isBufferLocationGroup\n} from \"../buffer-manager-base\";\nimport { IInstanceDiffManagerTarget } from \"../instance-diff-manager\";\nimport { IInstanceAttributeBufferLocationGroup } from \"./instance-attribute-buffer-manager\";\nimport { InstanceAttributeDiffProcessor } from \"./instance-attribute-diff-processor\";\n\nconst EMPTY: number[] = [];\n\n/**\n * Manages diffs for layers that are utilizing the base uniform instancing buffer strategy.\n */\nexport class InstanceAttributeQuadDiffProcessor<\n  T extends Instance\n> extends InstanceAttributeDiffProcessor<T> {\n  quadPicking: IQuadTreePickingMetrics<T>;\n\n  constructor(\n    layer: IInstanceDiffManagerTarget<T>,\n    bufferManager: BufferManagerBase<T, IBufferLocation>\n  ) {\n    super(layer, bufferManager);\n\n    if (layer.picking.type === PickType.ALL) {\n      this.quadPicking = layer.picking;\n    } else {\n      console.warn(\n        \"Diff Processing Error: A layer has a diff processor requesting Quad Processing but the picking type is not valid.\"\n      );\n    }\n  }\n\n  /**\n   * This processes add operations from changes in the instancing data and manages the layer's quad tree\n   * with the instance as well.\n   */\n  addInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    bufferLocations?: IInstanceAttributeBufferLocationGroup\n  ) {\n    // If the uniform cluster already exists, then we swap over to a change update\n    if (bufferLocations) {\n      manager.changeInstance(manager, instance, EMPTY, bufferLocations);\n    } else {\n      // Otherwise, we DO need to perform an add and we link a Uniform cluster to our instance\n      const locations = manager.layer.bufferManager.add(instance);\n\n      if (isBufferLocationGroup(locations)) {\n        instance.active = true;\n        instance.easingId = manager.layer.easingId;\n        manager.updateInstance(manager.layer, instance, EMPTY, locations);\n\n        // Ensure the instance has an updated injection in the quad tree\n        manager.quadPicking.quadTree.remove(instance);\n        manager.quadPicking.quadTree.add(instance);\n      }\n    }\n  }\n\n  /**\n   * This processes change operations from changes in the instancing data\n   */\n  changeInstance(\n    manager: this,\n    instance: T,\n    propIds: number[],\n    bufferLocations?: IInstanceAttributeBufferLocationGroup\n  ) {\n    // If there is an existing uniform cluster for this instance, then we can update the uniforms\n    if (bufferLocations) {\n      manager.updateInstance(manager.layer, instance, propIds, bufferLocations);\n\n      // Ensure the instance has an updated injection in the quad tree\n      manager.quadPicking.quadTree.remove(instance);\n      manager.quadPicking.quadTree.add(instance);\n    } else {\n      // If we don't have existing uniforms, then we must remove the instance\n      manager.addInstance(manager, instance, EMPTY, bufferLocations);\n    }\n  }\n\n  /**\n   * This processes remove operations from changes in the instancing data\n   */\n  removeInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    bufferLocations?: IInstanceAttributeBufferLocationGroup\n  ) {\n    if (bufferLocations) {\n      // We deactivate the instance so it does not render anymore\n      instance.active = false;\n      // Remove the easing information the instance gained from being apart of the layer\n      instance.clearEasing();\n      // We do one last update on the instance to update to it's deactivated state\n      manager.updateInstance(manager.layer, instance, EMPTY, bufferLocations);\n      // Unlink the instance from the uniform cluster\n      manager.layer.bufferManager.remove(instance);\n      // Remove the instance from our quad tree\n      manager.quadPicking.quadTree.remove(instance);\n    }\n  }\n}\n","import { Instance } from \"../../../instance-provider\";\nimport { ISinglePickingMetrics, PickType } from \"../../../types\";\nimport {\n  BufferManagerBase,\n  IBufferLocation,\n  isBufferLocationGroup\n} from \"../buffer-manager-base\";\nimport { IInstanceDiffManagerTarget } from \"../instance-diff-manager\";\nimport { IInstanceAttributeBufferLocationGroup } from \"./instance-attribute-buffer-manager\";\nimport { InstanceAttributeDiffProcessor } from \"./instance-attribute-diff-processor\";\n\nconst EMPTY: number[] = [];\n\n/**\n * Manages diffs for layers that are utilizing the base uniform instancing buffer strategy.\n */\nexport class InstanceAttributeColorDiffProcessor<\n  T extends Instance\n> extends InstanceAttributeDiffProcessor<T> {\n  colorPicking: ISinglePickingMetrics<T>;\n\n  constructor(\n    layer: IInstanceDiffManagerTarget<T>,\n    bufferManager: BufferManagerBase<T, IBufferLocation>\n  ) {\n    super(layer, bufferManager);\n\n    if (layer.picking.type === PickType.SINGLE) {\n      this.colorPicking = layer.picking;\n      this.colorPicking.uidToInstance = new Map<number, T>();\n    } else {\n      console.warn(\n        \"Diff Processing Error: A layer has a diff processor requesting Color Processing but the picking type is not valid.\"\n      );\n    }\n  }\n\n  /**\n   * This processes add operations from changes in the instancing data and manages the layer's matching of\n   * color / UID to Instance\n   */\n  addInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    bufferLocations?: IInstanceAttributeBufferLocationGroup\n  ) {\n    // If the uniform cluster already exists, then we swap over to a change update\n    if (bufferLocations) {\n      manager.changeInstance(manager, instance, EMPTY, bufferLocations);\n    } else {\n      // Otherwise, we DO need to perform an add and we link a Uniform cluster to our instance\n      const locations = manager.layer.bufferManager.add(instance);\n\n      if (isBufferLocationGroup(locations)) {\n        instance.active = true;\n        instance.easingId = manager.layer.easingId;\n        manager.updateInstance(manager.layer, instance, EMPTY, locations);\n\n        // Make sure the instance is mapped to it's UID\n        manager.colorPicking.uidToInstance.set(instance.uid, instance);\n      } else {\n        console.warn(\n          \"A data cluster was not provided by the manager to associate an instance with.\"\n        );\n      }\n    }\n  }\n\n  /**\n   * This processes change operations from changes in the instancing data\n   */\n  changeInstance(\n    manager: this,\n    instance: T,\n    propIds: number[],\n    bufferLocations?: IInstanceAttributeBufferLocationGroup\n  ) {\n    // If there is an existing uniform cluster for this instance, then we can update the uniforms\n    if (bufferLocations) {\n      manager.updateInstance(manager.layer, instance, propIds, bufferLocations);\n    } else {\n      // If we don't have existing uniforms, then we must remove the instance\n      manager.addInstance(manager, instance, EMPTY, bufferLocations);\n    }\n  }\n\n  /**\n   * This processes remove operations from changes in the instancing data\n   */\n  removeInstance(\n    manager: this,\n    instance: T,\n    _propIds: number[],\n    bufferLocations?: IInstanceAttributeBufferLocationGroup\n  ) {\n    if (bufferLocations) {\n      // We deactivate the instance so it does not render anymore\n      instance.active = false;\n      // Remove the easing information the instance gained from being apart of the layer\n      instance.clearEasing();\n      // We do one last update on the instance to update to it's deactivated state\n      manager.updateInstance(manager.layer, instance, EMPTY, bufferLocations);\n      // Unlink the instance from the uniform cluster\n      manager.layer.bufferManager.remove(instance);\n      // Remove the instance from our quad tree\n      manager.colorPicking.uidToInstance.delete(instance.uid);\n    }\n  }\n}\n","import { Attribute, Geometry, Material, Model } from \"../../../gl\";\nimport { Instance, ObservableMonitoring } from \"../../../instance-provider\";\nimport {\n  IInstanceAttribute,\n  IInstanceAttributeInternal,\n  InstanceAttributeSize,\n  InstanceDiffType,\n  isResourceAttribute\n} from \"../../../types\";\nimport { uid } from \"../../../util\";\nimport { emitOnce, flushEmitOnce } from \"../../../util/emit-once\";\nimport { Layer } from \"../../layer\";\nimport { generateLayerModel } from \"../../layer-processing/generate-layer-model\";\nimport { LayerScene } from \"../../layer-scene\";\nimport {\n  BufferManagerBase,\n  IBufferLocation,\n  IBufferLocationGroup\n} from \"../buffer-manager-base\";\n\nconst { max } = Math;\nconst debug = require(\"debug\")(\"performance\");\n\n/**\n * This represents the location of data for an instance's property to the piece of attribute buffer\n * it will update when it changes.\n */\nexport interface IInstanceAttributePackingBufferLocation\n  extends IBufferLocation {}\n\n/** Represents the Location Groupings for Instance attribute Buffer locations */\nexport type IInstanceAttributePackingBufferLocationGroup = IBufferLocationGroup<\n  IInstanceAttributePackingBufferLocation\n>;\n\n/**\n * This manages instances in how they associate with buffer data for an instanced attribute strategy that is\n * packed tightly.\n */\nexport class InstanceAttributePackingBufferManager<\n  T extends Instance\n> extends BufferManagerBase<T, IInstanceAttributePackingBufferLocation> {\n  /** This stores an attribute's name to the buffer locations generated for it */\n  private allBufferLocations: { [key: string]: IBufferLocation[] } = {};\n  /** This contains the buffer locations the system will have available */\n  private availableLocations: IInstanceAttributePackingBufferLocationGroup[] = [];\n  /** This is the number of instances the buffer draws currently */\n  currentInstancedCount = 0;\n  /** This is the mapped buffer location to the provided Instance */\n  private instanceToBufferLocation: {\n    [key: number]: IInstanceAttributePackingBufferLocationGroup;\n  } = {};\n  /** This is the number of instances the buffer currently supports */\n  private maxInstancedCount: number = 1000;\n\n  // These are the only Three objects that must be monitored for disposal\n  private geometry?: Geometry;\n  private material?: Material;\n  private model?: Model;\n  private attributes?: IInstanceAttributeInternal<T>[];\n  private blockAttributes?: IInstanceAttributeInternal<T>[];\n  private blockSubAttributesLookup = new Map<number, IInstanceAttribute<T>[]>();\n\n  /** This is a mapping of all attributes to their associated property ids that, when the property changes, the attribute will be updated */\n  private attributeToPropertyIds = new Map<IInstanceAttribute<T>, number[]>();\n  /**\n   * This is a trimmed listing of minimum property ids needed to trigger an update on all properties.\n   * This is used by the diffing process mostly to handle adding a new instance.\n   */\n  private updateAllPropertyIdList: number[] = [];\n  /**\n   * This is the discovered property id of the active attribute for the instance type this manager manages.\n   * This is used by the diffing process to target updates related to deactivating an instance.\n   */\n  private activePropertyId: number = -1;\n\n  constructor(layer: Layer<T, any>, scene: LayerScene) {\n    super(layer, scene);\n    // Start our add method as a registration step.\n    this.add = this.doAddWithRegistration;\n  }\n\n  /**\n   * First instance to be added to this manager will be heavily analyzed for used observables per attribute.\n   */\n  private doAddWithRegistration(instance: T) {\n    // We need to find out how an instance interacts with the attributes, so we will\n    // loop through the instances, call their updates and get feedback\n    this.layer.instanceAttributes.forEach(attribute => {\n      // We don't need to register child attributes as they get updated as a consequence to parent attributes\n      if (attribute.parentAttribute) return;\n\n      // Make sure attribute context is set before performing update methods\n      if (isResourceAttribute(attribute)) {\n        this.layer.resource.setAttributeContext(\n          attribute,\n          attribute.resource.type\n        );\n      }\n\n      // Activate monitoring of ids, this also resets the monitor's list\n      ObservableMonitoring.setObservableMonitor(true);\n      // Access the update which accesses an instance's properties (usually)\n      attribute.update(instance);\n      // We now have all of the ids of the properties that were used in updating the attributes\n      const propertyIdsForAttribute = ObservableMonitoring.getObservableMonitorIds(\n        true\n      );\n      // Store the mapping of the property ids\n      this.attributeToPropertyIds.set(attribute, propertyIdsForAttribute);\n\n      // If this is the active attribute, then we track the property id that modifies it\n      // for handling internal instance management.\n      if (attribute === this.layer.activeAttribute) {\n        this.activePropertyId = propertyIdsForAttribute[0];\n      }\n    });\n\n    // SUPER IMPORTANT to deactivate this here. Leaving this turned on causes memory to be chewed up\n    // for every property getter.\n    ObservableMonitoring.setObservableMonitor(false);\n    // This analyzes the properties and how they affect the attributes. It determines the smallest\n    // list possible of property ids needed to trigger an update on all of the attributes.\n    this.makeUpdateAllPropertyIdList();\n    // Do the first resize which creates the buffer and makes all of the initial buffer locations\n    const locationInfo = this.resizeBuffer();\n    // After all of the property id to attribute associations are made, we must break down the buffers\n    // into locations and then group those locations which will become our instance to buffer location\n    // slots\n    this.gatherLocationsIntoGroups(\n      locationInfo.newLocations,\n      locationInfo.growth\n    );\n    // After the first registration add, we gear shift to a more efficient add method.\n    this.add = this.doAdd;\n\n    // Perform the add after all of the registration process is complete\n    return this.doAdd(instance);\n  }\n\n  /**\n   * After the registration add happens, we gear shift over to this add method which will only pair instances\n   * with their appropriate buffer location.\n   */\n  private doAdd(instance: T) {\n    // Ensure we have buffer locations available\n    if (this.availableLocations.length <= 0) {\n      // Resice the buffer to accommodate more instances\n      const locationInfo = this.resizeBuffer();\n      // Break down the newly generated buffers into property groupings for the instances\n      this.gatherLocationsIntoGroups(\n        locationInfo.newLocations,\n        locationInfo.growth\n      );\n    }\n\n    // Get the next available location\n    const bufferLocations = this.availableLocations.shift();\n\n    // Pair up the instance with it's buffer location\n    if (bufferLocations && this.geometry) {\n      this.instanceToBufferLocation[instance.uid] = bufferLocations;\n      this.currentInstancedCount = this.geometry.maxInstancedCount = max(\n        this.currentInstancedCount,\n        // Instance index + 1 because the indices are zero indexed and the maxInstancedCount is a count value\n        bufferLocations.instanceIndex + 1\n      );\n\n      if (this.model) {\n        this.model.vertexDrawRange = [0, this.layer.instanceVertexCount];\n        this.model.drawInstances = this.currentInstancedCount;\n      }\n    } else {\n      console.error(\n        \"Add Error: Instance Attribute Buffer Manager failed to pair an instance with a buffer location\"\n      );\n    }\n\n    return bufferLocations;\n  }\n\n  /**\n   * Destroy this manager and clear out all elements utilized within the scene.\n   */\n  destroy() {\n    if (this.geometry) this.geometry.dispose();\n    if (this.material) this.material.dispose();\n\n    if (this.scene && this.scene.container && this.model) {\n      this.scene.container.remove(this.model);\n    }\n  }\n\n  /**\n   * This retireves the buffer locations associated with an instance, or returns nothing\n   * if the instance has not been associated yet.\n   */\n  getBufferLocations(instance: T) {\n    return this.instanceToBufferLocation[instance.uid];\n  }\n\n  /**\n   * This is the property id of the active attribute.\n   */\n  getActiveAttributePropertyId() {\n    return this.activePropertyId;\n  }\n\n  /**\n   * This is the bare minimum property ids that, when triggered for update, will update ALL of the attribute buffers\n   * for the managed layer.\n   */\n  getUpdateAllPropertyIdList() {\n    return this.updateAllPropertyIdList;\n  }\n\n  /**\n   * Checks to see if this buffer manager manages the indicated instance\n   */\n  managesInstance(instance: T) {\n    return this.instanceToBufferLocation[instance.uid] !== undefined;\n  }\n\n  /**\n   * Analyzes the list of attributes to the property ids that affects them. This populates the list\n   * of minimal property ids needed to trigger updates on all of the attributes.\n   */\n  private makeUpdateAllPropertyIdList() {\n    // Make a deduping list of ids\n    const updateAllPropertyIdList: { [key: number]: number } = {};\n\n    // Get unique ids that will target all attributes\n    this.attributeToPropertyIds.forEach(ids => {\n      updateAllPropertyIdList[ids[0]] = ids[0];\n    });\n\n    // Store the list for the diffing process to utilize\n    this.updateAllPropertyIdList = Object.values(\n      updateAllPropertyIdList\n    ).filter(Boolean);\n  }\n\n  /**\n   * Disassociates an instance with a buffer\n   */\n  remove = (instance: T) => {\n    const location = this.instanceToBufferLocation[instance.uid];\n\n    if (location) {\n      delete this.instanceToBufferLocation[instance.uid];\n      this.availableLocations.push(location);\n    }\n\n    return instance;\n  };\n\n  /**\n   * Clears all elements of this manager from the current scene it was in.\n   */\n  removeFromScene() {\n    if (this.scene && this.scene.container && this.model) {\n      this.scene.container.remove(this.model);\n    }\n\n    delete this.scene;\n  }\n\n  /**\n   * This generates a new buffer of attributes to associate instances with.\n   *\n   * This method for the attribute packing strategy creates a vertex attribute for each block required.\n   * The individual properties are then packed into each of these blocks.\n   */\n  private resizeBuffer() {\n    let growth = 0;\n    // Each attribute will generate lists of new buffer locations after being created or expanded\n    const attributeToNewBufferLocations = new Map<\n      string,\n      IInstanceAttributePackingBufferLocation[]\n    >();\n\n    // As an optimization to guarantee the buffer is resized only a single time for a single changelist\n    // we  will calculate the necessary growth of the buffer by finding all of the insertions the changelist\n    // will cause.\n    if (this.changeListContext) {\n      // We will always grow beyond a 1000 units. That way there is room to prevent immediate resize operations\n      // from happening too frequently.\n      growth = 1000;\n\n      // We loop through all of the changes to find which operations will result in an additional unit\n      for (let i = 0, iMax = this.changeListContext.length; i < iMax; ++i) {\n        const diff = this.changeListContext[i];\n\n        switch (diff[1]) {\n          case InstanceDiffType.CHANGE:\n          case InstanceDiffType.INSERT:\n            // If the instance is not managed, it is a buffer growth\n            if (!this.instanceToBufferLocation[diff[0].uid]) growth++;\n            break;\n\n          default:\n            break;\n        }\n      }\n    }\n\n    // If our geometry is not created yet, then it need be made\n    if (!this.geometry) {\n      // The buffer grows from 0 to our initial instance count\n      this.maxInstancedCount += growth;\n      // We generate a new geometry object for the buffer as the geometry\n      // Needs to have it's own unique draw range per buffer for optimal\n      // Performance.\n      this.geometry = new Geometry();\n\n      // The geometry needs the vertex information (which should be shared amongst all instances of the layer)\n      // These are static non-dynamic buffers for the instance.\n      for (const attribute of this.layer.vertexAttributes) {\n        if (attribute.materialAttribute) {\n          this.geometry.addAttribute(\n            attribute.name,\n            attribute.materialAttribute\n          );\n        }\n      }\n\n      this.attributes = [];\n      this.blockAttributes = [];\n\n      // We have to determine how many blocks will be used to cram all of our instance properties into.\n      // So we calculate how big each block will be. The number of sizes calculated will be how manyblocks\n      // need to be generated.\n      const blockSizes = new Map<number, number>();\n      const blockSubAttributesLookup = new Map<\n        number,\n        IInstanceAttribute<T>[]\n      >();\n      this.blockSubAttributesLookup = blockSubAttributesLookup;\n\n      for (\n        let i = 0, iMax = this.layer.instanceAttributes.length;\n        i < iMax;\n        ++i\n      ) {\n        const attribute = this.layer.instanceAttributes[i];\n        const block = attribute.block || 0;\n        let blockSize = blockSizes.get(block) || 0;\n        // Determine the bigger of the block sizes (incoming attribute or previously checked attribute)\n        blockSize = Math.max(\n          blockSize,\n          (attribute.blockIndex || 0) + (attribute.size || 0)\n        );\n        // Store the larger size for the block\n        blockSizes.set(block, blockSize);\n        // We need to store all of the attributes associated with a block\n        let blockAttributes = blockSubAttributesLookup.get(block);\n\n        if (!blockAttributes) {\n          blockAttributes = [];\n          blockSubAttributesLookup.set(block, blockAttributes);\n        }\n\n        blockAttributes.push(attribute);\n      }\n\n      // Let's sort all of the attributes associated with each block by their index in the block\n      // so from here on out we can assume they are in ascending order\n      blockSubAttributesLookup.forEach(attributes =>\n        attributes.sort((a, b) => (a.blockIndex || 0) - (b.blockIndex || 0))\n      );\n\n      // Now that we have the blocks that will be needed to accommodate the attributes, we will\n      // create these blocks as attributes attached to the geometry.\n      for (let block = 0, iMax = blockSizes.size; block < iMax; ++block) {\n        // Get the size each attribute will be for the block\n        const blockSize: number = blockSizes.get(block) || 0;\n        // This is an interesting case, the attributes that are generated are packed into other attributes\n        // for optimal use of the vertex attributes allotted for a systems resources.\n        const blockAttributeUID = uid();\n\n        if (!blockSize) {\n          console.warn(\n            \"Instance Attribute Packing Error: The system tried to build an attribute with a size of zero.\",\n            \"These are the attributes used:\",\n            this.layer.instanceAttributes,\n            \"These are the block sizes calculated\",\n            blockSizes,\n            \"This is the block to attribute lookup generated\",\n            blockSubAttributesLookup\n          );\n        }\n\n        // Make our attribute buffer to accommodate all of the instances to be rendered.\n        const buffer = new Float32Array(blockSize * this.maxInstancedCount);\n        // Make an instanced buffer to take advantage of hardware instancing\n        const bufferAttribute = new Attribute(buffer, blockSize, true, true);\n\n        // Add the attribute to our geometry labeled as a block like the uniform block packing strategy\n        this.geometry.addAttribute(`block${block}`, bufferAttribute);\n\n        // Get all of the attributes that will be applied to this block\n        const blockSubAttributes = blockSubAttributesLookup.get(block);\n\n        if (blockSubAttributes) {\n          for (let k = 0, kMax = blockSubAttributes.length; k < kMax; ++k) {\n            const attribute = blockSubAttributes[k];\n\n            let newBufferLocations = attributeToNewBufferLocations.get(\n              attribute.name\n            );\n\n            if (!newBufferLocations) {\n              newBufferLocations = [];\n              attributeToNewBufferLocations.set(\n                attribute.name,\n                newBufferLocations\n              );\n            }\n\n            const allLocations = this.allBufferLocations[attribute.name] || [];\n            this.allBufferLocations[attribute.name] = allLocations;\n\n            const internalAttribute: IInstanceAttributeInternal<\n              T\n            > = Object.assign({}, attribute, {\n              uid: block,\n              packUID: blockAttributeUID,\n              bufferAttribute,\n              size: blockSize\n            });\n\n            const startAttributeIndex = attribute.blockIndex || 0;\n            const attributeSize = attribute.size || 1;\n\n            for (let i = 0; i < this.maxInstancedCount; ++i) {\n              const newLocation: IBufferLocation = {\n                attribute: internalAttribute,\n                block,\n                buffer: {\n                  value: buffer\n                },\n                instanceIndex: i,\n                range: [\n                  i * blockSize + startAttributeIndex,\n                  i * blockSize + startAttributeIndex + attributeSize\n                ]\n              };\n\n              newBufferLocations.push(newLocation);\n              allLocations.push(newLocation);\n            }\n\n            this.attributes.push(internalAttribute);\n          }\n\n          // Make an internal instance attribute for tracking\n          this.blockAttributes.push({\n            uid: uid(),\n            packUID: blockAttributeUID,\n            bufferAttribute,\n            name: `block${block}`,\n            size: InstanceAttributeSize.FOUR,\n            update: () => [0]\n          });\n        } else {\n          console.warn(\n            \"Instance Attribute Packing Buffer Error: Somehow there are no attributes associated with a block.\",\n            \"These are the attributes used:\",\n            this.layer.instanceAttributes,\n            \"These are the block sizes calculated\",\n            blockSizes,\n            \"This is the block to attribute lookup generated\",\n            blockSubAttributesLookup\n          );\n        }\n      }\n\n      // Ensure the draw range covers every instance in the geometry.\n      this.geometry.maxInstancedCount = 0;\n      // This is the material that is generated for the layer that utilizes all of the generated and\n      // Injected shader IO and shader fragments\n      this.material = this.layer.material.clone();\n\n      // Grab the global uniforms from the material and add it to the uniform's materialUniform list so that\n      // We can keep uniforms consistent across all Instances\n      for (let i = 0, end = this.layer.uniforms.length; i < end; ++i) {\n        const uniform = this.layer.uniforms[i];\n        uniform.materialUniforms.push(this.material.uniforms[uniform.name]);\n      }\n    } else {\n      debug(\n        `Info: Vertex packing buffer is being resized for layer ${\n          this.layer.id\n        }`\n      );\n      // If the geometry is already created, then we will expand each instanced attribute to the next growth\n      // level and generate the new buffer locations based on the expansion\n      // Since were are resizing the buffer, let's destroy the old buffer and make one anew\n      this.geometry.dispose();\n      this.geometry = new Geometry();\n      const previousInstanceAmount = this.maxInstancedCount;\n\n      // The geometry needs the vertex information (which should be shared amongst all instances of the layer)\n      for (const attribute of this.layer.vertexAttributes) {\n        if (attribute.materialAttribute) {\n          this.geometry.addAttribute(\n            attribute.name,\n            attribute.materialAttribute\n          );\n        }\n      }\n\n      this.maxInstancedCount += growth;\n\n      // Ensure attributes is still defined\n      this.attributes = this.attributes || [];\n      this.blockAttributes = this.blockAttributes || [];\n\n      for (\n        let block = 0, iMax = this.blockAttributes.length;\n        block < iMax;\n        ++block\n      ) {\n        const attribute = this.blockAttributes[block];\n        let bufferAttribute = attribute.bufferAttribute;\n        const size: number = attribute.size || 0;\n\n        if (bufferAttribute.data instanceof Float32Array) {\n          // Make a new buffer that is the proper size\n          const buffer: Float32Array = new Float32Array(\n            this.maxInstancedCount * size\n          );\n          // Retain all of the information in the previous buffer\n          buffer.set(bufferAttribute.data, 0);\n          // Make our new attribute based on the grown buffer\n          const newAttribute = new Attribute(buffer, size, true, true);\n          // Make sure our attribute is updated with the newly made attribute\n          attribute.bufferAttribute = bufferAttribute = newAttribute;\n          // Add the new attribute to our new geometry object\n          this.geometry.addAttribute(attribute.name, newAttribute);\n\n          // Since we have a new buffer object we are working with, we must update all of the existing buffer\n          // locations to utilize this new buffer. The locations keep everything else the same, but the buffer\n          // object itself should be updated\n          // Get all of the attributes that will be applied to this block\n          const blockSubAttributes = this.blockSubAttributesLookup.get(block);\n          const blockSize = attribute.size || 0;\n\n          if (blockSubAttributes) {\n            for (let k = 0, kMax = blockSubAttributes.length; k < kMax; ++k) {\n              const subAttribute = blockSubAttributes[k];\n\n              let newBufferLocations = attributeToNewBufferLocations.get(\n                subAttribute.name\n              );\n\n              if (!newBufferLocations) {\n                newBufferLocations = [];\n                attributeToNewBufferLocations.set(\n                  subAttribute.name,\n                  newBufferLocations\n                );\n              }\n\n              const allLocations =\n                this.allBufferLocations[subAttribute.name] || [];\n              this.allBufferLocations[subAttribute.name] = allLocations;\n\n              const internalAttribute: IInstanceAttributeInternal<\n                T\n              > = Object.assign({}, subAttribute, {\n                uid: uid(),\n                packUID: attribute.packUID,\n                bufferAttribute\n              });\n\n              const startAttributeIndex = subAttribute.blockIndex || 0;\n              const attributeSize = subAttribute.size || 1;\n\n              // Update all existing attribute locations with the new internal attribute and new buffer\n              for (let j = 0, jMax = allLocations.length; j < jMax; ++j) {\n                const location = allLocations[j];\n                location.attribute = internalAttribute;\n                location.buffer = {\n                  value: buffer\n                };\n              }\n\n              // Create new locations for each new instance we will cover\n              for (\n                let i = previousInstanceAmount;\n                i < this.maxInstancedCount;\n                ++i\n              ) {\n                const newLocation: IBufferLocation = {\n                  attribute: internalAttribute,\n                  block,\n                  buffer: {\n                    value: buffer\n                  },\n                  instanceIndex: i,\n                  range: [\n                    i * blockSize + startAttributeIndex,\n                    i * blockSize + startAttributeIndex + attributeSize\n                  ]\n                };\n\n                newBufferLocations.push(newLocation);\n                allLocations.push(newLocation);\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Remove any existing model\n    if (this.scene && this.model && this.scene.container) {\n      this.scene.container.remove(this.model);\n    }\n\n    // Ensure material is defined\n    this.material = this.material || this.layer.material.clone();\n    // Remake the model with the generated geometry\n    this.model = generateLayerModel(\n      this.geometry,\n      this.material,\n      this.layer.model.drawMode\n    );\n\n    // Now that we are ready to utilize the buffer, let's add it to the scene so it may be rendered.\n    // Each new buffer equates to one draw call.\n    if (this.scene && this.scene.container && this.model) {\n      this.scene.container.add(this.model);\n    }\n\n    return {\n      growth,\n      newLocations: attributeToNewBufferLocations\n    };\n  }\n\n  /**\n   * This takes newly created buffer locations and groups them by the property ids identified by the\n   * registration phase.\n   */\n  private gatherLocationsIntoGroups(\n    attributeToNewBufferLocations: Map<\n      string,\n      IInstanceAttributePackingBufferLocation[]\n    >,\n    totalNewInstances: number\n  ) {\n    if (this.attributeToPropertyIds.size === 0) return;\n\n    // Optimize inner loops by pre-fetching lookups by names\n    const attributesBufferLocations: {\n      attribute: IInstanceAttribute<T>;\n      bufferLocationsForAttribute: IInstanceAttributePackingBufferLocation[];\n      childBufferLocations: IInstanceAttributePackingBufferLocation[][];\n      ids: number[];\n      bufferIndex: number;\n    }[] = [];\n\n    this.attributeToPropertyIds.forEach((ids, attribute) => {\n      attributesBufferLocations.push({\n        attribute,\n        bufferLocationsForAttribute:\n          attributeToNewBufferLocations.get(attribute.name) || [],\n        childBufferLocations: (attribute.childAttributes || []).map(\n          attr => attributeToNewBufferLocations.get(attr.name) || []\n        ),\n        ids,\n        bufferIndex: -1\n      });\n    });\n\n    // Loop through all of the new instances available and gather all of the buffer locations\n    for (let i = 0; i < totalNewInstances; ++i) {\n      const group: IInstanceAttributePackingBufferLocationGroup = {\n        instanceIndex: -1,\n        propertyToBufferLocation: {}\n      };\n\n      // Loop through all of the property ids that affect specific attributes. Each of these ids\n      // needs an association with the buffer location they modify.\n      for (let j = 0, endj = attributesBufferLocations.length; j < endj; ++j) {\n        const allLocations = attributesBufferLocations[j];\n        const attribute = allLocations.attribute;\n        const ids = allLocations.ids;\n        const bufferLocationsForAttribute =\n          allLocations.bufferLocationsForAttribute;\n\n        if (!bufferLocationsForAttribute) {\n          emitOnce(\n            \"Instance Attribute Buffer Error\",\n            (count: number, id: string) => {\n              console.warn(\n                `${id}: There is an error in forming buffer location groups in InstanceAttributePackingBufferManager. Error count: ${count}`\n              );\n            }\n          );\n          continue;\n        }\n\n        const bufferLocation =\n          bufferLocationsForAttribute[++allLocations.bufferIndex];\n\n        if (!bufferLocation) {\n          emitOnce(\n            \"Instance Attribute Buffer Error\",\n            (count: number, id: string) => {\n              console.warn(\n                `${id}: There is an error in forming buffer location groups in InstanceAttributePackingBufferManager. Error count: ${count}`\n              );\n            }\n          );\n          continue;\n        }\n\n        if (group.instanceIndex === -1) {\n          group.instanceIndex = bufferLocation.instanceIndex;\n        } else if (bufferLocation.instanceIndex !== group.instanceIndex) {\n          emitOnce(\n            \"Instance Attribute Parallelism Error\",\n            (count: number, id: string) => {\n              console.warn(\n                `${id}: A buffer location does not have a matching instance index which means the buffer locations are not in parallel with each other somehow. Error count: ${count}`\n              );\n              console.warn(attribute.name, bufferLocation);\n            }\n          );\n          continue;\n        }\n\n        // If the attribute has children attributes. Then when the attribute is updated, the child attributes should\n        // be updated as well. Thus the buffer location needs the child attribute buffer locations.\n        if (attribute.childAttributes) {\n          const childLocations = [];\n\n          for (\n            let k = 0, endk = attribute.childAttributes.length;\n            k < endk;\n            ++k\n          ) {\n            const childAttribute = attribute.childAttributes[k];\n            const bufferLocationsForChildAttribute =\n              allLocations.childBufferLocations[k];\n\n            if (bufferLocationsForChildAttribute) {\n              const childBufferLocation = bufferLocationsForChildAttribute.shift();\n              if (childBufferLocation) {\n                childLocations.push(childBufferLocation);\n              } else {\n                emitOnce(\n                  \"Instance Attribute Child Attribute Error\",\n                  (count: number, id: string) => {\n                    console.warn(\n                      `${id}: A child attribute does not have a buffer location available. Error count: ${count}`\n                    );\n                    console.warn(\n                      `Parent Attribute: ${attribute.name} Child Attribute: ${\n                        childAttribute.name\n                      }`\n                    );\n                  }\n                );\n              }\n            }\n          }\n\n          bufferLocation.childLocations = childLocations;\n        }\n\n        // In the group, associate the property ids that affect a buffer location WITH the buffer location they affect\n        for (let k = 0, endk = ids.length; k < endk; ++k) {\n          const id = ids[k];\n          group.propertyToBufferLocation[id] = bufferLocation;\n        }\n      }\n\n      // Store this group as a group that is ready to be associated with an instance\n      this.availableLocations.push(group);\n    }\n\n    // This helps ensure errors get reported in a timely fashion in case this triggers some massive looping\n    flushEmitOnce();\n  }\n\n  /**\n   * Returns the total instances this buffer manages.\n   */\n  getInstanceCount() {\n    return this.maxInstancedCount;\n  }\n}\n","\"use strict\";\n\nimport { Attribute, Geometry, Material, Model } from \"../../../gl\";\nimport { Instance, ObservableMonitoring } from \"../../../instance-provider\";\nimport {\n  IInstanceAttribute,\n  IInstanceAttributeInternal,\n  InstanceDiffType,\n  isResourceAttribute\n} from \"../../../types\";\nimport { emitOnce, flushEmitOnce } from \"../../../util/emit-once\";\nimport { uid } from \"../../../util/uid\";\nimport { Layer } from \"../../layer\";\nimport { generateLayerModel } from \"../../layer-processing/generate-layer-model\";\nimport { LayerScene } from \"../../layer-scene\";\nimport {\n  BufferManagerBase,\n  IBufferLocation,\n  IBufferLocationGroup\n} from \"../buffer-manager-base\";\n\nconst debug = require(\"debug\")(\"performance\");\nconst { max } = Math;\n\n/**\n * This represents the location of data for an instance's property to the piece of attribute buffer\n * it will update when it changes.\n */\nexport interface IInstanceAttributeBufferLocation extends IBufferLocation {\n  /** We narrow the buffer type for instance attributes down to just array buffers */\n  buffer: {\n    value: Float32Array | Uint8Array;\n  };\n\n  /** We narrow the chaild locations to be the same as this buffer location */\n  childLocations?: IInstanceAttributeBufferLocation[];\n}\n\n/** Represents the Location Groupings for Instance attribute Buffer locations */\nexport type IInstanceAttributeBufferLocationGroup = IBufferLocationGroup<\n  IInstanceAttributeBufferLocation\n>;\n\n/**\n * Typeguard for the instance attribute buffer location.\n */\nexport function isInstanceAttributeBufferLocation(\n  val: IBufferLocation\n): val is IInstanceAttributeBufferLocation {\n  return Boolean(val && val.buffer && val.buffer.value);\n}\n\n/**\n * This manages instances in how they associate with buffer data for an instanced attribute strategy.\n */\nexport class InstanceAttributeBufferManager<\n  T extends Instance\n> extends BufferManagerBase<T, IInstanceAttributeBufferLocation> {\n  /** This stores an attribute's name to the buffer locations generated for it */\n  private allBufferLocations: { [key: string]: IBufferLocation[] } = {};\n  /** This contains the buffer locations the system will have available */\n  private availableLocations: IInstanceAttributeBufferLocationGroup[] = [];\n  /** This is the number of instances the buffer draws currently */\n  currentInstancedCount = 0;\n  /** This is the mapped buffer location to the provided Instance */\n  private instanceToBufferLocation: {\n    [key: number]: IInstanceAttributeBufferLocationGroup;\n  } = {};\n  /** This is the number of instances the buffer currently supports */\n  private maxInstancedCount: number = 0;\n\n  // These are the only Three objects that must be monitored for disposal\n  private geometry?: Geometry;\n  private material?: Material;\n  private model?: Model;\n  private attributes?: IInstanceAttributeInternal<T>[];\n\n  /** This is a mapping of all attributes to their associated property ids that, when the property changes, the attribute will be updated */\n  private attributeToPropertyIds = new Map<IInstanceAttribute<T>, number[]>();\n  /**\n   * This is a trimmed listing of minimum property ids needed to trigger an update on all properties.\n   * This is used by the diffing process mostly to handle adding a new instance.\n   */\n  private updateAllPropertyIdList: number[] = [];\n  /**\n   * This is the discovered property id of the active attribute for the instance type this manager manages.\n   * This is used by the diffing process to target updates related to deactivating an instance.\n   */\n  private activePropertyId: number = -1;\n\n  constructor(layer: Layer<T, any>, scene: LayerScene) {\n    super(layer, scene);\n    // Start our add method as a registration step.\n    this.add = this.doAddWithRegistration;\n  }\n\n  /**\n   * First instance to be added to this manager will be heavily analyzed for used observables per attribute.\n   */\n  private doAddWithRegistration(instance: T) {\n    // We need to find out how an instance interacts with the attributes, so we will\n    // loop through the instances, call their updates and get feedback\n    this.layer.instanceAttributes.forEach(attribute => {\n      // We don't need to register child attributes as they get updated as a consequence to parent attributes\n      if (attribute.parentAttribute) return;\n\n      // Make sure attribute context is set before performing update methods\n      if (isResourceAttribute(attribute)) {\n        this.layer.resource.setAttributeContext(\n          attribute,\n          attribute.resource.type\n        );\n      }\n\n      // Activate monitoring of ids, this also resets the monitor's list\n      ObservableMonitoring.setObservableMonitor(true);\n      // Access the update which accesses an instances properties (usually)\n      attribute.update(instance);\n      // We now have all of the ids of the properties that were used in updating the attributes\n      const propertyIdsForAttribute = ObservableMonitoring.getObservableMonitorIds(\n        true\n      );\n      // Store the mapping of the property ids\n      this.attributeToPropertyIds.set(attribute, propertyIdsForAttribute);\n\n      // If this is the active attribute, then we track the property id that modifies it\n      // for handling internal instance management.\n      if (attribute === this.layer.activeAttribute) {\n        this.activePropertyId = propertyIdsForAttribute[0];\n      }\n    });\n\n    // SUPER IMPORTANT to deactivate this here. Leaving this turned on causes memory to be chewed up\n    // for every property getter.\n    ObservableMonitoring.setObservableMonitor(false);\n    // This analyzes the properties and how they affect the attributes. It determines the smallest\n    // list possible of property ids needed to trigger an update on all of the attributes.\n    this.makeUpdateAllPropertyIdList();\n    // Do the first resize which creates the buffer and makes all of the initial buffer locations\n    const locationInfo = this.resizeBuffer();\n    // After all of the property id to attribute associations are made, we must break down the buffers\n    // into locations and then group those locations which will become our instance to buffer location\n    // slots\n    this.gatherLocationsIntoGroups(\n      locationInfo.newLocations,\n      locationInfo.growth\n    );\n    // After the first registration add, we gear shift to a more efficient add method.\n    this.add = this.doAdd;\n\n    // Perform the add after all of the registration process is complete\n    return this.doAdd(instance);\n  }\n\n  /**\n   * After the registration add happens, we gear shift over to this add method which will only pair instances\n   * with their appropriate buffer location.\n   */\n  private doAdd(instance: T) {\n    // Ensure we have buffer locations available\n    if (this.availableLocations.length <= 0) {\n      // Resice the buffer to accommodate more instances\n      const locationInfo = this.resizeBuffer();\n      // Break down the newly generated buffers into property groupings for the instances\n      this.gatherLocationsIntoGroups(\n        locationInfo.newLocations,\n        locationInfo.growth\n      );\n    }\n\n    // Get the next available location\n    const bufferLocations = this.availableLocations.shift();\n\n    // Pair up the instance with it's buffer location\n    if (bufferLocations && this.geometry) {\n      this.instanceToBufferLocation[instance.uid] = bufferLocations;\n      this.currentInstancedCount = this.geometry.maxInstancedCount = max(\n        this.currentInstancedCount,\n        // Instance index + 1 because the indices are zero indexed and the maxInstancedCount is a count value\n        bufferLocations.instanceIndex + 1\n      );\n\n      if (this.model) {\n        this.model.vertexDrawRange = [0, this.layer.instanceVertexCount];\n        this.model.drawInstances = this.currentInstancedCount;\n      }\n    } else {\n      console.error(\n        \"Add Error: Instance Attribute Buffer Manager failed to pair an instance with a buffer location\"\n      );\n    }\n\n    return bufferLocations;\n  }\n\n  /**\n   * Free any buffer and material resources this is managing.\n   */\n  destroy() {\n    if (this.geometry) this.geometry.dispose();\n    if (this.material) this.material.dispose();\n\n    if (this.scene && this.scene.container && this.model) {\n      this.scene.container.remove(this.model);\n    }\n  }\n\n  /**\n   * This retireves the buffer locations associated with an instance, or returns nothing\n   * if the instance has not been associated yet.\n   */\n  getBufferLocations(instance: T) {\n    return this.instanceToBufferLocation[instance.uid];\n  }\n\n  /**\n   * This is the property id of the active attribute.\n   */\n  getActiveAttributePropertyId() {\n    return this.activePropertyId;\n  }\n\n  /**\n   * This is the bare minimum property ids that, when triggered for update, will update ALL of the attribute buffers\n   * for the managed layer.\n   */\n  getUpdateAllPropertyIdList() {\n    return this.updateAllPropertyIdList;\n  }\n\n  /**\n   * Checks to see if an instance is managed by this manager.\n   */\n  managesInstance(instance: T) {\n    // We know this instance is managed if the instance has buffer location real estate assigned to it\n    return this.instanceToBufferLocation[instance.uid] !== undefined;\n  }\n\n  /**\n   * Analyzes the list of attributes to the property ids that affects them. This populates the list\n   * of minimal property ids needed to trigger updates on all of the attributes.\n   */\n  private makeUpdateAllPropertyIdList() {\n    // Make a deduping list of ids\n    const updateAllPropertyIdList: { [key: number]: number } = {};\n\n    // Get unique ids that will target all attributes\n    this.attributeToPropertyIds.forEach(ids => {\n      updateAllPropertyIdList[ids[0]] = ids[0];\n    });\n\n    // Store the list for the diffing process to utilize\n    this.updateAllPropertyIdList = Object.values(\n      updateAllPropertyIdList\n    ).filter(Boolean);\n  }\n\n  /**\n   * Disassociates an instance with a buffer\n   */\n  remove = (instance: T) => {\n    const location = this.instanceToBufferLocation[instance.uid];\n\n    if (location) {\n      delete this.instanceToBufferLocation[instance.uid];\n      this.availableLocations.push(location);\n    }\n\n    return instance;\n  };\n\n  /**\n   * Clears all elements of this manager from the current scene it was in.\n   */\n  removeFromScene() {\n    if (this.scene && this.scene.container && this.model) {\n      this.scene.container.remove(this.model);\n    }\n\n    delete this.scene;\n  }\n\n  /**\n   * This generates a new buffer of uniforms to associate instances with.\n   */\n  private resizeBuffer() {\n    let growth = 0;\n    // Each attribute will generate lists of new buffer locations after being created or expanded\n    const attributeToNewBufferLocations = new Map<\n      string,\n      IInstanceAttributeBufferLocation[]\n    >();\n\n    // As an optimization to guarantee the buffer is resized only a single time for a single changelist\n    // we  will calculate the necessary growth of the buffer by finding all of the insertions the changelist\n    // will cause.\n    if (this.changeListContext) {\n      // We will always grow beyond a 1000 units. That way there is room to prevent immediate resize operations\n      // from happening too frequently.\n      growth = 1000;\n\n      // We loop through all of the changes to find which operations will result in an additional unit\n      for (let i = 0, iMax = this.changeListContext.length; i < iMax; ++i) {\n        const diff = this.changeListContext[i];\n\n        switch (diff[1]) {\n          case InstanceDiffType.CHANGE:\n          case InstanceDiffType.INSERT:\n            // If the instance is not managed, it is a buffer growth\n            if (!this.instanceToBufferLocation[diff[0].uid]) growth++;\n            break;\n\n          default:\n            break;\n        }\n      }\n    }\n\n    debug(\"BEGIN: Resizing unpacked attribute buffer by %d instances\", growth);\n\n    // If our geometry is not created yet, then it need be made\n    if (!this.geometry) {\n      // The buffer grows from 0 to our initial instance count\n      this.maxInstancedCount += growth;\n      // We generate a new geometry object for the buffer as the geometry\n      // Needs to have it's own unique draw range per buffer for optimal\n      // Performance.\n      this.geometry = new Geometry();\n\n      // The geometry needs the vertex information (which should be shared amongst all instances of the layer)\n      for (const attribute of this.layer.vertexAttributes) {\n        if (attribute.materialAttribute) {\n          this.geometry.addAttribute(\n            attribute.name,\n            attribute.materialAttribute\n          );\n        }\n      }\n\n      this.attributes = [];\n\n      // We now take the instance attributes and add them as Instanced Attributes to our geometry\n      for (const attribute of this.layer.instanceAttributes) {\n        // We start with enough data in the buffer to accommodate 1024 instances\n        const size: number = attribute.size || 0;\n        const buffer = new Float32Array(size * this.maxInstancedCount);\n        const bufferAttribute = new Attribute(buffer, size, true, true);\n        bufferAttribute.setDynamic(true);\n        this.geometry.addAttribute(attribute.name, bufferAttribute);\n        let newBufferLocations = attributeToNewBufferLocations.get(\n          attribute.name\n        );\n\n        if (!newBufferLocations) {\n          newBufferLocations = [];\n          attributeToNewBufferLocations.set(attribute.name, newBufferLocations);\n        }\n\n        const allLocations = this.allBufferLocations[attribute.name] || [];\n        this.allBufferLocations[attribute.name] = allLocations;\n\n        const internalAttribute: IInstanceAttributeInternal<T> = Object.assign(\n          {},\n          attribute,\n          { uid: uid(), bufferAttribute: bufferAttribute }\n        );\n\n        for (let i = 0; i < this.maxInstancedCount; ++i) {\n          const newLocation: IInstanceAttributeBufferLocation = {\n            attribute: internalAttribute,\n            buffer: {\n              value: buffer\n            },\n            instanceIndex: i,\n            range: [i * size, i * size + size]\n          };\n\n          newBufferLocations.push(newLocation);\n          allLocations.push(newLocation);\n        }\n\n        // Make an internal instance attribute for tracking\n        this.attributes.push(internalAttribute);\n      }\n\n      // Ensure the draw range covers every instance in the geometry.\n      this.geometry.maxInstancedCount = 0;\n      // This is the material that is generated for the layer that utilizes all of the generated and\n      // Injected shader IO and shader fragments\n      this.material = this.layer.material.clone();\n\n      // Grab the global uniforms from the material and add it to the uniform's materialUniform list so that\n      // We can keep uniforms consistent across all Instances\n      for (let i = 0, end = this.layer.uniforms.length; i < end; ++i) {\n        const uniform = this.layer.uniforms[i];\n        uniform.materialUniforms.push(this.material.uniforms[uniform.name]);\n      }\n    } else {\n      // If the geometry is already created, then we will expand each instanced attribute to the next growth\n      // level and generate the new buffer locations based on the expansion\n      // Since were are resizing the buffer, let's destroy the old buffer and make one anew\n      this.geometry.dispose();\n      this.geometry = new Geometry();\n      const previousInstanceAmount = this.maxInstancedCount;\n\n      // The geometry needs the vertex information (which should be shared amongst all instances of the layer)\n      for (const attribute of this.layer.vertexAttributes) {\n        if (attribute.materialAttribute) {\n          this.geometry.addAttribute(\n            attribute.name,\n            attribute.materialAttribute\n          );\n        }\n      }\n\n      this.maxInstancedCount += growth;\n\n      // Ensure attributes is still defined\n      this.attributes = this.attributes || [];\n\n      for (const attribute of this.attributes) {\n        const bufferAttribute = attribute.bufferAttribute;\n        const size: number = attribute.size || 0;\n\n        if (bufferAttribute.data instanceof Float32Array) {\n          // Make a new buffer that is the proper size\n          const buffer: Float32Array = new Float32Array(\n            this.maxInstancedCount * size\n          );\n          // Retain all of the information in the previous buffer\n          buffer.set(bufferAttribute.data, 0);\n          // Make our new attribute based on the grown buffer\n          const newAttribute = new Attribute(buffer, size, true, true);\n          // Set the attribute to dynamic so we can update ranges within it\n          newAttribute.setDynamic(true);\n          // Make sure our attribute is updated with the newly made attribute\n          attribute.bufferAttribute = newAttribute;\n          // Add the new attribute to our new geometry object\n          this.geometry.addAttribute(attribute.name, newAttribute);\n          // Get the temp storage for new buffer locations\n          let newBufferLocations = attributeToNewBufferLocations.get(\n            attribute.name\n          );\n\n          // Since we have a new buffer object we are working with, we must update all of the existing buffer\n          // locations to utilize this new buffer. The locations keep everything else the same, but the buffer\n          // object itself should be updated\n          const allLocations = this.allBufferLocations[attribute.name] || [];\n          this.allBufferLocations[attribute.name] = allLocations;\n\n          for (let k = 0, endk = allLocations.length; k < endk; ++k) {\n            allLocations[k].buffer.value = buffer;\n          }\n\n          if (!newBufferLocations) {\n            newBufferLocations = [];\n            attributeToNewBufferLocations.set(\n              attribute.name,\n              newBufferLocations\n            );\n          }\n\n          for (\n            let i = previousInstanceAmount, end = this.maxInstancedCount;\n            i < end;\n            ++i\n          ) {\n            const newLocation: IInstanceAttributeBufferLocation = {\n              attribute,\n              buffer: {\n                value: buffer\n              },\n              instanceIndex: i,\n              range: [i * size, i * size + size]\n            };\n\n            newBufferLocations.push(newLocation);\n            allLocations.push(newLocation);\n          }\n        }\n      }\n\n      if (this.scene.container && this.model) {\n        this.scene.container.remove(this.model);\n      }\n    }\n\n    if (this.scene && this.model && this.scene.container) {\n      this.scene.container.remove(this.model);\n    }\n\n    // Ensure material is defined\n    this.material = this.material || this.layer.material.clone();\n    // Remake the model with the generated geometry\n    this.model = generateLayerModel(\n      this.geometry,\n      this.material,\n      this.layer.model.drawMode\n    );\n\n    // Now that we are ready to utilize the buffer, let's add it to the scene so it may be rendered.\n    // Each new buffer equates to one draw call.\n    if (this.scene && this.scene.container && this.model) {\n      this.scene.container.add(this.model);\n    }\n\n    debug(\"COMPLETE: Resizing unpacked attribute buffer\");\n\n    return {\n      growth,\n      newLocations: attributeToNewBufferLocations\n    };\n  }\n\n  /**\n   * This takes newly created buffer locations and groups them by the property ids identified by the\n   * registration phase.\n   */\n  private gatherLocationsIntoGroups(\n    attributeToNewBufferLocations: Map<\n      string,\n      IInstanceAttributeBufferLocation[]\n    >,\n    totalNewInstances: number\n  ) {\n    if (this.attributeToPropertyIds.size === 0) return;\n\n    debug(\"BEGIN: Unpacked attribute manager grouping new buffer locations\");\n\n    // Optimize inner loops by pre-fetching lookups by names\n    const attributesBufferLocations: {\n      attribute: IInstanceAttribute<T>;\n      bufferLocationsForAttribute: IInstanceAttributeBufferLocation[];\n      childBufferLocations: IInstanceAttributeBufferLocation[][];\n      ids: number[];\n      bufferIndex: number;\n    }[] = [];\n\n    this.attributeToPropertyIds.forEach((ids, attribute) => {\n      attributesBufferLocations.push({\n        attribute,\n        bufferLocationsForAttribute:\n          attributeToNewBufferLocations.get(attribute.name) || [],\n        childBufferLocations: (attribute.childAttributes || []).map(\n          attr => attributeToNewBufferLocations.get(attr.name) || []\n        ),\n        ids,\n        bufferIndex: -1\n      });\n    });\n\n    let allLocations,\n      attribute: IInstanceAttribute<T>,\n      ids: number[],\n      bufferLocationsForAttribute: IInstanceAttributeBufferLocation[],\n      bufferLocation: IInstanceAttributeBufferLocation | undefined,\n      childAttribute: IInstanceAttribute<T>,\n      bufferLocationsForChildAttribute: IInstanceAttributeBufferLocation[],\n      childBufferLocation: IInstanceAttributeBufferLocation | undefined;\n\n    // Loop through all of the new instances available and gather all of the buffer locations\n    for (let i = 0; i < totalNewInstances; ++i) {\n      const group: IInstanceAttributeBufferLocationGroup = {\n        instanceIndex: -1,\n        propertyToBufferLocation: {}\n      };\n\n      // Loop through all of the property ids that affect specific attributes. Each of these ids\n      // needs an association with the buffer location they modify.\n      for (let j = 0, endj = attributesBufferLocations.length; j < endj; ++j) {\n        allLocations = attributesBufferLocations[j];\n        attribute = allLocations.attribute;\n        ids = allLocations.ids;\n        bufferLocationsForAttribute = allLocations.bufferLocationsForAttribute;\n\n        if (!bufferLocationsForAttribute) {\n          emitOnce(\n            \"Instance Attribute Buffer Error\",\n            (count: number, id: string) => {\n              console.warn(\n                `${id}: There is an error in forming buffer location groups in InstanceAttributeBufferManager. Error count: ${count}`\n              );\n            }\n          );\n          continue;\n        }\n\n        bufferLocation =\n          bufferLocationsForAttribute[++allLocations.bufferIndex];\n\n        if (!bufferLocation) {\n          emitOnce(\n            \"Instance Attribute Buffer Error\",\n            (count: number, id: string) => {\n              console.warn(\n                `${id}: There is an error in forming buffer location groups in InstanceAttributeBufferManager. Error count: ${count}`\n              );\n            }\n          );\n          continue;\n        }\n\n        if (group.instanceIndex === -1) {\n          group.instanceIndex = bufferLocation.instanceIndex;\n        } else if (bufferLocation.instanceIndex !== group.instanceIndex) {\n          emitOnce(\n            \"Instance Attribute Parallelism Error\",\n            (count: number, id: string) => {\n              console.warn(\n                `${id}: A buffer location does not have a matching instance index which means the buffer locations are not in parallel with each other somehow. Error count: ${count}`\n              );\n              console.warn(attribute.name, bufferLocation);\n            }\n          );\n          continue;\n        }\n\n        // If the attribute has children attributes. Then when the attribute is updated, the child attributes should\n        // be updated as well. Thus the buffer location needs the child attribute buffer locations.\n        if (attribute.childAttributes) {\n          bufferLocation.childLocations = [];\n\n          for (\n            let k = 0, endk = attribute.childAttributes.length;\n            k < endk;\n            ++k\n          ) {\n            bufferLocationsForChildAttribute =\n              allLocations.childBufferLocations[k];\n\n            if (bufferLocationsForChildAttribute) {\n              childBufferLocation = bufferLocationsForChildAttribute.shift();\n              if (childBufferLocation) {\n                bufferLocation.childLocations.push(childBufferLocation);\n              } else {\n                childAttribute = attribute.childAttributes[k];\n                emitOnce(\n                  \"Instance Attribute Child Attribute Error\",\n                  (count: number, id: string) => {\n                    console.warn(\n                      `${id}: A child attribute does not have a buffer location available. Error count: ${count}`\n                    );\n                    console.warn(\n                      `Parent Attribute: ${attribute.name} Child Attribute: ${\n                        childAttribute.name\n                      }`\n                    );\n                  }\n                );\n              }\n            }\n          }\n        }\n\n        // In the group, associate the property ids that affect a buffer location WITH the buffer location they affect\n        for (let k = 0, endk = ids.length; k < endk; ++k) {\n          group.propertyToBufferLocation[ids[k]] = bufferLocation;\n        }\n      }\n\n      // Store this group as a group that is ready to be associated with an instance\n      this.availableLocations.push(group);\n    }\n\n    debug(\n      \"COMPLETE: Unpacked attribute buffer manager buffer location grouping\"\n    );\n    // This helps ensure errors get reported in a timely fashion in case this triggers some massive looping\n    flushEmitOnce();\n  }\n\n  /**\n   * Returns the total instances this buffer manages.\n   */\n  getInstanceCount() {\n    return this.maxInstancedCount;\n  }\n}\n","import { Instance } from \"../../instance-provider/instance\";\nimport { ResourceManager } from \"../../resources\";\nimport {\n  IInstanceAttribute,\n  INonePickingMetrics,\n  IQuadTreePickingMetrics,\n  ISinglePickingMetrics,\n  PickType\n} from \"../../types\";\nimport { LayerBufferType } from \"../layer-processing/layer-buffer-type\";\nimport { BaseDiffProcessor } from \"./base-diff-processor\";\nimport { IBufferLocationGroup } from \"./buffer-manager-base\";\nimport { BufferManagerBase, IBufferLocation } from \"./buffer-manager-base\";\nimport { InstanceAttributeColorDiffProcessor } from \"./instance-attribute-buffering/instance-attribute-color-diff-processor\";\nimport { InstanceAttributeDiffProcessor } from \"./instance-attribute-buffering/instance-attribute-diff-processor\";\nimport { InstanceAttributeQuadDiffProcessor } from \"./instance-attribute-buffering/instance-attribute-quad-diff-processor\";\nimport { UniformColorDiffProcessor } from \"./uniform-buffering/uniform-color-diff-processor\";\nimport { UniformDiffProcessor } from \"./uniform-buffering/uniform-diff-processor\";\nimport { UniformQuadDiffProcessor } from \"./uniform-buffering/uniform-quad-diff-processor\";\n\n/** Signature of a method that handles a diff */\nexport type DiffHandler<T extends Instance> = (\n  manager: BaseDiffProcessor<T>,\n  instance: T,\n  propIds: number[],\n  bufferLocations?: IBufferLocation | IBufferLocationGroup<IBufferLocation>\n) => void;\n/** A set of diff handling methods in this order [change, add, remove] */\nexport type DiffLookup<T extends Instance> = DiffHandler<T>[];\n\n/**\n * This interface is the bare minimum properties needed for this diff manager to map instance updates to\n * uniform changes. We don't use a Layer as a target explicitly to avoid circular/hard dependencies\n */\nexport interface IInstanceDiffManagerTarget<T extends Instance> {\n  /** This is the attribute for the target that represents the _active injected value */\n  activeAttribute: IInstanceAttribute<T>;\n  /** This is used by the automated easing system and is the easing Ids used by the layer for given attributes */\n  easingId: { [key: string]: number };\n  /** This is all of the instance attributes applied to the target */\n  instanceAttributes: IInstanceAttribute<T>[];\n  /** This is the picking metrics for how Instances are picked with the mouse */\n  picking:\n    | IQuadTreePickingMetrics<T>\n    | ISinglePickingMetrics<T>\n    | INonePickingMetrics;\n  /** This is the resource manager for the target which let's us fetch information from an atlas for an instance */\n  resource: ResourceManager;\n  /** This is the manager that links an instance to it's uniform cluster for populating the uniform buffer */\n  bufferManager: BufferManagerBase<T, IBufferLocation>;\n  /** This is the buffering strategy being used */\n  bufferType: LayerBufferType;\n}\n\n/**\n * This class manages the process of taking the diffs of a layer and executing methods on those diffs to perform\n * updates to the uniforms that control those instances.\n */\nexport class InstanceDiffManager<T extends Instance> {\n  bufferManager: BufferManagerBase<T, IBufferLocation>;\n  processor: BaseDiffProcessor<T>;\n  processing: DiffLookup<T>;\n  layer: IInstanceDiffManagerTarget<T>;\n\n  constructor(\n    layer: IInstanceDiffManagerTarget<T>,\n    bufferManager: BufferManagerBase<T, IBufferLocation>\n  ) {\n    this.layer = layer;\n    this.bufferManager = bufferManager;\n  }\n\n  /**\n   * This returns the proper diff processor for handling diffs\n   */\n  makeProcessor(): DiffLookup<T> {\n    // If this manager has already figured out which processor to use. Just return that processor.\n    if (this.processing) return this.processing;\n\n    if (\n      this.layer.bufferType === LayerBufferType.INSTANCE_ATTRIBUTE ||\n      this.layer.bufferType === LayerBufferType.INSTANCE_ATTRIBUTE_PACKING\n    ) {\n      // Now we look at the state of the layer to determine the best diff processor strategy\n      if (this.layer.picking) {\n        if (this.layer.picking.type === PickType.SINGLE) {\n          this.processor = new InstanceAttributeColorDiffProcessor(\n            this.layer,\n            this.bufferManager\n          );\n        } else if (this.layer.picking.type === PickType.ALL) {\n          this.processor = new InstanceAttributeQuadDiffProcessor(\n            this.layer,\n            this.bufferManager\n          );\n        }\n      }\n\n      if (!this.processor) {\n        this.processor = new InstanceAttributeDiffProcessor(\n          this.layer,\n          this.bufferManager\n        );\n      }\n    } else {\n      // Now we look at the state of the layer to determine the best diff processor strategy\n      if (this.layer.picking) {\n        if (this.layer.picking.type === PickType.ALL) {\n          this.processor = new UniformQuadDiffProcessor(\n            this.layer,\n            this.bufferManager\n          );\n        } else if (this.layer.picking.type === PickType.SINGLE) {\n          this.processor = new UniformColorDiffProcessor(\n            this.layer,\n            this.bufferManager\n          );\n        }\n      }\n\n      if (!this.processor) {\n        this.processor = new UniformDiffProcessor(\n          this.layer,\n          this.bufferManager\n        );\n      }\n    }\n\n    this.processing = [\n      this.processor.changeInstance,\n      this.processor.addInstance,\n      this.processor.removeInstance\n    ];\n\n    return this.processing;\n  }\n}\n","import { Instance } from \"./instance\";\n\n/**\n * This is an instance that is basically an instance stub that won't throw any implementation\n * errors when used, but will effectively do nothing.\n */\nexport class BasicInstance extends Instance {\n  resourceTrigger() {\n    // NO -OP\n  }\n}\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  if (ms >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (ms >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (ms >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (ms >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  return plural(ms, d, 'day') ||\n    plural(ms, h, 'hour') ||\n    plural(ms, m, 'minute') ||\n    plural(ms, s, 'second') ||\n    ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) {\n    return;\n  }\n  if (ms < n * 1.5) {\n    return Math.floor(ms / n) + ' ' + name;\n  }\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = createDebug.debug = createDebug['default'] = createDebug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * Active `debug` instances.\n */\nexports.instances = [];\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n */\n\nexports.formatters = {};\n\n/**\n * Select a color.\n * @param {String} namespace\n * @return {Number}\n * @api private\n */\n\nfunction selectColor(namespace) {\n  var hash = 0, i;\n\n  for (i in namespace) {\n    hash  = ((hash << 5) - hash) + namespace.charCodeAt(i);\n    hash |= 0; // Convert to 32bit integer\n  }\n\n  return exports.colors[Math.abs(hash) % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction createDebug(namespace) {\n\n  var prevTime;\n\n  function debug() {\n    // disabled?\n    if (!debug.enabled) return;\n\n    var self = debug;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // turn the `arguments` into a proper Array\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %O\n      args.unshift('%O');\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-zA-Z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    // apply env-specific formatting (colors, etc.)\n    exports.formatArgs.call(self, args);\n\n    var logFn = debug.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n\n  debug.namespace = namespace;\n  debug.enabled = exports.enabled(namespace);\n  debug.useColors = exports.useColors();\n  debug.color = selectColor(namespace);\n  debug.destroy = destroy;\n\n  // env-specific initialization logic for debug instances\n  if ('function' === typeof exports.init) {\n    exports.init(debug);\n  }\n\n  exports.instances.push(debug);\n\n  return debug;\n}\n\nfunction destroy () {\n  var index = exports.instances.indexOf(this);\n  if (index !== -1) {\n    exports.instances.splice(index, 1);\n    return true;\n  } else {\n    return false;\n  }\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  exports.names = [];\n  exports.skips = [];\n\n  var i;\n  var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n\n  for (i = 0; i < exports.instances.length; i++) {\n    var instance = exports.instances[i];\n    instance.enabled = exports.enabled(instance.namespace);\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  if (name[name.length - 1] === '*') {\n    return true;\n  }\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","import { GLSettings } from \"../../gl\";\nimport { InstanceProvider } from \"../../instance-provider\";\nimport { ILayerProps, Layer } from \"../../surface/layer\";\nimport {\n  ILayerMaterialOptions,\n  InstanceAttributeSize,\n  IShaderInitialization,\n  UniformSize,\n  VertexAttributeSize\n} from \"../../types\";\nimport { CommonMaterialOptions, IAutoEasingMethod, Vec } from \"../../util\";\nimport { ArcInstance } from \"./arc-instance\";\n\nexport enum ArcScaleType {\n  /** All dimensions are within world space */\n  NONE,\n  /**\n   * The thickness of the arc is in screen space. Thus, camera zoom changes will not affect it and\n   * must be controlled by scaleFactor alone.\n   */\n  SCREEN_CURVE\n}\n\nexport interface IArcLayerProps<T extends ArcInstance> extends ILayerProps<T> {\n  scaleType?: ArcScaleType;\n  animate?: {\n    angle?: IAutoEasingMethod<Vec>;\n    center?: IAutoEasingMethod<Vec>;\n    colorEnd?: IAutoEasingMethod<Vec>;\n    colorStart?: IAutoEasingMethod<Vec>;\n    radius?: IAutoEasingMethod<Vec>;\n    thickness?: IAutoEasingMethod<Vec>;\n  };\n}\n\n/**\n * This layer displays Arcs and provides as many controls as possible for displaying\n * them in interesting ways.\n */\nexport class ArcLayer<\n  T extends ArcInstance,\n  U extends IArcLayerProps<T>\n> extends Layer<T, U> {\n  static defaultProps: IArcLayerProps<ArcInstance> = {\n    data: new InstanceProvider<ArcInstance>(),\n    key: \"\",\n    scaleType: ArcScaleType.NONE,\n    scene: \"default\"\n  };\n\n  /** Easy lookup of all attribute names for the layer */\n  static attributeNames = {\n    angle: \"angle\",\n    center: \"center\",\n    colorEnd: \"colorEnd\",\n    colorStart: \"colorStart\",\n    depth: \"depth\",\n    radius: \"radius\",\n    thickness: \"thickness\"\n  };\n\n  /**\n   * Define our shader and it's inputs\n   */\n  initShader(): IShaderInitialization<ArcInstance> {\n    const { scaleType } = this.props;\n    const animations = this.props.animate || {};\n    const {\n      angle: animateAngle,\n      center: animateCenter,\n      radius: animateRadius,\n      thickness: animateThickness,\n      colorStart: animateColorStart,\n      colorEnd: animateColorEnd\n    } = animations;\n\n    const MAX_SEGMENTS = 150;\n\n    // Calculate the normals and interpolations for our vertices\n    const vertexToNormal: { [key: number]: number } = {\n      0: 1,\n      [MAX_SEGMENTS * 2 + 2]: -1\n    };\n\n    const vertexInterpolation: { [key: number]: number } = {\n      0: 0,\n      [MAX_SEGMENTS * 2 + 2]: 1\n    };\n\n    let sign = 1;\n    for (let i = 0; i < MAX_SEGMENTS * 2; ++i) {\n      vertexToNormal[i + 1] = sign;\n      vertexInterpolation[i + 1] = Math.floor(i / 2) / (MAX_SEGMENTS - 1);\n      sign *= -1;\n    }\n\n    const vs =\n      scaleType === ArcScaleType.NONE\n        ? require(\"./arc-layer.vs\")\n        : require(\"./arc-layer-screen-space.vs\");\n\n    return {\n      fs: require(\"./arc-layer.fs\"),\n      instanceAttributes: [\n        {\n          easing: animateCenter,\n          name: ArcLayer.attributeNames.center,\n          size: InstanceAttributeSize.TWO,\n          update: o => o.center\n        },\n        {\n          easing: animateRadius,\n          name: ArcLayer.attributeNames.radius,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.radius]\n        },\n        {\n          name: ArcLayer.attributeNames.depth,\n          size: InstanceAttributeSize.ONE,\n          update: o => [o.depth]\n        },\n        {\n          easing: animateThickness,\n          name: ArcLayer.attributeNames.thickness,\n          size: InstanceAttributeSize.TWO,\n          update: o => o.thickness\n        },\n        {\n          easing: animateAngle,\n          name: ArcLayer.attributeNames.angle,\n          size: InstanceAttributeSize.TWO,\n          update: o => o.angle\n        },\n        {\n          easing: animateColorStart,\n          name: ArcLayer.attributeNames.colorStart,\n          size: InstanceAttributeSize.FOUR,\n          update: o => o.colorStart\n        },\n        {\n          easing: animateColorEnd,\n          name: ArcLayer.attributeNames.colorEnd,\n          size: InstanceAttributeSize.FOUR,\n          update: o => o.colorEnd\n        }\n      ],\n      uniforms: [\n        {\n          name: \"scaleFactor\",\n          size: UniformSize.ONE,\n          update: _u => [1]\n        }\n      ],\n      vertexAttributes: [\n        // TODO: This is from the heinous evils of THREEJS and their inability to fix a bug within our lifetimes.\n        // Right now position is REQUIRED in order for rendering to occur, otherwise the draw range gets updated to\n        // Zero against your wishes.\n        {\n          name: \"vertex\",\n          size: VertexAttributeSize.THREE,\n          update: (vertex: number) => [\n            // Normal\n            vertexToNormal[vertex],\n            // The side of the quad\n            vertexInterpolation[vertex],\n            // The number of vertices\n            MAX_SEGMENTS * 2\n          ]\n        }\n      ],\n      vertexCount: MAX_SEGMENTS * 2 + 2,\n      vs\n    };\n  }\n\n  getMaterialOptions(): ILayerMaterialOptions {\n    return Object.assign({}, CommonMaterialOptions.transparentShapeBlending, {\n      culling: GLSettings.Material.CullSide.NONE\n    } as ILayerMaterialOptions);\n  }\n}\n","export * from \"./arc-layer\";\nexport * from \"./arc-instance\";\n","export * from \"./arcs\";\nexport * from \"./circles\";\nexport * from \"./edges\";\nexport * from \"./images\";\nexport * from \"./labels\";\nexport * from \"./rectangle\";\nexport * from \"./rings\";\nexport * from \"./types\";\n","import { Instance } from \"../instance-provider\";\nimport { IEasingControl, NOOP } from \"../types\";\nimport { nextFrame } from \"./next-frame\";\n\n/** Handler type for discovered easing controls using the all() method */\nexport type EasingUtilAllHandler<T extends Instance> = (\n  easing: IEasingControl,\n  instance: T,\n  instanceIndex: number,\n  attrIndex: number\n) => void;\n\n/**\n * This contains helper methods to make setting easing values easier to instances that are a part of animated layers\n */\nexport class EasingUtil {\n  /**\n   * This finds all easing controls requested for all instances.\n   *\n   * If wait is true, then this method's returned promise will resolve AFTER the time\n   * of all discovered easing objects has passed.\n   */\n  static async all<T extends Instance>(\n    wait: boolean,\n    instances: T[],\n    layerAttributes: string[],\n    adjust?: EasingUtilAllHandler<T>\n  ) {\n    let resolver: Function = NOOP;\n    const promise = new Promise(resolve => (resolver = resolve));\n    let finishedTime = 0;\n    let start = 0;\n\n    for (let i = 0, iMax = layerAttributes.length; i < iMax; ++i) {\n      const attr = layerAttributes[i];\n\n      for (let k = 0, kMax = instances.length; k < kMax; ++k) {\n        const instance = instances[k];\n        const easing = instance.getEasing(attr);\n\n        if (easing) {\n          if (adjust) adjust(easing, instance, k, i);\n          finishedTime = Math.max((easing.delay || 0) + easing.duration);\n        }\n      }\n    }\n\n    // Keep looking at next frame until the animations are complete\n    const checkNextFrame = (t: number) => {\n      if (t - start < finishedTime) {\n        nextFrame(checkNextFrame);\n      } else resolver();\n    };\n\n    if (wait) {\n      requestAnimationFrame(t => {\n        start = t;\n        checkNextFrame(t);\n      });\n    } else {\n      resolver();\n    }\n\n    return promise;\n  }\n}\n","import { Instance } from \"../instance-provider/instance\";\nimport { Bounds } from \"../primitives/bounds\";\nimport { isVec2, Vec2 } from \"../util/vector\";\n\n// A configuration that controls how readily a quadtree will split to another level\n// Adjusting this number can improve or degrade your performance significantly and\n// Must be tested for specific use cases\nconst maxPopulation: number = 5;\nconst maxDepth: number = 10;\n\nexport type BoundsAccessor<T extends Instance> = (o: T) => Bounds | null;\n\n/**\n * Allows typing of a callback argument\n */\nexport interface IVisitFunction<T extends Instance> {\n  /**\n   * A callback to use during add or query\n   *\n   * Called do provide aggregation or filtering like Array.reduce or\n   * Array.filter, but in a QuadTree instead.\n   *\n   * @param node  The node to effect the function upon\n   * @param child The child to add to the node\n   */\n  (node: Node<T>, child?: Bounds): void;\n}\n\n/**\n * This is a class used specifically by the quad tree nodes to indicate split space\n * within the quad tree.\n */\nexport class Quadrants<T extends Instance> {\n  TL: Node<T>;\n  TR: Node<T>;\n  BL: Node<T>;\n  BR: Node<T>;\n\n  /**\n   * Ensures all memory is released for all nodes and all references are removed\n   * to potentially high memory consumption items\n   */\n  destroy() {\n    this.TL.destroy();\n    this.TR.destroy();\n    this.BL.destroy();\n    this.BR.destroy();\n    delete this.TL;\n    delete this.TR;\n    delete this.BL;\n    delete this.BR;\n  }\n\n  /**\n   * Creates an instance of Quadrants.\n   *\n   * @param bounds The bounds this will create quandrants for\n   * @param depth  The child depth of this element\n   */\n  constructor(\n    bounds: Bounds,\n    depth: number,\n    getBounds: BoundsAccessor<T>,\n    childToNode: Map<T, Node<T>>,\n    childToBounds: Map<T, Bounds | null>\n  ) {\n    const mid = bounds.mid;\n    this.TL = new Node<T>(bounds.x, mid[0], bounds.y, mid[1], getBounds, depth);\n    this.TR = new Node<T>(\n      mid[0],\n      bounds.right,\n      bounds.y,\n      mid[1],\n      getBounds,\n      depth\n    );\n    this.BL = new Node<T>(\n      bounds.x,\n      mid[0],\n      mid[1],\n      bounds.bottom,\n      getBounds,\n      depth\n    );\n    this.BR = new Node<T>(\n      mid[0],\n      bounds.right,\n      mid[1],\n      bounds.bottom,\n      getBounds,\n      depth\n    );\n    this.TL.childToNode = childToNode;\n    this.TR.childToNode = childToNode;\n    this.BL.childToNode = childToNode;\n    this.BR.childToNode = childToNode;\n    this.TL.childToBounds = childToBounds;\n    this.TR.childToBounds = childToBounds;\n    this.BL.childToBounds = childToBounds;\n    this.BR.childToBounds = childToBounds;\n  }\n}\n\n/**\n * The quad tree node. This Node will take in a certain population before dividing itself into\n * 4 quadrants which it will attempt to inject it's population into. If a member of the population\n * does not completely get injected into one of the quadrants it remains as a member of this node.\n */\nexport class Node<T extends Instance> {\n  /** This is the amount of space this node covers */\n  bounds: Bounds;\n  /** These are the child Instances of the node. */\n  children: T[] = [];\n  /**\n   * This tracks a quick lookup of a child to it's parent node. This is used so the child can\n   * be removed with ease and not require a traversal of the tree.\n   */\n  childToNode: Map<T, Node<T>>;\n  /** This tracks the bounds calcuated for the given instance */\n  childToBounds: Map<T, Bounds | null>;\n  /** This is how deep the node is within the tree */\n  depth: number = 0;\n  /** This is the accessor method that retrieves the bounds for an injected instance */\n  getBounds: BoundsAccessor<T>;\n  /** These are the child nodes of this quad node when this node is split. It is null if the node is not split yet */\n  nodes: Quadrants<T> | null = null;\n  /**\n   * These are children with null bounds that do not affect the splitting and ALWAYS get checked every query.\n   * They should only reside on the top node.\n   */\n  nullBounded: T[];\n\n  /**\n   * Destroys this node and ensures all child nodes are destroyed as well.\n   */\n  destroy() {\n    delete this.children;\n    delete this.bounds;\n\n    if (this.nodes) {\n      this.nodes.destroy();\n      this.nodes = null;\n    }\n  }\n\n  /**\n   * Creates an instance of Node.\n   */\n  constructor(\n    left: number,\n    right: number,\n    top: number,\n    bottom: number,\n    getBounds: BoundsAccessor<T>,\n    depth: number = 0\n  ) {\n    // If params insertted\n    if (arguments.length >= 4) {\n      this.bounds = new Bounds({ left, right, top, bottom });\n    } else {\n      // Otherwise, make tiny start area\n      this.bounds = new Bounds({ left: 0, right: 1, top: 1, bottom: 0 });\n    }\n\n    // Ensure the depth is set\n    this.depth = depth;\n    // Apply the bounds accessor method for instances\n    this.getBounds = getBounds;\n\n    // If this is the top level node, we need to instantiate the lookup that will be used\n    // Across all nodes.\n    if (this.depth === 0) {\n      this.nullBounded = [];\n      this.childToNode = new Map<T, Node<T>>();\n      this.childToBounds = new Map<T, Bounds>();\n    }\n  }\n\n  /**\n   * Adds an object that extends Bounds (or is Bounds) and properly injects it into this node\n   * or into a sub quadrant if this node is split already. If the child is outside the boundaries\n   * this quad tree spans (and this is the root node), the quad tree will expand to include\n   * the new child.\n   *\n   * @param child The Bounds type object to inject\n   * @param props Properties that can be retrieved with the child object if applicable\n   *\n   * @returns True if the insertion was successful\n   */\n  add(child: T): boolean {\n    let bounds = this.childToBounds.get(child);\n\n    if (!bounds) {\n      // First we access the bounds of the child and store it\n      bounds = this.getBounds(child);\n      this.childToBounds.set(child, bounds);\n    }\n\n    // This is the entry function for adding children, so we must first expand our top node\n    // To cover the area that the child is located.\n    // If we're in bounds, then let's just add the child\n    if (!bounds || bounds.isInside(this.bounds)) {\n      return this.doAdd(child, bounds);\n    } else {\n      // Otherwise, we need to expand first\n      this.cover(bounds);\n      return this.add(child);\n    }\n  }\n\n  /**\n   * Adds a list of new children to this quad tree. It performs the same operations as\n   * addChild for each child in the list, however, it more efficiently recalculates the\n   * bounds necessary to cover the area the children cover.\n   *\n   * @param children      List of Bounds objects to inject\n   */\n  addAll(children: T[]) {\n    // Make sure we cover the entire area of all the children.\n    // We can speed this up a lot if we first calculate the total bounds the new children covers\n    let minX = Number.MAX_VALUE;\n    let minY = Number.MAX_VALUE;\n    let maxX = -Number.MAX_VALUE;\n    let maxY = -Number.MAX_VALUE;\n\n    // Get the dimensions of the new bounds\n    children.forEach(child => {\n      const bounds = this.getBounds(child);\n      this.childToBounds.set(child, bounds);\n      if (!bounds) return;\n\n      if (bounds.x < minX) {\n        minX = bounds.x;\n      }\n      if (bounds.right > maxX) {\n        maxX = bounds.right;\n      }\n      if (bounds.bottom > maxY) {\n        maxY = bounds.bottom;\n      }\n      if (bounds.y < minY) {\n        minY = bounds.y;\n      }\n    });\n\n    // Ensure a valid cover dimension was established. If no valid dimension is established\n    // Then we don't cover, but we can still add the children as that have null Bounds which\n    // Means injecting at the top level.\n    if (\n      minX !== Number.MAX_VALUE &&\n      minY !== Number.MAX_VALUE &&\n      maxX !== -Number.MAX_VALUE &&\n      maxY !== -Number.MAX_VALUE\n    ) {\n      // Make sure our bounds includes the specified bounds\n      this.cover(\n        new Bounds({ left: minX, right: maxX, bottom: maxY, top: minY })\n      );\n    }\n\n    // Add all of the children into the tree.\n    children.forEach(child =>\n      this.doAdd(child, this.childToBounds.get(child) || null, true)\n    );\n  }\n\n  /**\n   * Ensures this quad tree includes the bounds specified in it's spatial coverage.\n   * This will cause all children to be re-injected into the tree.\n   *\n   * @param bounds The bounds to include in the tree's coverage\n   */\n  cover(bounds: Bounds) {\n    // If we are already covering the area: abort\n    if (bounds.isInside(this.bounds)) {\n      return;\n    }\n\n    // Make our bounds cover the new area\n    this.bounds.encapsulate(bounds);\n    this.bounds.x -= 1;\n    this.bounds.y -= 1;\n    this.bounds.width += 2;\n    this.bounds.height += 2;\n    // Get all of the children underneath this node\n    const allChildren = this.gatherChildren([]);\n    this.children = [];\n\n    // Destroy the split nodes\n    if (this.nodes) {\n      // Completely...destroy...\n      this.nodes.destroy();\n      this.nodes = null;\n    }\n\n    // Clear out the child to node relations\n    this.childToNode.clear();\n    // Reinsert all children with the new dimensions in place\n    allChildren.forEach(child =>\n      this.doAdd(child, this.childToBounds.get(child) || null)\n    );\n  }\n\n  /**\n   * When adding children, this performs the actual action of injecting the child into the tree\n   * without the process of seeing if the tree needs a spatial adjustment to account for the child.\n   *\n   * @param child The Bounds item to inject into the tree\n   * @param props The props to remain associated with the child\n   *\n   * @returns True if the injection was successful\n   */\n  private doAdd(child: T, bounds: Bounds | null, fromSplit?: boolean): boolean {\n    // If this is the top level node and the bounds are null, then we add to the null list\n    if (!bounds && this.depth === 0) {\n      this.nullBounded.push(child);\n      this.childToNode.set(child, this);\n\n      return true;\n    }\n\n    // If no bounds is available at this point, something went terribly wrong\n    if (!bounds) {\n      console.warn(\n        \"A null bounds was added to a Quad Tree node below the top node, which is invalid.\"\n      );\n      return false;\n    }\n\n    // If bounds are null, then just immediately add\n    // If nodes are present, then we have already exceeded the population of this node\n    if (this.nodes) {\n      if (bounds.isInside(this.nodes.TL.bounds)) {\n        return this.nodes.TL.doAdd(child, bounds, fromSplit);\n      }\n\n      if (bounds.isInside(this.nodes.TR.bounds)) {\n        return this.nodes.TR.doAdd(child, bounds, fromSplit);\n      }\n\n      if (bounds.isInside(this.nodes.BL.bounds)) {\n        return this.nodes.BL.doAdd(child, bounds, fromSplit);\n      }\n\n      if (bounds.isInside(this.nodes.BR.bounds)) {\n        return this.nodes.BR.doAdd(child, bounds, fromSplit);\n      }\n\n      // Otherwise, this is a child overlapping this border\n      this.children.push(child);\n      this.childToNode.set(child, this);\n\n      return true;\n    } else if (bounds.isInside(this.bounds)) {\n      // Otherwise, we have not had a split due to population limits being exceeded\n      this.children.push(child);\n      this.childToNode.set(child, this);\n\n      // If we exceeded our population for this quadrant, it is time to split up\n      if (this.children.length > maxPopulation && this.depth < maxDepth) {\n        this.split();\n      }\n\n      return true;\n    }\n\n    // This is when there is something wrong with the insertted child. The bounds\n    // For the quad should have grown without issue, but in this case the bounds\n    // Could not grow to accomodate the child.\n    if (isNaN(bounds.width + bounds.height + bounds.x + bounds.y)) {\n      console.error(\n        \"Child did not fit into bounds because a dimension is NaN\",\n        child,\n        bounds\n      );\n    } else if (bounds.area === 0) {\n      console.error(\n        \"Child did not fit into bounds because the area is zero\",\n        child,\n        bounds\n      );\n    } else {\n      console.error(\n        \"Child did not get insertted.\",\n        \"Parent:\",\n        this.bounds.toString(),\n        \"Child:\",\n        bounds.toString(),\n        \"Inside Checks:\",\n        bounds.x >= this.bounds.x,\n        bounds.right <= this.bounds.right,\n        bounds.y >= this.bounds.y,\n        bounds.bottom <= this.bounds.bottom\n      );\n    }\n\n    // Don't insert the child and continue\n    return true;\n  }\n\n  private doRemove(child: T) {\n    const index = this.children.indexOf(child);\n\n    if (index > -1) {\n      this.children.splice(index, 1);\n      this.childToNode.delete(child);\n      this.childToBounds.delete(child);\n    }\n  }\n\n  /**\n   * Collects all children of all the current and sub nodes into a single list.\n   *\n   * @param list The list we must aggregate children into\n   *\n   * @return The list specified as the list parameter\n   */\n  gatherChildren(list: T[]): T[] {\n    this.children.forEach(child => list.push(child));\n\n    if (this.nodes) {\n      this.nodes.TL.gatherChildren(list);\n      this.nodes.TR.gatherChildren(list);\n      this.nodes.BL.gatherChildren(list);\n      this.nodes.BR.gatherChildren(list);\n    }\n\n    return list;\n  }\n\n  /**\n   * Entry query for determining query type based on input object\n   *\n   * @param bounds Can be a Bounds or a Point object\n   * @param visit  A callback function that will receive the Node as it is analyzed. This gives\n   *               information on a spatial scale, how a query reaches it's target intersections.\n   *\n   * @return An array of children that intersects with the query\n   */\n  query(bounds: Bounds | Vec2, visit?: IVisitFunction<T>): T[] {\n    // This stores all of the found Instances when querying by bounds or point\n    let found: T[] = [];\n\n    // If this is the top level node then add in the null bunded items as the start\n    if (this.depth === 0) {\n      found = this.nullBounded.slice(0);\n    }\n\n    // Query a rectangle\n    if (bounds instanceof Bounds) {\n      if (bounds.hitBounds(this.bounds)) {\n        return this.queryBounds(bounds, found, visit);\n      }\n    }\n\n    if (isVec2(bounds)) {\n      // Query a point\n      if (this.bounds.containsPoint(bounds)) {\n        return this.queryPoint(bounds, found, visit);\n      }\n    }\n\n    // Return an empty array when nothing is collided with\n    return found;\n  }\n\n  /**\n   * Queries children for intersection with a bounds object\n   *\n   * @param b     The Bounds to test children against\n   * @param list  The list of children to aggregate into the query\n   * @param visit A callback function that will receive the Node as it is analyzed. This gives\n   *              information on a spatial scale, how a query reaches it's target intersections.\n   *\n   * @return     Returns the exact same list that was input as the list param\n   */\n  queryBounds(b: Bounds, list: T[], visit?: IVisitFunction<T>): T[] {\n    this.children.forEach(c => {\n      const bounds = this.childToBounds.get(c);\n\n      if (bounds && bounds.hitBounds(b)) {\n        list.push(c);\n      }\n    });\n\n    if (visit) {\n      visit(this);\n    }\n\n    if (this.nodes) {\n      if (b.hitBounds(this.nodes.TL.bounds)) {\n        this.nodes.TL.queryBounds(b, list, visit);\n      }\n\n      if (b.hitBounds(this.nodes.TR.bounds)) {\n        this.nodes.TR.queryBounds(b, list, visit);\n      }\n\n      if (b.hitBounds(this.nodes.BL.bounds)) {\n        this.nodes.BL.queryBounds(b, list, visit);\n      }\n\n      if (b.hitBounds(this.nodes.BR.bounds)) {\n        this.nodes.BR.queryBounds(b, list, visit);\n      }\n    }\n\n    return list;\n  }\n\n  /**\n   * Queries children for intersection with a point\n   *\n   * @param p     The Point to test children against\n   * @param list  The list of children to aggregate into the query\n   * @param visit A callback function that will receive the Node as it is analyzed. This gives\n   *              information on a spatial scale, how a query reaches it's target intersections.\n   *\n   * @return      Returns the exact same list that was input as the list param\n   */\n  queryPoint(p: any, list: T[], visit?: IVisitFunction<T>): T[] {\n    this.children.forEach(c => {\n      const bounds = this.childToBounds.get(c);\n\n      if (bounds && bounds.containsPoint(p)) {\n        list.push(c);\n      }\n    });\n\n    if (visit) {\n      visit(this);\n    }\n\n    if (this.nodes) {\n      if (this.nodes.TL.bounds.containsPoint(p)) {\n        this.nodes.TL.queryPoint(p, list, visit);\n      }\n\n      if (this.nodes.TR.bounds.containsPoint(p)) {\n        this.nodes.TR.queryPoint(p, list, visit);\n      }\n\n      if (this.nodes.BL.bounds.containsPoint(p)) {\n        this.nodes.BL.queryPoint(p, list, visit);\n      }\n\n      if (this.nodes.BR.bounds.containsPoint(p)) {\n        this.nodes.BR.queryPoint(p, list, visit);\n      }\n    }\n\n    return list;\n  }\n\n  /**\n   * Remove the provided item from the tree.\n   */\n  remove(child: T) {\n    if (this.childToNode) {\n      const node = this.childToNode.get(child);\n\n      // If the node is getting removed from the top level node, then it MAY be a null bounded item\n      // Which gets removed from the list\n      if (node && node.depth === 0) {\n        const index = node.nullBounded.indexOf(child);\n\n        if (index > -1) {\n          node.nullBounded.splice(index);\n          this.childToNode.delete(child);\n          this.childToBounds.delete(child);\n\n          return;\n        }\n      }\n\n      // Otherwise, just remove the node normally\n      if (node) {\n        node.doRemove(child);\n      }\n    }\n  }\n\n  /**\n   * Creates four sub quadrants for this node.\n   */\n  split() {\n    // Gather all items to be handed down\n    const allChildren = this.gatherChildren([]);\n    // Gather all props for the children to be handed down as well\n    this.nodes = new Quadrants<T>(\n      this.bounds,\n      this.depth + 1,\n      this.getBounds,\n      this.childToNode,\n      this.childToBounds\n    );\n    // Empty out the children as they are being re-injected\n    this.children = [];\n\n    for (let i = 0, end = allChildren.length; i < end; ++i) {\n      const child = allChildren[i];\n      this.doAdd(child, this.childToBounds.get(child) || null, true);\n    }\n  }\n\n  /**\n   * Traverses the quad tree returning every quadrant encountered\n   *\n   * @param cb A callback that has the parameter (node) which is a quadrant in the tree\n   */\n  visit(cb: IVisitFunction<T>): void {\n    const finished = Boolean(cb(this));\n\n    if (this.nodes && !finished) {\n      this.nodes.TL.visit(cb);\n      this.nodes.TR.visit(cb);\n      this.nodes.BL.visit(cb);\n      this.nodes.BR.visit(cb);\n    }\n  }\n}\n\nexport class TrackedQuadTree<T extends Instance> extends Node<T> {}\n","import { ChartCamera } from \"./chart-camera\";\n\nexport interface IReferenceCameraOptions {\n  /** This is the base camera to monitor */\n  base: ChartCamera;\n  /**\n   * This is a filter applied to the offset that comes from the chart camera.\n   */\n  offsetFilter?(offset: [number, number, number]): [number, number, number];\n  /**\n   * This is a filter applied to the scale that comes from the chart camera.\n   */\n  scaleFilter?(scale: [number, number, number]): [number, number, number];\n}\n\n/**\n * This is a camera that is based on another camera. This can apply filters\n * to the information provided from the base camera.\n *\n * Useful for situations such as a chart having a chart area and a list on the\n * left. This can use the same camera the chart area uses, but filter the response\n * to only track the y offset of the base camera.\n *\n * That would allow easy tracking of the left list to track with elements in the\n * chart and only manipulate a single camera instead of managing many cameras and\n * tie them together with lots of events.\n */\nexport class ReferenceCamera extends ChartCamera {\n  private base: ChartCamera;\n  private offsetFilter = (offset: [number, number, number]) => offset;\n  private scaleFilter = (scale: [number, number, number]) => scale;\n\n  set offset(_val: any) {\n    /** no-op */\n  }\n\n  get offset() {\n    return this.offsetFilter(this.base.offset);\n  }\n\n  set scale(_val: any) {\n    /** no-op */\n  }\n\n  get scale() {\n    return this.scaleFilter(this.base.scale);\n  }\n\n  constructor(options: IReferenceCameraOptions) {\n    super();\n    Object.assign(this, options);\n  }\n}\n","/**\n  BSD License\n\n  Copyright (c) 2015, Facebook, Inc. All rights reserved.\n\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n\n  * Redistributions of source code must retain the above copyright notice, this\n    list of conditions and the following disclaimer.\n\n  * Redistributions in binary form must reproduce the above copyright notice,\n    this list of conditions and the following disclaimer in the documentation\n    and/or other materials provided with the distribution.\n\n  * Neither the name Facebook nor the names of its contributors may be used to\n    endorse or promote products derived from this software without specific\n    prior written permission.\n\n  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\n  ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n  ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n'use strict';\n\nvar canUseDOM = !!(\n  typeof window !== 'undefined' &&\n  window.document &&\n  window.document.createElement\n);\n\n/**\n * Simple, lightweight module assisting with the detection and context of\n * Worker. Helps avoid circular dependencies and allows code to reason about\n * whether or not they are in a Worker, even if they never include the main\n * `ReactWorker` dependency.\n */\nvar ExecutionEnvironment = {\n\n  canUseDOM: canUseDOM,\n\n  canUseWorkers: typeof Worker !== 'undefined',\n\n  canUseEventListeners:\n    canUseDOM && !!(window.addEventListener || window.attachEvent),\n\n  canUseViewport: canUseDOM && !!window.screen,\n\n  isInWorker: !canUseDOM // For now, this is true - might change in the future.\n\n};\n\nmodule.exports = ExecutionEnvironment;\n","/**\n  BSD License\n\n  Copyright (c) 2015, Facebook, Inc. All rights reserved.\n\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n\n  * Redistributions of source code must retain the above copyright notice, this\n    list of conditions and the following disclaimer.\n\n  * Redistributions in binary form must reproduce the above copyright notice,\n    this list of conditions and the following disclaimer in the documentation\n    and/or other materials provided with the distribution.\n\n  * Neither the name Facebook nor the names of its contributors may be used to\n    endorse or promote products derived from this software without specific\n    prior written permission.\n\n  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\n  ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n  ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n'use strict';\n\nvar ExecutionEnvironment = require('./ExecutionEnvironment');\n\nvar useHasFeature;\nif (ExecutionEnvironment.canUseDOM) {\n  useHasFeature =\n    document.implementation &&\n    document.implementation.hasFeature &&\n    // always returns true in newer browsers as per the standard.\n    // @see http://dom.spec.whatwg.org/#dom-domimplementation-hasfeature\n    document.implementation.hasFeature('', '') !== true;\n}\n\n/**\n * Checks if an event is supported in the current execution environment.\n *\n * NOTE: This will not work correctly for non-generic events such as `change`,\n * `reset`, `load`, `error`, and `select`.\n *\n * Borrows from Modernizr.\n *\n * @param {string} eventNameSuffix Event name, e.g. \"click\".\n * @param {?boolean} capture Check if the capture phase is supported.\n * @return {boolean} True if the event is supported.\n * @internal\n * @license Modernizr 3.0.0pre (Custom Build) | MIT\n */\nfunction isEventSupported(eventNameSuffix, capture) {\n  if (!ExecutionEnvironment.canUseDOM ||\n      capture && !('addEventListener' in document)) {\n    return false;\n  }\n\n  var eventName = 'on' + eventNameSuffix;\n  var isSupported = eventName in document;\n\n  if (!isSupported) {\n    var element = document.createElement('div');\n    element.setAttribute(eventName, 'return;');\n    isSupported = typeof element[eventName] === 'function';\n  }\n\n  if (!isSupported && useHasFeature && eventNameSuffix === 'wheel') {\n    // This is the only way to test support for the `wheel` event in IE9+.\n    isSupported = document.implementation.hasFeature('Events.wheel', '3.0');\n  }\n\n  return isSupported;\n}\n\nmodule.exports = isEventSupported;\n","/**\n  BSD License\n\n  Copyright (c) 2015, Facebook, Inc. All rights reserved.\n\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n\n  * Redistributions of source code must retain the above copyright notice, this\n    list of conditions and the following disclaimer.\n\n  * Redistributions in binary form must reproduce the above copyright notice,\n    this list of conditions and the following disclaimer in the documentation\n    and/or other materials provided with the distribution.\n\n  * Neither the name Facebook nor the names of its contributors may be used to\n    endorse or promote products derived from this software without specific\n    prior written permission.\n\n  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\n  ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n  ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n *  Provides entirely client-side User Agent and OS detection. You should prefer\n *  the non-deprecated UserAgent module when possible, which exposes our\n *  authoritative server-side PHP-based detection to the client.\n *\n *  Usage is straightforward:\n *\n *    if (UserAgent_DEPRECATED.ie()) {\n *      //  IE\n *    }\n *\n *  You can also do version checks:\n *\n *    if (UserAgent_DEPRECATED.ie() >= 7) {\n *      //  IE7 or better\n *    }\n *\n *  The browser functions will return NaN if the browser does not match, so\n *  you can also do version compares the other way:\n *\n *    if (UserAgent_DEPRECATED.ie() < 7) {\n *      //  IE6 or worse\n *    }\n *\n *  Note that the version is a float and may include a minor version number,\n *  so you should always use range operators to perform comparisons, not\n *  strict equality.\n *\n *  **Note:** You should **strongly** prefer capability detection to browser\n *  version detection where it's reasonable:\n *\n *    http://www.quirksmode.org/js/support.html\n *\n *  Further, we have a large number of mature wrapper functions and classes\n *  which abstract away many browser irregularities. Check the documentation,\n *  grep for things, or ask on javascript@lists.facebook.com before writing yet\n *  another copy of \"event || window.event\".\n *\n */\n\nvar _populated = false;\n\n// Browsers\nvar _ie, _firefox, _opera, _webkit, _chrome;\n\n// Actual IE browser for compatibility mode\nvar _ie_real_version;\n\n// Platforms\nvar _osx, _windows, _linux, _android;\n\n// Architectures\nvar _win64;\n\n// Devices\nvar _iphone, _ipad, _native;\n\nvar _mobile;\n\nfunction _populate() {\n  if (_populated) {\n    return;\n  }\n\n  _populated = true;\n\n  // To work around buggy JS libraries that can't handle multi-digit\n  // version numbers, Opera 10's user agent string claims it's Opera\n  // 9, then later includes a Version/X.Y field:\n  //\n  // Opera/9.80 (foo) Presto/2.2.15 Version/10.10\n  var uas = navigator.userAgent;\n  var agent = /(?:MSIE.(\\d+\\.\\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\\d+\\.\\d+))|(?:Opera(?:.+Version.|.)(\\d+\\.\\d+))|(?:AppleWebKit.(\\d+(?:\\.\\d+)?))|(?:Trident\\/\\d+\\.\\d+.*rv:(\\d+\\.\\d+))/.exec(uas);\n  var os    = /(Mac OS X)|(Windows)|(Linux)/.exec(uas);\n\n  _iphone = /\\b(iPhone|iP[ao]d)/.exec(uas);\n  _ipad = /\\b(iP[ao]d)/.exec(uas);\n  _android = /Android/i.exec(uas);\n  _native = /FBAN\\/\\w+;/i.exec(uas);\n  _mobile = /Mobile/i.exec(uas);\n\n  // Note that the IE team blog would have you believe you should be checking\n  // for 'Win64; x64'.  But MSDN then reveals that you can actually be coming\n  // from either x64 or ia64;  so ultimately, you should just check for Win64\n  // as in indicator of whether you're in 64-bit IE.  32-bit IE on 64-bit\n  // Windows will send 'WOW64' instead.\n  _win64 = !!(/Win64/.exec(uas));\n\n  if (agent) {\n    _ie = agent[1] ? parseFloat(agent[1]) : (\n          agent[5] ? parseFloat(agent[5]) : NaN);\n    // IE compatibility mode\n    if (_ie && document && document.documentMode) {\n      _ie = document.documentMode;\n    }\n    // grab the \"true\" ie version from the trident token if available\n    var trident = /(?:Trident\\/(\\d+.\\d+))/.exec(uas);\n    _ie_real_version = trident ? parseFloat(trident[1]) + 4 : _ie;\n\n    _firefox = agent[2] ? parseFloat(agent[2]) : NaN;\n    _opera   = agent[3] ? parseFloat(agent[3]) : NaN;\n    _webkit  = agent[4] ? parseFloat(agent[4]) : NaN;\n    if (_webkit) {\n      // We do not add the regexp to the above test, because it will always\n      // match 'safari' only since 'AppleWebKit' appears before 'Chrome' in\n      // the userAgent string.\n      agent = /(?:Chrome\\/(\\d+\\.\\d+))/.exec(uas);\n      _chrome = agent && agent[1] ? parseFloat(agent[1]) : NaN;\n    } else {\n      _chrome = NaN;\n    }\n  } else {\n    _ie = _firefox = _opera = _chrome = _webkit = NaN;\n  }\n\n  if (os) {\n    if (os[1]) {\n      // Detect OS X version.  If no version number matches, set _osx to true.\n      // Version examples:  10, 10_6_1, 10.7\n      // Parses version number as a float, taking only first two sets of\n      // digits.  If only one set of digits is found, returns just the major\n      // version number.\n      var ver = /(?:Mac OS X (\\d+(?:[._]\\d+)?))/.exec(uas);\n\n      _osx = ver ? parseFloat(ver[1].replace('_', '.')) : true;\n    } else {\n      _osx = false;\n    }\n    _windows = !!os[2];\n    _linux   = !!os[3];\n  } else {\n    _osx = _windows = _linux = false;\n  }\n}\n\nvar UserAgent_DEPRECATED = {\n\n  /**\n   *  Check if the UA is Internet Explorer.\n   *\n   *\n   *  @return float|NaN Version number (if match) or NaN.\n   */\n  ie: function() {\n    return _populate() || _ie;\n  },\n\n  /**\n   * Check if we're in Internet Explorer compatibility mode.\n   *\n   * @return bool true if in compatibility mode, false if\n   * not compatibility mode or not ie\n   */\n  ieCompatibilityMode: function() {\n    return _populate() || (_ie_real_version > _ie);\n  },\n\n\n  /**\n   * Whether the browser is 64-bit IE.  Really, this is kind of weak sauce;  we\n   * only need this because Skype can't handle 64-bit IE yet.  We need to remove\n   * this when we don't need it -- tracked by #601957.\n   */\n  ie64: function() {\n    return UserAgent_DEPRECATED.ie() && _win64;\n  },\n\n  /**\n   *  Check if the UA is Firefox.\n   *\n   *\n   *  @return float|NaN Version number (if match) or NaN.\n   */\n  firefox: function() {\n    return _populate() || _firefox;\n  },\n\n\n  /**\n   *  Check if the UA is Opera.\n   *\n   *\n   *  @return float|NaN Version number (if match) or NaN.\n   */\n  opera: function() {\n    return _populate() || _opera;\n  },\n\n\n  /**\n   *  Check if the UA is WebKit.\n   *\n   *\n   *  @return float|NaN Version number (if match) or NaN.\n   */\n  webkit: function() {\n    return _populate() || _webkit;\n  },\n\n  /**\n   *  For Push\n   *  WILL BE REMOVED VERY SOON. Use UserAgent_DEPRECATED.webkit\n   */\n  safari: function() {\n    return UserAgent_DEPRECATED.webkit();\n  },\n\n  /**\n   *  Check if the UA is a Chrome browser.\n   *\n   *\n   *  @return float|NaN Version number (if match) or NaN.\n   */\n  chrome : function() {\n    return _populate() || _chrome;\n  },\n\n\n  /**\n   *  Check if the user is running Windows.\n   *\n   *  @return bool `true' if the user's OS is Windows.\n   */\n  windows: function() {\n    return _populate() || _windows;\n  },\n\n\n  /**\n   *  Check if the user is running Mac OS X.\n   *\n   *  @return float|bool   Returns a float if a version number is detected,\n   *                       otherwise true/false.\n   */\n  osx: function() {\n    return _populate() || _osx;\n  },\n\n  /**\n   * Check if the user is running Linux.\n   *\n   * @return bool `true' if the user's OS is some flavor of Linux.\n   */\n  linux: function() {\n    return _populate() || _linux;\n  },\n\n  /**\n   * Check if the user is running on an iPhone or iPod platform.\n   *\n   * @return bool `true' if the user is running some flavor of the\n   *    iPhone OS.\n   */\n  iphone: function() {\n    return _populate() || _iphone;\n  },\n\n  mobile: function() {\n    return _populate() || (_iphone || _ipad || _android || _mobile);\n  },\n\n  nativeApp: function() {\n    // webviews inside of the native apps\n    return _populate() || _native;\n  },\n\n  android: function() {\n    return _populate() || _android;\n  },\n\n  ipad: function() {\n    return _populate() || _ipad;\n  }\n};\n\nmodule.exports = UserAgent_DEPRECATED;\n","/**\n  BSD License\n\n  Copyright (c) 2015, Facebook, Inc. All rights reserved.\n\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n\n  * Redistributions of source code must retain the above copyright notice, this\n    list of conditions and the following disclaimer.\n\n  * Redistributions in binary form must reproduce the above copyright notice,\n    this list of conditions and the following disclaimer in the documentation\n    and/or other materials provided with the distribution.\n\n  * Neither the name Facebook nor the names of its contributors may be used to\n    endorse or promote products derived from this software without specific\n    prior written permission.\n\n  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\n  ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n  ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n\"use strict\";\n\nconst UserAgent_DEPRECATED = require(\"./UserAgent_DEPRECATED\");\n\nconst isEventSupported = require(\"./isEventSupported\");\n\n// Reasonable defaults\nconst PIXEL_STEP = 10;\nconst LINE_HEIGHT = 40;\nconst PAGE_HEIGHT = 800;\n\n/**\n * Mouse wheel (and 2-finger trackpad) support on the web sucks.  It is\n * complicated, thus this doc is long and (hopefully) detailed enough to answer\n * your questions.\n *\n * If you need to react to the mouse wheel in a predictable way, this code is\n * like your bestest friend. * hugs *\n *\n * As of today, there are 4 DOM event types you can listen to:\n *\n *   'wheel'                -- Chrome(31+), FF(17+), IE(9+)\n *   'mousewheel'           -- Chrome, IE(6+), Opera, Safari\n *   'MozMousePixelScroll'  -- FF(3.5 only!) (2010-2013) -- don't bother!\n *   'DOMMouseScroll'       -- FF(0.9.7+) since 2003\n *\n * So what to do?  The is the best:\n *\n *   normalizeWheel.getEventType();\n *\n * In your event callback, use this code to get sane interpretation of the\n * deltas.  This code will return an object with properties:\n *\n *   spinX   -- normalized spin speed (use for zoom) - x plane\n *   spinY   -- \" - y plane\n *   pixelX  -- normalized distance (to pixels) - x plane\n *   pixelY  -- \" - y plane\n *\n * Wheel values are provided by the browser assuming you are using the wheel to\n * scroll a web page by a number of lines or pixels (or pages).  Values can vary\n * significantly on different platforms and browsers, forgetting that you can\n * scroll at different speeds.  Some devices (like trackpads) emit more events\n * at smaller increments with fine granularity, and some emit massive jumps with\n * linear speed or acceleration.\n *\n * This code does its best to normalize the deltas for you:\n *\n *   - spin is trying to normalize how far the wheel was spun (or trackpad\n *     dragged).  This is super useful for zoom support where you want to\n *     throw away the chunky scroll steps on the PC and make those equal to\n *     the slow and smooth tiny steps on the Mac. Key data: This code tries to\n *     resolve a single slow step on a wheel to 1.\n *\n *   - pixel is normalizing the desired scroll delta in pixel units.  You'll\n *     get the crazy differences between browsers, but at least it'll be in\n *     pixels!\n *\n *   - positive value indicates scrolling DOWN/RIGHT, negative UP/LEFT.  This\n *     should translate to positive value zooming IN, negative zooming OUT.\n *     This matches the newer 'wheel' event.\n *\n * Why are there spinX, spinY (or pixels)?\n *\n *   - spinX is a 2-finger side drag on the trackpad, and a shift + wheel turn\n *     with a mouse.  It results in side-scrolling in the browser by default.\n *\n *   - spinY is what you expect -- it's the classic axis of a mouse wheel.\n *\n *   - I dropped spinZ/pixelZ.  It is supported by the DOM 3 'wheel' event and\n *     probably is by browsers in conjunction with fancy 3D controllers .. but\n *     you know.\n *\n * Implementation info:\n *\n * Examples of 'wheel' event if you scroll slowly (down) by one step with an\n * average mouse:\n *\n *   OS X + Chrome  (mouse)     -    4   pixel delta  (wheelDelta -120)\n *   OS X + Safari  (mouse)     -  N/A   pixel delta  (wheelDelta  -12)\n *   OS X + Firefox (mouse)     -    0.1 line  delta  (wheelDelta  N/A)\n *   Win8 + Chrome  (mouse)     -  100   pixel delta  (wheelDelta -120)\n *   Win8 + Firefox (mouse)     -    3   line  delta  (wheelDelta -120)\n *\n * On the trackpad:\n *\n *   OS X + Chrome  (trackpad)  -    2   pixel delta  (wheelDelta   -6)\n *   OS X + Firefox (trackpad)  -    1   pixel delta  (wheelDelta  N/A)\n *\n * On other/older browsers.. it's more complicated as there can be multiple and\n * also missing delta values.\n *\n * The 'wheel' event is more standard:\n *\n * http://www.w3.org/TR/DOM-Level-3-Events/#events-wheelevents\n *\n * The basics is that it includes a unit, deltaMode (pixels, lines, pages), and\n * deltaX, deltaY and deltaZ.  Some browsers provide other values to maintain\n * backward compatibility with older events.  Those other values help us\n * better normalize spin speed.  Example of what the browsers provide:\n *\n *                          | event.wheelDelta | event.detail\n *        ------------------+------------------+--------------\n *          Safari v5/OS X  |       -120       |       0\n *          Safari v5/Win7  |       -120       |       0\n *         Chrome v17/OS X  |       -120       |       0\n *         Chrome v17/Win7  |       -120       |       0\n *                IE9/Win7  |       -120       |   undefined\n *         Firefox v4/OS X  |     undefined    |       1\n *         Firefox v4/Win7  |     undefined    |       3\n *\n */\nexport function normalizeWheel(/*object*/ event: any) /*object*/ {\n  let sX = 0,\n    sY = 0, // spinX, spinY\n    pX = 0,\n    pY = 0; // pixelX, pixelY\n\n  // Legacy\n  if (\"detail\" in event) {\n    sY = event.detail;\n  }\n  if (\"wheelDelta\" in event) {\n    sY = -event.wheelDelta / 120;\n  }\n  if (\"wheelDeltaY\" in event) {\n    sY = -event.wheelDeltaY / 120;\n  }\n  if (\"wheelDeltaX\" in event) {\n    sX = -event.wheelDeltaX / 120;\n  }\n\n  // side scrolling on FF with DOMMouseScroll\n  if (\"axis\" in event && event.axis === event.HORIZONTAL_AXIS) {\n    sX = sY;\n    sY = 0;\n  }\n\n  pX = sX * PIXEL_STEP;\n  pY = sY * PIXEL_STEP;\n\n  if (\"deltaY\" in event) {\n    pY = event.deltaY;\n  }\n  if (\"deltaX\" in event) {\n    pX = event.deltaX;\n  }\n\n  if ((pX || pY) && event.deltaMode) {\n    if (event.deltaMode === 1) {\n      // delta in LINE units\n      pX *= LINE_HEIGHT;\n      pY *= LINE_HEIGHT;\n    } else {\n      // delta in PAGE units\n      pX *= PAGE_HEIGHT;\n      pY *= PAGE_HEIGHT;\n    }\n  }\n\n  // Fall-back if spin cannot be determined\n  if (pX && !sX) {\n    sX = pX < 1 ? -1 : 1;\n  }\n  if (pY && !sY) {\n    sY = pY < 1 ? -1 : 1;\n  }\n\n  return {\n    spinX: sX,\n    spinY: -sY,\n    pixelX: pX,\n    pixelY: -pY\n  };\n}\n\n/**\n * The best combination if you prefer spinX + spinY normalization.  It favors\n * the older DOMMouseScroll for Firefox, as FF does not include wheelDelta with\n * 'wheel' event, making spin speed determination impossible.\n */\nnormalizeWheel.getEventType = function() /*string*/ {\n  return UserAgent_DEPRECATED.firefox()\n    ? \"DOMMouseScroll\"\n    : isEventSupported(\"wheel\")\n      ? \"wheel\"\n      : \"mousewheel\";\n};\n","import { normalizeWheel } from \"./normalizeWheel\";\n\nexport { normalizeWheel };\n","import { Instance } from \"../instance-provider/instance\";\nimport { extendShader } from \"../shaders/util/extend-shader\";\nimport { IShaderInitialization, IShaderIOExtension } from \"../types\";\n\nexport function extendShaderInitialization<T extends Instance>(\n  shaderIO: IShaderInitialization<T>,\n  extend: IShaderIOExtension<T>\n): IShaderInitialization<T> {\n  const extendedShaders = extendShader(shaderIO, extend.vs, extend.fs);\n\n  return {\n    fs: extendedShaders.fs,\n    instanceAttributes: (shaderIO.instanceAttributes || []).concat(\n      extend.instanceAttributes || []\n    ),\n    uniforms: (shaderIO.uniforms || []).concat(extend.uniforms || []),\n    vertexAttributes: (shaderIO.vertexAttributes || []).concat(\n      extend.vertexAttributes || []\n    ),\n    vertexCount: shaderIO.vertexCount,\n    vs: extendedShaders.vs\n  };\n}\n","import { LayerSurface } from \"../surface\";\nimport { IAutoEasingMethod } from \"./auto-easing-method\";\nimport { Vec } from \"./vector\";\n\nexport type AnimationDelayAccessor = (\n  groupIndex: number,\n  currentDelay: number\n) => number;\nexport type AnimationInstanceModificationCallback = (\n  groupIndex: number\n) => void;\n\nfunction isNumber(val: any): val is number {\n  return !isNaN(val);\n}\n\n/**\n * This provides some methods that aids in more complicated animation tasks, such as\n * adjusting gpu animated properties with differing time delay values for each change.\n */\nexport class AnimationHelper {\n  surface: LayerSurface;\n\n  constructor(surface: LayerSurface) {\n    this.surface = surface;\n  }\n\n  /**\n   * When you want to animate properties of instances but you want them to start at differing times,\n   * use this method to ensure the timings starting between the elements is correct.\n   *\n   * @param easingMethod This is the easing method used for the layer's property to animate\n   * @param groupCount This is the number of animations desired for a given delay level\n   * @param delayGap This is the amount of delay between each group. This can be a static value or\n   *                 can be a dynamic callback\n   */\n  groupAnimation(\n    easingMethod: IAutoEasingMethod<Vec>,\n    groupCount: number,\n    baseDelay: number,\n    delayGap: number | AnimationDelayAccessor,\n    modifyInstances: AnimationInstanceModificationCallback\n  ) {\n    // Get the time of the current frame as our timing basis\n    const startFrameTime = this.surface.frameMetrics.currentTime;\n    // Do an initial commit to ensure all previous animated properties are committed based on the\n    // Delay specified for them\n    this.surface.commit(startFrameTime);\n\n    // Loop through the the number of grouped animations to work with\n    for (let i = 0; i < groupCount; ++i) {\n      // Determine how much extra delay is applied for the provided group\n      const gap = isNumber(delayGap)\n        ? delayGap\n        : delayGap(i, easingMethod.delay);\n      // Apply the delay\n      easingMethod.delay = baseDelay + gap * i;\n      // Make the instance modifications\n      modifyInstances(i);\n      // Commit the instance modifications based on the current delay settings\n      this.surface.commit(startFrameTime);\n    }\n  }\n}\n","import { Bounds } from \"../primitives/bounds\";\nimport { EventManager } from \"../surface/event-manager\";\nimport {\n  IDragMetrics,\n  IMouseInteraction,\n  IWheelMetrics\n} from \"../surface/mouse-event-manager\";\nimport { View } from \"../surface/view\";\nimport {\n  add3,\n  divide2,\n  max3,\n  min3,\n  subtract2,\n  subtract3,\n  Vec3,\n  vec3\n} from \"../util\";\nimport { ChartCamera } from \"../util/chart-camera\";\nexport enum CameraBoundsAnchor {\n  TOP_LEFT,\n  TOP_MIDDLE,\n  TOP_RIGHT,\n  MIDDLE_LEFT,\n  MIDDLE,\n  MIDDLE_RIGHT,\n  BOTTOM_LEFT,\n  BOTTOM_MIDDLE,\n  BOTTOM_RIGHT\n}\n\n/**\n * This represents how the camera should be bounded in the world space. This gives enough information\n * to handle all cases of bounding, including screen padding and anchoring for cases where the viewed space\n * is smaller than the view.\n */\nexport interface ICameraBoundsOptions {\n  /** How the bounded world space should anchor itself within the view when the projected world space to the screen is smaller than the view */\n  anchor: CameraBoundsAnchor;\n  /** Minimum settings the camera can scale to */\n  scaleMin?: Vec3;\n  /** Maximum settings the camera can scale to */\n  scaleMax?: Vec3;\n  /** The actual screen pixels the bounds can exceed when the camera's view has reached the bounds of the world */\n  screenPadding: { left: number; right: number; top: number; bottom: number };\n  /** This is the view for which the bounds applies towards */\n  view: string;\n  /** The area the camera is bound inside */\n  worldBounds: Bounds;\n}\n\nexport interface IBasicCameraControllerOptions {\n  /** Takes in the options to be used for creating a new ViewBounds object on this controller. */\n  bounds?: ICameraBoundsOptions;\n  /** This is the camera this controller will manipulate */\n  camera: ChartCamera;\n  /** When this is set to true, the start view can be targetted even when behind other views */\n  ignoreCoverViews?: boolean;\n  /**\n   * This provides a control to filter panning that will be applied to the camera. The input and\n   * output of this will be the delta value to be applied.\n   */\n  panFilter?(\n    offset: [number, number, number],\n    view: View,\n    allViews: View[]\n  ): [number, number, number];\n  /**\n   * This adjusts how fast scaling is applied from the mouse wheel\n   */\n  scaleFactor?: number;\n  /**\n   * This provides a control to filter scaling that will be applied to the camera. The input and\n   * output of this will be the delta value to be applied.\n   */\n  scaleFilter?(\n    scale: [number, number, number],\n    view: View,\n    allViews: View[]\n  ): [number, number, number];\n  /**\n   * This is the view that MUST be the start view from the events.\n   * If not provided, then dragging anywhere will adjust the camera\n   */\n  startView?: string | string[];\n\n  /**\n   * This is a handler for when the camera has applied changes to the visible range of what is seen.\n   * Which most likely means offset or scale has been altered.\n   */\n  onRangeChanged?(camera: ChartCamera, targetView: View): void;\n  /**\n   * This specifies whether a view can be scrolled by wheel\n   * If this is not specified or set false, the view can be zoomed by wheel\n   */\n  wheelShouldScroll?: boolean;\n}\n\n/**\n * This provides some very basic common needs for a camera control system. This is not a total solution\n * very every scenario. This should just often handle most basic needs.\n */\nexport class BasicCameraController extends EventManager {\n  /**\n   * If total bounds of worldbounds + screenpadding is smaller\n   * than width or height of view, anchor dictates placement.\n   */\n  bounds?: ICameraBoundsOptions;\n  /** This is the camera that this controller will manipulate */\n  camera: ChartCamera;\n  /** When this is set to true, the start view can be targetted even when behind other views */\n  ignoreCoverViews?: boolean;\n  /** Informative property indicating the controller is panning the chart or not */\n  isPanning: boolean = false;\n  /** This is the filter applied to panning operations */\n  private panFilter = (\n    offset: [number, number, number],\n    _view: View,\n    _allViews: View[]\n  ) => offset;\n  /** The rate scale is adjusted with the mouse wheel */\n  scaleFactor: number;\n  /** THis is the filter applied to tscaling operations */\n  private scaleFilter = (\n    scale: [number, number, number],\n    _view: View,\n    _allViews: View[]\n  ) => scale;\n  /** The view that must be the start or focus of the interactions in order for the interactions to occur */\n  startViews: string[] = [];\n  /** Whether a view can be scrolled by wheel */\n  wheelShouldScroll: boolean;\n  /** Stores the views this controller has flagged for optimizing */\n  private optimizedViews = new Set<View>();\n\n  /**\n   * If an unconvered start view is not available, this is the next available covered view, if present\n   */\n  private coveredStartView: View;\n  /**\n   * Callback for when the range has changed for the camera in a view\n   */\n  private onRangeChanged = (_camera: ChartCamera, _targetView: View) => {\n    /* no-op */\n  };\n\n  /**\n   * This flag is set to true when a start view is targetted on mouse down even if it is not\n   * the top most view.\n   */\n  private startViewDidStart: boolean = false;\n\n  constructor(options: IBasicCameraControllerOptions) {\n    super();\n    if (options.bounds) {\n      this.setBounds(options.bounds);\n    }\n    this.camera = options.camera;\n    this.scaleFactor = options.scaleFactor || 1000.0;\n    this.ignoreCoverViews = options.ignoreCoverViews || false;\n\n    if (options.startView) {\n      this.startViews = Array.isArray(options.startView)\n        ? options.startView\n        : [options.startView];\n    }\n\n    this.panFilter = options.panFilter || this.panFilter;\n    this.scaleFilter = options.scaleFilter || this.scaleFilter;\n    this.onRangeChanged = options.onRangeChanged || this.onRangeChanged;\n\n    if (options.wheelShouldScroll) {\n      this.wheelShouldScroll = options.wheelShouldScroll;\n    }\n  }\n\n  /**\n   * Corrects camera offset to respect current bounds and anchor.\n   */\n  applyBounds = () => {\n    if (this.bounds && this.camera) {\n      const targetView = this.getView(this.bounds.view);\n      this.applyScaleBounds();\n\n      // Next bound the positioning\n      if (targetView) {\n        this.camera.offset[0] = this.boundsHorizontalOffset(\n          targetView,\n          this.bounds\n        );\n\n        this.camera.offset[1] = this.boundsVerticalOffset(\n          targetView,\n          this.bounds\n        );\n      }\n    }\n  };\n\n  applyScaleBounds = () => {\n    if (this.camera && this.bounds) {\n      // First bound the scaling\n      if (this.bounds.scaleMin) {\n        this.camera.setScale(max3(this.camera.scale, this.bounds.scaleMin));\n      }\n\n      if (this.bounds.scaleMax) {\n        this.camera.setScale(min3(this.camera.scale, this.bounds.scaleMax));\n      }\n    }\n  };\n\n  /**\n   * Calculation for adhering to an anchor - x-axis offset only.\n   */\n  anchoredByBoundsHorizontal(targetView: View, bounds: ICameraBoundsOptions) {\n    switch (bounds.anchor) {\n      case CameraBoundsAnchor.TOP_LEFT:\n      case CameraBoundsAnchor.MIDDLE_LEFT:\n      case CameraBoundsAnchor.BOTTOM_LEFT:\n        return -(\n          bounds.worldBounds.left -\n          bounds.screenPadding.left / this.camera.scale[0]\n        );\n\n      case CameraBoundsAnchor.TOP_MIDDLE:\n      case CameraBoundsAnchor.MIDDLE:\n      case CameraBoundsAnchor.BOTTOM_MIDDLE:\n        return -(\n          bounds.worldBounds.right -\n          bounds.worldBounds.width / 2 -\n          0.5 *\n            ((targetView.screenBounds.width + bounds.screenPadding.right) /\n              this.camera.scale[0])\n        );\n\n      case CameraBoundsAnchor.TOP_RIGHT:\n      case CameraBoundsAnchor.MIDDLE_RIGHT:\n      case CameraBoundsAnchor.BOTTOM_RIGHT:\n        return -(\n          bounds.worldBounds.right -\n          (targetView.screenBounds.width - bounds.screenPadding.right) /\n            this.camera.scale[0]\n        );\n    }\n  }\n\n  /**\n   * Calculation for adhering to an anchor - y-axis offset only.\n   */\n  anchoredByBoundsVertical(targetView: View, bounds: ICameraBoundsOptions) {\n    switch (bounds.anchor) {\n      case CameraBoundsAnchor.TOP_LEFT:\n      case CameraBoundsAnchor.TOP_MIDDLE:\n      case CameraBoundsAnchor.TOP_RIGHT:\n        return (\n          -bounds.worldBounds.top - -bounds.screenPadding.top / this.scale[1]\n        );\n\n      case CameraBoundsAnchor.MIDDLE_LEFT:\n      case CameraBoundsAnchor.MIDDLE:\n      case CameraBoundsAnchor.MIDDLE_RIGHT:\n        return (\n          -(bounds.worldBounds.bottom - bounds.worldBounds.height / 2) +\n          0.5 *\n            (targetView.screenBounds.height - bounds.screenPadding.bottom) /\n            this.scale[1]\n        );\n\n      case CameraBoundsAnchor.BOTTOM_LEFT:\n      case CameraBoundsAnchor.BOTTOM_MIDDLE:\n      case CameraBoundsAnchor.BOTTOM_RIGHT:\n        return -(\n          bounds.worldBounds.bottom -\n          (targetView.screenBounds.height - bounds.screenPadding.bottom) /\n            this.scale[1]\n        );\n    }\n  }\n\n  /**\n   * Returns offset on x-axis due to current bounds and anchor.\n   */\n  boundsHorizontalOffset(targetView: View, bounds: ICameraBoundsOptions) {\n    const worldTLinScreenSpace = targetView.worldToScreen([\n      bounds.worldBounds.left,\n      bounds.worldBounds.top\n    ]);\n    const worldBRinScreenSpace = targetView.worldToScreen([\n      bounds.worldBounds.right,\n      bounds.worldBounds.bottom\n    ]);\n\n    const widthDifference =\n      worldBRinScreenSpace[0] -\n      worldTLinScreenSpace[0] +\n      bounds.screenPadding.left +\n      bounds.screenPadding.right -\n      targetView.screenBounds.width;\n\n    // If the worldBounds are smaller than the screenBounds,\n    // We offset according to the anchoring\n    if (widthDifference < 0) {\n      return this.anchoredByBoundsHorizontal(targetView, bounds);\n    }\n\n    if (\n      worldBRinScreenSpace[0] <\n      targetView.screenBounds.right - bounds.screenPadding.right\n    ) {\n      return (\n        -bounds.worldBounds.right +\n        (targetView.screenBounds.width - bounds.screenPadding.right) /\n          this.camera.scale[0]\n      );\n    }\n\n    if (\n      worldTLinScreenSpace[0] >\n      targetView.screenBounds.left + bounds.screenPadding.left\n    ) {\n      return (\n        -bounds.worldBounds.left +\n        bounds.screenPadding.left / this.camera.scale[0]\n      );\n    }\n\n    return this.camera.offset[0];\n  }\n\n  /**\n   * Returns offset on y-axis due to current bounds and anchor.\n   */\n  boundsVerticalOffset(targetView: View, bounds: ICameraBoundsOptions) {\n    const worldTLinScreenSpace = targetView.worldToScreen([\n      bounds.worldBounds.left,\n      bounds.worldBounds.top\n    ]);\n    const worldBRinScreenSpace = targetView.worldToScreen([\n      bounds.worldBounds.right,\n      bounds.worldBounds.bottom\n    ]);\n\n    const heightDifference =\n      worldBRinScreenSpace[1] -\n      worldTLinScreenSpace[1] +\n      bounds.screenPadding.top +\n      bounds.screenPadding.bottom -\n      targetView.screenBounds.height;\n\n    // If the viewBounds are larger than the screenBounds,\n    // We offset according to the anchoring\n    if (heightDifference < 0) {\n      return this.anchoredByBoundsVertical(targetView, bounds);\n    }\n\n    if (\n      worldTLinScreenSpace[1] >\n      targetView.screenBounds.top - bounds.screenPadding.top\n    ) {\n      return -(\n        bounds.worldBounds.top -\n        bounds.screenPadding.top / this.camera.scale[1]\n      );\n    }\n\n    if (\n      worldBRinScreenSpace[1] <\n      targetView.screenBounds.bottom + bounds.screenPadding.bottom\n    ) {\n      return -(\n        bounds.worldBounds.bottom +\n        (-targetView.screenBounds.height + bounds.screenPadding.bottom) /\n          this.camera.scale[1]\n      );\n    }\n\n    return this.camera.offset[1];\n  }\n\n  private canStart(viewId: string) {\n    return (\n      this.startViews.length === 0 ||\n      (this.startViews && this.startViews.indexOf(viewId) > -1) ||\n      (this.startViewDidStart && this.ignoreCoverViews)\n    );\n  }\n\n  private findCoveredStartView(e: IMouseInteraction) {\n    const found = e.viewsUnderMouse.find(\n      under => this.startViews.indexOf(under.view.id) > -1\n    );\n    this.startViewDidStart = Boolean(found);\n\n    if (found) {\n      this.coveredStartView = found.view;\n    }\n  }\n\n  private getTargetView(e: IMouseInteraction) {\n    // If we have a start view and we do not ignore covering views,\n    // Then our target view is the view we started with\n    if (this.startViews && !this.ignoreCoverViews) {\n      return e.target.view;\n    } else {\n      // Otherwise, we use the covered start view\n      return this.coveredStartView;\n    }\n  }\n\n  /**\n   * Used to aid in handling the pan effect and determine the contextual view targetted.\n   */\n  handleMouseDown(e: IMouseInteraction, _button: number) {\n    if (this.startViews) {\n      // We look for valid covered views on mouse down so dragging will work\n      this.findCoveredStartView(e);\n      // If this is a valid start view, then we enter a panning state with the mouse down\n      if (e.start) {\n        this.isPanning = this.canStart(e.start.view.id) || this.isPanning;\n      }\n    }\n  }\n\n  /**\n   * Used to aid in handling the pan effect\n   */\n  handleMouseUp(_e: IMouseInteraction) {\n    this.startViewDidStart = false;\n    this.isPanning = false;\n    this.optimizedViews.forEach(view => (view.optimizeRendering = false));\n    this.optimizedViews.clear();\n  }\n\n  private doPan(e: IMouseInteraction, view: View, delta: [number, number]) {\n    let pan: Vec3 = vec3(divide2(delta, this.camera.scale), 0);\n\n    if (this.panFilter) {\n      pan = this.panFilter(pan, view, e.viewsUnderMouse.map(v => v.view));\n    }\n\n    this.camera.offset[0] += pan[0];\n    this.camera.offset[1] += pan[1];\n\n    // Add additional correction for bounds\n    this.applyBounds();\n    // Broadcast the change occurred\n    if (e.start) this.onRangeChanged(this.camera, e.start.view);\n    // Add additional correction for bounds\n    this.applyBounds();\n    // Indicate the camera needs a refresh\n    this.camera.update();\n  }\n\n  /**\n   * Applies a panning effect by adjusting the camera's offset.\n   */\n  handleDrag(e: IMouseInteraction, drag: IDragMetrics) {\n    if (e.start) {\n      if (this.canStart(e.start.view.id)) {\n        e.viewsUnderMouse.forEach(view => {\n          view.view.optimizeRendering = true;\n          this.optimizedViews.add(view.view);\n        });\n\n        this.doPan(e, e.start.view, drag.screen.delta);\n      }\n    }\n  }\n\n  /**\n   * Applies a scaling effect to the camera for mouse wheel events\n   */\n  handleWheel(e: IMouseInteraction, wheelMetrics: IWheelMetrics) {\n    // Every mouse wheel event must look to see if it's over a valid covered start view\n    this.findCoveredStartView(e);\n\n    if (this.canStart(e.target.view.id)) {\n      if (this.wheelShouldScroll) {\n        const deltaPosition: [number, number] = [\n          -wheelMetrics.wheel[0],\n          wheelMetrics.wheel[1]\n        ];\n\n        if (e.start) this.doPan(e, e.start.view, deltaPosition);\n      } else {\n        const targetView = this.getTargetView(e);\n        const beforeZoom = targetView.screenToWorld(e.screen.mouse);\n        const currentZoomX = this.camera.scale[0] || 1.0;\n        const currentZoomY = this.camera.scale[1] || 1.0;\n\n        let deltaScale: [number, number, number] = [\n          wheelMetrics.wheel[1] / this.scaleFactor * currentZoomX,\n          wheelMetrics.wheel[1] / this.scaleFactor * currentZoomY,\n          1\n        ];\n\n        if (this.scaleFilter) {\n          deltaScale = this.scaleFilter(\n            deltaScale,\n            targetView,\n            e.viewsUnderMouse.map(v => v.view)\n          );\n        }\n\n        this.camera.scale[0] = currentZoomX + deltaScale[0];\n        this.camera.scale[1] = currentZoomY + deltaScale[1];\n\n        // Ensure the new scale values are within bounds before attempting to correct offsets\n        this.applyScaleBounds();\n\n        const afterZoom = targetView.screenToWorld(e.screen.mouse);\n        const deltaZoom = subtract2(beforeZoom, afterZoom);\n        this.camera.offset[0] -= deltaZoom[0];\n        this.camera.offset[1] -= deltaZoom[1];\n\n        // Add additional correction for bounds\n        this.applyBounds();\n        // Broadcast the change occurred\n        this.onRangeChanged(this.camera, targetView);\n        // Add additional correction for bounds\n        this.applyBounds();\n\n        // Make sure the camera updates\n        this.camera.update();\n      }\n    }\n  }\n\n  // These are the currently Unused responses for this controller\n  handleMouseOut(_e: IMouseInteraction) {\n    /*no-op*/\n  }\n  handleClick(_e: IMouseInteraction) {\n    /*no-op*/\n  }\n  handleMouseMove(_e: IMouseInteraction) {\n    /*no-op*/\n  }\n  handleMouseOver(_e: IMouseInteraction) {\n    /*no-op*/\n  }\n\n  /**\n   * Evaluates the world bounds the specified view is observing\n   *\n   * @param viewId The id of the view when the view was generated when the surface was made\n   */\n  getRange(viewId: string): Bounds {\n    /** Get the projections for the provided view */\n    const projection = this.getProjection(viewId);\n    /** Get the bounds on the screen for the indicated view */\n    const screenBounds = this.getViewScreenBounds(viewId);\n\n    // Make sure we have a valid projection and screen bounds to make the adjustment\n    if (projection && screenBounds) {\n      /** Get the current viewed world bounds of the view */\n      const topLeft = projection.screenToWorld([\n        screenBounds.x,\n        screenBounds.y\n      ]);\n      const bottomRight = projection.screenToWorld([\n        screenBounds.right,\n        screenBounds.bottom\n      ]);\n\n      return new Bounds({\n        height: bottomRight[1] - topLeft[1],\n        width: bottomRight[0] - topLeft[0],\n        x: topLeft[0],\n        y: topLeft[1]\n      });\n    }\n\n    return new Bounds({ x: 0, y: 0, width: 1, height: 1 });\n  }\n\n  /**\n   * Retrieves the current pan of the controlled camera\n   */\n  get pan(): Vec3 {\n    return this.camera.offset;\n  }\n\n  /**\n   * Sets bounds applicable to the supplied view.\n   * If no view is supplied, it uses the first in the startViews array\n   */\n  setBounds(bounds: ICameraBoundsOptions) {\n    this.bounds = bounds;\n    this.applyBounds();\n  }\n\n  /**\n   * Retrieves the current scale of the camera\n   */\n  get scale(): Vec3 {\n    return this.camera.scale;\n  }\n\n  /**\n   * This lets you set the visible range of a view based on the view's camera. This will probably not work\n   * as expected if the view indicated and this controller do not share the same camera.\n   *\n   * @param viewId The id of the view when the view was generated when the surface was made\n   */\n  setRange(newWorld: Bounds, viewId: string) {\n    /** Get the projections for the provided view */\n    const projection = this.getProjection(viewId);\n    /** Get the bounds on the screen for the indicated view */\n    const screenBounds = this.getViewScreenBounds(viewId);\n    /** Get the view the range is being applied towards */\n    const view = this.getView(viewId);\n\n    // Make sure we have a valid projection and screen bounds to make the adjustment\n    if (projection && screenBounds && view) {\n      const deltaScale = subtract3(\n        [\n          screenBounds.width / newWorld.width,\n          screenBounds.height / newWorld.height,\n          1\n        ],\n        this.camera.scale\n      );\n\n      this.camera.setScale(\n        add3(this.camera.scale, this.scaleFilter(deltaScale, view, [view]))\n      );\n\n      const deltaPan = subtract3(\n        [-newWorld.x, -newWorld.y, 0],\n        this.camera.offset\n      );\n\n      this.camera.setOffset(\n        add3(this.camera.offset, this.scaleFilter(deltaPan, view, [view]))\n      );\n\n      // Bound the camera to the specified bounding range\n      this.applyBounds();\n      // Broadcast the change occurred\n      this.onRangeChanged(this.camera, view);\n      // Bound the camera to the specified bounding range\n      this.applyBounds();\n    }\n  }\n}\n","export * from \"./basic-camera-controller\";\n","/**\n * This provides a WebGL2RenderingContext class object for the system to check instanceof so\n * type checking for WebGL2RenderingContext does not break the system.\n * when the target device does not have any notion of WebGL2 within it's environment.\n *\n * This does not attempt to mimic ANY behavior, it merely makes:\n *\n * foo instanceof WebGL2RenderingContext\n *\n * fail instead of break and error the system.\n */\n(window as any).WebGL2RenderingContext =\n  (window as any).WebGL2RenderingContext ||\n  function WebGL2RenderingContext() {\n    /** Do nothing */\n  };\n","import \"./util/webgl2-type-shim\";\n\nexport * from \"./base-event-managers\";\nexport * from \"./base-layers\";\nexport * from \"./instance-provider\";\nexport * from \"./primitives\";\nexport * from \"./surface\";\nexport * from \"./types\";\nexport * from \"./util\";\nexport * from \"./shaders\";\nexport * from \"./resources\";\nexport * from \"./gl\";\n"],"sourceRoot":""}