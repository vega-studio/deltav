{"version":3,"sources":["webpack://network-bubble-chart/webpack/universalModuleDefinition","webpack://network-bubble-chart/webpack/bootstrap","webpack://network-bubble-chart/external \"three\"","webpack://network-bubble-chart/./src/voidgl/types.ts","webpack://network-bubble-chart/./src/voidgl/primitives/bounds.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/types.ts","webpack://network-bubble-chart/./src/voidgl/surface/layer.ts","webpack://network-bubble-chart/./src/voidgl/instance-provider/instance.ts","webpack://network-bubble-chart/./src/voidgl/instance-provider/index.ts","webpack://network-bubble-chart/./src/voidgl/primitives/index.ts","webpack://network-bubble-chart/./src/voidgl/util/index.ts","webpack://network-bubble-chart/./src/voidgl/surface/texture/index.ts","webpack://network-bubble-chart/./src/voidgl/util/identify-by-key.ts","webpack://network-bubble-chart/./src/voidgl/instance-provider/observable.ts","webpack://network-bubble-chart/./src/voidgl/util/shader-templating.ts","webpack://network-bubble-chart/./src/voidgl/surface/generate-layer-model.ts","webpack://network-bubble-chart/./src/voidgl/surface/view.ts","webpack://network-bubble-chart/./src/voidgl/surface/scene.ts","webpack://network-bubble-chart/./src/voidgl/surface/texture/label-atlas-resource.ts","webpack://network-bubble-chart/./src/voidgl/surface/texture/base-atlas-resource.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/edges/types.ts","webpack://network-bubble-chart/./src/voidgl/shaders/template-vars.ts","webpack://network-bubble-chart/./src/voidgl/util/view-camera.ts","webpack://network-bubble-chart/./src/voidgl/util/chart-camera.ts","webpack://network-bubble-chart/./src/voidgl/util/vector.ts","webpack://network-bubble-chart/./src/voidgl/util/auto-easing-method.ts","webpack://network-bubble-chart/./src/voidgl/surface/event-manager.ts","webpack://network-bubble-chart/./src/voidgl/surface/mouse-event-manager.ts","webpack://network-bubble-chart/./src/voidgl/surface/inject-shader-io.ts","webpack://network-bubble-chart/./src/voidgl/surface/generate-layer-material.ts","webpack://network-bubble-chart/./src/voidgl/surface/generate-layer-geometry.ts","webpack://network-bubble-chart/./src/voidgl/util/data-bounds.ts","webpack://network-bubble-chart/./src/voidgl/surface/generate-default-scene.ts","webpack://network-bubble-chart/./src/voidgl/util/make-instance-uniform-name.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/labels/index.ts","webpack://network-bubble-chart/./src/voidgl/surface/texture/label-rasterizer.ts","webpack://network-bubble-chart/./src/voidgl/surface/texture/image-atlas-resource.ts","webpack://network-bubble-chart/./src/voidgl/surface/texture/color-rasterizer.ts","webpack://network-bubble-chart/./src/voidgl/surface/texture/color-atlas-resource.ts","webpack://network-bubble-chart/./src/voidgl/surface/texture/sub-texture.ts","webpack://network-bubble-chart/./src/voidgl/surface/texture/atlas.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/images/index.ts","webpack://network-bubble-chart/./src/voidgl/util/webgl-stat.ts","webpack://network-bubble-chart/./src/voidgl/util/uid.ts","webpack://network-bubble-chart/./node_modules/debug/src/browser.js","webpack://network-bubble-chart/./src/voidgl/util/mouse.ts","webpack://network-bubble-chart/./src/voidgl/surface/texture/atlas-resource-manager.ts","webpack://network-bubble-chart/./src/voidgl/surface/event-managers/layer-mouse-events.ts","webpack://network-bubble-chart/./src/voidgl/util/instance-uniform-manager.ts","webpack://network-bubble-chart/./src/voidgl/util/color-picking-analysis.ts","webpack://network-bubble-chart/./src/voidgl/util/quad-tree.ts","webpack://network-bubble-chart/./src/voidgl/primitives/absolute-position.ts","webpack://network-bubble-chart/./src/voidgl/shaders/fragments/color-picking-assignment.vs","webpack://network-bubble-chart/./src/voidgl/shaders/fragments/color-picking-disabled.fs","webpack://network-bubble-chart/./src/voidgl/shaders/fragments/color-picking-method.fs","webpack://network-bubble-chart/./src/voidgl/shaders/fragments/color-picking-vertex-header.vs","webpack://network-bubble-chart/./src/voidgl/shaders/fragments/projection-methods.vs","webpack://network-bubble-chart/./src/voidgl/shaders/fragments/shader-input.vs","webpack://network-bubble-chart/./src/voidgl/shaders/fragments/instance-destructuring-array.vs","webpack://network-bubble-chart/./src/voidgl/shaders/fragments/fragment-shader-composition.fs","webpack://network-bubble-chart/./src/voidgl/shaders/fragments/vertex-shader-composition.vs","webpack://network-bubble-chart/./src/voidgl/shaders/fragments/instance-retrieval-array.vs","webpack://network-bubble-chart/./src/voidgl/shaders/util/uniform-instance-block-array.ts","webpack://network-bubble-chart/./src/voidgl/shaders/util/attribute-generation.ts","webpack://network-bubble-chart/./src/voidgl/surface/layer-surface.ts","webpack://network-bubble-chart/./src/voidgl/surface/index.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/rings/ring-layer.vs","webpack://network-bubble-chart/./src/voidgl/base-layers/rings/ring-layer.fs","webpack://network-bubble-chart/./src/voidgl/base-layers/rings/ring-layer.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/rings/ring-instance.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/rings/index.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/rectangle/rectangle-instance.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/rectangle/rectangle-layer.vs","webpack://network-bubble-chart/./src/voidgl/base-layers/rectangle/rectangle-layer.fs","webpack://network-bubble-chart/./src/voidgl/base-layers/rectangle/rectangle-layer.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/rectangle/index.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/labels/label-instance.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/labels/label-layer.vs","webpack://network-bubble-chart/./src/voidgl/base-layers/labels/label-layer.fs","webpack://network-bubble-chart/./src/voidgl/base-layers/labels/label-layer.ts","webpack://network-bubble-chart/./src/voidgl/surface/texture/image-rasterizer.ts","webpack://network-bubble-chart/./src/voidgl/surface/texture/atlas-manager.ts","webpack://network-bubble-chart/./src/voidgl/surface/texture/pack-node.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/images/image-instance.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/images/image-layer.vs","webpack://network-bubble-chart/./src/voidgl/base-layers/images/image-layer.fs","webpack://network-bubble-chart/./src/voidgl/base-layers/images/image-layer.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/edges/edge-instance.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/edges/shader/edge-layer.fs","webpack://network-bubble-chart/./src/voidgl/base-layers/edges/shader/edge-layer-screen-curve.vs","webpack://network-bubble-chart/./src/voidgl/base-layers/edges/shader/edge-layer.vs","webpack://network-bubble-chart/./src/voidgl/base-layers/edges/shader/edge-layer-bezier2.vs","webpack://network-bubble-chart/./src/voidgl/base-layers/edges/shader/edge-layer-bezier.vs","webpack://network-bubble-chart/./src/voidgl/base-layers/edges/shader/edge-layer-line.vs","webpack://network-bubble-chart/./src/voidgl/base-layers/edges/edge-picking.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/edges/edge-layer.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/edges/index.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/circles/circle-instance.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/circles/circle-layer.vs","webpack://network-bubble-chart/./src/voidgl/base-layers/circles/circle-layer.fs","webpack://network-bubble-chart/./src/voidgl/shaders/base/no-op.vs","webpack://network-bubble-chart/./src/voidgl/shaders/base/no-op.fs","webpack://network-bubble-chart/./src/voidgl/surface/layer-interaction-handler.ts","webpack://network-bubble-chart/./src/voidgl/surface/instance-diff-manager.ts","webpack://network-bubble-chart/./src/voidgl/primitives/point.ts","webpack://network-bubble-chart/./src/voidgl/instance-provider/instance-provider.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/circles/circle-layer.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/circles/index.ts","webpack://network-bubble-chart/./src/voidgl/base-layers/index.ts","webpack://network-bubble-chart/./src/voidgl/shaders/util/extend-shader.ts","webpack://network-bubble-chart/./src/voidgl/util/extend-shader-io.ts","webpack://network-bubble-chart/./src/voidgl/util/tracked-quad-tree.ts","webpack://network-bubble-chart/./src/voidgl/util/reference-camera.ts","webpack://network-bubble-chart/./node_modules/ms/index.js","webpack://network-bubble-chart/./node_modules/debug/src/debug.js","webpack://network-bubble-chart/./node_modules/process/browser.js","webpack://network-bubble-chart/external \"bowser\"","webpack://network-bubble-chart/./src/voidgl/util/animation-helper.ts","webpack://network-bubble-chart/./src/voidgl/base-event-managers/basic-camera-controller.ts","webpack://network-bubble-chart/./src/voidgl/base-event-managers/index.ts","webpack://network-bubble-chart/./src/voidgl/index.ts","webpack://network-bubble-chart/./src/index.ts"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__0__","__WEBPACK_EXTERNAL_MODULE__114__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","InstanceBlockIndex","InstanceAttributeSize","UniformSize","VertexAttributeSize","ShaderInjectionTarget","PickType","InstanceDiffType","Bounds","options","this","x","y","width","height","left","top","bottom","right","emptyBounds","containsPoint","point","encapsulate","item","Math","abs","fits","bounds","hitBounds","isInside","toString","AnchorType","ScaleType","__extends","extendStatics","setPrototypeOf","__proto__","Array","b","__","constructor","create","Three","types_1","util_1","identify_by_key_1","instance_diff_manager_1","layer_interaction_handler_1","Layer","_super","props","_this","depth","instanceById","Map","instanceVertexCount","assign","defaultProps","_a","picking","NONE","ALL","pickingMethods","getInstancePickingMethods","currentPickMode","hitTest","quadTree","TrackedQuadTree","boundsAccessor","type","SINGLE","uidToInstance","diffManager","InstanceDiffManager","diffProcessor","getDiffProcessor","interactions","LayerInteractionHandler","destroy","uniformManager","didUpdateProps","draw","uniform","change","instance","uniforms","changeList","data","end","length","getUniforms","changes","resolve","update","materialUniforms","forEach","materialUniform","Error","getModelType","drawMode","TrianglesDrawMode","modelType","Mesh","getMaterialOptions","initShader","fs","instanceAttributes","vertexAttributes","vertexCount","vs","makeInstanceAttribute","block","blockIndex","size","atlas","makeUniform","shaderInjection","qualifier","willUpdateInstances","_changes","willUpdateProps","_newProps","didUpdate","IdentifyByKey","__decorate","decorators","target","key","desc","arguments","getOwnPropertyDescriptor","Reflect","decorate","observable_1","instanceUID","Instance","_easing","observableStorage","_uid","newUID","_id","id","active","_observer","set","val","oldObserver","remove","resourceTrigger","observable","__export","uid_1","ObservableMonitoring","setObservableMonitor","enabled","gatherIds","observableIds","getObservableMonitorIds","clear","values","slice","observableNamesToUID","propertyUID","uid","push","newVal","observer","instanceUpdated","shaderTemplate","templateOptions","shader","required","onError","onToken","matched","noValueProvided","notFound","shaderOptions","shaderResults","replace","_x","match","keys","option","results","resolvedShaderOptions","shaderProvidedOptions","unresolvedProvidedOptions","unresolvedShaderOptions","msg","console","error","generateLayerModel","layer","geometry","material","modelInfo","model","Boolean","isMesh","undefined","TriangleStripDrawMode","absolute_position_1","bounds_1","view_camera_1","isOrthographic","ClearFlags","View","pixelRatio","devicePixelRatio","screenToPixelSpace","out","pixelSpaceToScreen","screenToView","viewBounds","viewToScreen","screenToWorld","view","world","camera","offset","scale","viewCamera","ViewCameraType","CUSTOM","warn","worldToScreen","screen","viewToWorld","worldToView","fitViewtoViewport","surfaceDimensions","CONTROLLED","baseCamera","getAbsolutePositionBounds","viewport","far","near","position","z","updateMatrix","updateMatrixWorld","updateProjectionMatrix","screenBounds","DEFAULT_VIEW_ID","sortByDepth","a","Scene","container","pickingContainer","layers","sortIsDirty","viewById","frustumCulled","autoUpdate","addLayer","addView","removeLayer","index","indexOf","splice","sortLayers","sort","DEFAULT_SCENE_ID","LabelAtlasResource","label","BaseAtlasResource","sampleScale","EdgeScaleType","EdgeType","EdgeBroadphase","templateVars","attributeFragments","attributes","blocksPerInstance","easingMethod","easingMethods","extend","extendHeader","instanceBlockCount","instanceDataBinaryTree","instanceDataRetrieval","instanceDestructuring","instanceFragments","instanceUniformDeclarations","layerUniforms","projectionMethods","shaderInput","ViewCamera","chartCameraUID","applyArray","source","apply","concat","ChartCamera","location","sqrt","add1","scale1","vec","subtract1","multiply1","dot1","linear1","start","t","length1","add2","scale2","subtract2","multiply2","dot2","linear2","length2","add3","scale3","subtract3","multiply3","linear3","length3","dot3","add4","scale4","subtract4","multiply4","dot4","linear4","length4","VecMath","add","dot","linear","multiply","subtract","AutoEasingLoopStyle","vector_1","min","max","pow","round","sin","PI","GPU_PI","clamp","minVal","maxVal","easeOutElasticGPU","easeBackInGPU","AutoEasingMethod","cpu","gpu","duration","method","delay","loop","methodName","immediate","_start","_t","easeInQuad","time","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeOutElastic","easeBackIn","easeBackOut","t1","easeBackInOut","a1","t2","EventManager","getProjection","viewId","mouseManager","getView","getViewScreenBounds","setMouseManager","mouse_1","quad_tree_1","isDefined","MouseEventManager","canvas","views","controllers","handlesWheelEvents","eventCleanup","_waitingForRender","getViewsUnderMouse","mouse","hitViews","query","resize","context","setViews","setControllers","addContextListeners","QuadTree","addAll","map","v","filter","startView","element","startPosition","wheelHandler","event","eventElementPosition","interaction","makeInteraction","wheel","makeWheel","controller","handleWheel","stopPropagation","preventDefault","onwheel","addEventListener","onmouseleave","waitingForRender","handleMouseOut","onmousemove","handleMouseMove","onmousedown","downViews","canClick","clickStartTime","Date","now","currentPosition","handleMouseDown","button","document","delta","drag","makeDrag","handleDrag","onmouseup","_event","onmouseover","handleMouseOver","handleMouseUp","handleClick","onselectstart","addTouchContextListeners","ontouchstart","ontouchend","ontouchmove","ontouchcancel","_i","previous","current","viewsUnderMouse","normalizeWheel","onmousewheel","removeEventListener","_b","auto_easing_method_1","testStartVector","ONE","TWO","THREE","FOUR","testEndVector","emptyTexture","Texture","isEasingAttribute","attr","easing","isInstanceAttribute","isVertexAttribute","isUniform","toVertexAttributeInternal","attribute","materialAttribute","toUniformInternal","findEmptyBlock","seekingSize","usedBlocks","maxBlock","instanceAttribute","ind","breadth","sortNeedsUpdateFirstToTop","generateAtlasResourceUniforms","atlasInstanceAttributes","requestedAtlasInjections","isAtlasAttribute","injection","FRAGMENT","injections","VERTEX","ATLAS","resource","getAtlasTexture","compareVec","injectShaderIO","shaderIO","testStart","testEnd","test","validateInstanceAttributes","easingAttributes","instanceAttributes_1","_loop_1","easingValues","name_1","easingUID","currentTime","surface","frameMetrics","startTime","timeValue","REPEAT","REFLECT","timePassed","slot","startAttr","_o","startTimeAttr","durationAttr","easingAttributes_1","generateEasingAttributes","addedUniforms","MATRIX4","projectionMatrix","elements","matrix","generateBaseUniforms","generatePickingUniforms","addedInstanceAttributes","fillBlock","baseAttributes","activeAttribute","generateBaseInstanceAttributes","emptyFillBlock","color","generatePickingAttributes","allVertexAttributes","allUniforms","UNIFORM_SIZE_TO_MATERIAL_TYPE","MATRIX3","DEFAULT_UNIFORM_VALUE","toMaterialUniform","generateLayerMaterial","instancingUniforms","materialParams","vertexShader","fragmentShader","generatedUniform","RawShaderMaterial","isNumberCluster","isArray","generateLayerGeometry","maxInstancesPerBuffer","vertexBuffers","attribute_1","Float32Array","buffer","endk","formatError","k","j","endj","instanceSize","endk_1","copyWithin","instancingBuffer","instanceStartIndex","BufferGeometry","attribute_3","BufferAttribute","addAttribute","DataBounds","chart_camera_1","scene_1","view_1","generateDefaultScene","aspectRatio","viewSize","defaultCamera","OrthographicCamera","defaultChartCamera","defaultViewport","defaultView","defaultScene","scene","INSTANCE_UNIFORM_ATTRIBUTE_PREFIX","makeInstanceUniformNameArray","makeInstanceUniformNameTree","__awaiter","thisArg","_arguments","P","generator","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","f","g","_","sent","trys","ops","verb","throw","return","Symbol","iterator","op","TypeError","pop","floor","LabelRasterizer","awaitContext","getContext","setTimeout","calculateLabelSize","calculateTexture","calculateTrucatedText","sampleScaling","drawLabel","truncatedText","measureContents","minX","minY","maxX","maxY","rasterization","texture","createCroppedCanvas","maxWidth","text","firstTest","cursor","safety","substr","nextCursor","cropped","createElement","imageSmoothingEnabled","drawImage","fontSize","getLabelRasterizationFontSize","fillStyle","font","makeCSSFont","measureText","fillText","potentialCanvas","fontWeight","fontFamily","imageData","getImageData","Number","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","render","renderSync","ImageAtlasResource","image","ColorRasterizer","limit","makeCSS","opacity","fillRect","ColorAtlasResource","SubTexture","atlasReferenceID","atlasTexture","atlasTL","atlasTR","atlasBL","atlasBR","widthOnAtlas","heightOnAtlas","isValid","pixelWidth","pixelHeight","pack_node_1","sub_texture_1","AtlasSize","Atlas","validResources","textureSettings","packing","PackNode","updateTexture","invalidateResource","zero","setManager","manager","registerResource","removeResource","redoneCanvas","dispose","generateMipmaps","premultiplyAlpha","needsUpdate","_isValid","getProgramInfo","gl","program","attributeCount","uniformCount","activeUniforms","getProgramParameter","ACTIVE_UNIFORMS","activeAttributes","ACTIVE_ATTRIBUTES","enums","35664","35665","35666","35667","35668","35669","35670","35671","35672","35673","35674","35675","35676","35678","35680","5120","5121","5122","5123","5124","5125","5126","blocks","getActiveUniform","typeName","getActiveAttrib","WebGLStat","MAX_VERTEX_UNIFORMS","MAX_FRAGMENT_UNIFORMS","MAX_ATTRIBUTES","WEBGL_SUPPORTED","MAX_TEXTURE_SIZE","WebGLRenderingContext","getAContext","getParameter","MAX_VERTEX_UNIFORM_VECTORS","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_VERTEX_ATTRIBS","initStats","UID","CUID","colorUID","process","load","storage","debug","env","DEBUG","log","Function","formatArgs","args","useColors","namespace","humanize","diff","lastC","save","namespaces","removeItem","navigator","userAgent","toLowerCase","documentElement","style","WebkitAppearance","firebug","exception","table","parseInt","RegExp","$1","chrome","local","localStorage","localstorage","colors","formatters","JSON","stringify","err","message","enable","browser","three_1","IE_ADJUSTMENT","OLD_IE_ADJUSTMENT","MAX_FIREFOX_WHEELDELTA","lowPassY","LOW_PASS_U0","LOW_PASS_U1","LOW_PASS_U2","LOW_PASS_U3","firefox","deltaX","deltaY","sign","unshift","Vector2","msie","version","wheelDeltaX","wheelDeltaY","wheelDelta","detail","msedge","multiplyScalar","relative","mouseX","mouseY","eventX","eventY","nativeEvent","pageX","pageY","clientX","clientY","scrollLeft","scrollTop","offsetParent","offsetLeft","offsetTop","label_atlas_resource_1","toInstanceIOValue","AtlasResourceManager","targetAtlas","requestQueue","requestLookup","atlasManager","dequeueRequests","didDequeue","this_1","resources","_c","requests","atlasRequests_1","updateAtlas","request","delete","request_1","from","entries","atlasRequests","existingRequests","setTargetAtlas","LayerMouseEvents","isOver","sceneViews","getSceneViewsUnderMouse","sceneViewByViewId","sceneView","viewItem","getMouseByViewId","viewMouseByViewId","handleInteraction","handleMouseClick","_drag","handleMouseDrag","callback","sceneViews_1","handleSceneView","_e","_flag","updateColorPickRange","allSceneViews","currentSceneViews","generate_layer_model_1","make_instance_uniform_name_1","InstanceUniformManager","buffers","availableClusters","instanceToCluster","clusterToBuffer","maxUniformBlock","uniformBlocksPerInstance","makeNewBuffer","cluster","removeFromScene","pickModel","setScene","newGeometry","drawRange","count","newMaterial","clone","newModel","activeInstances","clusters","firstInstance","lastInstance","uniformIndex","uniformName","instanceData","Vector4","instanceIndex","uniformRange","analyzeColorPickingRendering","pickingData","allColors","colorData","dataHeight","dataWidth","nearestColor","uniqueColors","pixelIndex","distance","row","dx","dy","testDistance","filterQuery","queryValues","filtered","obj","find","Quadrants","mid","TL","Node","TR","BL","BR","children","nodes","child","doAdd","cover","childrenProps","MAX_VALUE","allChildren","gatherChildren","split","isNaN","area","list","visit","queryBounds","queryPoint","cb","finished","data_bounds_1","ref","scaleRatio","parse","num","parseFloat","reference","top_1","shader_templating_1","template_vars_1","instanceRetrievalArrayFragment","VECTOR_COMPONENTS","sizeToType","1","2","3","4","9","16","99","orderByPriority","makeVectorSwizzle","join","makeUniformArrayDeclaration","totalBlocks","fragment","fill","makeInstanceRetrievalArray","makeInstanceDestructuringArray","orderedAttributes","webgl_stat_1","uniform_instance_block_array_1","vertexShaderComposition","fragmentShaderComposition","instanceDestructuringArray","MAX_USE_PER_BLOCK","generateUniforms","injectionType","injectFragments","shaders","shaderInputMetrics","instancingInfo","instanceUniformBlockCount","ceil","calculateUniformBlockUseage","sortedInstanceAttributes","currentBlock","trueBlockIndex","blockUseage","innerBlockUseage","attributeSize","oldUseage","newUseage","innerUseage","instances","uniformMetrics","blockQualifierDedup","qualifiers","blockQualifiers","qualifierList","allQualifiers","declaration","makeInstanceUniformDeclaration","makeUniformInstanceDataOptions","metrics","generateInstanceDataLookupOptions","additionalOptions","generateVertexAttributes","methods","methodSizes","sizeType","generateEasingMethods","generateShaderInputs","generateVertexPicking","_maxInstancesPerBuffer","makeInstanceDestructuring","makePickingDestructuring","makeInstanceAttributeReferences","generateVertexShader","vertexShaderResults","generateFragmentShader","generateFragmentPickingMethod","images_1","labels_1","attribute_generation_1","generate_default_scene_1","generate_layer_geometry_1","generate_layer_material_1","inject_shader_io_1","mouse_event_manager_1","color_picking_analysis_1","instance_uniform_manager_1","layer_mouse_events_1","texture_1","atlas_resource_manager_1","DEFAULT_BACKGROUND_COLOR","Color","isCanvas","createLayer","layerClass","LayerSurface","AtlasManager","currentViewport","currentFrame","previousTime","isBufferingAtlas","scenes","willDisposeLayer","initLayer","commit","frameIncrement","onViewReady","pickingPass","resourceManager","renderer","pickingRenderer","LabelInstance","ImageInstance","didBuffer","drawSceneView","updateColorPick","defaultSceneElements","flags","clearFlags","COLOR","DEPTH","pickingTarget","Uint8Array","pickWidth","readRenderTargetPixels","pickHeight","colorPicking","rendererSize","getSize","getPixelRatio","background","SCISSOR_TEST","scissor","clearColor","setSize","setRenderTarget","STENCIL","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","setViewport","getViewSize","getViewWorldBounds","topLeft","bottomRight","init","setContext","initGL","initMouseManager","initResources","WebGLRenderer","alpha","antialias","preserveDrawingBuffer","autoClear","setFaceCulling","CullFaceNone","setRendererSize","setPixelRatio","setClearColor","sceneViewDepth","sceneOptions","newScene","viewOptions","newView","addLayerToScene","shaderMetrics","eventManagers","atlasResources","createAtlas","layerInitializers","existingLayer","layerId","_layer","fitContainer","_pixelRatio","parentElement","className","setAttribute","containerBox","getBoundingClientRect","box","isWebGLContext","canvasContext","isString","getElementById","WebGLRenderTarget","magFilter","LinearFilter","minFilter","stencilBuffer","primitives_1","layer_1","RingLayer","ring","radius","scaleFactor","vertexToNormal","0","5","vertexToSide","thickness","vertex","premultipliedAlpha","transparent","instance_1","RingInstance","instance_provider_1","anchorCalculator","TopLeft","anchor","_rectangle","padding","TopMiddle","rectangle","TopRight","MiddleLeft","Middle","MiddleRight","BottomLeft","BottomMiddle","BottomRight","Custom","RectangleInstance","scaling","BOUND_MAX","_anchor","setAnchor","newAnchor","types_2","RectangleLayer","anchorEffect","projection","maxScale","minScale","ALWAYS","NEVER","screenPoint","_u","blending","CustomBlending","blendSrc","OneFactor","rasterizationLookUp","_label","_cssFont","_fontFamily","_fontSize","_fontStyle","_fontWeight","_maxWidth","_text","_width","_height","_isDestroyed","fontStyle","cssFontLookup","rasterizations","references","_rasterization","LabelLayer","ImageRasterizer","calculateImageSize","_sampleScale","atlas_1","color_atlas_resource_1","color_rasterizer_1","image_atlas_resource_1","label_rasterizer_1","ZERO_IMAGE","allAtlas","destroyAtlas","atlasName","setDefaultImage","loadedImage","rect","dimensions","insertedNode","ux","uy","uw","uh","onePixelX","atlasDimensions","loadImage","isValidImage","first","second","insert","nodeImage","nodeDimensions","imageSrc","subTexture","image_1","onload","onerror","path","toDataURL","Image","src","resources_1","isLeaf","child0","child1","hasChild","newNode","fitFlag","imgWidth","imgHeight","dWidth","dHeight","removed","_image","tint","_sourceWidth","_sourceHeight","_element","_path","aspect","ImageLayer","EdgeInstance","colorStart","colorEnd","control","widthStart","widthEnd","setEdgeWidth","setColor","interpolation","LINE","p1","p2","_c1","_c2","BEZIER","c1","BEZIER2","c2","toPointObject","toPointArray","TEST_RESOLUTION","edgePicking","broadphase","minPickDistance","scaleType","interpolate","edge","edgeWidthStart","edgeWidthEnd","PASS_X","PASS_Y","SCREEN_CURVE","closestIndex","closestDistance","secondClosestIndex","secondClosestDistance","control1","control2","startPoint","endPoint","linePoint","lineWidth","startSegment","endSegment","vector","lineDirection","lineNormal","distanceTo","_view","edge_picking_1","pickVS","baseVS","screenVS","edgeFS","EdgeLayer","MAX_SEGMENTS","_d","vertexInterpolation","_uniform","InstanceProvider","CircleInstance","isMouseOver","isMouseDown","getColorPickInstance","_mouse","onMouseDown","hitTest_1","query_1","world_1","querySpace","check","bind","instanceForColor","onMouseOut","hitTest_2","query_2","world_2","onMouseUp","hitTest_3","query_3","world_3","onMouseOver","onMouseMove","hitTest_4","query_4","info","world_4","notOverInstances","isCurrentlyOver_1","noLongerOver","onMouseClick","hitTest_5","query_5","world_5","VECTOR_ACCESSORS","quadPicking","changeInstanceQuad","addInstanceQuad","removeInstanceQuad","changeInstanceColorPick","addInstanceColorPick","removeInstanceColorPick","changeInstance","addInstance","removeInstance","uniformCluster","updateInstance","uniformRangeStart","instanceUniform","squareDistance","Point","getClosest","testPoint","points","closestPoint","getClosestIndex","amount","normalize","magnitude","getDistance","squared","getMidpoint","direction","make","cleanObservation","instanceChanges","allowChanges","disposer","observableDisposer","INSERT","_property","CHANGE","REMOVE","CircleLayer","circle","circleScreenCenter","mouseScreen","animations","animate","animateCenter","center","animateRadius","animateColor","fadeOutOversized","extendShader","baseFS","extendedVS","extendedFS","header","token","extend_shader_1","extendShaderInitialization","extendedShaders","getBounds","childToNode","childToBounds","nullBounded","fromSplit","doRemove","found","node","ReferenceCamera","offsetFilter","scaleFilter","base","_val","h","plural","ms","str","String","exec","long","fmtLong","fmtShort","createDebug","prevTime","self","curr","prev","coerce","format","formatter","hash","charCodeAt","selectColor","stack","disable","names","skips","len","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","run","marker","runClearTimeout","Item","array","noop","nextTick","title","argv","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","isNumber","AnimationHelper","groupAnimation","groupCount","baseDelay","delayGap","modifyInstances","startFrameTime","gap","CameraBoundsAnchor","event_manager_1","BasicCameraController","isPanning","panFilter","_allViews","startViews","onRangeChanged","_camera","_targetView","startViewDidStart","applyBounds","targetView","applyScaleBounds","boundsHorizontalOffset","boundsVerticalOffset","scaleMin","scaleMax","setBounds","ignoreCoverViews","anchoredByBoundsHorizontal","TOP_LEFT","MIDDLE_LEFT","BOTTOM_LEFT","worldBounds","screenPadding","TOP_MIDDLE","MIDDLE","BOTTOM_MIDDLE","TOP_RIGHT","MIDDLE_RIGHT","BOTTOM_RIGHT","anchoredByBoundsVertical","worldTLinScreenSpace","worldBRinScreenSpace","canStart","findCoveredStartView","under","coveredStartView","getTargetView","_button","pan","wheelMetrics","beforeZoom","currentZoomX","currentZoomY","afterZoom","getRange","setRange","newWorld","deltaScale","deltaPan"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"three\"), require(\"bowser\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"three\", \"bowser\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"network-bubble-chart\"] = factory(require(\"three\"), require(\"bowser\"));\n\telse\n\t\troot[\"network-bubble-chart\"] = factory(root[\"three\"], root[\"bowser\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__, __WEBPACK_EXTERNAL_MODULE__114__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 119);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar InstanceBlockIndex;\n(function (InstanceBlockIndex) {\n    InstanceBlockIndex[InstanceBlockIndex[\"ONE\"] = 1] = \"ONE\";\n    InstanceBlockIndex[InstanceBlockIndex[\"TWO\"] = 2] = \"TWO\";\n    InstanceBlockIndex[InstanceBlockIndex[\"THREE\"] = 3] = \"THREE\";\n    InstanceBlockIndex[InstanceBlockIndex[\"FOUR\"] = 4] = \"FOUR\";\n})(InstanceBlockIndex = exports.InstanceBlockIndex || (exports.InstanceBlockIndex = {}));\nvar InstanceAttributeSize;\n(function (InstanceAttributeSize) {\n    InstanceAttributeSize[InstanceAttributeSize[\"ONE\"] = 1] = \"ONE\";\n    InstanceAttributeSize[InstanceAttributeSize[\"TWO\"] = 2] = \"TWO\";\n    InstanceAttributeSize[InstanceAttributeSize[\"THREE\"] = 3] = \"THREE\";\n    InstanceAttributeSize[InstanceAttributeSize[\"FOUR\"] = 4] = \"FOUR\";\n    InstanceAttributeSize[InstanceAttributeSize[\"ATLAS\"] = 99] = \"ATLAS\";\n})(InstanceAttributeSize = exports.InstanceAttributeSize || (exports.InstanceAttributeSize = {}));\nvar UniformSize;\n(function (UniformSize) {\n    UniformSize[UniformSize[\"ONE\"] = 1] = \"ONE\";\n    UniformSize[UniformSize[\"TWO\"] = 2] = \"TWO\";\n    UniformSize[UniformSize[\"THREE\"] = 3] = \"THREE\";\n    UniformSize[UniformSize[\"FOUR\"] = 4] = \"FOUR\";\n    UniformSize[UniformSize[\"MATRIX3\"] = 9] = \"MATRIX3\";\n    UniformSize[UniformSize[\"MATRIX4\"] = 16] = \"MATRIX4\";\n    UniformSize[UniformSize[\"ATLAS\"] = 99] = \"ATLAS\";\n})(UniformSize = exports.UniformSize || (exports.UniformSize = {}));\nvar VertexAttributeSize;\n(function (VertexAttributeSize) {\n    VertexAttributeSize[VertexAttributeSize[\"ONE\"] = 1] = \"ONE\";\n    VertexAttributeSize[VertexAttributeSize[\"TWO\"] = 2] = \"TWO\";\n    VertexAttributeSize[VertexAttributeSize[\"THREE\"] = 3] = \"THREE\";\n    VertexAttributeSize[VertexAttributeSize[\"FOUR\"] = 4] = \"FOUR\";\n})(VertexAttributeSize = exports.VertexAttributeSize || (exports.VertexAttributeSize = {}));\nvar ShaderInjectionTarget;\n(function (ShaderInjectionTarget) {\n    ShaderInjectionTarget[ShaderInjectionTarget[\"VERTEX\"] = 1] = \"VERTEX\";\n    ShaderInjectionTarget[ShaderInjectionTarget[\"FRAGMENT\"] = 2] = \"FRAGMENT\";\n    ShaderInjectionTarget[ShaderInjectionTarget[\"ALL\"] = 3] = \"ALL\";\n})(ShaderInjectionTarget = exports.ShaderInjectionTarget || (exports.ShaderInjectionTarget = {}));\nvar PickType;\n(function (PickType) {\n    PickType[PickType[\"NONE\"] = 0] = \"NONE\";\n    PickType[PickType[\"ALL\"] = 1] = \"ALL\";\n    PickType[PickType[\"SINGLE\"] = 2] = \"SINGLE\";\n})(PickType = exports.PickType || (exports.PickType = {}));\nvar InstanceDiffType;\n(function (InstanceDiffType) {\n    InstanceDiffType[InstanceDiffType[\"CHANGE\"] = 0] = \"CHANGE\";\n    InstanceDiffType[InstanceDiffType[\"INSERT\"] = 1] = \"INSERT\";\n    InstanceDiffType[InstanceDiffType[\"REMOVE\"] = 2] = \"REMOVE\";\n})(InstanceDiffType = exports.InstanceDiffType || (exports.InstanceDiffType = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Bounds = (function () {\n    function Bounds(options) {\n        this.x = 0;\n        this.y = 0;\n        this.width = 0;\n        this.height = 0;\n        this.x = options.x || options.left || 0;\n        this.y = options.y || options.top || 0;\n        this.height = options.height || (options.bottom || 0) - this.y || 0;\n        this.width = options.width || (options.right || 0) - this.x || 0;\n    }\n    Object.defineProperty(Bounds.prototype, \"area\", {\n        get: function () {\n            return this.width * this.height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Bounds.prototype, \"bottom\", {\n        get: function () {\n            return this.y + this.height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Bounds.prototype, \"left\", {\n        get: function () {\n            return this.x;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Bounds.prototype, \"mid\", {\n        get: function () {\n            return {\n                x: this.x + this.width / 2.0,\n                y: this.y + this.height / 2.0\n            };\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Bounds.prototype, \"right\", {\n        get: function () {\n            return this.x + this.width;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Bounds.prototype, \"top\", {\n        get: function () {\n            return this.y;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Bounds.emptyBounds = function () {\n        return new Bounds({\n            height: 0,\n            width: 0,\n            x: 0,\n            y: 0\n        });\n    };\n    Bounds.prototype.containsPoint = function (point) {\n        return !(point.x < this.x ||\n            point.y < this.y ||\n            point.x > this.right ||\n            point.y > this.bottom);\n    };\n    Bounds.prototype.encapsulate = function (item) {\n        if (item instanceof Bounds) {\n            if (item.x < this.x) {\n                this.width += Math.abs(item.x - this.x);\n                this.x = item.x;\n            }\n            if (item.y < this.y) {\n                this.height += Math.abs(item.y - this.y);\n                this.y = item.y;\n            }\n            if (this.right < item.right) {\n                this.width += item.right - this.right;\n            }\n            if (this.bottom < item.bottom) {\n                this.height += item.bottom - this.bottom;\n            }\n            return true;\n        }\n        else {\n            if (item.x < this.x) {\n                this.width += this.x - item.x;\n                this.x = item.x;\n            }\n            if (item.x > this.right) {\n                this.width += item.x - this.x;\n            }\n            if (item.y < this.y) {\n                this.height += this.y - item.y;\n                this.y = item.y;\n            }\n            if (item.y > this.bottom) {\n                this.height += item.y - this.y;\n            }\n            return true;\n        }\n    };\n    Bounds.prototype.fits = function (bounds) {\n        if (this.width === bounds.width && this.height === bounds.height) {\n            return 1;\n        }\n        if (this.width >= bounds.width && this.height >= bounds.height) {\n            return 2;\n        }\n        return 0;\n    };\n    Bounds.prototype.hitBounds = function (bounds) {\n        return !(this.right < bounds.x ||\n            this.x > bounds.right ||\n            this.bottom < bounds.y ||\n            this.y > bounds.height);\n    };\n    Bounds.prototype.isInside = function (bounds) {\n        return (this.x >= bounds.x &&\n            this.right <= bounds.right &&\n            this.y >= bounds.y &&\n            this.bottom <= bounds.bottom);\n    };\n    Bounds.prototype.toString = function () {\n        return \"{x: \" + this.x + \" y:\" + this.y + \" w:\" + this.width + \" h:\" + this.height + \"}\";\n    };\n    return Bounds;\n}());\nexports.Bounds = Bounds;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar AnchorType;\n(function (AnchorType) {\n    AnchorType[AnchorType[\"BottomLeft\"] = 0] = \"BottomLeft\";\n    AnchorType[AnchorType[\"BottomMiddle\"] = 1] = \"BottomMiddle\";\n    AnchorType[AnchorType[\"BottomRight\"] = 2] = \"BottomRight\";\n    AnchorType[AnchorType[\"Custom\"] = 3] = \"Custom\";\n    AnchorType[AnchorType[\"Middle\"] = 4] = \"Middle\";\n    AnchorType[AnchorType[\"MiddleLeft\"] = 5] = \"MiddleLeft\";\n    AnchorType[AnchorType[\"MiddleRight\"] = 6] = \"MiddleRight\";\n    AnchorType[AnchorType[\"TopLeft\"] = 7] = \"TopLeft\";\n    AnchorType[AnchorType[\"TopMiddle\"] = 8] = \"TopMiddle\";\n    AnchorType[AnchorType[\"TopRight\"] = 9] = \"TopRight\";\n})(AnchorType = exports.AnchorType || (exports.AnchorType = {}));\nvar ScaleType;\n(function (ScaleType) {\n    ScaleType[ScaleType[\"ALWAYS\"] = 1] = \"ALWAYS\";\n    ScaleType[ScaleType[\"BOUND_MAX\"] = 2] = \"BOUND_MAX\";\n    ScaleType[ScaleType[\"NEVER\"] = 3] = \"NEVER\";\n})(ScaleType = exports.ScaleType || (exports.ScaleType = {}));\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar types_1 = require(\"../types\");\nvar util_1 = require(\"../util\");\nvar identify_by_key_1 = require(\"../util/identify-by-key\");\nvar instance_diff_manager_1 = require(\"./instance-diff-manager\");\nvar layer_interaction_handler_1 = require(\"./layer-interaction-handler\");\nvar Layer = (function (_super) {\n    __extends(Layer, _super);\n    function Layer(props) {\n        var _this = _super.call(this, props) || this;\n        _this.depth = 0;\n        _this.instanceById = new Map();\n        _this.instanceVertexCount = 0;\n        _this.props = Object.assign({}, Layer.defaultProps || {}, props);\n        var _a = _this.props.picking, picking = _a === void 0 ? types_1.PickType.NONE : _a;\n        if (picking === types_1.PickType.ALL) {\n            var pickingMethods = _this.getInstancePickingMethods();\n            _this.picking = {\n                currentPickMode: types_1.PickType.NONE,\n                hitTest: pickingMethods.hitTest,\n                quadTree: new util_1.TrackedQuadTree(0, 1, 0, 1, pickingMethods.boundsAccessor),\n                type: types_1.PickType.ALL\n            };\n        }\n        else if (picking === types_1.PickType.SINGLE) {\n            _this.picking = {\n                currentPickMode: types_1.PickType.NONE,\n                type: types_1.PickType.SINGLE,\n                uidToInstance: new Map()\n            };\n        }\n        else {\n            _this.picking = {\n                currentPickMode: types_1.PickType.NONE,\n                type: types_1.PickType.NONE\n            };\n        }\n        _this.diffManager = new instance_diff_manager_1.InstanceDiffManager(_this);\n        _this.diffProcessor = _this.diffManager.getDiffProcessor();\n        _this.interactions = new layer_interaction_handler_1.LayerInteractionHandler(_this);\n        return _this;\n    }\n    Layer.prototype.destroy = function () {\n        this.uniformManager.destroy();\n    };\n    Layer.prototype.didUpdateProps = function () {\n    };\n    Layer.prototype.draw = function () {\n        var uniform;\n        var value;\n        var changeList = this.props.data.changeList;\n        var change, instance, uniforms;\n        var diffProcessor = this.diffProcessor;\n        var diffManager = this.diffManager;\n        for (var i = 0, end = changeList.length; i < end; ++i) {\n            change = changeList[i];\n            instance = change[0];\n            uniforms = this.uniformManager.getUniforms(instance);\n            diffProcessor[change[1]](diffManager, instance, uniforms);\n            instance.changes = {};\n        }\n        this.props.data.resolve();\n        for (var i = 0, end = this.uniforms.length; i < end; ++i) {\n            uniform = this.uniforms[i];\n            value = uniform.update(uniform);\n            uniform.materialUniforms.forEach(function (materialUniform) { return (materialUniform.value = value); });\n        }\n    };\n    Layer.prototype.getInstancePickingMethods = function () {\n        throw new Error(\"When picking is set to PickType.ALL, the layer MUST have this method implemented; otherwise, the layer is incompatible with this picking mode.\");\n    };\n    Layer.prototype.getModelType = function () {\n        return {\n            drawMode: Three.TrianglesDrawMode,\n            modelType: Three.Mesh\n        };\n    };\n    Layer.prototype.getMaterialOptions = function () {\n        return {};\n    };\n    Layer.prototype.initShader = function () {\n        return {\n            fs: require(\"../shaders/base/no-op.fs\"),\n            instanceAttributes: [],\n            uniforms: [],\n            vertexAttributes: [],\n            vertexCount: 0,\n            vs: require(\"../shaders/base/no-op.vs\")\n        };\n    };\n    Layer.prototype.makeInstanceAttribute = function (block, blockIndex, name, size, update, atlas) {\n        return {\n            atlas: atlas,\n            block: block,\n            blockIndex: blockIndex,\n            name: name,\n            size: size,\n            update: update\n        };\n    };\n    Layer.prototype.makeUniform = function (name, size, update, shaderInjection, qualifier) {\n        return {\n            name: name,\n            qualifier: qualifier,\n            shaderInjection: shaderInjection,\n            size: size,\n            update: update\n        };\n    };\n    Layer.prototype.willUpdateInstances = function (_changes) {\n    };\n    Layer.prototype.willUpdateProps = function (_newProps) {\n    };\n    Layer.prototype.didUpdate = function () {\n        this.props.data.resolve();\n    };\n    Layer.defaultProps = {};\n    return Layer;\n}(identify_by_key_1.IdentifyByKey));\nexports.Layer = Layer;\n","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar observable_1 = require(\"./observable\");\nvar instanceUID = 0;\nvar Instance = (function () {\n    function Instance(options) {\n        this._easing = new Map();\n        this.observableStorage = [];\n        this._uid = Instance.newUID;\n        this.changes = {};\n        this._id = options.id || \"\";\n        this.active = options.active || this.active;\n    }\n    Object.defineProperty(Instance, \"newUID\", {\n        get: function () {\n            return (instanceUID = ++instanceUID % 0xffffff);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Instance.prototype.destroy = function () {\n    };\n    Object.defineProperty(Instance.prototype, \"observableDisposer\", {\n        get: function () {\n            var _this = this;\n            return function () { return delete _this._observer; };\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Instance.prototype, \"observer\", {\n        get: function () {\n            return this._observer || null;\n        },\n        set: function (val) {\n            var oldObserver = this._observer;\n            if (oldObserver && oldObserver !== val) {\n                oldObserver.remove(this);\n            }\n            this._observer = val;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Instance.prototype, \"easing\", {\n        get: function () {\n            return this._easing;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Instance.prototype, \"id\", {\n        get: function () {\n            return this._id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Instance.prototype, \"uid\", {\n        get: function () {\n            return this._uid;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Instance.prototype.resourceTrigger = function () {\n    };\n    __decorate([\n        observable_1.observable\n    ], Instance.prototype, \"active\", void 0);\n    return Instance;\n}());\nexports.Instance = Instance;\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./observable\"));\n__export(require(\"./instance-provider\"));\n__export(require(\"./instance\"));\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./bounds\"));\n__export(require(\"./point\"));\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./animation-helper\"));\n__export(require(\"./auto-easing-method\"));\n__export(require(\"./chart-camera\"));\n__export(require(\"./mouse\"));\n__export(require(\"./reference-camera\"));\n__export(require(\"./shader-templating\"));\n__export(require(\"./tracked-quad-tree\"));\n__export(require(\"./uid\"));\n__export(require(\"./vector\"));\n__export(require(\"./view-camera\"));\n__export(require(\"./webgl-stat\"));\n__export(require(\"./extend-shader-io\"));\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./atlas\"));\n__export(require(\"./atlas-manager\"));\n__export(require(\"./color-atlas-resource\"));\n__export(require(\"./color-rasterizer\"));\n__export(require(\"./image-atlas-resource\"));\n__export(require(\"./image-rasterizer\"));\n__export(require(\"./label-atlas-resource\"));\n__export(require(\"./label-rasterizer\"));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar IdentifyByKey = (function () {\n    function IdentifyByKey(options) {\n        this.key = options.key;\n    }\n    Object.defineProperty(IdentifyByKey.prototype, \"id\", {\n        get: function () {\n            return this.key;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return IdentifyByKey;\n}());\nexports.IdentifyByKey = IdentifyByKey;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar uid_1 = require(\"../util/uid\");\nvar ObservableMonitoring = (function () {\n    function ObservableMonitoring() {\n    }\n    ObservableMonitoring.setObservableMonitor = function (enabled) {\n        ObservableMonitoring.gatherIds = enabled;\n        ObservableMonitoring.observableIds = [];\n    };\n    ObservableMonitoring.getObservableMonitorIds = function (clear) {\n        var values = ObservableMonitoring.observableIds.slice(0);\n        if (clear)\n            ObservableMonitoring.observableIds = [];\n        return values;\n    };\n    ObservableMonitoring.gatherIds = false;\n    ObservableMonitoring.observableIds = [];\n    ObservableMonitoring.observableNamesToUID = new Map();\n    return ObservableMonitoring;\n}());\nexports.ObservableMonitoring = ObservableMonitoring;\nfunction observable(target, key) {\n    var propertyUID = ObservableMonitoring.observableNamesToUID.get(key) || 0;\n    if (!propertyUID) {\n        propertyUID = uid_1.uid();\n        ObservableMonitoring.observableNamesToUID.set(key, propertyUID);\n    }\n    function getter() {\n        if (ObservableMonitoring.gatherIds) {\n            ObservableMonitoring.observableIds.push(propertyUID);\n        }\n        return this.observableStorage[propertyUID];\n    }\n    function setter(newVal) {\n        this.observableStorage[propertyUID] = newVal;\n        this.changes[propertyUID] = propertyUID;\n        this.observer && this.observer.instanceUpdated(this, propertyUID);\n    }\n    Object.defineProperty(target, key, {\n        configurable: true,\n        enumerable: true,\n        get: getter,\n        set: setter\n    });\n}\nexports.observable = observable;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction shaderTemplate(templateOptions) {\n    var shader = templateOptions.shader, options = templateOptions.options, required = templateOptions.required, onError = templateOptions.onError, onToken = templateOptions.onToken;\n    var matched = new Map();\n    var noValueProvided = new Map();\n    var notFound = new Map();\n    var shaderOptions = new Map();\n    var shaderResults = shader.replace(/\\$\\{(\\w+)\\}/g, function (_x, match) {\n        var replace = \"\";\n        shaderOptions.set(match, (shaderOptions.get(match) || 0) + 1);\n        if (match in options) {\n            matched.set(match, (matched.get(match) || 0) + 1);\n            replace = options[match];\n        }\n        else {\n            noValueProvided.set(match, (noValueProvided.get(match) || 0) + 1);\n        }\n        if (onToken) {\n            replace = onToken(match, replace);\n        }\n        return replace;\n    });\n    Object.keys(options).forEach(function (option) {\n        if (!matched.get(option)) {\n            notFound.set(option, (notFound.get(option) || 0) + 1);\n        }\n    });\n    var results = {\n        resolvedShaderOptions: matched,\n        shader: shaderResults,\n        shaderProvidedOptions: shaderOptions,\n        unresolvedProvidedOptions: notFound,\n        unresolvedShaderOptions: noValueProvided\n    };\n    if (required) {\n        required.values.forEach(function (require) {\n            if (results.unresolvedProvidedOptions.get(require)) {\n                var msg = required.name + \": Could not resolve all the required inputs. Input: \" + require;\n                if (onError)\n                    onError(msg);\n                else\n                    console.error(msg);\n            }\n            else if (results.unresolvedShaderOptions.get(require)) {\n                var msg = required.name + \": A required option was not provided in the options parameter. Option: \" + require;\n                if (onError)\n                    onError(msg);\n                else\n                    console.error(msg);\n            }\n            else if (!results.resolvedShaderOptions.get(require)) {\n                var msg = required.name + \": A required option was not provided in the options parameter. Option: \" + require;\n                if (onError)\n                    onError(msg);\n                else\n                    console.error(msg);\n            }\n        });\n    }\n    return results;\n}\nexports.shaderTemplate = shaderTemplate;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nfunction isMesh(val) {\n    return Boolean(val.isMesh);\n}\nfunction generateLayerModel(layer, geometry, material) {\n    var modelInfo = layer.getModelType();\n    var model = new modelInfo.modelType(geometry, material);\n    if (isMesh(model)) {\n        model.drawMode =\n            modelInfo.drawMode === undefined\n                ? Three.TriangleStripDrawMode\n                : modelInfo.drawMode;\n    }\n    return model;\n}\nexports.generateLayerModel = generateLayerModel;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar absolute_position_1 = require(\"../primitives/absolute-position\");\nvar bounds_1 = require(\"../primitives/bounds\");\nvar identify_by_key_1 = require(\"../util/identify-by-key\");\nvar view_camera_1 = require(\"../util/view-camera\");\nvar ClearFlags;\n(function (ClearFlags) {\n    ClearFlags[ClearFlags[\"COLOR\"] = 1] = \"COLOR\";\n    ClearFlags[ClearFlags[\"DEPTH\"] = 2] = \"DEPTH\";\n    ClearFlags[ClearFlags[\"STENCIL\"] = 4] = \"STENCIL\";\n})(ClearFlags = exports.ClearFlags || (exports.ClearFlags = {}));\nfunction isOrthographic(val) {\n    return \"left\" in val;\n}\nvar View = (function (_super) {\n    __extends(View, _super);\n    function View(options) {\n        var _this = _super.call(this, options) || this;\n        _this.depth = 0;\n        _this.pixelRatio = window.devicePixelRatio;\n        Object.assign(_this, options);\n        return _this;\n    }\n    View.prototype.screenToPixelSpace = function (point, out) {\n        var p = out || { x: 0, y: 0 };\n        p.x = point.x * this.pixelRatio;\n        p.y = point.y * this.pixelRatio;\n        return p;\n    };\n    View.prototype.pixelSpaceToScreen = function (point, out) {\n        var p = out || { x: 0, y: 0 };\n        p.x = point.x / this.pixelRatio;\n        p.y = point.y / this.pixelRatio;\n        return p;\n    };\n    View.prototype.screenToView = function (point, out) {\n        var p = this.screenToPixelSpace(point, out);\n        p.x = p.x - this.viewBounds.x;\n        p.y = p.y - this.viewBounds.y;\n        return p;\n    };\n    View.prototype.viewToScreen = function (point, out) {\n        var p = { x: 0, y: 0 };\n        p.x = point.x + this.viewBounds.x;\n        p.y = point.y + this.viewBounds.y;\n        return this.pixelSpaceToScreen(p, out);\n    };\n    View.prototype.screenToWorld = function (point, out) {\n        var view = this.pixelSpaceToScreen(this.screenToView(point));\n        var world = out || { x: 0, y: 0 };\n        world.x =\n            (view.x - this.camera.offset[0] * this.camera.scale[0]) /\n                this.camera.scale[0];\n        world.y =\n            (view.y - this.camera.offset[1] * this.camera.scale[1]) /\n                this.camera.scale[1];\n        if (this.viewCamera.type === view_camera_1.ViewCameraType.CUSTOM) {\n            console.warn(\"Custom View Camera projections not supported yet\");\n        }\n        return world;\n    };\n    View.prototype.worldToScreen = function (point, out) {\n        var screen = { x: 0, y: 0 };\n        screen.x =\n            (point.x * this.camera.scale[0] +\n                this.camera.offset[0] * this.camera.scale[0]) *\n                this.pixelRatio;\n        screen.y =\n            (point.y * this.camera.scale[1] +\n                this.camera.offset[1] * this.camera.scale[1]) *\n                this.pixelRatio;\n        if (this.viewCamera.type === view_camera_1.ViewCameraType.CUSTOM) {\n            console.warn(\"Custom View Camera projections not supported yet\");\n        }\n        return this.viewToScreen(screen, out);\n    };\n    View.prototype.viewToWorld = function (point, out) {\n        var world = out || { x: 0, y: 0 };\n        var screen = this.pixelSpaceToScreen(point);\n        world.x =\n            (screen.x - this.camera.offset[0] * this.camera.scale[0]) /\n                this.camera.scale[0];\n        world.y =\n            (screen.y - this.camera.offset[1] * this.camera.scale[1]) /\n                this.camera.scale[1];\n        if (this.viewCamera.type === view_camera_1.ViewCameraType.CUSTOM) {\n            console.warn(\"Custom View Camera projections not supported yet\");\n        }\n        return world;\n    };\n    View.prototype.worldToView = function (point, out) {\n        var screen = out || { x: 0, y: 0 };\n        screen.x =\n            point.x * this.camera.scale[0] +\n                this.camera.offset[0] * this.camera.scale[0];\n        screen.y =\n            point.y * this.camera.scale[1] +\n                this.camera.offset[1] * this.camera.scale[1];\n        if (this.viewCamera.type === view_camera_1.ViewCameraType.CUSTOM) {\n            console.warn(\"Custom View Camera projections not supported yet\");\n        }\n        return screen;\n    };\n    View.prototype.fitViewtoViewport = function (surfaceDimensions) {\n        if (this.viewCamera.type === view_camera_1.ViewCameraType.CONTROLLED &&\n            isOrthographic(this.viewCamera.baseCamera)) {\n            var viewBounds = absolute_position_1.getAbsolutePositionBounds(this.viewport, surfaceDimensions, this.pixelRatio);\n            var width = viewBounds.width;\n            var height = viewBounds.height;\n            var viewport = {\n                bottom: -height / 2,\n                far: 10000000,\n                left: -width / 2,\n                near: -100,\n                right: width / 2,\n                top: height / 2\n            };\n            var scaleX = 1;\n            var scaleY = 1;\n            var camera = this.viewCamera.baseCamera;\n            Object.assign(camera, viewport);\n            camera.position.set(-viewBounds.width / 2.0 * scaleX, viewBounds.height / 2.0 * scaleY, camera.position.z);\n            camera.scale.set(scaleX, -scaleY, 1.0);\n            camera.updateMatrix();\n            camera.updateMatrixWorld(true);\n            camera.updateProjectionMatrix();\n            this.viewBounds = viewBounds;\n            this.viewBounds.data = this;\n            this.screenBounds = new bounds_1.Bounds({\n                height: this.viewBounds.height / this.pixelRatio,\n                width: this.viewBounds.width / this.pixelRatio,\n                x: this.viewBounds.x / this.pixelRatio,\n                y: this.viewBounds.y / this.pixelRatio\n            });\n        }\n        else if (!isOrthographic(this.viewCamera.baseCamera)) {\n            console.warn(\"Fit to viewport does not support non-orthographic cameras as a default behavior.\");\n        }\n    };\n    View.DEFAULT_VIEW_ID = \"__default__\";\n    return View;\n}(identify_by_key_1.IdentifyByKey));\nexports.View = View;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar identify_by_key_1 = require(\"../util/identify-by-key\");\nfunction sortByDepth(a, b) {\n    return a.depth - b.depth;\n}\nvar Scene = (function (_super) {\n    __extends(Scene, _super);\n    function Scene(options) {\n        var _this = _super.call(this, options) || this;\n        _this.container = new Three.Scene();\n        _this.pickingContainer = new Three.Scene();\n        _this.layers = [];\n        _this.sortIsDirty = false;\n        _this.viewById = new Map();\n        _this.container.frustumCulled = false;\n        _this.container.autoUpdate = false;\n        return _this;\n    }\n    Scene.prototype.addLayer = function (layer) {\n        this.layers.push(layer);\n        this.sortIsDirty = true;\n    };\n    Scene.prototype.addView = function (view) {\n        this.viewById.set(view.id, view);\n    };\n    Scene.prototype.destroy = function () {\n        delete this.container;\n    };\n    Scene.prototype.removeLayer = function (layer) {\n        if (this.layers) {\n            var index = this.layers.indexOf(layer);\n            if (index >= 0) {\n                this.layers.splice(index, 1);\n                return;\n            }\n        }\n        console.warn(\"Could not remove a layer from the scene as the layer was not a part of the scene to start. Scene:\", this.id, \"Layer:\", layer.id);\n    };\n    Scene.prototype.sortLayers = function () {\n        if (this.sortIsDirty) {\n            this.layers.sort(sortByDepth);\n        }\n    };\n    Scene.DEFAULT_SCENE_ID = \"__default__\";\n    return Scene;\n}(identify_by_key_1.IdentifyByKey));\nexports.Scene = Scene;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_atlas_resource_1 = require(\"./base-atlas-resource\");\nvar LabelAtlasResource = (function (_super) {\n    __extends(LabelAtlasResource, _super);\n    function LabelAtlasResource(label) {\n        var _this = _super.call(this) || this;\n        _this.label = label;\n        return _this;\n    }\n    return LabelAtlasResource;\n}(base_atlas_resource_1.BaseAtlasResource));\nexports.LabelAtlasResource = LabelAtlasResource;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BaseAtlasResource = (function () {\n    function BaseAtlasResource() {\n        this.sampleScale = 1;\n    }\n    return BaseAtlasResource;\n}());\nexports.BaseAtlasResource = BaseAtlasResource;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EdgeScaleType;\n(function (EdgeScaleType) {\n    EdgeScaleType[EdgeScaleType[\"NONE\"] = 0] = \"NONE\";\n    EdgeScaleType[EdgeScaleType[\"SCREEN_CURVE\"] = 1] = \"SCREEN_CURVE\";\n})(EdgeScaleType = exports.EdgeScaleType || (exports.EdgeScaleType = {}));\nvar EdgeType;\n(function (EdgeType) {\n    EdgeType[EdgeType[\"LINE\"] = 0] = \"LINE\";\n    EdgeType[EdgeType[\"BEZIER\"] = 1] = \"BEZIER\";\n    EdgeType[EdgeType[\"BEZIER2\"] = 2] = \"BEZIER2\";\n})(EdgeType = exports.EdgeType || (exports.EdgeType = {}));\nvar EdgeBroadphase;\n(function (EdgeBroadphase) {\n    EdgeBroadphase[EdgeBroadphase[\"ALL\"] = 0] = \"ALL\";\n    EdgeBroadphase[EdgeBroadphase[\"PASS_Y\"] = 1] = \"PASS_Y\";\n    EdgeBroadphase[EdgeBroadphase[\"PASS_X\"] = 2] = \"PASS_X\";\n})(EdgeBroadphase = exports.EdgeBroadphase || (exports.EdgeBroadphase = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.templateVars = {\n    attributeFragments: \"attributeFragments\",\n    attributes: \"attributes\",\n    blocksPerInstance: \"blocksPerInstance\",\n    easingMethod: \"easingMethod\",\n    easingMethods: \"easingMethods\",\n    extend: \"extend\",\n    extendHeader: \"extendHeader\",\n    instanceBlockCount: \"instanceBlockCount\",\n    instanceDataBinaryTree: \"instanceDataBinaryTree\",\n    instanceDataRetrieval: \"instanceDataRetrieval\",\n    instanceDestructuring: \"instanceDestructuring\",\n    instanceFragments: \"instanceFragments\",\n    instanceUniformDeclarations: \"instanceUniformDeclarations\",\n    layerUniforms: \"layerUniforms\",\n    picking: \"picking\",\n    projectionMethods: \"projectionMethods\",\n    shader: \"shader\",\n    shaderInput: \"shaderInput\",\n    vertexAttributes: \"vertexAttributes\"\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ViewCameraType;\n(function (ViewCameraType) {\n    ViewCameraType[ViewCameraType[\"CONTROLLED\"] = 0] = \"CONTROLLED\";\n    ViewCameraType[ViewCameraType[\"CUSTOM\"] = 1] = \"CUSTOM\";\n})(ViewCameraType = exports.ViewCameraType || (exports.ViewCameraType = {}));\nvar ViewCamera = (function () {\n    function ViewCamera() {\n        this.type = ViewCameraType.CONTROLLED;\n    }\n    return ViewCamera;\n}());\nexports.ViewCamera = ViewCamera;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar chartCameraUID = 0;\nfunction applyArray(target, source) {\n    target && source && target.splice.apply(target, [0, source.length].concat(source));\n}\nvar ChartCamera = (function () {\n    function ChartCamera(options) {\n        this._id = chartCameraUID++;\n        this.offset = [0, 0, 0];\n        this.scale = [1, 1, 1];\n        if (options) {\n            applyArray(this.offset, options.offset);\n            applyArray(this.scale, options.scale);\n        }\n    }\n    Object.defineProperty(ChartCamera.prototype, \"id\", {\n        get: function () {\n            return this._id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ChartCamera.prototype.position = function (location) {\n        this.offset = location.slice(0);\n    };\n    return ChartCamera;\n}());\nexports.ChartCamera = ChartCamera;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar sqrt = Math.sqrt;\nfunction add1(left, right) {\n    return [left[0] + right[0]];\n}\nexports.add1 = add1;\nfunction scale1(vec, scale) {\n    return [vec[0] * scale];\n}\nexports.scale1 = scale1;\nfunction subtract1(left, right) {\n    return [left[0] - right[0]];\n}\nexports.subtract1 = subtract1;\nfunction multiply1(left, right) {\n    return [left[0] * right[0]];\n}\nexports.multiply1 = multiply1;\nfunction dot1(left, right) {\n    return left[0] * right[0];\n}\nexports.dot1 = dot1;\nfunction linear1(start, end, t) {\n    return scale1(add1(subtract1(end, start), start), t);\n}\nexports.linear1 = linear1;\nfunction length1(start) {\n    return sqrt(dot1(start, start));\n}\nexports.length1 = length1;\nfunction add2(left, right) {\n    return [left[0] + right[0], left[1] + right[1]];\n}\nexports.add2 = add2;\nfunction scale2(left, scale) {\n    return [left[0] * scale, left[1] * scale];\n}\nexports.scale2 = scale2;\nfunction subtract2(left, right) {\n    return [left[0] - right[0], left[1] - right[1]];\n}\nexports.subtract2 = subtract2;\nfunction multiply2(left, right) {\n    return [left[0] * right[0], left[1] * right[1]];\n}\nexports.multiply2 = multiply2;\nfunction dot2(left, right) {\n    return left[0] * right[0] + left[1] * right[1];\n}\nexports.dot2 = dot2;\nfunction linear2(start, end, t) {\n    return scale2(add2(subtract2(end, start), start), t);\n}\nexports.linear2 = linear2;\nfunction length2(start) {\n    return sqrt(dot2(start, start));\n}\nexports.length2 = length2;\nfunction add3(left, right) {\n    return [left[0] + right[0], left[1] + right[1], left[2] + right[2]];\n}\nexports.add3 = add3;\nfunction scale3(left, scale) {\n    return [left[0] * scale, left[1] * scale, left[2] * scale];\n}\nexports.scale3 = scale3;\nfunction subtract3(left, right) {\n    return [left[0] - right[0], left[1] - right[1], left[2] - right[2]];\n}\nexports.subtract3 = subtract3;\nfunction multiply3(left, right) {\n    return [left[0] * right[0], left[1] * right[1], left[2] * right[2]];\n}\nexports.multiply3 = multiply3;\nfunction linear3(start, end, t) {\n    return scale3(add3(subtract3(end, start), start), t);\n}\nexports.linear3 = linear3;\nfunction length3(start) {\n    return sqrt(dot3(start, start));\n}\nexports.length3 = length3;\nfunction dot3(left, right) {\n    return left[0] * right[0] + left[1] * right[1] + left[2] * right[2];\n}\nexports.dot3 = dot3;\nfunction add4(left, right) {\n    return [\n        left[0] + right[0],\n        left[1] + right[1],\n        left[2] + right[2],\n        left[3] + right[3]\n    ];\n}\nexports.add4 = add4;\nfunction scale4(left, scale) {\n    return [left[0] * scale, left[1] * scale, left[2] * scale, left[3] * scale];\n}\nexports.scale4 = scale4;\nfunction subtract4(left, right) {\n    return [\n        left[0] - right[0],\n        left[1] - right[1],\n        left[2] - right[2],\n        left[3] - right[3]\n    ];\n}\nexports.subtract4 = subtract4;\nfunction multiply4(left, right) {\n    return [\n        left[0] * right[0],\n        left[1] * right[1],\n        left[2] * right[2],\n        left[3] * right[3]\n    ];\n}\nexports.multiply4 = multiply4;\nfunction dot4(left, right) {\n    return (left[0] * right[0] +\n        left[1] * right[1] +\n        left[2] * right[2] +\n        left[3] * right[3]);\n}\nexports.dot4 = dot4;\nfunction linear4(start, end, t) {\n    return scale4(add4(subtract4(end, start), start), t);\n}\nexports.linear4 = linear4;\nfunction length4(start) {\n    return sqrt(dot4(start, start));\n}\nexports.length4 = length4;\nfunction VecMath(vec) {\n    var methods;\n    if (vec.length === 1) {\n        methods = {\n            add: add1,\n            dot: dot1,\n            length: length1,\n            linear: linear1,\n            multiply: multiply1,\n            scale: scale1,\n            subtract: subtract1\n        };\n        return methods;\n    }\n    else if (vec.length === 2) {\n        methods = {\n            add: add2,\n            dot: dot2,\n            length: length2,\n            linear: linear2,\n            multiply: multiply2,\n            scale: scale2,\n            subtract: subtract2\n        };\n        return methods;\n    }\n    else if (vec.length === 3) {\n        methods = {\n            add: add3,\n            dot: dot3,\n            length: length3,\n            linear: linear3,\n            multiply: multiply3,\n            scale: scale3,\n            subtract: subtract3\n        };\n        return methods;\n    }\n    methods = {\n        add: add4,\n        dot: dot4,\n        length: length4,\n        linear: linear4,\n        multiply: multiply4,\n        scale: scale4,\n        subtract: subtract4\n    };\n    return methods;\n}\nexports.VecMath = VecMath;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar vector_1 = require(\"./vector\");\nvar min = Math.min, max = Math.max, pow = Math.pow, round = Math.round, sin = Math.sin, PI = Math.PI;\nvar GPU_PI = round(PI * 1000) / 1000;\nfunction clamp(x, minVal, maxVal) {\n    return min(max(x, minVal), maxVal);\n}\nvar AutoEasingLoopStyle;\n(function (AutoEasingLoopStyle) {\n    AutoEasingLoopStyle[AutoEasingLoopStyle[\"NONE\"] = 1] = \"NONE\";\n    AutoEasingLoopStyle[AutoEasingLoopStyle[\"REPEAT\"] = 2] = \"REPEAT\";\n    AutoEasingLoopStyle[AutoEasingLoopStyle[\"REFLECT\"] = 3] = \"REFLECT\";\n})(AutoEasingLoopStyle = exports.AutoEasingLoopStyle || (exports.AutoEasingLoopStyle = {}));\nvar immediateGPU = \"\\n${easingMethod} {\\n  return end;\\n}\\n\";\nvar linearGPU = \"\\n${easingMethod} {\\n  return (end - start) * t + start;\\n}\\n\";\nvar easeInQuadGPU = \"\\n${easingMethod} {\\n  float time = t * t;\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeOutQuadGPU = \"\\n${easingMethod} {\\n  float time = t * (2.0 - t);\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeInOutQuadGPU = \"\\n${easingMethod} {\\n  float time = t < 0.5 ? 2.0 * t * t : -1.0 + (4.0 - 2.0 * t) * t;\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeInCubicGPU = \"\\n${easingMethod} {\\n  float time = t * t * t;\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeOutCubicGPU = \"\\n${easingMethod} {\\n  float t1 = t - 1.0;\\n  float time = t1 * t1 * t1 + 1.0;\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeInOutCubicGPU = \"\\n${easingMethod} {\\n  float time = t < 0.5 ? 4.0 * t * t * t : (t - 1.0) * (2.0 * t - 2.0) * (2.0 * t - 2.0) + 1.0;\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeInQuartGPU = \"\\n${easingMethod} {\\n  float time = t * t * t * t;\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeOutQuartGPU = \"\\n${easingMethod} {\\n  float t1 = t - 1.0;\\n  float time = 1.0 - t1 * t1 * t1 * t1;\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeInOutQuartGPU = \"\\n${easingMethod} {\\n  float t1 = t - 1.0;\\n  float time = t < 0.5 ? 8.0 * t * t * t * t : 1.0 - 8.0 * t1 * t1 * t1 * t1;\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeInQuintGPU = \"\\n${easingMethod} {\\n  float time = t * t * t * t * t;\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeOutQuintGPU = \"\\n${easingMethod} {\\n  float t1 = t - 1.0;\\n  float time = 1.0 + t1 * t1 * t1 * t1 * t1;\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeInOutQuintGPU = \"\\n${easingMethod} {\\n  float t1 = t - 1.0;\\n  float time = t < 0.5 ? 16.0 * t * t * t * t * t : 1.0 + 16.0 * t1 * t1 * t1 * t1 * t1;\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeOutElasticGPU = \"\\n${easingMethod} {\\n  float p = 0.3;\\n  float time = pow(2.0, -10.0 * t) * sin((t - p / 4.0) * (2.0 * \" + GPU_PI + \") / p) + 1.0;\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeBackInGPU = \"\\n${easingMethod} {\\n  float time = t * t * t - t * 1.05 * sin(t * \" + GPU_PI + \");\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeBackOutGPU = \"\\n${easingMethod} {\\n  float t1 = t - 1.0;\\n  float a = 1.7;\\n  float time = (t1 * t1 * ((a + 1.0) * t1 + a) + 1.0);\\n  return (end - start) * time + start;\\n}\\n\";\nvar easeBackInOutGPU = \"\\n${easingMethod} {\\n  float a = 1.4;\\n  float a1 = a * 1.525;\\n  float t1 = t / 0.5;\\n  float t2 = t1 - 2.0;\\n  float time =\\n    (t1 < 1.0) ? 0.5 * (t1 * t1 * (a1 + 1.0) * t1 - a1) :\\n    0.5 * (t2 * t2 * ((a1 + 1.0) * t2 + a1) + 2.0)\\n  ;\\n\\n  return (end - start) * time + start;\\n}\\n\";\nvar AutoEasingMethod = (function () {\n    function AutoEasingMethod(cpu, gpu, duration, method) {\n        this.delay = 0;\n        this.duration = 500;\n        this.loop = AutoEasingLoopStyle.NONE;\n        this.cpu = cpu;\n        this.gpu = gpu;\n        this.duration = duration || 500;\n        this.methodName = method || \"easingMethod\";\n    }\n    AutoEasingMethod.immediate = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (_start, end, _t) { return end; },\n            delay: delay,\n            duration: duration,\n            gpu: immediateGPU,\n            loop: loop,\n            methodName: \"immediate\"\n        };\n    };\n    AutoEasingMethod.linear = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                t = clamp(t, 0, 1);\n                return add(scale(subtract(end, start), t), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: linearGPU,\n            loop: loop,\n            methodName: \"linear\"\n        };\n    };\n    AutoEasingMethod.easeInQuad = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var time = t * t;\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeInQuadGPU,\n            loop: loop,\n            methodName: \"easeInQuad\"\n        };\n    };\n    AutoEasingMethod.easeOutQuad = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var time = t * (2 - t);\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeOutQuadGPU,\n            loop: loop,\n            methodName: \"easeOutQuad\"\n        };\n    };\n    AutoEasingMethod.easeInOutQuad = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var time = t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeInOutQuadGPU,\n            loop: loop,\n            methodName: \"easeInOutQuad\"\n        };\n    };\n    AutoEasingMethod.easeInCubic = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var time = t * t * t;\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeInCubicGPU,\n            loop: loop,\n            methodName: \"easeInCubic\"\n        };\n    };\n    AutoEasingMethod.easeOutCubic = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var time = --t * t * t + 1;\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeOutCubicGPU,\n            loop: loop,\n            methodName: \"easeOutCubic\"\n        };\n    };\n    AutoEasingMethod.easeInOutCubic = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var time = t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeInOutCubicGPU,\n            loop: loop,\n            methodName: \"easeInOutCubic\"\n        };\n    };\n    AutoEasingMethod.easeInQuart = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var time = t * t * t * t;\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeInQuartGPU,\n            loop: loop,\n            methodName: \"easeInQuart\"\n        };\n    };\n    AutoEasingMethod.easeOutQuart = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var time = 1 - --t * t * t * t;\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeOutQuartGPU,\n            loop: loop,\n            methodName: \"easeOutQuart\"\n        };\n    };\n    AutoEasingMethod.easeInOutQuart = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var time = t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t;\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeInOutQuartGPU,\n            loop: loop,\n            methodName: \"easeInOutQuart\"\n        };\n    };\n    AutoEasingMethod.easeInQuint = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var time = t * t * t * t * t;\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeInQuintGPU,\n            loop: loop,\n            methodName: \"easeInQuint\"\n        };\n    };\n    AutoEasingMethod.easeOutQuint = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var time = 1 + --t * t * t * t * t;\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeOutQuintGPU,\n            loop: loop,\n            methodName: \"easeOutQuint\"\n        };\n    };\n    AutoEasingMethod.easeInOutQuint = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var time = t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeInOutQuintGPU,\n            loop: loop,\n            methodName: \"easeInOutQuint\"\n        };\n    };\n    AutoEasingMethod.easeOutElastic = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var p = 0.3;\n                var time = pow(2, -10 * t) * sin((t - p / 4) * (2 * PI) / p) + 1;\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeOutElasticGPU,\n            loop: loop,\n            methodName: \"easeOutElastic\"\n        };\n    };\n    AutoEasingMethod.easeBackIn = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var a = 1.05;\n                var time = t * t * t - t * a * sin(t * PI);\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeBackInGPU,\n            loop: loop,\n            methodName: \"easeBackIn\"\n        };\n    };\n    AutoEasingMethod.easeBackOut = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var a = 1.7;\n                var t1 = t - 1;\n                var time = t1 * t1 * ((a + 1) * t1 + a) + 1;\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeBackOutGPU,\n            loop: loop,\n            methodName: \"easeBackOut\"\n        };\n    };\n    AutoEasingMethod.easeBackInOut = function (duration, delay, loop) {\n        if (delay === void 0) { delay = 0; }\n        if (loop === void 0) { loop = AutoEasingLoopStyle.NONE; }\n        return {\n            cpu: function (start, end, t) {\n                t = clamp(t, 0, 1);\n                var a = 1.7;\n                var a1 = a * 1.525;\n                var t1 = t / 0.5;\n                var t2 = t1 - 2;\n                var time = t1 < 1\n                    ? 0.5 * (t1 * t1 * (a1 + 1) * t1 - a1)\n                    : 0.5 * (t2 * t2 * ((a1 + 1) * t2 + a1) + 2);\n                var _a = vector_1.VecMath(start), add = _a.add, scale = _a.scale, subtract = _a.subtract;\n                return add(scale(subtract(end, start), time), start);\n            },\n            delay: delay,\n            duration: duration,\n            gpu: easeBackInOutGPU,\n            loop: loop,\n            methodName: \"easeBackInOut\"\n        };\n    };\n    return AutoEasingMethod;\n}());\nexports.AutoEasingMethod = AutoEasingMethod;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EventManager = (function () {\n    function EventManager() {\n    }\n    EventManager.prototype.getProjection = function (viewId) {\n        return this.mouseManager.getView(viewId);\n    };\n    EventManager.prototype.getView = function (viewId) {\n        return (this.mouseManager && this.mouseManager.getView(viewId)) || null;\n    };\n    EventManager.prototype.getViewScreenBounds = function (viewId) {\n        var view = this.mouseManager.getView(viewId);\n        if (view) {\n            return view.screenBounds;\n        }\n        return null;\n    };\n    EventManager.prototype.setMouseManager = function (mouseManager) {\n        this.mouseManager = mouseManager;\n    };\n    return EventManager;\n}());\nexports.EventManager = EventManager;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar mouse_1 = require(\"../util/mouse\");\nvar quad_tree_1 = require(\"../util/quad-tree\");\nvar VALID_CLICK_DELAY = 1e3;\nfunction sortByDepth(a, b) {\n    return b.data.depth - a.data.depth;\n}\nfunction isDefined(val) {\n    return Boolean(val);\n}\nvar MouseEventManager = (function () {\n    function MouseEventManager(canvas, views, controllers, handlesWheelEvents) {\n        var _this = this;\n        this.eventCleanup = [];\n        this._waitingForRender = true;\n        this.getViewsUnderMouse = function (mouse) {\n            var hitViews = _this.quadTree.query(mouse);\n            hitViews.sort(sortByDepth);\n            return hitViews;\n        };\n        this.resize = function () {\n            _this._waitingForRender = true;\n        };\n        this.context = canvas;\n        this.setViews(views);\n        this.setControllers(controllers);\n        this.addContextListeners(handlesWheelEvents);\n    }\n    Object.defineProperty(MouseEventManager.prototype, \"waitingForRender\", {\n        get: function () {\n            return this._waitingForRender;\n        },\n        set: function (val) {\n            this._waitingForRender = val;\n            if (!val) {\n                this.quadTree = new quad_tree_1.QuadTree(0, 0, 0, 0);\n                this.quadTree.addAll(this.views.map(function (v) { return v.bounds; }).filter(isDefined));\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    MouseEventManager.prototype.addContextListeners = function (handlesWheelEvents) {\n        var _this = this;\n        var element = this.context;\n        var startView;\n        var startPosition = { x: 0, y: 0 };\n        if (handlesWheelEvents) {\n            var wheelHandler = function (event) {\n                var mouse = mouse_1.eventElementPosition(event, element);\n                var interaction = _this.makeInteraction(mouse, startPosition, startView);\n                var wheel = _this.makeWheel(event);\n                _this.controllers.forEach(function (controller) {\n                    controller.handleWheel(interaction, wheel);\n                });\n                event.stopPropagation();\n                event.preventDefault();\n            };\n            if (\"onwheel\" in element) {\n                element.onwheel = wheelHandler;\n            }\n            if (\"addEventListener\" in element) {\n                element.addEventListener(\"DOMMouseScroll\", wheelHandler);\n                this.eventCleanup.push([\"DOMMouseScroll\", wheelHandler]);\n            }\n        }\n        element.onmouseleave = function (event) {\n            if (_this.waitingForRender)\n                return;\n            var mouse = mouse_1.eventElementPosition(event, element);\n            var interaction = _this.makeInteraction(mouse, startPosition, startView);\n            _this.controllers.forEach(function (controller) {\n                controller.handleMouseOut(interaction);\n            });\n        };\n        element.onmousemove = function (event) {\n            if (_this.waitingForRender)\n                return;\n            var mouse = mouse_1.eventElementPosition(event, element);\n            var interaction = _this.makeInteraction(mouse, startPosition, startView);\n            _this.controllers.forEach(function (controller) {\n                controller.handleMouseMove(interaction);\n            });\n        };\n        element.onmousedown = function (event) {\n            if (_this.waitingForRender)\n                return;\n            startPosition = mouse_1.eventElementPosition(event, element);\n            var downViews = _this.getViewsUnderMouse(startPosition);\n            var canClick = true;\n            var clickStartTime = Date.now();\n            if (downViews.length <= 0) {\n                return;\n            }\n            startView = downViews[0].data;\n            if (!startView)\n                return;\n            var interaction = _this.makeInteraction(startPosition, startPosition, startView);\n            var currentPosition = startPosition;\n            _this.controllers.forEach(function (controller) {\n                controller.handleMouseDown(interaction, event.button);\n            });\n            event.stopPropagation();\n            document.onmousemove = function (event) {\n                var mouse = mouse_1.eventElementPosition(event, element);\n                var interaction = _this.makeInteraction(mouse, startPosition, startView);\n                var delta = {\n                    x: mouse.x - currentPosition.x,\n                    y: mouse.y - currentPosition.y\n                };\n                var drag = _this.makeDrag(mouse, startPosition || { x: 0, y: 0 }, currentPosition, delta);\n                currentPosition = mouse;\n                _this.controllers.forEach(function (controller) {\n                    controller.handleDrag(interaction, drag);\n                });\n                canClick = false;\n            };\n            document.onmouseup = function (_event) {\n                document.onmousemove = null;\n                document.onmouseup = null;\n                document.onmouseover = null;\n            };\n            document.onmouseover = function (event) {\n                var mouse = mouse_1.eventElementPosition(event, element);\n                var interaction = _this.makeInteraction(mouse, startPosition, startView);\n                _this.controllers.forEach(function (controller) {\n                    controller.handleMouseOver(interaction);\n                });\n                event.stopPropagation();\n            };\n            element.onmouseup = function (event) {\n                var mouse = mouse_1.eventElementPosition(event, element);\n                var interaction = _this.makeInteraction(mouse, startPosition, startView);\n                _this.controllers.forEach(function (controller) {\n                    controller.handleMouseUp(interaction, event.button);\n                });\n                if (canClick && Date.now() - clickStartTime < VALID_CLICK_DELAY) {\n                    _this.controllers.forEach(function (controller) {\n                        controller.handleClick(interaction, event.button);\n                    });\n                }\n            };\n            element.onselectstart = function () {\n                return false;\n            };\n        };\n        this.addTouchContextListeners();\n    };\n    MouseEventManager.prototype.addTouchContextListeners = function () {\n        var element = this.context;\n        element.ontouchstart = function (_event) {\n        };\n        element.ontouchend = function (_event) {\n        };\n        element.ontouchmove = function (_event) {\n        };\n        element.ontouchcancel = function (_event) {\n        };\n    };\n    MouseEventManager.prototype.getView = function (viewId) {\n        for (var _i = 0, _a = this.views; _i < _a.length; _i++) {\n            var view = _a[_i];\n            if (view.view.id === viewId) {\n                return view.view;\n            }\n        }\n        return null;\n    };\n    MouseEventManager.prototype.makeDrag = function (mouse, start, previous, delta) {\n        return {\n            screen: {\n                current: mouse,\n                delta: delta,\n                previous: previous,\n                start: start\n            }\n        };\n    };\n    MouseEventManager.prototype.makeInteraction = function (mouse, start, startView) {\n        var hitViews = this.getViewsUnderMouse(mouse);\n        return {\n            screen: {\n                mouse: mouse\n            },\n            start: start &&\n                startView && {\n                mouse: startView.view.screenToView(mouse),\n                view: startView.view\n            },\n            target: {\n                mouse: hitViews[0] && hitViews[0].data.view.screenToView(mouse),\n                view: hitViews[0] && hitViews[0].data.view\n            },\n            viewsUnderMouse: hitViews.map(function (v) { return ({\n                mouse: v.data.view.screenToView(mouse),\n                view: v.data.view\n            }); })\n        };\n    };\n    MouseEventManager.prototype.makeWheel = function (event) {\n        var wheel = mouse_1.normalizeWheel(event);\n        return {\n            wheel: [wheel.x, wheel.y]\n        };\n    };\n    MouseEventManager.prototype.setControllers = function (controllers) {\n        this.controllers = controllers;\n        for (var _i = 0, _a = this.controllers; _i < _a.length; _i++) {\n            var controller = _a[_i];\n            controller.setMouseManager(this);\n        }\n    };\n    MouseEventManager.prototype.setViews = function (views) {\n        this.views = views;\n    };\n    MouseEventManager.prototype.destroy = function () {\n        var _this = this;\n        delete this.quadTree;\n        this.context.onmousedown = null;\n        this.context.onmousemove = null;\n        this.context.onmouseleave = null;\n        this.context.onmousewheel = null;\n        this.eventCleanup.forEach(function (event) {\n            _this.context.removeEventListener(event[0], event[1]);\n        });\n    };\n    return MouseEventManager;\n}());\nexports.MouseEventManager = MouseEventManager;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar types_1 = require(\"../types\");\nvar util_1 = require(\"../util\");\nvar auto_easing_method_1 = require(\"../util/auto-easing-method\");\nvar abs = Math.abs;\nvar testStartVector = (_a = {},\n    _a[types_1.InstanceAttributeSize.ONE] = [1],\n    _a[types_1.InstanceAttributeSize.TWO] = [1, 2],\n    _a[types_1.InstanceAttributeSize.THREE] = [1, 2, 3],\n    _a[types_1.InstanceAttributeSize.FOUR] = [1, 2, 3, 4],\n    _a);\nvar testEndVector = (_b = {},\n    _b[types_1.InstanceAttributeSize.ONE] = [4],\n    _b[types_1.InstanceAttributeSize.TWO] = [4, 3],\n    _b[types_1.InstanceAttributeSize.THREE] = [4, 3, 2],\n    _b[types_1.InstanceAttributeSize.FOUR] = [4, 3, 2, 1],\n    _b);\nvar emptyTexture = new Three.Texture();\nfunction isAtlasAttribute(attr) {\n    return Boolean(attr) && attr.atlas;\n}\nfunction isEasingAttribute(attr) {\n    return Boolean(attr) && attr.easing && attr.size !== undefined;\n}\nfunction isInstanceAttribute(attr) {\n    return Boolean(attr);\n}\nfunction isVertexAttribute(attr) {\n    return Boolean(attr);\n}\nfunction isUniform(attr) {\n    return Boolean(attr);\n}\nfunction toVertexAttributeInternal(attribute) {\n    return Object.assign({}, attribute, { materialAttribute: null });\n}\nfunction toUniformInternal(uniform) {\n    return Object.assign({}, uniform, { materialUniforms: [] });\n}\nfunction findEmptyBlock(attributes, seekingSize) {\n    var usedBlocks = [];\n    var maxBlock = 0;\n    if (seekingSize === undefined) {\n        seekingSize = 1;\n    }\n    attributes.forEach(function (instanceAttribute) {\n        var block = instanceAttribute.block;\n        var index = instanceAttribute.blockIndex === undefined\n            ? 0\n            : instanceAttribute.blockIndex;\n        var size = instanceAttribute.size === undefined ? 0 : instanceAttribute.size;\n        maxBlock = Math.max(block, maxBlock);\n        while (usedBlocks.length - 1 < block) {\n            usedBlocks.push([false, false, false, false]);\n        }\n        for (var i = index - 1, end = index - 1 + size; i < end; ++i) {\n            usedBlocks[block][i] = true;\n        }\n    });\n    for (var x = 0; x < usedBlocks.length; x++) {\n        for (var ind = 0; ind < 4; ind++) {\n            if (usedBlocks[x][ind]) {\n                continue;\n            }\n            else {\n                for (var breadth = ind; breadth < 4; breadth++) {\n                    if (!usedBlocks[x][breadth]) {\n                        if (breadth - ind + 1 === seekingSize) {\n                            return [x, ind + 1];\n                        }\n                    }\n                }\n            }\n        }\n    }\n    return [maxBlock + 1, types_1.InstanceBlockIndex.ONE];\n}\nfunction sortNeedsUpdateFirstToTop(a, b) {\n    if (a.atlas && !b.atlas)\n        return -1;\n    if (a.easing && !b.easing)\n        return -1;\n    return 1;\n}\nfunction generateAtlasResourceUniforms(layer, instanceAttributes) {\n    var atlasInstanceAttributes = [];\n    var requestedAtlasInjections = new Map();\n    instanceAttributes.forEach(function (attribute) {\n        if (isAtlasAttribute(attribute)) {\n            attribute.size = types_1.InstanceAttributeSize.FOUR;\n            attribute.blockIndex = types_1.InstanceBlockIndex.ONE;\n            var injection = attribute.atlas.shaderInjection || types_1.ShaderInjectionTarget.FRAGMENT;\n            var injections = requestedAtlasInjections.get(attribute.atlas.name);\n            if (injections) {\n                requestedAtlasInjections.set(attribute.atlas.name, [\n                    injections[0] ||\n                        injection === types_1.ShaderInjectionTarget.VERTEX ||\n                        injection === types_1.ShaderInjectionTarget.ALL,\n                    injections[1] ||\n                        injection === types_1.ShaderInjectionTarget.FRAGMENT ||\n                        injection === types_1.ShaderInjectionTarget.ALL\n                ]);\n            }\n            else {\n                atlasInstanceAttributes.push(attribute);\n                requestedAtlasInjections.set(attribute.atlas.name, [\n                    injection === types_1.ShaderInjectionTarget.VERTEX ||\n                        injection === types_1.ShaderInjectionTarget.ALL,\n                    injection === types_1.ShaderInjectionTarget.FRAGMENT ||\n                        injection === types_1.ShaderInjectionTarget.ALL\n                ]);\n            }\n        }\n    });\n    return atlasInstanceAttributes.map(function (instanceAttribute) {\n        var injection = types_1.ShaderInjectionTarget.FRAGMENT;\n        if (instanceAttribute.atlas) {\n            var injections = requestedAtlasInjections.get(instanceAttribute.atlas.name);\n            if (injections) {\n                injection =\n                    (injections[0] && injections[1] && types_1.ShaderInjectionTarget.ALL) ||\n                        (injections[0] && !injections[1] && types_1.ShaderInjectionTarget.VERTEX) ||\n                        (!injections[0] && injections[1] && types_1.ShaderInjectionTarget.FRAGMENT) ||\n                        injection;\n            }\n        }\n        return {\n            name: instanceAttribute.atlas.name,\n            shaderInjection: injection,\n            size: types_1.UniformSize.ATLAS,\n            update: function () {\n                return layer.resource.getAtlasTexture(instanceAttribute.atlas.key) ||\n                    emptyTexture;\n            }\n        };\n    });\n}\nfunction generateEasingAttributes(layer, instanceAttributes) {\n    var easingAttributes = [];\n    for (var _i = 0, instanceAttributes_1 = instanceAttributes; _i < instanceAttributes_1.length; _i++) {\n        var attribute = instanceAttributes_1[_i];\n        if (isEasingAttribute(attribute)) {\n            easingAttributes.push(attribute);\n        }\n    }\n    var _loop_1 = function (attribute) {\n        var _a = attribute.easing, easing = _a.cpu, loop = _a.loop;\n        var name_1 = attribute.name, size = attribute.size, update = attribute.update;\n        var easingUID = util_1.uid();\n        var easingValues;\n        attribute.update = function (o) {\n            var _a = attribute.easing, delay = _a.delay, duration = _a.duration;\n            var end = update(o);\n            var currentTime = layer.surface.frameMetrics.currentTime;\n            easingValues = o.easing.get(easingUID) || {\n                duration: duration,\n                end: end,\n                start: end,\n                startTime: currentTime\n            };\n            var timeValue = 1;\n            switch (loop) {\n                case auto_easing_method_1.AutoEasingLoopStyle.REPEAT:\n                    timeValue = ((currentTime - easingValues.startTime) / duration) % 1;\n                    break;\n                case auto_easing_method_1.AutoEasingLoopStyle.REFLECT:\n                    var timePassed = (currentTime - easingValues.startTime) / duration;\n                    timeValue = abs((timePassed / 2.0) % 1 - 0.5) * 2.0;\n                    break;\n                case auto_easing_method_1.AutoEasingLoopStyle.NONE:\n                default:\n                    timeValue = (currentTime - easingValues.startTime) / duration;\n                    break;\n            }\n            easingValues.start = easing(easingValues.start, easingValues.end, timeValue);\n            easingValues.startTime = currentTime + delay;\n            easingValues.end = end;\n            o.easing.set(easingUID, easingValues);\n            return end;\n        };\n        var slot = findEmptyBlock(instanceAttributes, size);\n        var startAttr = {\n            block: slot[0],\n            blockIndex: slot[1],\n            name: \"_\" + name_1 + \"_start\",\n            size: size,\n            update: function (_o) { return easingValues.start; }\n        };\n        instanceAttributes.push(startAttr);\n        slot = findEmptyBlock(instanceAttributes, types_1.InstanceAttributeSize.ONE);\n        var startTimeAttr = {\n            block: slot[0],\n            blockIndex: slot[1],\n            name: \"_\" + name_1 + \"_start_time\",\n            size: types_1.InstanceAttributeSize.ONE,\n            update: function (_o) { return [easingValues.startTime]; }\n        };\n        instanceAttributes.push(startTimeAttr);\n        slot = findEmptyBlock(instanceAttributes, types_1.InstanceAttributeSize.ONE);\n        var durationAttr = {\n            block: slot[0],\n            blockIndex: slot[1],\n            name: \"_\" + name_1 + \"_duration\",\n            size: types_1.InstanceAttributeSize.ONE,\n            update: function (_o) { return [easingValues.duration]; }\n        };\n        instanceAttributes.push(durationAttr);\n    };\n    for (var _a = 0, easingAttributes_1 = easingAttributes; _a < easingAttributes_1.length; _a++) {\n        var attribute = easingAttributes_1[_a];\n        _loop_1(attribute);\n    }\n}\nfunction generatePickingUniforms(layer) {\n    if (layer.picking.type === types_1.PickType.SINGLE) {\n        return [\n            {\n                name: \"pickingActive\",\n                shaderInjection: types_1.ShaderInjectionTarget.ALL,\n                size: types_1.UniformSize.ONE,\n                update: function () { return [\n                    layer.picking.currentPickMode === types_1.PickType.SINGLE ? 1.0 : 0.0\n                ]; }\n            }\n        ];\n    }\n    return [];\n}\nfunction generatePickingAttributes(layer, instanceAttributes) {\n    if (layer.picking.type === types_1.PickType.SINGLE) {\n        var emptyFillBlock = findEmptyBlock(instanceAttributes, types_1.InstanceAttributeSize.FOUR);\n        return [\n            {\n                block: emptyFillBlock[0],\n                blockIndex: emptyFillBlock[1],\n                name: \"_pickingColor\",\n                size: types_1.InstanceAttributeSize.FOUR,\n                update: function (o) {\n                    var color = 0xffffff - o.uid;\n                    return [\n                        (color >> 16) / 255.0,\n                        ((color & 0x00ff00) >> 8) / 255.0,\n                        (color & 0x0000ff) / 255.0,\n                        1\n                    ];\n                }\n            }\n        ];\n    }\n    return [];\n}\nfunction generateBaseUniforms(layer) {\n    return [\n        {\n            name: \"projection\",\n            size: types_1.UniformSize.MATRIX4,\n            update: function () { return layer.view.viewCamera.baseCamera.projectionMatrix.elements; }\n        },\n        {\n            name: \"modelView\",\n            size: types_1.UniformSize.MATRIX4,\n            update: function () { return layer.view.viewCamera.baseCamera.matrix.elements; }\n        },\n        {\n            name: \"cameraOffset\",\n            size: types_1.UniformSize.THREE,\n            update: function () { return layer.view.camera.offset; }\n        },\n        {\n            name: \"cameraScale\",\n            size: types_1.UniformSize.THREE,\n            update: function () { return layer.view.camera.scale; }\n        },\n        {\n            name: \"viewSize\",\n            size: types_1.UniformSize.TWO,\n            update: function () { return [layer.view.viewBounds.width, layer.view.viewBounds.height]; }\n        },\n        {\n            name: \"pixelRatio\",\n            size: types_1.UniformSize.ONE,\n            update: function () { return [layer.view.pixelRatio]; }\n        },\n        {\n            name: \"currentTime\",\n            size: types_1.UniformSize.ONE,\n            update: function () { return [layer.surface.frameMetrics.currentTime]; }\n        }\n    ];\n}\nfunction generateBaseInstanceAttributes(layer, instanceAttributes) {\n    var fillBlock = findEmptyBlock(instanceAttributes, types_1.InstanceAttributeSize.ONE);\n    var baseAttributes = [\n        {\n            block: fillBlock[0],\n            blockIndex: fillBlock[1],\n            name: \"_active\",\n            size: types_1.InstanceAttributeSize.ONE,\n            update: function (o) { return [o.active ? 1 : 0]; }\n        }\n    ];\n    layer.activeAttribute = baseAttributes[0];\n    return baseAttributes;\n}\nfunction generateBaseVertexAttributes() {\n    return [\n        {\n            name: \"instance\",\n            size: types_1.VertexAttributeSize.ONE,\n            update: function () { return [0]; }\n        }\n    ];\n}\nfunction compareVec(a, b) {\n    if (a.length !== b.length)\n        return false;\n    for (var i = 0, end = a.length; i < end; ++i) {\n        if (Math.round(a[i] * 100) / 100 !== Math.round(b[i] * 100) / 100) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction validateInstanceAttributes(instanceAttributes) {\n    instanceAttributes.forEach(function (attribute) {\n        if (attribute.easing && attribute.atlas) {\n            console.warn(\"An instance attribute can not have both easing and atlas properties. Undefined behavior will occur.\");\n            console.warn(attribute);\n        }\n        if (!attribute.atlas) {\n            if (attribute.size === undefined) {\n                console.warn(\"An instance attribute requires the size to be defined.\");\n                console.warn(attribute);\n            }\n        }\n        if (attribute.easing) {\n            if (attribute.size !== undefined) {\n                var testStart = testStartVector[attribute.size];\n                var testEnd = testEndVector[attribute.size];\n                var test = attribute.easing.cpu(testStart, testEnd, 0);\n                if (!compareVec(test, testStart)) {\n                    console.warn(\"Auto Easing Validation Failed: using a time of 0 does not produce the start value\");\n                    console.warn(\"Start:\", testStart, \"End:\", testEnd, \"Result:\", test);\n                    console.warn(attribute);\n                }\n                test = attribute.easing.cpu(testStart, testEnd, 1);\n                if (!compareVec(test, testEnd)) {\n                    console.warn(\"Auto Easing Validation Failed: using a time of 1 does not produce the end value\");\n                    console.warn(\"Start:\", testStart, \"End:\", testEnd, \"Result:\", test);\n                    console.warn(attribute);\n                }\n                test = attribute.easing.cpu(testStart, testEnd, -1);\n                if (!compareVec(test, testStart)) {\n                    console.warn(\"Auto Easing Validation Failed: using a time of -1 does not produce the start value\");\n                    console.warn(\"Start:\", testStart, \"End:\", testEnd, \"Result:\", test);\n                    console.warn(attribute);\n                }\n                test = attribute.easing.cpu(testStart, testEnd, 2);\n                if (!compareVec(test, testEnd)) {\n                    console.warn(\"Auto Easing Validation Failed: using a time of 2 does not produce the end value\");\n                    console.warn(\"Start:\", testStart, \"End:\", testEnd, \"Result:\", test);\n                    console.warn(attribute);\n                }\n            }\n            else {\n                console.warn(\"An Instance Attribute with easing MUST have a size declared\");\n            }\n        }\n    });\n}\nfunction injectShaderIO(layer, shaderIO) {\n    var instanceAttributes = (shaderIO.instanceAttributes || []).filter(isInstanceAttribute);\n    var vertexAttributes = (shaderIO.vertexAttributes || []).filter(isVertexAttribute);\n    var uniforms = (shaderIO.uniforms || []).filter(isUniform);\n    validateInstanceAttributes(instanceAttributes);\n    generateEasingAttributes(layer, instanceAttributes);\n    var addedUniforms = uniforms.concat(generateAtlasResourceUniforms(layer, instanceAttributes));\n    addedUniforms = addedUniforms.concat(generateBaseUniforms(layer));\n    addedUniforms = addedUniforms.concat(generatePickingUniforms(layer));\n    var addedInstanceAttributes = instanceAttributes.concat(generateBaseInstanceAttributes(layer, instanceAttributes));\n    addedInstanceAttributes = addedInstanceAttributes.concat(generatePickingAttributes(layer, addedInstanceAttributes));\n    var addedVertexAttributes = generateBaseVertexAttributes();\n    var allVertexAttributes = addedVertexAttributes\n        .concat(vertexAttributes || [])\n        .map(toVertexAttributeInternal);\n    var allUniforms = addedUniforms.map(toUniformInternal);\n    var allInstanceAttributes = addedInstanceAttributes.sort(sortNeedsUpdateFirstToTop);\n    return {\n        instanceAttributes: allInstanceAttributes,\n        uniforms: allUniforms,\n        vertexAttributes: allVertexAttributes\n    };\n}\nexports.injectShaderIO = injectShaderIO;\nvar _a, _b;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar types_1 = require(\"../types\");\nvar UNIFORM_SIZE_TO_MATERIAL_TYPE = (_a = {},\n    _a[types_1.UniformSize.ONE] = \"f\",\n    _a[types_1.UniformSize.TWO] = \"v2\",\n    _a[types_1.UniformSize.THREE] = \"v3\",\n    _a[types_1.UniformSize.FOUR] = \"v4\",\n    _a[types_1.UniformSize.MATRIX3] = \"Matrix3fv\",\n    _a[types_1.UniformSize.MATRIX4] = \"Matrix4fv\",\n    _a);\nvar DEFAULT_UNIFORM_VALUE = (_b = {},\n    _b[types_1.UniformSize.ONE] = [0],\n    _b[types_1.UniformSize.TWO] = [0, 0],\n    _b[types_1.UniformSize.THREE] = [0, 0, 0],\n    _b[types_1.UniformSize.FOUR] = [0, 0, 0, 0],\n    _b[types_1.UniformSize.MATRIX3] = [0, 0, 0, 0, 0, 0, 0, 0, 0],\n    _b[types_1.UniformSize.MATRIX4] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    _b);\nfunction toMaterialUniform(uniform) {\n    return {\n        type: UNIFORM_SIZE_TO_MATERIAL_TYPE[uniform.size],\n        value: DEFAULT_UNIFORM_VALUE[uniform.size]\n    };\n}\nfunction generateLayerMaterial(layer, vs, fs, layerUniforms, instancingUniforms) {\n    var materialParams = layer.getMaterialOptions();\n    materialParams.vertexShader = vs;\n    materialParams.fragmentShader = fs;\n    materialParams.uniforms = {};\n    for (var i = 0, end = layerUniforms.length; i < end; ++i) {\n        var uniform = layerUniforms[i];\n        var materialUniform = toMaterialUniform(uniform);\n        materialParams.uniforms[uniform.name] = materialUniform;\n    }\n    for (var i = 0, end = instancingUniforms.length; i < end; ++i) {\n        var generatedUniform = instancingUniforms[i];\n        materialParams.uniforms[generatedUniform.name] = {\n            type: generatedUniform.type,\n            value: generatedUniform.value\n        };\n    }\n    return new Three.RawShaderMaterial(materialParams);\n}\nexports.generateLayerMaterial = generateLayerMaterial;\nvar _a, _b;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nfunction isNumberCluster(val) {\n    return !Array.isArray(val[0]);\n}\nfunction generateLayerGeometry(maxInstancesPerBuffer, vertexAttributes, vertexCount) {\n    var vertexBuffers = [];\n    for (var i = 0, end = vertexAttributes.length; i < end; ++i) {\n        var attribute_1 = vertexAttributes[i];\n        vertexBuffers.push(new Float32Array(attribute_1.size * vertexCount * maxInstancesPerBuffer));\n    }\n    var endk = vertexAttributes.length;\n    var buffer;\n    var attribute;\n    var value;\n    var formatError = false;\n    for (var i = 0, end = vertexCount; i < end; ++i) {\n        for (var k = 0; k < endk; ++k) {\n            attribute = vertexAttributes[k];\n            buffer = vertexBuffers[k];\n            value = attribute.update(i);\n            if (isNumberCluster(value)) {\n                for (var j = i * attribute.size, endj = j + attribute.size, index = 0; j < endj; ++j, ++index) {\n                    buffer[j] = value[index];\n                }\n            }\n            else {\n                formatError = true;\n            }\n        }\n    }\n    if (formatError) {\n        console.warn(\"A vertex buffer updating method should not use arrays of arrays of numbers.\");\n    }\n    for (var i = 0, end = vertexAttributes.length; i < end; ++i) {\n        var attribute_2 = vertexAttributes[i];\n        var instanceSize = attribute_2.size * vertexCount;\n        for (var k = 1, endk_1 = maxInstancesPerBuffer; k < endk_1; ++k) {\n            vertexBuffers[i].copyWithin(instanceSize * k, 0, instanceSize);\n        }\n    }\n    var instancingBuffer = vertexBuffers[0];\n    for (var i = 0, end = maxInstancesPerBuffer; i < end; ++i) {\n        var instanceStartIndex = i * vertexCount;\n        for (var k = 0; k < vertexCount; ++k) {\n            instancingBuffer[k + instanceStartIndex] = i;\n        }\n    }\n    var geometry = new Three.BufferGeometry();\n    for (var i = 0, end = vertexAttributes.length; i < end; ++i) {\n        var attribute_3 = vertexAttributes[i];\n        var materialAttribute = new Three.BufferAttribute(vertexBuffers[i], attribute_3.size);\n        attribute_3.materialAttribute = materialAttribute;\n        geometry.addAttribute(attribute_3.name, materialAttribute);\n    }\n    return geometry;\n}\nexports.generateLayerGeometry = generateLayerGeometry;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar bounds_1 = require(\"../primitives/bounds\");\nvar DataBounds = (function (_super) {\n    __extends(DataBounds, _super);\n    function DataBounds() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    DataBounds.emptyBounds = function () {\n        return new DataBounds({\n            height: 0,\n            width: 0,\n            x: 0,\n            y: 0\n        });\n    };\n    return DataBounds;\n}(bounds_1.Bounds));\nexports.DataBounds = DataBounds;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar chart_camera_1 = require(\"../util/chart-camera\");\nvar view_camera_1 = require(\"../util/view-camera\");\nvar scene_1 = require(\"./scene\");\nvar view_1 = require(\"./view\");\nfunction generateDefaultScene(context) {\n    var height = context.canvas.height;\n    var width = context.canvas.width;\n    var aspectRatio = width / height;\n    var viewport = {\n        aspectRatio: aspectRatio,\n        bottom: -height / 2,\n        far: 10000000,\n        left: -width / 2,\n        near: -100,\n        right: width / 2,\n        top: height / 2,\n        viewSize: height\n    };\n    var defaultCamera = new view_camera_1.ViewCamera();\n    defaultCamera.baseCamera = new Three.OrthographicCamera(viewport.left, viewport.right, viewport.top, viewport.bottom, viewport.near, viewport.far);\n    defaultCamera.baseCamera.scale.set(1.0, -1.0, 1.0);\n    defaultCamera.baseCamera.position.set(0.0, 0.0, -300.0);\n    defaultCamera.baseCamera.updateMatrixWorld(true);\n    defaultCamera.baseCamera.updateMatrix();\n    if (defaultCamera.baseCamera instanceof Three.OrthographicCamera) {\n        defaultCamera.baseCamera.updateProjectionMatrix();\n    }\n    var defaultChartCamera = new chart_camera_1.ChartCamera();\n    var defaultViewport = {\n        bottom: 0,\n        left: 0,\n        right: 0,\n        top: 0\n    };\n    var defaultView = new view_1.View({\n        camera: defaultChartCamera,\n        key: view_1.View.DEFAULT_VIEW_ID,\n        viewCamera: defaultCamera,\n        viewport: defaultViewport\n    });\n    var defaultScene = new scene_1.Scene({\n        key: scene_1.Scene.DEFAULT_SCENE_ID,\n        views: []\n    });\n    defaultScene.addView(defaultView);\n    return {\n        camera: defaultChartCamera,\n        scene: defaultScene,\n        view: defaultView,\n        viewCamera: defaultCamera,\n        viewport: defaultViewport\n    };\n}\nexports.generateDefaultScene = generateDefaultScene;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar INSTANCE_UNIFORM_ATTRIBUTE_PREFIX = \"u\";\nfunction makeInstanceUniformNameArray() {\n    return \"instanceData\";\n}\nexports.makeInstanceUniformNameArray = makeInstanceUniformNameArray;\nfunction makeInstanceUniformNameTree(index) {\n    return \"\" + INSTANCE_UNIFORM_ATTRIBUTE_PREFIX + index.toString(31);\n}\nexports.makeInstanceUniformNameTree = makeInstanceUniformNameTree;\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./label-layer\"));\n__export(require(\"./label-instance\"));\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar canvas;\nvar MAX_FONT_SIZE = 50;\nvar floor = Math.floor, max = Math.max, min = Math.min;\nvar LabelRasterizer = (function () {\n    function LabelRasterizer() {\n    }\n    LabelRasterizer.awaitContext = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!!canvas) return [3, 2];\n                        this.getContext();\n                        return [4, new Promise(function (resolve) { return setTimeout(resolve, 10); })];\n                    case 1:\n                        _a.sent();\n                        return [3, 0];\n                    case 2: return [2];\n                }\n            });\n        });\n    };\n    LabelRasterizer.calculateLabelSize = function (resource, sampleScale, calculateTexture) {\n        if (calculateTexture) {\n            this.calculateTrucatedText(resource);\n        }\n        var label = resource.label;\n        var sampleScaling = sampleScale || resource.sampleScale || 1.0;\n        this.drawLabel(label, resource.truncatedText, canvas, sampleScaling);\n        var _a = this.measureContents(canvas), minX = _a.minX, minY = _a.minY, maxX = _a.maxX, maxY = _a.maxY;\n        resource.rasterization = resource.rasterization || {\n            texture: { height: 0, width: 0 },\n            world: { height: 0, width: 0 }\n        };\n        if (!calculateTexture) {\n            resource.rasterization.world = {\n                height: maxY - minY,\n                width: maxX - minX\n            };\n        }\n        else {\n            resource.rasterization.texture = {\n                height: maxY - minY,\n                width: maxX - minX\n            };\n            resource.rasterization.canvas = this.createCroppedCanvas(resource, minY, minX);\n            this.calculateLabelSize(resource, 1.0, false);\n        }\n    };\n    LabelRasterizer.calculateTrucatedText = function (resource) {\n        var label = resource.label;\n        var maxWidth = label.maxWidth;\n        if (!maxWidth) {\n            resource.truncatedText = label.text;\n            return;\n        }\n        this.drawLabel(label, label.text, canvas, 1);\n        var firstTest = this.measureContents(canvas);\n        if (firstTest.maxX - firstTest.minX <= maxWidth) {\n            resource.truncatedText = label.text;\n            return;\n        }\n        var text = label.text;\n        var left = 0;\n        var right = text.length;\n        var cursor = floor((right - left) / 2.0);\n        var safety = 0;\n        var safetyMax = 50;\n        while (right > left && cursor !== 0 && safety++ < safetyMax) {\n            this.drawLabel(label, text.substr(0, cursor) + \"...\", canvas, 1);\n            var _a = this.measureContents(canvas), minX = _a.minX, maxX = _a.maxX;\n            if (maxX - minX <= maxWidth) {\n                left = cursor;\n            }\n            else {\n                right = cursor;\n            }\n            var nextCursor = floor((right - left) / 2.0) + left;\n            if (nextCursor === cursor) {\n                break;\n            }\n            cursor = nextCursor;\n        }\n        if (cursor === 0) {\n            resource.truncatedText = \"...\";\n        }\n        else {\n            resource.truncatedText = text.substr(0, cursor) + \"...\";\n        }\n    };\n    LabelRasterizer.createCroppedCanvas = function (resource, top, left) {\n        var cropped = document.createElement(\"canvas\");\n        var context = cropped.getContext(\"2d\");\n        if (context) {\n            var texture = resource.rasterization.texture;\n            cropped.width = texture.width;\n            cropped.height = texture.height;\n            context.imageSmoothingEnabled = false;\n            context.drawImage(canvas.canvas, left, top, texture.width, texture.height, 0, 0, texture.width, texture.height);\n        }\n        else {\n            console.warn(\"Could not create a canvas 2d context to generate a label's cropped image.\");\n        }\n        return cropped;\n    };\n    LabelRasterizer.drawLabel = function (label, text, canvas, sampleScaling) {\n        var fontSize = this.getLabelRasterizationFontSize(label, sampleScaling);\n        canvas.fillStyle = \"white\";\n        canvas.font = this.makeCSSFont(label, sampleScaling);\n        canvas.canvas.width = canvas.measureText(label.text).width + fontSize;\n        canvas.canvas.height = fontSize * 2.0;\n        canvas.fillStyle = \"white\";\n        canvas.font = this.makeCSSFont(label, sampleScaling);\n        canvas.fillText(text, fontSize / 2.0, fontSize / 4.0 + fontSize);\n    };\n    LabelRasterizer.getContext = function () {\n        if (!canvas) {\n            var potentialCanvas = document.createElement(\"canvas\").getContext(\"2d\");\n            if (potentialCanvas) {\n                canvas = potentialCanvas;\n            }\n            return potentialCanvas;\n        }\n        return canvas;\n    };\n    LabelRasterizer.getLabelRasterizationFontSize = function (label, sampleScale) {\n        return label.fontSize * sampleScale;\n    };\n    LabelRasterizer.makeCSSFont = function (label, sampleScale) {\n        return label.fontWeight + \" \" + this.getLabelRasterizationFontSize(label, sampleScale) + \"px \" + label.fontFamily;\n    };\n    LabelRasterizer.measureContents = function (canvas) {\n        var _a = canvas.canvas, width = _a.width, height = _a.height;\n        var imageData = canvas.getImageData(0, 0, width, height).data;\n        var r;\n        var minY = Number.MAX_SAFE_INTEGER;\n        var minX = Number.MAX_SAFE_INTEGER;\n        var maxX = Number.MIN_SAFE_INTEGER;\n        var maxY = Number.MIN_SAFE_INTEGER;\n        for (var i = 0; i < width; ++i) {\n            for (var k = 0; k < height; ++k) {\n                var redIndex = k * (width * 4) + i * 4;\n                r = imageData[redIndex];\n                if (r > 0.0) {\n                    minY = min(minY, k);\n                    minX = min(minX, i);\n                    maxX = max(maxX, i);\n                    maxY = max(maxY, k);\n                }\n            }\n        }\n        minY -= 1;\n        maxY += 2;\n        maxX += 2;\n        minX -= 1;\n        minY = max(minY, 0);\n        minX = max(minX, 0);\n        return { minX: minX, minY: minY, maxX: maxX, maxY: maxY };\n    };\n    LabelRasterizer.render = function (resource) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4, this.awaitContext()];\n                    case 1:\n                        _a.sent();\n                        if (resource.label.fontSize > MAX_FONT_SIZE) {\n                            console.warn(\"Labels only support font sizes up to 50\");\n                            return [2, resource];\n                        }\n                        this.calculateLabelSize(resource, resource.sampleScale, true);\n                        return [2, resource];\n                }\n            });\n        });\n    };\n    LabelRasterizer.renderSync = function (resource) {\n        this.getContext();\n        if (!canvas) {\n            console.warn(\"Can not render a label synchronously without the canvas context being ready.\");\n            return resource;\n        }\n        if (resource.label.fontSize > MAX_FONT_SIZE) {\n            console.warn(\"Labels only support font sizes up to 50\");\n            return resource;\n        }\n        this.calculateLabelSize(resource, resource.sampleScale, true);\n        return resource;\n    };\n    return LabelRasterizer;\n}());\nexports.LabelRasterizer = LabelRasterizer;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_atlas_resource_1 = require(\"./base-atlas-resource\");\nvar ImageAtlasResource = (function (_super) {\n    __extends(ImageAtlasResource, _super);\n    function ImageAtlasResource(image) {\n        var _this = _super.call(this) || this;\n        _this.image = image;\n        return _this;\n    }\n    return ImageAtlasResource;\n}(base_atlas_resource_1.BaseAtlasResource));\nexports.ImageAtlasResource = ImageAtlasResource;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar COLOR_RASTERIZATION_SIZE = 2;\nvar ColorRasterizer = (function () {\n    function ColorRasterizer() {\n    }\n    ColorRasterizer.awaitContext = function (canvas) {\n        return __awaiter(this, void 0, void 0, function () {\n            var c, limit;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        c = canvas.getContext(\"2d\"), limit = 0;\n                        _a.label = 1;\n                    case 1:\n                        if (!(!Boolean(c) && limit < 100)) return [3, 4];\n                        return [4, new Promise(function (resolve) { return setTimeout(resolve, 10); })];\n                    case 2:\n                        _a.sent();\n                        _a.label = 3;\n                    case 3:\n                        c = canvas.getContext(\"2d\"), ++limit;\n                        return [3, 1];\n                    case 4: return [2];\n                }\n            });\n        });\n    };\n    ColorRasterizer.makeCSS = function (color) {\n        return \"rgba(\" + Math.floor(color.r * 256) + \", \" + Math.floor(color.g * 256) + \", \" + Math.floor(color.b * 256) + \", \" + color.opacity + \")\";\n    };\n    ColorRasterizer.render = function (resource) {\n        return __awaiter(this, void 0, void 0, function () {\n            var canvas, context;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        canvas = document.createElement(\"canvas\");\n                        context = canvas.getContext(\"2d\");\n                        return [4, this.awaitContext(canvas)];\n                    case 1:\n                        _a.sent();\n                        if (context) {\n                            canvas.width = COLOR_RASTERIZATION_SIZE;\n                            canvas.height = COLOR_RASTERIZATION_SIZE;\n                            context.imageSmoothingEnabled = false;\n                            context.fillStyle = this.makeCSS(resource.color);\n                            context.fillRect(0, 0, COLOR_RASTERIZATION_SIZE, COLOR_RASTERIZATION_SIZE);\n                            resource.rasterization.canvas = canvas;\n                        }\n                        else {\n                            console.warn(\"Could not create a canvas 2d context to generate a color for rasterization.\");\n                        }\n                        return [2, resource];\n                }\n            });\n        });\n    };\n    return ColorRasterizer;\n}());\nexports.ColorRasterizer = ColorRasterizer;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_atlas_resource_1 = require(\"./base-atlas-resource\");\nvar ColorAtlasResource = (function (_super) {\n    __extends(ColorAtlasResource, _super);\n    function ColorAtlasResource(color) {\n        var _this = _super.call(this) || this;\n        _this.color = color;\n        return _this;\n    }\n    return ColorAtlasResource;\n}(base_atlas_resource_1.BaseAtlasResource));\nexports.ColorAtlasResource = ColorAtlasResource;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar SubTexture = (function () {\n    function SubTexture() {\n        this.aspectRatio = 1.0;\n        this.atlasReferenceID = \"\";\n        this.atlasTexture = null;\n        this.atlasTL = { x: 0, y: 0 };\n        this.atlasTR = { x: 0, y: 0 };\n        this.atlasBL = { x: 0, y: 0 };\n        this.atlasBR = { x: 0, y: 0 };\n        this.widthOnAtlas = 0;\n        this.heightOnAtlas = 0;\n        this.isValid = false;\n        this.pixelWidth = 0;\n        this.pixelHeight = 0;\n    }\n    return SubTexture;\n}());\nexports.SubTexture = SubTexture;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar identify_by_key_1 = require(\"../../util/identify-by-key\");\nvar pack_node_1 = require(\"./pack-node\");\nvar sub_texture_1 = require(\"./sub-texture\");\nvar AtlasSize;\n(function (AtlasSize) {\n    AtlasSize[AtlasSize[\"_2\"] = 2] = \"_2\";\n    AtlasSize[AtlasSize[\"_4\"] = 4] = \"_4\";\n    AtlasSize[AtlasSize[\"_8\"] = 8] = \"_8\";\n    AtlasSize[AtlasSize[\"_16\"] = 16] = \"_16\";\n    AtlasSize[AtlasSize[\"_32\"] = 32] = \"_32\";\n    AtlasSize[AtlasSize[\"_64\"] = 64] = \"_64\";\n    AtlasSize[AtlasSize[\"_128\"] = 128] = \"_128\";\n    AtlasSize[AtlasSize[\"_256\"] = 256] = \"_256\";\n    AtlasSize[AtlasSize[\"_512\"] = 512] = \"_512\";\n    AtlasSize[AtlasSize[\"_1024\"] = 1024] = \"_1024\";\n    AtlasSize[AtlasSize[\"_2048\"] = 2048] = \"_2048\";\n    AtlasSize[AtlasSize[\"_4096\"] = 4096] = \"_4096\";\n})(AtlasSize = exports.AtlasSize || (exports.AtlasSize = {}));\nvar Atlas = (function (_super) {\n    __extends(Atlas, _super);\n    function Atlas(options) {\n        var _this = _super.call(this, options) || this;\n        _this.validResources = new Map();\n        var canvas = document.createElement(\"canvas\");\n        _this.width = canvas.width = options.width;\n        _this.height = canvas.height = options.height;\n        _this.textureSettings = options.textureSettings;\n        _this.packing = new pack_node_1.PackNode(0, 0, options.width, options.height);\n        _this.updateTexture(canvas);\n        return _this;\n    }\n    Atlas.prototype.invalidateResource = function (resource) {\n        var zero = { x: 0, y: 0 };\n        resource.texture.aspectRatio = 1;\n        resource.texture.atlasBL = zero;\n        resource.texture.atlasBR = zero;\n        resource.texture.atlasTL = zero;\n        resource.texture.atlasTR = zero;\n        resource.texture.atlasReferenceID = \"\";\n        resource.texture.pixelWidth = 0;\n        resource.texture.pixelHeight = 0;\n        resource.texture.isValid = false;\n    };\n    Atlas.prototype.setManager = function (manager) {\n        this.manager = manager;\n    };\n    Atlas.prototype.registerResource = function (resource) {\n        if (this.validResources.get(resource) === undefined) {\n            if (!resource.texture || !resource.texture.isValid) {\n                if (!resource.texture) {\n                    resource.texture = new sub_texture_1.SubTexture();\n                }\n                resource.texture.isValid = true;\n                this.validResources.set(resource, true);\n                return true;\n            }\n            else {\n                console.warn(\"Atlas Error:\", this.id, \"Attempted to add a resource to an Atlas that is already a valid resource on another atlas.\", \"Consider Creating a new resource to be loaded into this particular atlas.\", \"Resource:\", resource);\n            }\n        }\n        else {\n            console.warn(\"Atlas Error:\", this.id, \"A resource was trying to be added to the atlas that has already been added before.\", \"Consider creating a new resource to indicate what you want loaded to the atlas\", \"Resource:\", resource);\n        }\n        return false;\n    };\n    Atlas.prototype.removeResource = function (resource) {\n        if (this.validResources.get(resource)) {\n            this.validResources.set(resource, false);\n            this.invalidateResource(resource);\n        }\n        else {\n            console.warn(\"Atlas Error:\", this.id, \"Attempted to remove a resource that does not exist on this atlas.\", \"or the resource was already considered invalidated on this atlas.\", \"Resource:\", resource);\n        }\n    };\n    Atlas.prototype.updateTexture = function (canvas) {\n        if (this.texture) {\n            var redoneCanvas = this.texture.image;\n            this.texture.dispose();\n            this.texture = new Three.Texture(redoneCanvas);\n        }\n        else {\n            this.texture = new Three.Texture(canvas);\n        }\n        this.texture.generateMipmaps = true;\n        this.texture.premultiplyAlpha = true;\n        this.textureSettings && Object.assign(this.texture, this.textureSettings);\n        this.texture.needsUpdate = true;\n    };\n    Atlas.prototype.destroy = function () {\n        var _this = this;\n        this.texture.dispose();\n        this.validResources.forEach(function (_isValid, resource) {\n            _this.invalidateResource(resource);\n        });\n    };\n    return Atlas;\n}(identify_by_key_1.IdentifyByKey));\nexports.Atlas = Atlas;\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./image-layer\"));\n__export(require(\"./image-instance\"));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction getProgramInfo(gl, program) {\n    var result = {\n        attributeCount: 0,\n        attributes: new Array(),\n        uniformCount: 0,\n        uniforms: new Array()\n    }, activeUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS), activeAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n    var enums = {\n        0x8b50: \"FLOAT_VEC2\",\n        0x8b51: \"FLOAT_VEC3\",\n        0x8b52: \"FLOAT_VEC4\",\n        0x8b53: \"INT_VEC2\",\n        0x8b54: \"INT_VEC3\",\n        0x8b55: \"INT_VEC4\",\n        0x8b56: \"BOOL\",\n        0x8b57: \"BOOL_VEC2\",\n        0x8b58: \"BOOL_VEC3\",\n        0x8b59: \"BOOL_VEC4\",\n        0x8b5a: \"FLOAT_MAT2\",\n        0x8b5b: \"FLOAT_MAT3\",\n        0x8b5c: \"FLOAT_MAT4\",\n        0x8b5e: \"SAMPLER_2D\",\n        0x8b60: \"SAMPLER_CUBE\",\n        0x1400: \"BYTE\",\n        0x1401: \"UNSIGNED_BYTE\",\n        0x1402: \"SHORT\",\n        0x1403: \"UNSIGNED_SHORT\",\n        0x1404: \"INT\",\n        0x1405: \"UNSIGNED_INT\",\n        0x1406: \"FLOAT\"\n    };\n    var blocks = {\n        0x8b50: 1,\n        0x8b51: 1,\n        0x8b52: 1,\n        0x8b53: 1,\n        0x8b54: 1,\n        0x8b55: 1,\n        0x8b56: 1,\n        0x8b57: 1,\n        0x8b58: 1,\n        0x8b59: 1,\n        0x8b5a: 1,\n        0x8b5b: 3,\n        0x8b5c: 4,\n        0x8b5e: 1,\n        0x8b60: 1,\n        0x1400: 1,\n        0x1401: 1,\n        0x1402: 1,\n        0x1403: 1,\n        0x1404: 1,\n        0x1405: 1,\n        0x1406: 1\n    };\n    for (var i = 0; i < activeUniforms; ++i) {\n        var uniform = gl.getActiveUniform(program, i);\n        uniform.typeName = enums[uniform.type];\n        result.uniforms.push(uniform);\n        result.uniformCount += uniform.size;\n        uniform.size = uniform.size * blocks[uniform.type];\n    }\n    for (var i = 0; i < activeAttributes; i++) {\n        var attribute = gl.getActiveAttrib(program, i);\n        attribute.typeName = enums[attribute.type];\n        result.attributes.push(attribute);\n        result.attributeCount += attribute.size;\n    }\n    return result;\n}\nexports.getProgramInfo = getProgramInfo;\nvar WebGLStat = (function () {\n    function WebGLStat() {\n    }\n    WebGLStat.MAX_VERTEX_UNIFORMS = 0;\n    WebGLStat.MAX_FRAGMENT_UNIFORMS = 0;\n    WebGLStat.MAX_ATTRIBUTES = 0;\n    WebGLStat.WEBGL_SUPPORTED = false;\n    WebGLStat.MAX_TEXTURE_SIZE = 0;\n    return WebGLStat;\n}());\nexports.WebGLStat = WebGLStat;\nfunction initStats() {\n    function getAContext() {\n        try {\n            var canvas = document.createElement(\"canvas\");\n            return (window.WebGLRenderingContext &&\n                (canvas.getContext(\"webgl\") || canvas.getContext(\"experimental-webgl\")));\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    var gl = getAContext();\n    if (gl) {\n        WebGLStat.WEBGL_SUPPORTED = true;\n        WebGLStat.MAX_VERTEX_UNIFORMS = gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS);\n        WebGLStat.MAX_FRAGMENT_UNIFORMS = gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS);\n        WebGLStat.MAX_ATTRIBUTES = gl.getParameter(gl.MAX_VERTEX_ATTRIBS);\n        WebGLStat.MAX_TEXTURE_SIZE = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n    }\n}\ninitStats();\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar UID = 0;\nfunction uid() {\n    return ++UID;\n}\nexports.uid = uid;\nvar CUID = 0;\nfunction colorUID() {\n    return ++CUID % 0xffffff;\n}\nexports.colorUID = colorUID;\n","/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  '#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC',\n  '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF',\n  '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC',\n  '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF',\n  '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC',\n  '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033',\n  '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366',\n  '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933',\n  '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC',\n  '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF',\n  '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && window.process.type === 'renderer') {\n    return true;\n  }\n\n  // Internet Explorer and Edge do not support colors.\n  if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n    return false;\n  }\n\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n  return (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n    // double check webkit in userAgent just in case we are in a worker\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  try {\n    return JSON.stringify(v);\n  } catch (err) {\n    return '[UnexpectedJSONParseError]: ' + err.message;\n  }\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return;\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit')\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar browser = require(\"bowser\");\nvar three_1 = require(\"three\");\nvar debug = require(\"debug\")(\"CommunicationsView:Mouse\");\nvar IE_ADJUSTMENT = 1 / 30;\nvar OLD_IE_ADJUSTMENT = -0.25;\nvar MAX_FIREFOX_WHEELDELTA = 100;\nvar lowPassY = [0, 0, 0, 0];\nvar LOW_PASS_U0 = 0.02;\nvar LOW_PASS_U1 = 0.1;\nvar LOW_PASS_U2 = 0.18;\nvar LOW_PASS_U3 = 0.7;\nfunction normalizeFirefoxWheel(e) {\n    var wheel = e;\n    var deltaX = 0;\n    var deltaY = 0;\n    if (Math.sign(lowPassY[0]) !== Math.sign(deltaY)) {\n        lowPassY.splice(0, lowPassY.length, 0, 0, 0, 0);\n    }\n    deltaX = wheel.deltaX * MAX_FIREFOX_WHEELDELTA;\n    deltaY =\n        wheel.deltaY * MAX_FIREFOX_WHEELDELTA * LOW_PASS_U0 +\n            lowPassY[0] * LOW_PASS_U1 +\n            lowPassY[1] * LOW_PASS_U2 +\n            lowPassY[2] * LOW_PASS_U3;\n    lowPassY.unshift(deltaY);\n    lowPassY.pop();\n    return new three_1.Vector2(-deltaX, -deltaY);\n}\nfunction normalizeChromeWheel(e) {\n    var wheel = e;\n    return new three_1.Vector2(wheel.deltaX, -wheel.deltaY);\n}\nfunction normalizeIE11Wheel(e) {\n    var wheel = e;\n    var deltaX = wheel.deltaX;\n    if (deltaX === undefined) {\n        deltaX =\n            wheel.wheelDeltaX !== undefined ? wheel.wheelDeltaX * IE_ADJUSTMENT : 0;\n    }\n    var deltaY = wheel.deltaY;\n    if (deltaY === undefined) {\n        if (wheel.wheelDeltaY !== undefined) {\n            deltaY = wheel.wheelDeltaY * IE_ADJUSTMENT;\n        }\n        else {\n            deltaY = (wheel.wheelDelta || -wheel.detail) * OLD_IE_ADJUSTMENT;\n        }\n    }\n    return new three_1.Vector2(-deltaX, -deltaY);\n}\nfunction normalizeIE12Wheel(e) {\n    var wheel = e;\n    var deltaX = wheel.deltaX, deltaY = wheel.deltaY;\n    if (deltaX === undefined) {\n        deltaX =\n            wheel.wheelDeltaX !== undefined ? wheel.wheelDeltaX * IE_ADJUSTMENT : 0;\n    }\n    if (deltaY === undefined) {\n        if (wheel.wheelDeltaY !== undefined) {\n            deltaY = wheel.wheelDeltaY * IE_ADJUSTMENT;\n        }\n        else {\n            deltaY = wheel.wheelDelta || -wheel.detail;\n        }\n    }\n    var v = new three_1.Vector2(deltaX, -deltaY);\n    v.multiplyScalar(0.25);\n    return v;\n}\nvar normalizeWheel;\nexports.normalizeWheel = normalizeWheel;\nif (browser.firefox) {\n    debug(\"Using mouse wheel for firefox\");\n    exports.normalizeWheel = normalizeWheel = normalizeFirefoxWheel;\n}\nelse if (browser.msie && +browser.version >= 11) {\n    debug(\"Using mouse wheel for IE 11\");\n    exports.normalizeWheel = normalizeWheel = normalizeIE11Wheel;\n}\nelse if (browser.msedge) {\n    debug(\"Using mouse wheel for MS EDGE\");\n    exports.normalizeWheel = normalizeWheel = normalizeIE12Wheel;\n}\nelse {\n    debug(\"Using mouse wheel for Chrome\");\n    exports.normalizeWheel = normalizeWheel = normalizeChromeWheel;\n}\nfunction eventElementPosition(e, relative) {\n    var mouseX = 0, mouseY = 0, eventX = 0, eventY = 0, object = relative || (e.nativeEvent && e.nativeEvent.target) || e.target;\n    if (!e) {\n        e = window.event;\n    }\n    if (e.pageX || e.pageY) {\n        mouseX = e.pageX;\n        mouseY = e.pageY;\n    }\n    else if (e.clientX || e.clientY) {\n        mouseX =\n            e.clientX +\n                document.body.scrollLeft +\n                document.documentElement.scrollLeft;\n        mouseY =\n            e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\n    }\n    if (object.offsetParent) {\n        do {\n            eventX += object.offsetLeft;\n            eventY += object.offsetTop;\n            object = object.offsetParent;\n        } while (object);\n    }\n    return { x: mouseX - eventX, y: mouseY - eventY };\n}\nexports.eventElementPosition = eventElementPosition;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar label_atlas_resource_1 = require(\"./label-atlas-resource\");\nfunction toInstanceIOValue(texture) {\n    if (!texture) {\n        return [0, 0, 0, 0];\n    }\n    return [\n        texture.atlasTL.x,\n        texture.atlasTL.y,\n        texture.atlasBR.x,\n        texture.atlasBR.y\n    ];\n}\nvar AtlasResourceManager = (function () {\n    function AtlasResourceManager(options) {\n        this.targetAtlas = \"\";\n        this.requestQueue = new Map();\n        this.requestLookup = new Map();\n        this.atlasManager = options.atlasManager;\n    }\n    AtlasResourceManager.prototype.dequeueRequests = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var didDequeue, _loop_1, this_1, _i, _a, _b, targetAtlas, resources;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        didDequeue = false;\n                        _loop_1 = function (targetAtlas, resources) {\n                            var requests, atlasRequests_1;\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0:\n                                        if (!(resources.length > 0)) return [3, 2];\n                                        didDequeue = true;\n                                        requests = resources.slice(0);\n                                        resources.length = 0;\n                                        return [4, this_1.atlasManager.updateAtlas(targetAtlas, requests)];\n                                    case 1:\n                                        _a.sent();\n                                        atlasRequests_1 = this_1.requestLookup.get(targetAtlas);\n                                        if (atlasRequests_1) {\n                                            requests.forEach(function (resource) {\n                                                var request = atlasRequests_1.get(resource);\n                                                atlasRequests_1.delete(resource);\n                                                if (request) {\n                                                    for (var _i = 0, request_1 = request; _i < request_1.length; _i++) {\n                                                        var _a = request_1[_i], layer = _a[0], instance = _a[1];\n                                                        if (layer.uniformManager.getUniforms(instance)) {\n                                                            instance.active = true;\n                                                        }\n                                                    }\n                                                }\n                                            });\n                                        }\n                                        _a.label = 2;\n                                    case 2: return [2];\n                                }\n                            });\n                        };\n                        this_1 = this;\n                        _i = 0, _a = Array.from(this.requestQueue.entries());\n                        _c.label = 1;\n                    case 1:\n                        if (!(_i < _a.length)) return [3, 4];\n                        _b = _a[_i], targetAtlas = _b[0], resources = _b[1];\n                        return [5, _loop_1(targetAtlas, resources)];\n                    case 2:\n                        _c.sent();\n                        _c.label = 3;\n                    case 3:\n                        _i++;\n                        return [3, 1];\n                    case 4: return [2, didDequeue];\n                }\n            });\n        });\n    };\n    AtlasResourceManager.prototype.destroy = function () {\n        this.atlasManager.destroy();\n    };\n    AtlasResourceManager.prototype.getAtlasTexture = function (key) {\n        var atlas = this.atlasManager.getAtlasTexture(key);\n        if (atlas) {\n            return atlas.texture;\n        }\n        return null;\n    };\n    AtlasResourceManager.prototype.request = function (layer, instance, resource) {\n        var texture = resource.texture;\n        if (texture) {\n            return toInstanceIOValue(texture);\n        }\n        if (resource instanceof label_atlas_resource_1.LabelAtlasResource) {\n            if (!resource.label.text) {\n                return toInstanceIOValue(texture);\n            }\n        }\n        var atlasRequests = this.requestLookup.get(this.targetAtlas);\n        if (atlasRequests) {\n            var existingRequests = atlasRequests.get(resource);\n            if (existingRequests) {\n                existingRequests.push([layer, instance]);\n                instance.active = false;\n                return toInstanceIOValue(texture);\n            }\n        }\n        else {\n            atlasRequests = new Map();\n            this.requestLookup.set(this.targetAtlas, atlasRequests);\n        }\n        instance.active = false;\n        var requests = this.requestQueue.get(this.targetAtlas);\n        if (!requests) {\n            requests = [];\n            this.requestQueue.set(this.targetAtlas, requests);\n        }\n        requests.push(resource);\n        atlasRequests.set(resource, [[layer, instance]]);\n        return toInstanceIOValue(texture);\n    };\n    AtlasResourceManager.prototype.setTargetAtlas = function (target) {\n        this.targetAtlas = target;\n    };\n    return AtlasResourceManager;\n}());\nexports.AtlasResourceManager = AtlasResourceManager;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar types_1 = require(\"../../types\");\nvar event_manager_1 = require(\"../event-manager\");\nfunction isDefined(val) {\n    return Boolean(val);\n}\nvar LayerMouseEvents = (function (_super) {\n    __extends(LayerMouseEvents, _super);\n    function LayerMouseEvents(surface) {\n        var _this = _super.call(this) || this;\n        _this.isOver = new Map();\n        _this.surface = surface;\n        _this.sceneViews = surface.sceneViews;\n        return _this;\n    }\n    LayerMouseEvents.prototype.getSceneViewsUnderMouse = function (e) {\n        var sceneViewByViewId = new Map();\n        for (var _i = 0, _a = this.sceneViews; _i < _a.length; _i++) {\n            var sceneView = _a[_i];\n            sceneViewByViewId.set(sceneView.view.id, sceneView);\n        }\n        return e.viewsUnderMouse\n            .map(function (viewItem) { return sceneViewByViewId.get(viewItem.view.id); })\n            .filter(isDefined);\n    };\n    LayerMouseEvents.prototype.getMouseByViewId = function (e) {\n        var viewMouseByViewId = new Map();\n        for (var _i = 0, _a = e.viewsUnderMouse; _i < _a.length; _i++) {\n            var viewItem = _a[_i];\n            viewMouseByViewId.set(viewItem.view.id, viewItem.mouse);\n        }\n        return viewMouseByViewId;\n    };\n    LayerMouseEvents.prototype.handleClick = function (e, button) {\n        this.handleInteraction(e, function (layer, view, mouse) {\n            return layer.interactions.handleMouseClick(view, mouse, button);\n        });\n    };\n    LayerMouseEvents.prototype.handleDrag = function (e, _drag) {\n        this.handleInteraction(e, function (layer, view, mouse) {\n            return layer.interactions.handleMouseDrag(view, mouse);\n        });\n    };\n    LayerMouseEvents.prototype.handleInteraction = function (e, callback) {\n        var sceneViews = this.getSceneViewsUnderMouse(e);\n        var viewMouseByViewId = this.getMouseByViewId(e);\n        for (var _i = 0, sceneViews_1 = sceneViews; _i < sceneViews_1.length; _i++) {\n            var sceneView = sceneViews_1[_i];\n            this.handleSceneView(sceneView, viewMouseByViewId, callback);\n        }\n        return sceneViews;\n    };\n    LayerMouseEvents.prototype.handleMouseDown = function (e, button) {\n        this.handleInteraction(e, function (layer, view, mouse) {\n            return layer.interactions.handleMouseDown(view, mouse, button);\n        });\n    };\n    LayerMouseEvents.prototype.handleMouseUp = function (e, button) {\n        this.handleInteraction(e, function (layer, view, mouse) {\n            return layer.interactions.handleMouseUp(view, mouse, button);\n        });\n    };\n    LayerMouseEvents.prototype.handleMouseOver = function (_e) {\n    };\n    LayerMouseEvents.prototype.handleMouseOut = function (e) {\n        var _this = this;\n        var viewMouseByViewId = this.getMouseByViewId(e);\n        var screen = e.screen.mouse;\n        this.isOver.forEach(function (_flag, sceneView) {\n            viewMouseByViewId.set(sceneView.view.id, sceneView.view.screenToView(screen));\n            _this.handleSceneView(sceneView, viewMouseByViewId, function (layer, view, mouse) {\n                return layer.interactions.handleMouseOut(view, mouse);\n            });\n        });\n        this.isOver.clear();\n    };\n    LayerMouseEvents.prototype.handleMouseMove = function (e) {\n        var _this = this;\n        if (this.surface) {\n            this.surface.updateColorPickRange([e.screen.mouse.x, e.screen.mouse.y], e.viewsUnderMouse.map(function (v) { return v.view; }));\n        }\n        var allSceneViews = this.handleInteraction(e, function (layer, view, mouse) {\n            return layer.interactions.handleMouseMove(view, mouse);\n        });\n        var viewMouseByViewId = this.getMouseByViewId(e);\n        var screen = e.screen.mouse;\n        var currentSceneViews = new Map();\n        allSceneViews.forEach(function (v) { return currentSceneViews.set(v, true); });\n        currentSceneViews.forEach(function (_flag, sceneView) {\n            if (!_this.isOver.get(sceneView)) {\n                _this.handleSceneView(sceneView, viewMouseByViewId, function (layer, view, mouse) {\n                    return layer.interactions.handleMouseOver(view, mouse);\n                });\n            }\n        });\n        this.isOver.forEach(function (_flag, sceneView) {\n            if (!currentSceneViews.get(sceneView)) {\n                viewMouseByViewId.set(sceneView.view.id, sceneView.view.screenToView(screen));\n                _this.handleSceneView(sceneView, viewMouseByViewId, function (layer, view, mouse) { return layer.interactions.handleMouseOut(view, mouse); });\n            }\n        });\n        this.isOver = currentSceneViews;\n    };\n    LayerMouseEvents.prototype.handleSceneView = function (sceneView, viewMouseByViewId, callback) {\n        var view = sceneView.view;\n        var mouse = viewMouseByViewId.get(view.id);\n        if (mouse) {\n            for (var _i = 0, _a = sceneView.scene.layers; _i < _a.length; _i++) {\n                var layer = _a[_i];\n                if (layer.picking && layer.picking.type !== types_1.PickType.NONE) {\n                    callback(layer, view, mouse);\n                }\n            }\n        }\n    };\n    LayerMouseEvents.prototype.handleWheel = function (_e) {\n    };\n    return LayerMouseEvents;\n}(event_manager_1.EventManager));\nexports.LayerMouseEvents = LayerMouseEvents;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar generate_layer_model_1 = require(\"../surface/generate-layer-model\");\nvar types_1 = require(\"../types\");\nvar make_instance_uniform_name_1 = require(\"./make-instance-uniform-name\");\nvar InstanceUniformManager = (function () {\n    function InstanceUniformManager(layer, scene) {\n        this.buffers = [];\n        this.availableClusters = [];\n        this.instanceToCluster = new Map();\n        this.clusterToBuffer = new Map();\n        this.layer = layer;\n        var maxUniformBlock = 0;\n        layer.instanceAttributes.forEach(function (attributes) {\n            maxUniformBlock = Math.max(attributes.block, maxUniformBlock);\n        });\n        this.uniformBlocksPerInstance = maxUniformBlock + 1;\n        this.scene = scene;\n    }\n    InstanceUniformManager.prototype.add = function (instance) {\n        if (this.availableClusters.length <= 0) {\n            this.makeNewBuffer();\n        }\n        var cluster = this.availableClusters.pop();\n        if (cluster) {\n            this.instanceToCluster.set(instance.uid, cluster);\n        }\n        else {\n            console.warn(\"No valid cluster available for instance added to uniform manager.\");\n        }\n        return cluster;\n    };\n    InstanceUniformManager.prototype.destroy = function () {\n        this.buffers.forEach(function (buffer) {\n            buffer.geometry.dispose();\n            buffer.material.dispose();\n        });\n    };\n    InstanceUniformManager.prototype.getUniforms = function (instance) {\n        return this.instanceToCluster.get(instance.uid);\n    };\n    InstanceUniformManager.prototype.remove = function (instance) {\n        var cluster = this.instanceToCluster.get(instance.uid);\n        if (cluster) {\n            this.instanceToCluster.delete(instance.uid);\n            this.availableClusters.push(cluster);\n        }\n        return cluster;\n    };\n    InstanceUniformManager.prototype.removeFromScene = function () {\n        var _this = this;\n        this.buffers.forEach(function (buffer) {\n            _this.scene.container.remove(buffer.model);\n            buffer.pickModel && _this.scene.pickingContainer.remove(buffer.pickModel);\n        });\n        delete this.scene;\n    };\n    InstanceUniformManager.prototype.setScene = function (scene) {\n        var _this = this;\n        this.buffers.forEach(function (buffer) {\n            _this.scene.container.add(buffer.model);\n            buffer.pickModel && _this.scene.pickingContainer.add(buffer.pickModel);\n        });\n        this.scene = scene;\n    };\n    InstanceUniformManager.prototype.makeNewBuffer = function () {\n        var newGeometry = new Three.BufferGeometry();\n        this.layer.vertexAttributes.forEach(function (attribute) {\n            if (attribute.materialAttribute) {\n                newGeometry.addAttribute(attribute.name, attribute.materialAttribute);\n            }\n        });\n        newGeometry.drawRange.start = 0;\n        newGeometry.drawRange.count =\n            this.layer.maxInstancesPerBuffer * this.layer.instanceVertexCount;\n        var newMaterial = this.layer.material.clone();\n        var newModel = generate_layer_model_1.generateLayerModel(this.layer, newGeometry, newMaterial);\n        newModel.frustumCulled = false;\n        var buffer = {\n            activeInstances: [],\n            clusters: [],\n            firstInstance: 0,\n            geometry: newGeometry,\n            lastInstance: 0,\n            material: newMaterial,\n            model: newModel,\n            pickModel: this.layer.picking.type === types_1.PickType.SINGLE\n                ? newModel.clone()\n                : undefined\n        };\n        this.buffers.push(buffer);\n        var uniformIndex = 0;\n        var uniformName = make_instance_uniform_name_1.makeInstanceUniformNameArray();\n        var instanceData = newMaterial.uniforms[uniformName];\n        instanceData.value = instanceData.value.map(function () { return new Three.Vector4(0.0, 0.0, 0.0, 0.0); });\n        for (var i = 0, end = this.layer.maxInstancesPerBuffer; i < end; ++i) {\n            var cluster = {\n                instanceIndex: i,\n                uniform: instanceData,\n                uniformRange: [uniformIndex, 0]\n            };\n            uniformIndex += this.uniformBlocksPerInstance;\n            cluster.uniformRange[1] = uniformIndex;\n            buffer.clusters.push(cluster);\n            this.availableClusters.push(cluster);\n            this.clusterToBuffer.set(cluster, buffer);\n        }\n        for (var i = 0, end = this.layer.uniforms.length; i < end; ++i) {\n            var uniform = this.layer.uniforms[i];\n            uniform.materialUniforms.push(newMaterial.uniforms[uniform.name]);\n        }\n        if (this.scene) {\n            this.scene.container.add(buffer.model);\n            buffer.pickModel && this.scene.pickingContainer.add(buffer.pickModel);\n        }\n    };\n    return InstanceUniformManager;\n}());\nexports.InstanceUniformManager = InstanceUniformManager;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction analyzeColorPickingRendering(mouse, data, width, height) {\n    var pickingData = {\n        allColors: [],\n        colorData: data,\n        dataHeight: height,\n        dataWidth: width,\n        mouse: mouse,\n        nearestColor: 0\n    };\n    var uniqueColors = new Map();\n    var pixelIndex = 0;\n    var colors = [];\n    var mouseX = width / 2;\n    var mouseY = height / 2;\n    var nearestColor = 0x000000;\n    var distance = Number.MAX_SAFE_INTEGER;\n    for (var i = 0; i < height; ++i) {\n        var row = [];\n        colors.push(row);\n        for (var k = 0; k < width; ++k) {\n            var r = data[pixelIndex];\n            var g = data[pixelIndex + 1];\n            var b = data[pixelIndex + 2];\n            pixelIndex += 4;\n            var color = (r << 16) | (g << 8) | b;\n            uniqueColors.set(color, true);\n            row.push(color);\n            if (color !== 0x000000) {\n                var dx = k - mouseX;\n                var dy = i - mouseY;\n                var testDistance = dx * dx + dy * dy;\n                if (testDistance < distance) {\n                    distance = testDistance;\n                    nearestColor = color;\n                }\n            }\n        }\n    }\n    pickingData.allColors = Array.from(uniqueColors.keys());\n    pickingData.nearestColor = nearestColor;\n    return pickingData;\n}\nexports.analyzeColorPickingRendering = analyzeColorPickingRendering;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar bounds_1 = require(\"../primitives/bounds\");\nvar maxPopulation = 5;\nvar maxDepth = 10;\nfunction filterQuery(type, queryValues) {\n    var filtered = [];\n    queryValues.forEach(function (obj) {\n        if (type.find(function (t) { return obj instanceof t; })) {\n            filtered.push(obj);\n        }\n    });\n    return filtered;\n}\nexports.filterQuery = filterQuery;\nvar Quadrants = (function () {\n    function Quadrants(bounds, depth) {\n        var mid = bounds.mid;\n        this.TL = new Node(bounds.x, mid.x, bounds.y, mid.y, depth);\n        this.TR = new Node(mid.x, bounds.right, bounds.y, mid.y, depth);\n        this.BL = new Node(bounds.x, mid.x, mid.y, bounds.bottom, depth);\n        this.BR = new Node(mid.x, bounds.right, mid.y, bounds.bottom, depth);\n    }\n    Quadrants.prototype.destroy = function () {\n        this.TL.destroy();\n        this.TR.destroy();\n        this.BL.destroy();\n        this.BR.destroy();\n        delete this.TL;\n        delete this.TR;\n        delete this.BL;\n        delete this.BR;\n    };\n    return Quadrants;\n}());\nexports.Quadrants = Quadrants;\nvar Node = (function () {\n    function Node(left, right, top, bottom, depth) {\n        this.children = [];\n        this.depth = 0;\n        if (arguments.length >= 4) {\n            this.bounds = new bounds_1.Bounds({\n                height: top - bottom,\n                width: right - left,\n                x: left,\n                y: top\n            });\n        }\n        else {\n            this.bounds = new bounds_1.Bounds({\n                height: 1,\n                width: 1,\n                x: 0,\n                y: 0\n            });\n        }\n        this.depth = depth || 0;\n    }\n    Node.prototype.destroy = function () {\n        delete this.children;\n        delete this.bounds;\n        if (this.nodes) {\n            this.nodes.destroy();\n            delete this.nodes;\n        }\n    };\n    Node.prototype.add = function (child, props) {\n        if (child.isInside(this.bounds)) {\n            return this.doAdd(child);\n        }\n        else {\n            this.cover(child);\n            return this.add(child, props);\n        }\n    };\n    Node.prototype.addAll = function (children, childrenProps) {\n        var _this = this;\n        childrenProps = childrenProps || [];\n        var minX = Number.MAX_VALUE;\n        var minY = Number.MAX_VALUE;\n        var maxX = -Number.MAX_VALUE;\n        var maxY = -Number.MAX_VALUE;\n        children.forEach(function (child) {\n            if (child.x < minX) {\n                minX = child.x;\n            }\n            if (child.right > maxX) {\n                maxX = child.right;\n            }\n            if (child.bottom > maxY) {\n                maxY = child.bottom;\n            }\n            if (child.y < minY) {\n                minY = child.y;\n            }\n        });\n        this.cover(new bounds_1.Bounds({\n            height: maxY - minY,\n            width: maxX - minX,\n            x: minX,\n            y: minY\n        }));\n        children.forEach(function (child) { return _this.doAdd(child); });\n    };\n    Node.prototype.cover = function (bounds) {\n        var _this = this;\n        if (bounds.isInside(this.bounds)) {\n            return;\n        }\n        this.bounds.encapsulate(bounds);\n        this.bounds.x -= 1;\n        this.bounds.y -= 1;\n        this.bounds.width += 2;\n        this.bounds.height += 4;\n        var allChildren = this.gatherChildren([]);\n        if (this.nodes) {\n            this.nodes.destroy();\n            delete this.nodes;\n        }\n        allChildren.forEach(function (child) { return _this.doAdd(child); });\n    };\n    Node.prototype.doAdd = function (child) {\n        if (this.nodes) {\n            if (child.isInside(this.nodes.TL.bounds)) {\n                return this.nodes.TL.doAdd(child);\n            }\n            if (child.isInside(this.nodes.TR.bounds)) {\n                return this.nodes.TR.doAdd(child);\n            }\n            if (child.isInside(this.nodes.BL.bounds)) {\n                return this.nodes.BL.doAdd(child);\n            }\n            if (child.isInside(this.nodes.BR.bounds)) {\n                return this.nodes.BR.doAdd(child);\n            }\n            this.children.push(child);\n            return true;\n        }\n        else if (child.isInside(this.bounds)) {\n            this.children.push(child);\n            if (this.children.length > maxPopulation && this.depth < maxDepth) {\n                this.split();\n            }\n            return true;\n        }\n        if (isNaN(child.width + child.height + child.x + child.y)) {\n            console.error(\"Child did not fit into bounds because a dimension is NaN\", child);\n        }\n        else if (child.area === 0) {\n            console.error(\"Child did not fit into bounds because the area is zero\", child);\n        }\n        return true;\n    };\n    Node.prototype.gatherChildren = function (list) {\n        list = list.concat(this.children);\n        if (this.nodes) {\n            this.nodes.TL.gatherChildren(list);\n            this.nodes.TR.gatherChildren(list);\n            this.nodes.BL.gatherChildren(list);\n            this.nodes.BR.gatherChildren(list);\n        }\n        return list;\n    };\n    Node.prototype.query = function (bounds, visit) {\n        if (bounds instanceof bounds_1.Bounds) {\n            if (bounds.hitBounds(this.bounds)) {\n                return this.queryBounds(bounds, [], visit);\n            }\n            return [];\n        }\n        if (this.bounds.containsPoint(bounds)) {\n            return this.queryPoint(bounds, [], visit);\n        }\n        return [];\n    };\n    Node.prototype.queryBounds = function (b, list, visit) {\n        this.children.forEach(function (c) {\n            if (c.hitBounds(b)) {\n                list.push(c);\n            }\n        });\n        if (visit) {\n            visit(this);\n        }\n        if (this.nodes) {\n            if (b.hitBounds(this.nodes.TL.bounds)) {\n                this.nodes.TL.queryBounds(b, list, visit);\n            }\n            if (b.hitBounds(this.nodes.TR.bounds)) {\n                this.nodes.TR.queryBounds(b, list, visit);\n            }\n            if (b.hitBounds(this.nodes.BL.bounds)) {\n                this.nodes.BL.queryBounds(b, list, visit);\n            }\n            if (b.hitBounds(this.nodes.BR.bounds)) {\n                this.nodes.BR.queryBounds(b, list, visit);\n            }\n        }\n        return list;\n    };\n    Node.prototype.queryPoint = function (p, list, visit) {\n        this.children.forEach(function (c) {\n            if (c.containsPoint(p)) {\n                list.push(c);\n            }\n        });\n        if (visit) {\n            visit(this);\n        }\n        if (this.nodes) {\n            if (this.nodes.TL.bounds.containsPoint(p)) {\n                this.nodes.TL.queryPoint(p, list, visit);\n            }\n            if (this.nodes.TR.bounds.containsPoint(p)) {\n                this.nodes.TR.queryPoint(p, list, visit);\n            }\n            if (this.nodes.BL.bounds.containsPoint(p)) {\n                this.nodes.BL.queryPoint(p, list, visit);\n            }\n            if (this.nodes.BR.bounds.containsPoint(p)) {\n                this.nodes.BR.queryPoint(p, list, visit);\n            }\n        }\n        return list;\n    };\n    Node.prototype.split = function () {\n        var allChildren = this.gatherChildren([]);\n        this.nodes = new Quadrants(this.bounds, this.depth + 1);\n        this.children = [];\n        while (allChildren.length > 0) {\n            var child = allChildren.pop();\n            if (child)\n                this.doAdd(child);\n        }\n    };\n    Node.prototype.visit = function (cb) {\n        var finished = Boolean(cb(this));\n        if (this.nodes && !finished) {\n            this.nodes.TL.visit(cb);\n            this.nodes.TR.visit(cb);\n            this.nodes.BL.visit(cb);\n            this.nodes.BR.visit(cb);\n        }\n    };\n    return Node;\n}());\nexports.Node = Node;\nvar QuadTree = (function (_super) {\n    __extends(QuadTree, _super);\n    function QuadTree() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return QuadTree;\n}(Node));\nexports.QuadTree = QuadTree;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar data_bounds_1 = require(\"../util/data-bounds\");\nfunction value(val, ref, scaleRatio) {\n    var parse = \"\" + val;\n    var num = parseFloat(parse);\n    if (isNaN(num)) {\n        return 0;\n    }\n    if (parse.indexOf(\"%\") > -1) {\n        return num / 100.0 * ref;\n    }\n    return num * scaleRatio;\n}\nfunction getAbsolutePositionBounds(item, reference, scaleRatio) {\n    if (reference.width === 0 || reference.height === 0) {\n        console.warn(\"An AbsolutePosition evaluated to invalid dimensions.\", \"Please ensure that the object provided and the reference has valid dimensions\", \"to produce dimensions with width and height that are non-zero.\", \"item:\", item, \"reference:\", reference.toString());\n    }\n    var bounds = data_bounds_1.DataBounds.emptyBounds();\n    var width;\n    var height;\n    if (item.width) {\n        bounds.width = value(item.width, reference.width, scaleRatio);\n        if (item.left !== undefined) {\n            bounds.x = value(item.left, reference.width, scaleRatio);\n        }\n        else if (item.right !== undefined) {\n            bounds.x =\n                reference.width -\n                    value(item.right, reference.width, scaleRatio) -\n                    bounds.width;\n        }\n    }\n    else {\n        var left = value(item.left || 0, reference.width, scaleRatio);\n        var right = reference.width - value(item.right || 0, reference.width, scaleRatio);\n        width = right - left;\n        if (width < 0) {\n            console.warn(\"An AbsolutePosition evaluated to invalid dimensions.\", \"Please ensure that the object provided and the reference has valid dimensions\", \"to produce dimensions with width and height that are greater than zero.\", \"item:\", item, \"reference:\", reference.toString());\n        }\n        bounds.x = left;\n        bounds.width = width;\n    }\n    if (item.height) {\n        bounds.height = value(item.height, reference.height, scaleRatio);\n        if (item.top !== undefined) {\n            bounds.y = value(item.top, reference.height, scaleRatio);\n        }\n        else if (item.bottom !== undefined) {\n            bounds.y =\n                reference.height -\n                    value(item.bottom, reference.height, scaleRatio) -\n                    bounds.height;\n        }\n    }\n    else {\n        var top_1 = value(item.top || 0, reference.height, scaleRatio);\n        var bottom = reference.height - value(item.bottom || 0, reference.height, scaleRatio);\n        height = bottom - top_1;\n        if (height === undefined || height < 0) {\n            console.warn(\"An AbsolutePosition evaluated to invalid dimensions.\", \"Please ensure that the object provided and the reference has valid dimensions\", \"to produce dimensions with width and height that are greater than zero.\", \"item:\", item, \"reference:\", reference.toString());\n        }\n        bounds.y = top_1;\n        bounds.height = height;\n    }\n    if (bounds.width === 0 ||\n        bounds.height === 0 ||\n        isNaN(bounds.x + bounds.y + bounds.width + bounds.height)) {\n        bounds.x = 0;\n        bounds.y = 0;\n        bounds.width = reference.width;\n        bounds.height = reference.height;\n    }\n    return bounds;\n}\nexports.getAbsolutePositionBounds = getAbsolutePositionBounds;\n","module.exports = \"// This portion is where the shader assigns the picking color that gets passed to the fragment shader\\n  _picking_color_pass_ = _pickingColor;\\n\"","module.exports = \"lowp vec4 setColor(vec4 color) {\\n  gl_FragColor = color;\\n  return gl_FragColor;\\n}\\n\"","module.exports = \"precision lowp float;\\n\\n// This contains the method required to be used on a fragment shader when a layer desires to use\\n// PickType.SINGLE (color picking).\\nvarying vec4 _picking_color_pass_;\\n\\nvec4 setColor(vec4 color) {\\n  gl_FragColor = mix(color, _picking_color_pass_, pickingActive);\\n\\n  if (color.a == 0.0) {\\n    discard;\\n  }\\n\\n  return gl_FragColor;\\n}\\n\"","module.exports = \"// This is the varying auto generated for the fragment shader that is needed in the vertex shader to pass the\\n// color for the instance through to the fragment shader\\nvarying vec4 _picking_color_pass_;\\n\"","module.exports = \"// These are projection methods utilizing the simpler camera breakdown approach\\n\\nvec3 cameraSpace(vec3 world) {\\n  return (world + cameraOffset) * cameraScale;\\n}\\n\\nvec3 cameraSpaceSize(vec3 worldSize) {\\n  return worldSize * cameraScale;\\n}\\n\\nvec4 clipSpace(vec3 world) {\\n  return vec4(((projection * modelView) * vec4(cameraSpace(world), 1.0)).xyz, 1.0);\\n}\\n\\nvec4 clipSpaceSize(vec3 worldSize) {\\n  return vec4(((projection * modelView) * vec4(cameraSpaceSize(worldSize), 0.0)).xyz, 1.0);\\n}\\n\"","module.exports = \"// When instancing is enabled, it causes a major list of uniforms to be generated\\n// it also generates a massive search tree to retrieve the correct unforms in question.\\n${instanceUniformDeclarations}\\n\\n// This is the uniforms provided by the system along with the uniforms created by the layer\\n${layerUniforms}\\n\\n// This is the attributes generated for vertex attributes\\n${vertexAttributes}\\n\\n// This is the methods and set up needed to retrieve a block of data for an instance\\n${instanceDataRetrieval}\\n\\n// This is the methods generated for the automated easing of attributes\\n${easingMethods}\\n\"","module.exports = \"// This is the injected dereferencing of the instance attributes\\n  int instanceIndex = int(instance);\\n  ${instanceDestructuring}\\n\\n  // This is a special injected instance attribute. It lets the system\\n  // control specific instances ability to draw, which allows the backend\\n  // system greater control on how it optimizes draw calls and it's buffers.\\n  if (_active == 0.0) {\\n    gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\\n\\n    // Quick exit to prevent any geometry from arising from the instance\\n    return;\\n  }\\n\\n  ${picking}\\n\"","module.exports = \"precision highp float;\\n\\n// This is the fragment shader generated by the system\\n${layerUniforms}\\n\\n${picking}\\n\\n// --------------- The fragment shader provided by the layer ------------------\\n${shader}\\n\"","module.exports = \"// This is the vertex shader generated by the system\\n${shaderInput}\\n${projectionMethods}\\n${picking}\\n// --------------- Vertex shader provided by the layer -----------------\\n${shader}\\n\"","module.exports = \"int instanceSize = ${instanceBlockCount};\\n\\nvec4 getBlock(int index, int instanceIndex) {\\n  return instanceData[(instanceSize * instanceIndex) + index];\\n}\\n\"","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar types_1 = require(\"../../types\");\nvar auto_easing_method_1 = require(\"../../util/auto-easing-method\");\nvar make_instance_uniform_name_1 = require(\"../../util/make-instance-uniform-name\");\nvar shader_templating_1 = require(\"../../util/shader-templating\");\nvar template_vars_1 = require(\"../template-vars\");\nvar instanceRetrievalArrayFragment = require(\"../fragments/instance-retrieval-array.vs\");\nvar VECTOR_COMPONENTS = [\"x\", \"y\", \"z\", \"w\"];\nvar sizeToType = {\n    1: \"float\",\n    2: \"vec2\",\n    3: \"vec3\",\n    4: \"vec4\",\n    9: \"mat3\",\n    16: \"mat4\",\n    99: \"vec4\"\n};\nfunction orderByPriority(a, b) {\n    if (a.easing && !b.easing)\n        return 1;\n    return -1;\n}\nfunction makeUniformArrayDeclaration(totalBlocks) {\n    return {\n        fragment: \"uniform vec4 \" + make_instance_uniform_name_1.makeInstanceUniformNameArray() + \"[\" + totalBlocks + \"];\",\n        materialUniforms: [\n            {\n                name: make_instance_uniform_name_1.makeInstanceUniformNameArray(),\n                type: \"4fv\",\n                value: new Array(totalBlocks)\n                    .fill(0)\n                    .map(function () { return new Three.Vector4(0, 0, 0, 0); })\n            }\n        ]\n    };\n}\nexports.makeUniformArrayDeclaration = makeUniformArrayDeclaration;\nfunction makeInstanceRetrievalArray(blocksPerInstance) {\n    var templateOptions = {};\n    templateOptions[template_vars_1.templateVars.instanceBlockCount] = \"\" + blocksPerInstance;\n    var required = {\n        name: \"makeInstanceRetrievalArray\",\n        values: [template_vars_1.templateVars.instanceBlockCount]\n    };\n    var results = shader_templating_1.shaderTemplate({\n        options: templateOptions,\n        required: required,\n        shader: instanceRetrievalArrayFragment\n    });\n    return results.shader;\n}\nexports.makeInstanceRetrievalArray = makeInstanceRetrievalArray;\nfunction makeInstanceDestructuringArray(instanceAttributes, blocksPerInstance) {\n    var out = \"\";\n    var orderedAttributes = instanceAttributes.slice(0).sort(orderByPriority);\n    for (var i = 0; i < blocksPerInstance; ++i) {\n        out += \"  vec4 block\" + i + \" = getBlock(\" + i + \", instanceIndex);\\n\";\n    }\n    orderedAttributes.forEach(function (attribute) {\n        var block = attribute.block;\n        if (attribute.easing && attribute.size) {\n            if (attribute.size === types_1.InstanceAttributeSize.FOUR) {\n                out += \"  \" + sizeToType[attribute.size] + \" _\" + attribute.name + \"_end = block\" + block + \";\\n\";\n            }\n            else {\n                out += \"  \" + sizeToType[attribute.size || 1] + \" _\" + attribute.name + \"_end = block\" + block + \".\" + makeVectorSwizzle(attribute.blockIndex || 0, attribute.size || 1) + \";\\n\";\n            }\n            switch (attribute.easing.loop) {\n                case auto_easing_method_1.AutoEasingLoopStyle.REPEAT:\n                    out += \"  float _\" + attribute.name + \"_time = clamp(fract((currentTime - _\" + attribute.name + \"_start_time) / _\" + attribute.name + \"_duration), 0.0, 1.0);\\n\";\n                    break;\n                case auto_easing_method_1.AutoEasingLoopStyle.REFLECT:\n                    out += \"  float _\" + attribute.name + \"_timePassed = (currentTime - _\" + attribute.name + \"_start_time) / _\" + attribute.name + \"_duration;\\n\";\n                    out += \"  float _\" + attribute.name + \"_pingPong = abs((fract(_\" + attribute.name + \"_timePassed / 2.0)) - 0.5) * 2.0;\\n\";\n                    out += \"  float _\" + attribute.name + \"_time = clamp(_\" + attribute.name + \"_pingPong, 0.0, 1.0);\\n\";\n                    break;\n                case auto_easing_method_1.AutoEasingLoopStyle.NONE:\n                default:\n                    out += \"  float _\" + attribute.name + \"_time = clamp((currentTime - _\" + attribute.name + \"_start_time) / _\" + attribute.name + \"_duration, 0.0, 1.0);\\n\";\n                    break;\n            }\n            out += \"  \" + sizeToType[attribute.size] + \" \" + attribute.name + \" = \" + attribute.easing.methodName + \"(_\" + attribute.name + \"_start, _\" + attribute.name + \"_end, _\" + attribute.name + \"_time);\\n\";\n        }\n        else if (attribute.size === types_1.InstanceAttributeSize.FOUR) {\n            out += \"  \" + sizeToType[attribute.size] + \" \" + attribute.name + \" = block\" + block + \";\\n\";\n        }\n        else if (attribute.atlas) {\n            out += \"  \" + sizeToType[types_1.InstanceAttributeSize.ATLAS] + \" \" + attribute.name + \" = block\" + block + \";\\n\";\n        }\n        else {\n            out += \"  \" + sizeToType[attribute.size || 1] + \" \" + attribute.name + \" = block\" + block + \".\" + makeVectorSwizzle(attribute.blockIndex || 0, attribute.size || 1) + \";\\n\";\n        }\n    });\n    return out;\n}\nexports.makeInstanceDestructuringArray = makeInstanceDestructuringArray;\nfunction makeVectorSwizzle(start, size) {\n    return VECTOR_COMPONENTS.slice(start, start + size).join(\"\");\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar types_1 = require(\"../../types\");\nvar shader_templating_1 = require(\"../../util/shader-templating\");\nvar webgl_stat_1 = require(\"../../util/webgl-stat\");\nvar template_vars_1 = require(\"../template-vars\");\nvar uniform_instance_block_array_1 = require(\"./uniform-instance-block-array\");\nvar vertexShaderComposition = require(\"../fragments/vertex-shader-composition.vs\");\nvar fragmentShaderComposition = require(\"../fragments/fragment-shader-composition.fs\");\nvar instanceDestructuringArray = require(\"../fragments/instance-destructuring-array.vs\");\nvar shaderInput = require(\"../fragments/shader-input.vs\");\nvar projectionMethods = require(\"../fragments/projection-methods.vs\");\nvar MAX_USE_PER_BLOCK = 4;\nvar sizeToType = {\n    1: \"float\",\n    2: \"vec2\",\n    3: \"vec3\",\n    4: \"vec4\",\n    9: \"mat3\",\n    16: \"mat4\",\n    99: \"sampler2D\"\n};\nfunction calculateUniformBlockUseage(uniforms) {\n    var count = 0;\n    for (var i = 0, end = uniforms.length; i < end; ++i) {\n        count += Math.ceil(uniforms[i].size / 4);\n    }\n    return count;\n}\nfunction injectFragments(layer, shaders, vertexAttributes, instanceAttributes, uniforms) {\n    var shaderInputMetrics = generateShaderInputs(layer, vertexAttributes, instanceAttributes, uniforms);\n    var templateOptions = (_a = {},\n        _a[template_vars_1.templateVars.projectionMethods] = generateProjectionMethods(),\n        _a[template_vars_1.templateVars.picking] = generateVertexPicking(layer),\n        _a[template_vars_1.templateVars.shaderInput] = shaderInputMetrics.fragment,\n        _a[template_vars_1.templateVars.shader] = generateVertexShader(layer, shaders, instanceAttributes, shaderInputMetrics.metrics.maxInstancesPerBuffer, shaderInputMetrics.metrics.blocksPerInstance),\n        _a);\n    var required = {\n        name: \"vertex shader composition\",\n        values: [\n            template_vars_1.templateVars.projectionMethods,\n            template_vars_1.templateVars.shaderInput,\n            template_vars_1.templateVars.shader\n        ]\n    };\n    if (layer.picking.type === types_1.PickType.SINGLE) {\n        required.values.push(template_vars_1.templateVars.picking);\n    }\n    var vertexShaderResults = shader_templating_1.shaderTemplate({\n        options: templateOptions,\n        required: required,\n        shader: vertexShaderComposition\n    });\n    templateOptions = (_b = {},\n        _b[template_vars_1.templateVars.layerUniforms] = generateUniforms(uniforms, types_1.ShaderInjectionTarget.FRAGMENT),\n        _b[template_vars_1.templateVars.shader] = generateFragmentShader(shaders),\n        _b[template_vars_1.templateVars.picking] = generateFragmentPickingMethod(layer),\n        _b);\n    required = {\n        name: \"fragment shader composition\",\n        values: [template_vars_1.templateVars.layerUniforms, template_vars_1.templateVars.shader]\n    };\n    if (layer.picking.type === types_1.PickType.SINGLE) {\n        required.values.push(template_vars_1.templateVars.picking);\n    }\n    var fragmentShaderResults = shader_templating_1.shaderTemplate({\n        options: templateOptions,\n        required: required,\n        shader: fragmentShaderComposition\n    });\n    return {\n        fs: fragmentShaderResults.shader,\n        materialUniforms: shaderInputMetrics.materialUniforms,\n        maxInstancesPerBuffer: shaderInputMetrics.metrics.maxInstancesPerBuffer,\n        vs: vertexShaderResults.shader\n    };\n    var _a, _b;\n}\nexports.injectFragments = injectFragments;\nfunction generateProjectionMethods() {\n    var templateOptions = {};\n    var required = {\n        name: \"projection methods\",\n        values: []\n    };\n    var results = shader_templating_1.shaderTemplate({\n        options: templateOptions,\n        required: required,\n        shader: projectionMethods\n    });\n    return results.shader;\n}\nfunction generateShaderInputs(layer, vertexAttributes, instanceAttributes, uniforms) {\n    var templateOptions = {};\n    var instancingInfo = generateInstanceDataLookupOptions(layer, templateOptions, instanceAttributes, uniforms);\n    var additionalOptions = (_a = {},\n        _a[template_vars_1.templateVars.layerUniforms] = generateUniforms(uniforms, types_1.ShaderInjectionTarget.VERTEX),\n        _a[template_vars_1.templateVars.vertexAttributes] = generateVertexAttributes(vertexAttributes),\n        _a[template_vars_1.templateVars.easingMethods] = generateEasingMethods(instanceAttributes),\n        _a);\n    Object.assign(templateOptions, additionalOptions);\n    var required = {\n        name: \"shader input\",\n        values: [\n            template_vars_1.templateVars.instanceDataRetrieval,\n            template_vars_1.templateVars.instanceUniformDeclarations,\n            template_vars_1.templateVars.layerUniforms,\n            template_vars_1.templateVars.vertexAttributes,\n            template_vars_1.templateVars.easingMethods\n        ]\n    };\n    var results = shader_templating_1.shaderTemplate({\n        options: templateOptions,\n        required: required,\n        shader: shaderInput\n    });\n    return {\n        fragment: results.shader,\n        materialUniforms: instancingInfo.materialUniforms,\n        metrics: instancingInfo.metrics\n    };\n    var _a;\n}\nfunction generateEasingMethods(instanceAttributes) {\n    var methods = new Map();\n    var out = \"\";\n    instanceAttributes.forEach(function (attribute) {\n        if (attribute.easing && attribute.size) {\n            var methodSizes = methods.get(attribute.easing.methodName);\n            if (!methodSizes) {\n                methodSizes = new Map();\n                methods.set(attribute.easing.methodName, methodSizes);\n            }\n            methodSizes.set(attribute.size, attribute.easing.gpu);\n        }\n    });\n    var required = {\n        name: \"Easing Method Generation\",\n        values: [template_vars_1.templateVars.easingMethod]\n    };\n    methods.forEach(function (methodSizes, methodName) {\n        methodSizes.forEach(function (method, size) {\n            var sizeType = sizeToType[size];\n            var templateOptions = (_a = {},\n                _a[template_vars_1.templateVars.easingMethod] = sizeType + \" \" + methodName + \"(\" + sizeType + \" start, \" + sizeType + \" end, float t)\",\n                _a);\n            var results = shader_templating_1.shaderTemplate({\n                options: templateOptions,\n                required: required,\n                shader: method\n            });\n            out += results.shader + \"\\n\";\n            var _a;\n        });\n    });\n    return out;\n}\nfunction generateUniforms(uniforms, injectionType) {\n    var out = \"\";\n    var injection = injectionType || types_1.ShaderInjectionTarget.VERTEX;\n    uniforms.forEach(function (uniform) {\n        uniform.shaderInjection =\n            uniform.shaderInjection || types_1.ShaderInjectionTarget.VERTEX;\n        if (uniform.shaderInjection === injection ||\n            uniform.shaderInjection === types_1.ShaderInjectionTarget.ALL) {\n            out += \"uniform \" + (uniform.qualifier || \"\") + (uniform.qualifier ? \" \" : \"\") + sizeToType[uniform.size] + \" \" + uniform.name + \";\\n\";\n        }\n    });\n    return out;\n}\nfunction generateVertexShader(layer, shaders, instanceAttributes, _maxInstancesPerBuffer, blocksPerInstance) {\n    var templateOptions = (_a = {},\n        _a[template_vars_1.templateVars.attributes] = makeInstanceAttributeReferences(layer, instanceAttributes, blocksPerInstance),\n        _a);\n    var required = {\n        name: \"layer vertex shader\",\n        values: [template_vars_1.templateVars.attributes]\n    };\n    var results = shader_templating_1.shaderTemplate({\n        options: templateOptions,\n        required: required,\n        shader: shaders.vs\n    });\n    return results.shader;\n    var _a;\n}\nfunction generateVertexPicking(layer) {\n    if (layer.picking.type === types_1.PickType.SINGLE) {\n        return require(\"../fragments/color-picking-vertex-header.vs\");\n    }\n    return \"\";\n}\nfunction generateFragmentPickingMethod(layer) {\n    if (layer.picking.type === types_1.PickType.SINGLE) {\n        return require(\"../fragments/color-picking-method.fs\");\n    }\n    return require(\"../fragments/color-picking-disabled.fs\");\n}\nfunction generateFragmentShader(shaders) {\n    var templateOptions = {};\n    var required = {\n        name: \"layer fragment shader\",\n        values: []\n    };\n    var results = shader_templating_1.shaderTemplate({\n        options: templateOptions,\n        required: required,\n        shader: shaders.fs\n    });\n    return results.shader;\n}\nfunction makeInstanceAttributeReferences(layer, instanceAttributes, blocksPerInstance) {\n    var templateOptions = {};\n    templateOptions[template_vars_1.templateVars.blocksPerInstance] = \"\" + blocksPerInstance;\n    templateOptions[template_vars_1.templateVars.instanceDestructuring] = makeInstanceDestructuring(instanceAttributes, blocksPerInstance);\n    templateOptions[template_vars_1.templateVars.picking] = makePickingDestructuring(layer);\n    var required = {\n        name: \"instance attributes fragment\",\n        values: [template_vars_1.templateVars.instanceDestructuring]\n    };\n    if (layer.picking.type === types_1.PickType.SINGLE) {\n        required.values.push(template_vars_1.templateVars.picking);\n    }\n    var results = shader_templating_1.shaderTemplate({\n        options: templateOptions,\n        required: required,\n        shader: instanceDestructuringArray\n    });\n    return results.shader;\n}\nfunction makeInstanceDestructuring(instanceAttributes, blocksPerInstance) {\n    return uniform_instance_block_array_1.makeInstanceDestructuringArray(instanceAttributes, blocksPerInstance);\n}\nfunction makePickingDestructuring(layer) {\n    if (layer.picking.type === types_1.PickType.SINGLE) {\n        return require(\"../fragments/color-picking-assignment.vs\");\n    }\n    return \"\";\n}\nfunction generateVertexAttributes(vertexAttributes) {\n    var out = \"\";\n    vertexAttributes.forEach(function (attribute) {\n        out += \"attribute \" + sizeToType[attribute.size] + \" \" + (attribute.qualifier ||\n            \"\") + ((attribute.qualifier && \" \") || \"\") + attribute.name + \";\\n\";\n    });\n    return out;\n}\nfunction generateInstanceDataLookupOptions(layer, templateOptions, instanceAttributes, uniforms) {\n    var maxUniforms = webgl_stat_1.WebGLStat.MAX_VERTEX_UNIFORMS;\n    var instanceUniformBlockCount = maxUniforms - calculateUniformBlockUseage(uniforms);\n    var sortedInstanceAttributes = instanceAttributes\n        .slice(0)\n        .sort(function (a, b) { return a.block - b.block; });\n    var currentBlock = sortedInstanceAttributes[0].block;\n    var trueBlockIndex = 0;\n    var blockUseage = new Map();\n    var innerBlockUseage = new Map();\n    sortedInstanceAttributes.forEach(function (attribute) {\n        if (attribute.block !== currentBlock) {\n            currentBlock = attribute.block;\n            trueBlockIndex++;\n        }\n        var attributeSize = attribute.size || 1;\n        var oldUseage = blockUseage.get(trueBlockIndex) || 0;\n        var newUseage = oldUseage + attributeSize;\n        if (newUseage > MAX_USE_PER_BLOCK) {\n            console.error(\"An instance attribute was specified that over fills the maximum allowed useage for a block.\", \"\\nSource Layer: \" + layer.id, \"\\nMax Allowed per block \" + MAX_USE_PER_BLOCK, \"\\nAttribute: \" + attribute.name + \" Block Specified: \" + attribute.block, \"\\nTotal blocks used with this attribute: \" + newUseage);\n            return;\n        }\n        blockUseage.set(trueBlockIndex, newUseage);\n        attribute.blockIndex = oldUseage;\n        var innerUseage = innerBlockUseage.get(trueBlockIndex) || new Map();\n        if (attribute.blockIndex + attributeSize > MAX_USE_PER_BLOCK) {\n            console.error(\"An instance attribute was specified that would fill indices greater than the block allows.\", \"\\nMax index per block \" + MAX_USE_PER_BLOCK, \"\\nAttribute: \" + attribute.name + \" Block Index: \" + attribute.blockIndex + \" Size: \" + attribute.size + \" Block Index + Size: \" + (attribute.blockIndex +\n                (attribute.size || 1)));\n            return;\n        }\n        for (var i = attribute.blockIndex; i < attribute.blockIndex + attributeSize; ++i) {\n            if (innerUseage.get(i)) {\n                console.error(\"An instance attribute was specified who's block index overaps another attributes useage\", \"\\nMax index per block \" + MAX_USE_PER_BLOCK, \"\\nAttribute: \" + attribute.name + \" Block Index: \" + attribute.blockIndex + \" Size: \" + attribute.size + \" Block Index + Size: \" + (attribute.blockIndex +\n                    (attribute.size || 1)));\n                return;\n            }\n        }\n        attribute.block = trueBlockIndex;\n    });\n    var blocksPerInstance = trueBlockIndex + 1;\n    var maxInstancesPerBuffer = Math.floor(instanceUniformBlockCount / blocksPerInstance);\n    var instancingMetrics = makeUniformInstanceDataOptions(templateOptions, maxInstancesPerBuffer, blocksPerInstance, sortedInstanceAttributes);\n    return {\n        materialUniforms: instancingMetrics.materialUniforms,\n        metrics: {\n            blocksPerInstance: blocksPerInstance,\n            maxInstancesPerBuffer: maxInstancesPerBuffer\n        }\n    };\n}\nfunction makeUniformInstanceDataOptions(templateOptions, maxInstancesPerBuffer, blocksPerInstance, instanceAttributes) {\n    var instances = [];\n    for (var i = 0; i < maxInstancesPerBuffer; ++i) {\n        instances.push(i);\n    }\n    var uniformMetrics = makeInstanceUniformDeclaration(maxInstancesPerBuffer * blocksPerInstance, instanceAttributes);\n    templateOptions[template_vars_1.templateVars.instanceUniformDeclarations] =\n        uniformMetrics.fragment;\n    templateOptions[template_vars_1.templateVars.instanceBlockCount] = \"\" + blocksPerInstance;\n    templateOptions[template_vars_1.templateVars.instanceDataRetrieval] = uniform_instance_block_array_1.makeInstanceRetrievalArray(blocksPerInstance);\n    return {\n        materialUniforms: uniformMetrics.materialUniforms\n    };\n}\nfunction makeInstanceUniformDeclaration(instanceUniformBlockCount, attributes) {\n    var out = \"\";\n    var blockQualifierDedup = new Map();\n    var maxBlock = 0;\n    attributes.forEach(function (attribute) {\n        var qualifiers = blockQualifierDedup.get(attribute.block) || new Map();\n        if (attribute.qualifier) {\n            qualifiers.set(attribute.qualifier, true);\n        }\n        maxBlock = Math.max(maxBlock, attribute.block);\n    });\n    var blockQualifiers = new Map();\n    blockQualifierDedup.forEach(function (qualifierList, block) {\n        var allQualifiers = Array.from(qualifierList.keys());\n        blockQualifiers.set(block, allQualifiers.join(\" \") + \" \");\n    });\n    var declaration = uniform_instance_block_array_1.makeUniformArrayDeclaration(instanceUniformBlockCount);\n    out += declaration.fragment;\n    out += \"\\n\";\n    return {\n        fragment: out,\n        materialUniforms: declaration.materialUniforms\n    };\n}\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar three_1 = require(\"three\");\nvar images_1 = require(\"../base-layers/images\");\nvar labels_1 = require(\"../base-layers/labels\");\nvar bounds_1 = require(\"../primitives/bounds\");\nvar attribute_generation_1 = require(\"../shaders/util/attribute-generation\");\nvar generate_default_scene_1 = require(\"../surface/generate-default-scene\");\nvar generate_layer_geometry_1 = require(\"../surface/generate-layer-geometry\");\nvar generate_layer_material_1 = require(\"../surface/generate-layer-material\");\nvar generate_layer_model_1 = require(\"../surface/generate-layer-model\");\nvar inject_shader_io_1 = require(\"../surface/inject-shader-io\");\nvar mouse_event_manager_1 = require(\"../surface/mouse-event-manager\");\nvar scene_1 = require(\"../surface/scene\");\nvar view_1 = require(\"../surface/view\");\nvar types_1 = require(\"../types\");\nvar color_picking_analysis_1 = require(\"../util/color-picking-analysis\");\nvar data_bounds_1 = require(\"../util/data-bounds\");\nvar instance_uniform_manager_1 = require(\"../util/instance-uniform-manager\");\nvar layer_mouse_events_1 = require(\"./event-managers/layer-mouse-events\");\nvar texture_1 = require(\"./texture\");\nvar atlas_resource_manager_1 = require(\"./texture/atlas-resource-manager\");\nvar DEFAULT_BACKGROUND_COLOR = new Three.Color(1.0, 1.0, 1.0);\nfunction isCanvas(val) {\n    return Boolean(val.getContext);\n}\nfunction isString(val) {\n    return Boolean(val.substr);\n}\nfunction isWebGLContext(val) {\n    return Boolean(val.canvas);\n}\nfunction createLayer(layerClass, props) {\n    return [layerClass, props];\n}\nexports.createLayer = createLayer;\nvar LayerSurface = (function () {\n    function LayerSurface() {\n        this.atlasManager = new texture_1.AtlasManager();\n        this.currentViewport = new Map();\n        this.frameMetrics = {\n            currentFrame: 0,\n            currentTime: Date.now() | 0,\n            previousTime: Date.now() | 0\n        };\n        this.isBufferingAtlas = false;\n        this.layers = new Map();\n        this.pixelRatio = window.devicePixelRatio;\n        this.scenes = new Map();\n        this.sceneViews = [];\n        this.willDisposeLayer = new Map();\n    }\n    Object.defineProperty(LayerSurface.prototype, \"gl\", {\n        get: function () {\n            return this.context;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    LayerSurface.prototype.addLayer = function (layer) {\n        if (!layer.id) {\n            console.warn(\"All layers must have an id\");\n            return layer;\n        }\n        if (this.layers.get(layer.id)) {\n            console.warn(\"All layer's ids must be unique per layer manager\");\n            return layer;\n        }\n        this.layers.set(layer.id, layer);\n        this.initLayer(layer);\n        return layer;\n    };\n    LayerSurface.prototype.commit = function (time, frameIncrement, onViewReady) {\n        return __awaiter(this, void 0, void 0, function () {\n            var scenes, i, end, scene, views, layers, k, endk, view, pickingPass, j, endj, layer;\n            return __generator(this, function (_a) {\n                if (!this.gl)\n                    return [2];\n                if (frameIncrement)\n                    this.frameMetrics.currentFrame++;\n                this.frameMetrics.previousTime = this.frameMetrics.currentTime;\n                if (time === undefined) {\n                    this.frameMetrics.currentTime = Date.now() | 0;\n                }\n                else {\n                    if (this.frameMetrics.previousTime === this.frameMetrics.currentTime) {\n                        this.frameMetrics.previousTime = time;\n                    }\n                    this.frameMetrics.currentTime = time;\n                }\n                scenes = Array.from(this.scenes.values());\n                for (i = 0, end = scenes.length; i < end; ++i) {\n                    scene = scenes[i];\n                    views = Array.from(scene.viewById.values());\n                    layers = scene.layers;\n                    scene.sortLayers();\n                    for (k = 0, endk = views.length; k < endk; ++k) {\n                        view = views[k];\n                        pickingPass = [];\n                        view.fitViewtoViewport(new bounds_1.Bounds({\n                            height: this.context.canvas.height,\n                            width: this.context.canvas.width,\n                            x: 0,\n                            y: 0\n                        }));\n                        for (j = 0, endj = layers.length; j < endj; ++j) {\n                            layer = layers[j];\n                            layer.view = view;\n                            layer.draw();\n                            if (layer.picking.type === types_1.PickType.SINGLE) {\n                                pickingPass.push(layer);\n                            }\n                        }\n                        if (onViewReady) {\n                            onViewReady(scene, view, pickingPass);\n                        }\n                    }\n                }\n                return [2];\n            });\n        });\n    };\n    LayerSurface.prototype.destroy = function () {\n        this.layers.forEach(function (layer) { return layer.destroy(); });\n        this.resourceManager.destroy();\n        this.mouseManager.destroy();\n        this.sceneViews.forEach(function (sceneView) { return sceneView.scene.destroy(); });\n        this.renderer.dispose();\n        this.pickingRenderer.dispose();\n        this.currentViewport.clear();\n        labels_1.LabelInstance.destroy();\n        images_1.ImageInstance.destroy();\n    };\n    LayerSurface.prototype.draw = function (time) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var didBuffer;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.gl)\n                            return [2];\n                        this.commit(time, true, function (scene, view, pickingPass) {\n                            _this.drawSceneView(scene.container, view);\n                            if (pickingPass.length > 0 && _this.updateColorPick) {\n                                var mouse = _this.updateColorPick.mouse;\n                                var views = _this.updateColorPick.views;\n                                if (view.id !== _this.defaultSceneElements.view.id &&\n                                    views.indexOf(view) > -1) {\n                                    view.pixelRatio = 1.0;\n                                    var flags = view.clearFlags.slice(0);\n                                    view.clearFlags = [view_1.ClearFlags.COLOR, view_1.ClearFlags.DEPTH];\n                                    view.fitViewtoViewport(new bounds_1.Bounds({\n                                        height: _this.context.canvas.height / _this.pixelRatio,\n                                        width: _this.context.canvas.width / _this.pixelRatio,\n                                        x: 0,\n                                        y: 0\n                                    }));\n                                    for (var j = 0, endj = pickingPass.length; j < endj; ++j) {\n                                        var layer = pickingPass[j];\n                                        layer.picking.currentPickMode = types_1.PickType.SINGLE;\n                                        layer.draw();\n                                        layer.picking.currentPickMode = types_1.PickType.NONE;\n                                    }\n                                    _this.drawSceneView(scene.pickingContainer, view, _this.pickingRenderer, _this.pickingTarget);\n                                    var pickWidth = 5;\n                                    var pickHeight = 5;\n                                    var numBytesPerColor = 4;\n                                    var out = new Uint8Array(pickWidth * pickHeight * numBytesPerColor);\n                                    _this.pickingRenderer.readRenderTargetPixels(_this.pickingTarget, mouse[0] - view.screenBounds.x - pickWidth / 2, view.screenBounds.height -\n                                        (mouse[1] - view.screenBounds.y) -\n                                        pickHeight / 2, pickWidth, pickHeight, out);\n                                    var pickingData = color_picking_analysis_1.analyzeColorPickingRendering(mouse, out, pickWidth, pickHeight);\n                                    for (var j = 0, endj = pickingPass.length; j < endj; ++j) {\n                                        var layer = pickingPass[j];\n                                        if (layer.picking.type === types_1.PickType.SINGLE) {\n                                            layer.interactions.colorPicking = pickingData;\n                                        }\n                                    }\n                                    view.pixelRatio = _this.pixelRatio;\n                                    view.clearFlags = flags;\n                                    view.fitViewtoViewport(new bounds_1.Bounds({\n                                        height: _this.context.canvas.height,\n                                        width: _this.context.canvas.width,\n                                        x: 0,\n                                        y: 0\n                                    }));\n                                }\n                            }\n                        });\n                        if (this.mouseManager.waitingForRender) {\n                            this.sceneViews.forEach(function (sceneView) {\n                                sceneView.bounds = new data_bounds_1.DataBounds(sceneView.view.screenBounds);\n                                sceneView.bounds.data = sceneView;\n                            });\n                            this.mouseManager.waitingForRender = false;\n                        }\n                        if (!!this.isBufferingAtlas) return [3, 2];\n                        this.isBufferingAtlas = true;\n                        return [4, this.resourceManager.dequeueRequests()];\n                    case 1:\n                        didBuffer = _a.sent();\n                        this.isBufferingAtlas = false;\n                        if (didBuffer)\n                            this.draw();\n                        _a.label = 2;\n                    case 2:\n                        delete this.updateColorPick;\n                        return [2];\n                }\n            });\n        });\n    };\n    LayerSurface.prototype.drawSceneView = function (scene, view, renderer, target) {\n        renderer = renderer || this.renderer;\n        var offset = { x: view.viewBounds.left, y: view.viewBounds.top };\n        var size = view.viewBounds;\n        var rendererSize = renderer.getSize();\n        var pixelRatio = renderer.getPixelRatio();\n        rendererSize.width *= pixelRatio;\n        rendererSize.height *= pixelRatio;\n        var background = view.background;\n        var context = renderer.getContext();\n        if (!target) {\n            context.enable(context.SCISSOR_TEST);\n            context.scissor(offset.x, rendererSize.height - offset.y - size.height, size.width, size.height);\n            if (view.background) {\n                context.clearColor(background[0], background[1], background[2], background[3]);\n            }\n        }\n        if (view.clearFlags) {\n            if (target) {\n                target.setSize(size.width, size.height);\n                renderer.setRenderTarget(target);\n                renderer.clear(view.clearFlags.indexOf(view_1.ClearFlags.COLOR) > -1, view.clearFlags.indexOf(view_1.ClearFlags.DEPTH) > -1, view.clearFlags.indexOf(view_1.ClearFlags.STENCIL) > -1);\n            }\n            else {\n                renderer\n                    .getContext()\n                    .clear((view.clearFlags.indexOf(view_1.ClearFlags.COLOR) > -1\n                    ? context.COLOR_BUFFER_BIT\n                    : 0x0) |\n                    (view.clearFlags.indexOf(view_1.ClearFlags.DEPTH) > -1\n                        ? context.DEPTH_BUFFER_BIT\n                        : 0x0) |\n                    (view.clearFlags.indexOf(view_1.ClearFlags.STENCIL) > -1\n                        ? context.STENCIL_BUFFER_BIT\n                        : 0x0));\n            }\n        }\n        else {\n            if (target) {\n                target.setSize(size.width, size.height);\n                renderer.setRenderTarget(target);\n                renderer.clear(true, true);\n            }\n            else {\n                context.clear(context.COLOR_BUFFER_BIT | context.DEPTH_BUFFER_BIT);\n            }\n        }\n        renderer.setViewport(offset.x / pixelRatio, offset.y / pixelRatio, size.width, size.height);\n        renderer.render(scene, view.viewCamera.baseCamera, target);\n    };\n    LayerSurface.prototype.getViewSize = function (viewId) {\n        for (var _i = 0, _a = this.sceneViews; _i < _a.length; _i++) {\n            var sceneView = _a[_i];\n            if (sceneView.view.id === viewId) {\n                return sceneView.view.screenBounds;\n            }\n        }\n        return null;\n    };\n    LayerSurface.prototype.getViewWorldBounds = function (viewId) {\n        for (var _i = 0, _a = this.sceneViews; _i < _a.length; _i++) {\n            var sceneView = _a[_i];\n            if (sceneView.view.id === viewId) {\n                var view = sceneView.view;\n                if (view.screenBounds) {\n                    var topLeft = view.viewToWorld({ x: 0, y: 0 });\n                    var bottomRight = view.screenToWorld({\n                        x: view.screenBounds.right,\n                        y: view.screenBounds.bottom\n                    });\n                    return new bounds_1.Bounds({\n                        bottom: bottomRight.y,\n                        left: topLeft.x,\n                        right: bottomRight.x,\n                        top: topLeft.y\n                    });\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n        return null;\n    };\n    LayerSurface.prototype.init = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.pixelRatio = options.pixelRatio || this.pixelRatio;\n                        this.setContext(options.context);\n                        if (!this.gl) return [3, 2];\n                        this.initGL(options);\n                        this.initMouseManager(options);\n                        return [4, this.initResources(options)];\n                    case 1:\n                        _a.sent();\n                        return [3, 3];\n                    case 2:\n                        console.warn(\"Could not establish a GL context. Layer Surface will be unable to render\");\n                        _a.label = 3;\n                    case 3: return [2, this];\n                }\n            });\n        });\n    };\n    LayerSurface.prototype.initGL = function (options) {\n        var _this = this;\n        if (!this.context) {\n            console.error(\"Can not initialize Layer Surface as a valid GL context was not established.\");\n            return;\n        }\n        var canvas = this.context.canvas;\n        var width = canvas.width;\n        var height = canvas.height;\n        this.renderer = new Three.WebGLRenderer({\n            alpha: options.background && options.background[3] < 1.0,\n            antialias: true,\n            canvas: canvas,\n            preserveDrawingBuffer: true\n        });\n        this.pickingRenderer = new Three.WebGLRenderer({\n            alpha: false,\n            antialias: false,\n            preserveDrawingBuffer: true\n        });\n        this.renderer.autoClear = false;\n        this.renderer.setFaceCulling(Three.CullFaceNone);\n        this.setRendererSize(width, height);\n        this.renderer.setPixelRatio(this.pixelRatio);\n        if (options.background) {\n            this.renderer.setClearColor(new Three.Color(options.background[0], options.background[1], options.background[2]), options.background[3]);\n        }\n        else {\n            this.renderer.setClearColor(DEFAULT_BACKGROUND_COLOR);\n        }\n        this.pickingRenderer.autoClear = false;\n        this.pickingRenderer.setFaceCulling(Three.CullFaceNone);\n        this.pickingRenderer.setPixelRatio(1.0);\n        this.pickingRenderer.setClearColor(new Three.Color(0, 0, 0), 1);\n        this.defaultSceneElements = generate_default_scene_1.generateDefaultScene(this.context);\n        this.defaultSceneElements.view.background = options.background;\n        this.scenes.set(this.defaultSceneElements.scene.id, this.defaultSceneElements.scene);\n        var sceneViewDepth = 0;\n        this.sceneViews.push({\n            depth: ++sceneViewDepth,\n            scene: this.defaultSceneElements.scene,\n            view: this.defaultSceneElements.view\n        });\n        this.context.enable(this.context.SCISSOR_TEST);\n        if (options.scenes) {\n            options.scenes.forEach(function (sceneOptions) {\n                var newScene = new scene_1.Scene(sceneOptions);\n                if (sceneOptions.views.length === 0) {\n                    newScene.addView(_this.defaultSceneElements.view);\n                    _this.sceneViews.push({\n                        depth: ++sceneViewDepth,\n                        scene: newScene,\n                        view: _this.defaultSceneElements.view\n                    });\n                }\n                sceneOptions.views.forEach(function (viewOptions) {\n                    var newView = new view_1.View(viewOptions);\n                    newView.camera = newView.camera || _this.defaultSceneElements.camera;\n                    newView.viewCamera =\n                        newView.viewCamera || _this.defaultSceneElements.viewCamera;\n                    newView.viewport =\n                        newView.viewport || _this.defaultSceneElements.viewport;\n                    newView.pixelRatio = _this.pixelRatio;\n                    newScene.addView(newView);\n                    for (var _i = 0, _a = _this.sceneViews; _i < _a.length; _i++) {\n                        var sceneView = _a[_i];\n                        if (sceneView.view.id === newView.id) {\n                            console.warn(\"You can NOT have two views with the same id. Please use unique identifiers for every view generated.\");\n                        }\n                    }\n                    _this.sceneViews.push({\n                        depth: ++sceneViewDepth,\n                        scene: newScene,\n                        view: newView\n                    });\n                });\n                _this.scenes.set(sceneOptions.key, newScene);\n            });\n        }\n    };\n    LayerSurface.prototype.initLayer = function (layer) {\n        layer.surface = this;\n        layer.resource = this.resourceManager;\n        var scene = this.addLayerToScene(layer);\n        var shaderIO = layer.initShader();\n        shaderIO.instanceAttributes = (shaderIO.instanceAttributes || []).filter(Boolean);\n        shaderIO.vertexAttributes = (shaderIO.vertexAttributes || []).filter(Boolean);\n        shaderIO.uniforms = (shaderIO.uniforms || []).filter(Boolean);\n        var _a = inject_shader_io_1.injectShaderIO(layer, shaderIO), vertexAttributes = _a.vertexAttributes, instanceAttributes = _a.instanceAttributes, uniforms = _a.uniforms;\n        var shaderMetrics = attribute_generation_1.injectFragments(layer, shaderIO, vertexAttributes, instanceAttributes, uniforms);\n        var geometry = generate_layer_geometry_1.generateLayerGeometry(shaderMetrics.maxInstancesPerBuffer, vertexAttributes, shaderIO.vertexCount);\n        var material = generate_layer_material_1.generateLayerMaterial(layer, shaderMetrics.vs, shaderMetrics.fs, uniforms, shaderMetrics.materialUniforms);\n        var model = generate_layer_model_1.generateLayerModel(layer, geometry, material);\n        layer.geometry = geometry;\n        layer.instanceAttributes = instanceAttributes;\n        layer.instanceVertexCount = shaderIO.vertexCount;\n        layer.material = material;\n        layer.maxInstancesPerBuffer = shaderMetrics.maxInstancesPerBuffer;\n        layer.model = model;\n        layer.uniforms = uniforms;\n        layer.vertexAttributes = vertexAttributes;\n        layer.uniformManager = new instance_uniform_manager_1.InstanceUniformManager(layer, scene);\n        return layer;\n    };\n    LayerSurface.prototype.initMouseManager = function (options) {\n        var eventManagers = [\n            new layer_mouse_events_1.LayerMouseEvents(this)\n        ].concat(options.eventManagers || []);\n        this.mouseManager = new mouse_event_manager_1.MouseEventManager(this.context.canvas, this.sceneViews, eventManagers, options.handlesWheelEvents);\n    };\n    LayerSurface.prototype.initResources = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _i, _a, resource;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!options.atlasResources) return [3, 4];\n                        _i = 0, _a = options.atlasResources;\n                        _b.label = 1;\n                    case 1:\n                        if (!(_i < _a.length)) return [3, 4];\n                        resource = _a[_i];\n                        return [4, this.atlasManager.createAtlas(resource)];\n                    case 2:\n                        _b.sent();\n                        _b.label = 3;\n                    case 3:\n                        _i++;\n                        return [3, 1];\n                    case 4:\n                        this.resourceManager = new atlas_resource_manager_1.AtlasResourceManager({\n                            atlasManager: this.atlasManager\n                        });\n                        return [2];\n                }\n            });\n        });\n    };\n    LayerSurface.prototype.addLayerToScene = function (layer) {\n        var scene = this.scenes.get(layer.props.scene || \"\");\n        if (!scene) {\n            scene = this.defaultSceneElements.scene;\n            if (layer.props.scene) {\n                console.warn(\"Layer specified a scene that is not within the layer surface manager. Layer will be added to the default scene.\");\n            }\n        }\n        scene.addLayer(layer);\n        return scene;\n    };\n    LayerSurface.prototype.removeLayer = function (layer) {\n        if (!layer) {\n            return null;\n        }\n        if (!this.layers.get(layer && layer.id)) {\n            console.warn(\"Tried to remove a layer that is not in the manager.\", layer);\n            return layer;\n        }\n        layer.uniformManager.removeFromScene();\n        layer.destroy();\n        this.layers.delete(layer.id);\n        return layer;\n    };\n    LayerSurface.prototype.render = function (layerInitializers) {\n        var _this = this;\n        if (!this.gl)\n            return;\n        if (layerInitializers && layerInitializers.length > 0) {\n            layerInitializers.forEach(function (init) {\n                var layerClass = init[0];\n                var props = init[1];\n                var existingLayer = _this.layers.get(props.key);\n                if (existingLayer) {\n                    existingLayer.willUpdateProps(props);\n                    Object.assign(existingLayer.props, props);\n                    existingLayer.didUpdateProps();\n                }\n                else {\n                    _this.addLayer(new layerClass(Object.assign({}, layerClass.defaultProps, props)));\n                }\n                _this.willDisposeLayer.set(props.key, false);\n            });\n        }\n        this.willDisposeLayer.forEach(function (dispose, layerId) {\n            if (dispose) {\n                var layer = _this.layers.get(layerId);\n                if (layer) {\n                    _this.removeLayer(layer);\n                }\n                else {\n                    console.warn(\"this.willDisposeLayer called on non-gettable layer.\");\n                }\n            }\n        });\n        this.willDisposeLayer.clear();\n        this.layers.forEach(function (_layer, id) {\n            _this.willDisposeLayer.set(id, true);\n        });\n    };\n    LayerSurface.prototype.fitContainer = function (_pixelRatio) {\n        var container = this.context.canvas.parentElement;\n        if (container) {\n            var canvas = this.context.canvas;\n            canvas.className = \"\";\n            canvas.setAttribute(\"style\", \"\");\n            container.style.position = \"relative\";\n            canvas.style.position = \"absolute\";\n            canvas.style.left = \"0xp\";\n            canvas.style.top = \"0xp\";\n            canvas.style.width = \"100%\";\n            canvas.style.height = \"100%\";\n            canvas.setAttribute(\"width\", \"\");\n            canvas.setAttribute(\"height\", \"\");\n            var containerBox = container.getBoundingClientRect();\n            var box = canvas.getBoundingClientRect();\n            this.resize(box.width || 100, containerBox.height || 100);\n        }\n    };\n    LayerSurface.prototype.resize = function (width, height, pixelRatio) {\n        var _this = this;\n        this.pixelRatio = pixelRatio || this.pixelRatio;\n        this.sceneViews.forEach(function (sceneView) { return (sceneView.view.pixelRatio = _this.pixelRatio); });\n        this.setRendererSize(width, height);\n        this.renderer.setPixelRatio(this.pixelRatio);\n        this.pickingRenderer.setPixelRatio(1.0);\n        this.mouseManager.resize();\n    };\n    LayerSurface.prototype.setContext = function (context) {\n        if (!context) {\n            return;\n        }\n        if (isWebGLContext(context)) {\n            this.context = context;\n        }\n        else if (isCanvas(context)) {\n            var canvasContext = context.getContext(\"webgl\") || context.getContext(\"experimental-webgl\");\n            if (!canvasContext) {\n                console.warn(\"A valid GL context was not found for the context provided to the surface. This surface will not be able to operate.\");\n            }\n            else {\n                this.context = canvasContext;\n            }\n        }\n        else if (isString(context)) {\n            var element = document.getElementById(context);\n            if (isCanvas(element)) {\n                this.setContext(element);\n            }\n        }\n    };\n    LayerSurface.prototype.setRendererSize = function (width, height) {\n        width = width || 100;\n        height = height || 100;\n        this.renderer.setSize(width, height);\n        this.pickingRenderer.setSize(width, height);\n        if (!this.pickingTarget) {\n            this.pickingTarget = new three_1.WebGLRenderTarget(width, height, {\n                magFilter: Three.LinearFilter,\n                minFilter: Three.LinearFilter,\n                stencilBuffer: false\n            });\n        }\n        this.pickingTarget.setSize(width, height);\n    };\n    LayerSurface.prototype.updateColorPickRange = function (mouse, views) {\n        this.updateColorPick = {\n            mouse: mouse,\n            views: views\n        };\n    };\n    return LayerSurface;\n}());\nexports.LayerSurface = LayerSurface;\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./layer-surface\"));\n__export(require(\"./event-manager\"));\n__export(require(\"./generate-default-scene\"));\n__export(require(\"./generate-layer-geometry\"));\n__export(require(\"./generate-layer-material\"));\n__export(require(\"./generate-layer-model\"));\n__export(require(\"./inject-shader-io\"));\n__export(require(\"./layer\"));\n__export(require(\"./mouse-event-manager\"));\n__export(require(\"./scene\"));\n__export(require(\"./texture\"));\n__export(require(\"./view\"));\n","module.exports = \"precision highp float;\\n\\nvarying vec4 vertexColor;\\nvarying float edgeSharpness;\\nvarying float borderSize;\\nvarying vec2 pointCoord;\\n${extendHeader}\\n\\nvarying float scale;\\n\\nvoid main() {\\n  ${attributes}\\n\\n  scale = scaleFactor;\\n\\n  vertexColor = color * color.a;\\n  float size = radius * scaleFactor;\\n\\n  thickness = mix(2.0 , thickness, float(thickness > 2.0));\\n\\n  borderSize = mix(\\n    (thickness) / size,\\n    ((thickness * pixelRatio) / size),\\n    float(pixelRatio > 1.0)\\n  );\\n\\n  edgeSharpness = min(0.2 / (thickness * scale),  0.1);\\n\\n  pointCoord = (position.xy + vec2(1.0, 1.0)) / 2.0;  \\n\\n  // Center within clip space\\n  vec4 clipCenter = clipSpace(vec3(center, depth));\\n  // Center in screen space\\n  vec2 screenCenter = (clipCenter.xy + vec2(1.0, 1.0)) * vec2(0.5, 0.5) * viewSize;\\n  // Position in screen space\\n  vec2 vertex = (position.xy * size) + screenCenter;\\n  // Position back to clip space\\n  gl_Position = vec4((vertex / viewSize) * vec2(2.0, 2.0) - vec2(1.0, 1.0), clipCenter.zw);\\n  ${extend}\\n}\\n\"","module.exports = \"precision highp float;\\n\\n${picking}\\n\\n/** This is the color of the ring */\\nvarying vec4 vertexColor;\\n/**\\n * This is how sharp the ring renders. For tiny rings, it's best to have\\n * less sharpness to better convey the shape of a circle. A good starter setting:\\n * edgeSharpness = mix(0.8, 0.01, min(gl_PointSize / 45.0, 1.0));\\n */\\nvarying float edgeSharpness;\\n/**\\n * This should be a value that sets the thickness of the ring in normal space\\n * relative to the PointSize\\n */\\nvarying float borderSize;\\n/**\\n * Since this is now a quad instead of a point sprite, this provides what gl_PointCoord\\n * used to provide.\\n */\\nvarying vec2 pointCoord;\\n\\nvarying float scale;\\n\\nfloat circle(vec2 coord, float radius){\\n  vec2 dist = coord - vec2(0.5);\\n\\n  return 1.0 - smoothstep(\\n    radius - (radius * edgeSharpness),\\n    radius,\\n    dot(dist, dist) * 4.0\\n  );\\n\\n}\\n\\n${extendHeader}\\n\\nvoid main() {\\n  float outer_step_factor = circle(pointCoord, 1.0);\\n  float inner_step_factor = circle(pointCoord, 1.0 - borderSize * scale);\\n\\n  setColor(mix(\\n    mix(                        // Select the outer color outside of the inner radius\\n      vec4(0.0, 0.0, 0.0, 0.0),    // Select invisible outside of inner and outer radius\\n      vertexColor,                  // Select outer color outside of inner, but inside outer\\n      outer_step_factor\\n    ),\\n    vec4(0.0, 0.0, 0.0, 0.0),                 // Select inner color inside inner\\n    inner_step_factor\\n  ));\\n\\n  ${extend}\\n}\\n\"","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar primitives_1 = require(\"../../primitives\");\nvar layer_1 = require(\"../../surface/layer\");\nvar types_1 = require(\"../../types\");\nvar max = Math.max;\nvar RingLayer = (function (_super) {\n    __extends(RingLayer, _super);\n    function RingLayer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    RingLayer.prototype.getInstancePickingMethods = function () {\n        return {\n            boundsAccessor: function (ring) {\n                return new primitives_1.Bounds({\n                    height: ring.radius * 2,\n                    width: ring.radius * 2,\n                    x: ring.x - ring.radius,\n                    y: ring.y - ring.radius\n                });\n            },\n            hitTest: function (ring, point, view) {\n                var r = ring.radius / max.apply(void 0, view.camera.scale);\n                var delta = [point.x - ring.x, point.y - ring.y];\n                return delta[0] * delta[0] + delta[1] * delta[1] < r * r;\n            }\n        };\n    };\n    RingLayer.prototype.initShader = function () {\n        var scaleFactor = this.props.scaleFactor || (function () { return 1; });\n        var vertexToNormal = {\n            0: 1,\n            1: 1,\n            2: -1,\n            3: 1,\n            4: -1,\n            5: -1\n        };\n        var vertexToSide = {\n            0: -1,\n            1: -1,\n            2: -1,\n            3: 1,\n            4: 1,\n            5: 1\n        };\n        return {\n            fs: require(\"./ring-layer.fs\"),\n            instanceAttributes: [\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"center\",\n                    size: types_1.InstanceAttributeSize.TWO,\n                    update: function (o) { return [o.x, o.y]; }\n                },\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.THREE,\n                    name: \"radius\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.radius]; }\n                },\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.FOUR,\n                    name: \"depth\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.depth]; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"color\",\n                    size: types_1.InstanceAttributeSize.FOUR,\n                    update: function (o) { return o.color; }\n                },\n                {\n                    block: 2,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"thickness\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.thickness]; }\n                }\n            ],\n            uniforms: [\n                {\n                    name: \"scaleFactor\",\n                    size: types_1.UniformSize.ONE,\n                    update: function (_) { return [scaleFactor()]; }\n                }\n            ],\n            vertexAttributes: [\n                {\n                    name: \"position\",\n                    size: types_1.VertexAttributeSize.THREE,\n                    update: function (vertex) { return [\n                        vertexToNormal[vertex],\n                        vertexToSide[vertex],\n                        0\n                    ]; }\n                }\n            ],\n            vertexCount: 6,\n            vs: require(\"./ring-layer.vs\")\n        };\n    };\n    RingLayer.prototype.getModelType = function () {\n        return {\n            drawMode: Three.TriangleStripDrawMode,\n            modelType: Three.Mesh\n        };\n    };\n    RingLayer.prototype.getMaterialOptions = function () {\n        return {\n            premultipliedAlpha: true,\n            transparent: true\n        };\n    };\n    return RingLayer;\n}(layer_1.Layer));\nexports.RingLayer = RingLayer;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar instance_1 = require(\"../../instance-provider/instance\");\nvar observable_1 = require(\"../../instance-provider/observable\");\nvar RingInstance = (function (_super) {\n    __extends(RingInstance, _super);\n    function RingInstance(options) {\n        var _this = _super.call(this, options) || this;\n        _this.color = [1.0, 1.0, 1.0, 1.0];\n        _this.depth = 0;\n        _this.radius = 0;\n        _this.thickness = 1;\n        _this.x = 0;\n        _this.y = 0;\n        _this.color = options.color || [1, 1, 1, 1];\n        _this.depth = options.depth || 0;\n        _this.radius = options.radius;\n        _this.thickness = options.thickness || _this.thickness;\n        _this.x = options.x;\n        _this.y = options.y;\n        return _this;\n    }\n    Object.defineProperty(RingInstance.prototype, \"width\", {\n        get: function () {\n            return this.radius * 2;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(RingInstance.prototype, \"height\", {\n        get: function () {\n            return this.radius * 2;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(RingInstance.prototype, \"innerRadius\", {\n        get: function () {\n            return this.radius - this.thickness;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    __decorate([\n        observable_1.observable\n    ], RingInstance.prototype, \"color\", void 0);\n    __decorate([\n        observable_1.observable\n    ], RingInstance.prototype, \"depth\", void 0);\n    __decorate([\n        observable_1.observable\n    ], RingInstance.prototype, \"radius\", void 0);\n    __decorate([\n        observable_1.observable\n    ], RingInstance.prototype, \"thickness\", void 0);\n    __decorate([\n        observable_1.observable\n    ], RingInstance.prototype, \"x\", void 0);\n    __decorate([\n        observable_1.observable\n    ], RingInstance.prototype, \"y\", void 0);\n    return RingInstance;\n}(instance_1.Instance));\nexports.RingInstance = RingInstance;\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./ring-instance\"));\n__export(require(\"./ring-layer\"));\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar instance_provider_1 = require(\"../../instance-provider\");\nvar instance_1 = require(\"../../instance-provider/instance\");\nvar types_1 = require(\"../types\");\nvar anchorCalculator = (_a = {},\n    _a[types_1.AnchorType.TopLeft] = function (anchor, _rectangle) {\n        anchor.x = -anchor.padding;\n        anchor.y = -anchor.padding;\n    },\n    _a[types_1.AnchorType.TopMiddle] = function (anchor, rectangle) {\n        anchor.x = rectangle.width / 2.0;\n        anchor.y = -anchor.padding;\n    },\n    _a[types_1.AnchorType.TopRight] = function (anchor, rectangle) {\n        anchor.x = rectangle.width + anchor.padding;\n        anchor.y = -anchor.padding;\n    },\n    _a[types_1.AnchorType.MiddleLeft] = function (anchor, rectangle) {\n        anchor.x = -anchor.padding;\n        anchor.y = rectangle.height / 2;\n    },\n    _a[types_1.AnchorType.Middle] = function (anchor, rectangle) {\n        anchor.x = rectangle.width / 2.0;\n        anchor.y = rectangle.height / 2.0;\n    },\n    _a[types_1.AnchorType.MiddleRight] = function (anchor, rectangle) {\n        anchor.x = rectangle.width + anchor.padding;\n        anchor.y = rectangle.height / 2.0;\n    },\n    _a[types_1.AnchorType.BottomLeft] = function (anchor, rectangle) {\n        anchor.x = -anchor.padding;\n        anchor.y = rectangle.height + anchor.padding;\n    },\n    _a[types_1.AnchorType.BottomMiddle] = function (anchor, rectangle) {\n        anchor.x = rectangle.width / 2.0;\n        anchor.y = rectangle.height + anchor.padding;\n    },\n    _a[types_1.AnchorType.BottomRight] = function (anchor, rectangle) {\n        anchor.x = rectangle.width + anchor.padding;\n        anchor.y = rectangle.height + anchor.padding;\n    },\n    _a[types_1.AnchorType.Custom] = function (anchor, _rectangle) {\n        anchor.x = anchor.x || 0;\n        anchor.y = anchor.y || 0;\n    },\n    _a);\nvar RectangleInstance = (function (_super) {\n    __extends(RectangleInstance, _super);\n    function RectangleInstance(options) {\n        var _this = _super.call(this, options) || this;\n        _this.color = [0, 0, 0, 1];\n        _this.depth = 0;\n        _this.height = 1;\n        _this.scaling = types_1.ScaleType.BOUND_MAX;\n        _this.width = 1;\n        _this.x = 0;\n        _this.y = 0;\n        _this._anchor = {\n            padding: 0,\n            type: types_1.AnchorType.TopLeft,\n            x: 0,\n            y: 0\n        };\n        _this.depth = options.depth || _this.depth;\n        _this.color = options.color || _this.color;\n        _this.scaling = options.scaling || _this.scaling;\n        _this.x = options.x || _this.x;\n        _this.y = options.y || _this.y;\n        _this.width = options.width || 1;\n        _this.height = options.height || 1;\n        options.anchor && _this.setAnchor(options.anchor);\n        return _this;\n    }\n    Object.defineProperty(RectangleInstance.prototype, \"anchor\", {\n        get: function () {\n            return this._anchor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    RectangleInstance.prototype.setAnchor = function (anchor) {\n        var newAnchor = {\n            padding: anchor.padding || 0,\n            type: anchor.type,\n            x: anchor.x || 0,\n            y: anchor.y || 0\n        };\n        anchorCalculator[newAnchor.type](newAnchor, this);\n        this._anchor = newAnchor;\n    };\n    __decorate([\n        instance_provider_1.observable\n    ], RectangleInstance.prototype, \"color\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], RectangleInstance.prototype, \"depth\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], RectangleInstance.prototype, \"height\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], RectangleInstance.prototype, \"scaling\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], RectangleInstance.prototype, \"width\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], RectangleInstance.prototype, \"x\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], RectangleInstance.prototype, \"y\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], RectangleInstance.prototype, \"_anchor\", void 0);\n    return RectangleInstance;\n}(instance_1.Instance));\nexports.RectangleInstance = RectangleInstance;\nvar _a;\n","module.exports = \"precision highp float;\\n\\nvarying vec4 vertexColor;\\n${extendHeader}\\n\\nvoid main() {\\n  ${attributes}\\n\\n  // Figure out the size of the image as it'd show on the screen\\n  vec3 screenSize = cameraSpaceSize(vec3(size, 1.0));\\n  // Do the test for when the image is larger on the screen than the font size\\n  bool largerOnScreen = screenSize.y > size.y;\\n  // Determines if a scale mode should be used or not for the vertex\\n  float useScaleMode = float(\\n    (\\n      scaling == 3.0 ||                  // NEVER mode - keep the image the same size always\\n      (largerOnScreen && scaling == 2.0) // BOUND_MAX mode - only if we're larger than the font size do we scale down\\n    ) &&\\n    scaling != 1.0                       // ALWAYS mode - the image stays completely in world space allowing it to scale freely\\n  );\\n  // If zooms are unequal, assume one is filtered to be 1.0\\n  float unequalZooms = float((cameraScale.x > cameraScale.y || cameraScale.y > cameraScale.x) && useScaleMode != 0.0);\\n  // Destructure threejs's bug with the position requirement\\n  float normal = position.x;\\n  float side = position.y;\\n  // Get the location of the anchor in world space\\n  vec2 worldAnchor = location + anchor;\\n  // Apply the image's tint as a tint to the image\\n  vertexColor = color * color.a;\\n\\n  // Correct aspect ratio.\\n  size = mix(\\n    size,\\n    (size * cameraScale.yx),\\n    unequalZooms\\n  );\\n\\n  vec2 adjustedAnchor = mix(\\n    anchor,\\n    (anchor * cameraScale.yx),\\n    unequalZooms\\n  );\\n\\n  vec2 vertex = vec2(side, float(normal == 1.0)) * size + location - adjustedAnchor;\\n\\n  // See how scaled the size on screen will be from the actual height of the image\\n  float imageScreenScale = mix(\\n    screenSize.y / size.y,\\n    screenSize.x / size.x,\\n    float((cameraScale.x < 1.0) || (cameraScale.x > 1.0))\\n  );\\n\\n  // If our screen rendering is larger than the size the image is supposed to be, then we automagically\\n  // scale down our image to stay the correct size, centered on the anchor point\\n  vec2 anchorToVertex = vertex - location;\\n\\n  // We now choose between keeping the same image size or keeping it in world space\\n  vertex = mix(\\n    // This option keeps the image size in world space\\n    vertex,\\n    // This option counters the scaling of the image on the screen keeping it a static size\\n    (anchorToVertex / imageScreenScale) + location,\\n    // This is the flag determining if a scale mode should be applied to the vertex\\n    useScaleMode\\n  );\\n\\n  gl_Position = clipSpace(vec3(vertex, depth));\\n  ${extend}\\n}\\n\"","module.exports = \"precision highp float;\\n\\n${picking}\\nvarying vec4 vertexColor;\\n${extendHeader}\\n\\nvoid main() {\\n  setColor(vertexColor);\\n  ${extend}\\n}\\n\"","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar primitives_1 = require(\"../../primitives\");\nvar layer_1 = require(\"../../surface/layer\");\nvar types_1 = require(\"../../types\");\nvar types_2 = require(\"../types\");\nvar min = Math.min, max = Math.max;\nvar RectangleLayer = (function (_super) {\n    __extends(RectangleLayer, _super);\n    function RectangleLayer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    RectangleLayer.prototype.getInstancePickingMethods = function () {\n        return {\n            boundsAccessor: function (rectangle) {\n                var anchorEffect = [0, 0];\n                if (rectangle.anchor) {\n                    anchorEffect[0] = rectangle.anchor.x || 0;\n                    anchorEffect[1] = rectangle.anchor.y || 0;\n                }\n                var topLeft = [\n                    rectangle.x - anchorEffect[0],\n                    rectangle.y - anchorEffect[1]\n                ];\n                return new primitives_1.Bounds({\n                    height: rectangle.height,\n                    width: rectangle.width,\n                    x: topLeft[0],\n                    y: topLeft[1]\n                });\n            },\n            hitTest: function (rectangle, point, projection) {\n                var maxScale = max.apply(void 0, projection.camera.scale);\n                var minScale = min.apply(void 0, projection.camera.scale);\n                if (rectangle.scaling === types_2.ScaleType.ALWAYS) {\n                    return true;\n                }\n                else if (rectangle.scaling === types_2.ScaleType.BOUND_MAX) {\n                    if (minScale <= 1 && maxScale <= 1) {\n                        return true;\n                    }\n                    else {\n                        var anchorEffect = [0, 0];\n                        if (rectangle.anchor) {\n                            anchorEffect[0] = rectangle.anchor.x || 0;\n                            anchorEffect[1] = rectangle.anchor.y || 0;\n                        }\n                        var topLeft = [\n                            rectangle.x - anchorEffect[0] / maxScale,\n                            rectangle.y - anchorEffect[1] / maxScale\n                        ];\n                        return new primitives_1.Bounds({\n                            height: rectangle.height / maxScale,\n                            width: rectangle.width / maxScale,\n                            x: topLeft[0],\n                            y: topLeft[1]\n                        }).containsPoint(point);\n                    }\n                }\n                else if (rectangle.scaling === types_2.ScaleType.NEVER) {\n                    var anchorEffect = [0, 0];\n                    if (rectangle.anchor) {\n                        anchorEffect[0] = rectangle.anchor.x || 0;\n                        anchorEffect[1] = rectangle.anchor.y || 0;\n                    }\n                    var topLeft = projection.worldToScreen({\n                        x: rectangle.x - anchorEffect[0] / projection.camera.scale[0],\n                        y: rectangle.y - anchorEffect[1] / projection.camera.scale[1]\n                    });\n                    var screenPoint = projection.worldToScreen(point);\n                    return new primitives_1.Bounds({\n                        height: rectangle.height,\n                        width: rectangle.width,\n                        x: topLeft.x,\n                        y: topLeft.y\n                    }).containsPoint(screenPoint);\n                }\n                return true;\n            }\n        };\n    };\n    RectangleLayer.prototype.initShader = function () {\n        var vertexToNormal = {\n            0: 1,\n            1: 1,\n            2: -1,\n            3: 1,\n            4: -1,\n            5: -1\n        };\n        var vertexToSide = {\n            0: 0,\n            1: 0,\n            2: 0,\n            3: 1,\n            4: 1,\n            5: 1\n        };\n        return {\n            fs: require(\"./rectangle-layer.fs\"),\n            instanceAttributes: [\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"location\",\n                    size: types_1.InstanceAttributeSize.TWO,\n                    update: function (o) { return [o.x, o.y]; }\n                },\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.THREE,\n                    name: \"anchor\",\n                    size: types_1.InstanceAttributeSize.TWO,\n                    update: function (o) { return [o.anchor.x || 0, o.anchor.y || 0]; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"size\",\n                    size: types_1.InstanceAttributeSize.TWO,\n                    update: function (o) { return [o.width, o.height]; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.THREE,\n                    name: \"depth\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.depth]; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.FOUR,\n                    name: \"scaling\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.scaling]; }\n                },\n                {\n                    block: 3,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"color\",\n                    size: types_1.InstanceAttributeSize.FOUR,\n                    update: function (o) { return o.color; }\n                }\n            ],\n            uniforms: [\n                {\n                    name: \"scaleFactor\",\n                    size: types_1.UniformSize.ONE,\n                    update: function (_u) { return [1]; }\n                }\n            ],\n            vertexAttributes: [\n                {\n                    name: \"position\",\n                    size: types_1.VertexAttributeSize.THREE,\n                    update: function (vertex) { return [\n                        vertexToNormal[vertex],\n                        vertexToSide[vertex],\n                        0\n                    ]; }\n                }\n            ],\n            vertexCount: 6,\n            vs: require(\"./rectangle-layer.vs\")\n        };\n    };\n    RectangleLayer.prototype.getModelType = function () {\n        return {\n            drawMode: Three.TriangleStripDrawMode,\n            modelType: Three.Mesh\n        };\n    };\n    RectangleLayer.prototype.getMaterialOptions = function () {\n        return {\n            blending: Three.CustomBlending,\n            blendSrc: Three.OneFactor,\n            premultipliedAlpha: true,\n            transparent: true\n        };\n    };\n    return RectangleLayer;\n}(layer_1.Layer));\nexports.RectangleLayer = RectangleLayer;\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./rectangle-layer\"));\n__export(require(\"./rectangle-instance\"));\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar instance_provider_1 = require(\"../../instance-provider\");\nvar instance_1 = require(\"../../instance-provider/instance\");\nvar texture_1 = require(\"../../surface/texture\");\nvar types_1 = require(\"../types\");\nvar rasterizationLookUp = new Map();\nvar anchorCalculator = (_a = {},\n    _a[types_1.AnchorType.TopLeft] = function (anchor, _label) {\n        anchor.x = -anchor.padding;\n        anchor.y = -anchor.padding;\n    },\n    _a[types_1.AnchorType.TopMiddle] = function (anchor, label) {\n        anchor.x = label.width / 2.0;\n        anchor.y = -anchor.padding;\n    },\n    _a[types_1.AnchorType.TopRight] = function (anchor, label) {\n        anchor.x = label.width + anchor.padding;\n        anchor.y = -anchor.padding;\n    },\n    _a[types_1.AnchorType.MiddleLeft] = function (anchor, label) {\n        anchor.x = -anchor.padding;\n        anchor.y = label.height / 2;\n    },\n    _a[types_1.AnchorType.Middle] = function (anchor, label) {\n        anchor.x = label.width / 2.0;\n        anchor.y = label.height / 2.0;\n    },\n    _a[types_1.AnchorType.MiddleRight] = function (anchor, label) {\n        anchor.x = label.width + anchor.padding;\n        anchor.y = label.height / 2.0;\n    },\n    _a[types_1.AnchorType.BottomLeft] = function (anchor, label) {\n        anchor.x = -anchor.padding;\n        anchor.y = label.height + anchor.padding;\n    },\n    _a[types_1.AnchorType.BottomMiddle] = function (anchor, label) {\n        anchor.x = label.width / 2.0;\n        anchor.y = label.height + anchor.padding;\n    },\n    _a[types_1.AnchorType.BottomRight] = function (anchor, label) {\n        anchor.x = label.width + anchor.padding;\n        anchor.y = label.height + anchor.padding;\n    },\n    _a[types_1.AnchorType.Custom] = function (anchor, _label) {\n        anchor.x = anchor.x || 0;\n        anchor.y = anchor.y || 0;\n    },\n    _a);\nvar LabelInstance = (function (_super) {\n    __extends(LabelInstance, _super);\n    function LabelInstance(options) {\n        var _this = _super.call(this, options) || this;\n        _this.color = [0, 0, 0, 1];\n        _this.depth = 0;\n        _this.maxScale = 1;\n        _this.scaling = types_1.ScaleType.BOUND_MAX;\n        _this.scale = 1.0;\n        _this.x = 0;\n        _this.y = 0;\n        _this._cssFont = \"\";\n        _this._fontFamily = \"Arial\";\n        _this._fontSize = 12;\n        _this._fontStyle = \"normal\";\n        _this._fontWeight = 400;\n        _this._maxWidth = 0;\n        _this._text = \"\";\n        _this._width = 0;\n        _this._height = 0;\n        _this._isDestroyed = false;\n        _this._anchor = {\n            padding: 0,\n            type: types_1.AnchorType.TopLeft,\n            x: 0,\n            y: 0\n        };\n        _this.depth = options.depth || _this.depth;\n        _this.color = options.color || _this.color;\n        _this.maxScale = options.maxScale || _this.maxScale;\n        _this.scaling = options.scaling || _this.scaling;\n        _this.scale = options.scale || _this.scale;\n        _this.x = options.x || _this.x;\n        _this.y = options.y || _this.y;\n        _this._fontFamily = options.fontFamily || _this._fontFamily;\n        _this._fontSize = options.fontSize || _this._fontSize;\n        _this._fontStyle = options.fontStyle || _this._fontStyle;\n        _this._fontWeight = options.fontWeight || _this._fontWeight;\n        _this._maxWidth = options.maxWidth || 0;\n        _this._text = options.text || _this._text;\n        _this._cssFont = texture_1.LabelRasterizer.makeCSSFont(_this, 1);\n        var cssFontLookup = _this._cssFont + \"_\" + _this._maxWidth;\n        var rasterizations = rasterizationLookUp.get(_this._text);\n        var rasterization;\n        if (rasterizations) {\n            rasterization = rasterizations.get(cssFontLookup);\n            if (rasterization) {\n                rasterization.references++;\n            }\n        }\n        else {\n            rasterizations = new Map();\n        }\n        if (!rasterization) {\n            rasterization = {\n                references: 1,\n                resource: new texture_1.LabelAtlasResource(_this)\n            };\n            if (options.rasterization) {\n                rasterization.resource.sampleScale = options.rasterization.scale || 1.0;\n            }\n            rasterization.resource.sampleScale =\n                rasterization.resource.sampleScale || 1.0;\n            texture_1.LabelRasterizer.renderSync(rasterization.resource);\n            rasterizationLookUp.set(_this._text, rasterizations);\n            rasterizations.set(cssFontLookup, rasterization);\n        }\n        _this._rasterization = rasterization;\n        _this._width = rasterization.resource.rasterization.world.width;\n        _this._height = rasterization.resource.rasterization.world.height;\n        options.anchor && _this.setAnchor(options.anchor);\n        return _this;\n    }\n    LabelInstance.destroy = function () {\n        rasterizationLookUp.clear();\n    };\n    Object.defineProperty(LabelInstance.prototype, \"cssFont\", {\n        get: function () {\n            return this._cssFont;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LabelInstance.prototype, \"isDestroyed\", {\n        get: function () {\n            return this._isDestroyed;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LabelInstance.prototype, \"fontFamily\", {\n        get: function () {\n            return this._fontFamily;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LabelInstance.prototype, \"fontSize\", {\n        get: function () {\n            return this._fontSize;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LabelInstance.prototype, \"fontStyle\", {\n        get: function () {\n            return this._fontStyle;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LabelInstance.prototype, \"fontWeight\", {\n        get: function () {\n            return this._fontWeight;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LabelInstance.prototype, \"maxWidth\", {\n        get: function () {\n            return this._maxWidth;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LabelInstance.prototype, \"resource\", {\n        get: function () {\n            return this._rasterization.resource;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LabelInstance.prototype, \"text\", {\n        get: function () {\n            return this._text;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LabelInstance.prototype, \"truncatedText\", {\n        get: function () {\n            return this._rasterization.resource.truncatedText || this.text;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LabelInstance.prototype, \"width\", {\n        get: function () {\n            return this._width;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LabelInstance.prototype, \"height\", {\n        get: function () {\n            return this._height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    LabelInstance.prototype.destroy = function () {\n        if (!this._isDestroyed) {\n            this._isDestroyed = true;\n            this._rasterization.references--;\n            if (this._rasterization.references === 0) {\n                this._rasterization.resource;\n            }\n        }\n    };\n    Object.defineProperty(LabelInstance.prototype, \"anchor\", {\n        get: function () {\n            return this._anchor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    LabelInstance.prototype.setAnchor = function (anchor) {\n        var newAnchor = {\n            padding: anchor.padding || 0,\n            type: anchor.type,\n            x: anchor.x || 0,\n            y: anchor.y || 0\n        };\n        anchorCalculator[newAnchor.type](newAnchor, this);\n        this._anchor = newAnchor;\n    };\n    __decorate([\n        instance_provider_1.observable\n    ], LabelInstance.prototype, \"color\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], LabelInstance.prototype, \"depth\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], LabelInstance.prototype, \"maxScale\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], LabelInstance.prototype, \"scaling\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], LabelInstance.prototype, \"scale\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], LabelInstance.prototype, \"x\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], LabelInstance.prototype, \"y\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], LabelInstance.prototype, \"_anchor\", void 0);\n    return LabelInstance;\n}(instance_1.Instance));\nexports.LabelInstance = LabelInstance;\nvar _a;\n","module.exports = \"precision highp float;\\n\\nvarying vec4 vertexColor;\\nvarying vec2 texCoord;\\n${extendHeader}\\n\\nvoid main() {\\n  ${attributes}\\n\\n  // Determine final screen size of label\\n  vec3 screenSize = cameraSpaceSize(vec3(size * scale / maxScale, 1.0));\\n\\n  // Test whether the label is larger on the screen than the font size\\n  bool largerOnScreen = screenSize.y > size.y || screenSize.x > size.x;\\n\\n  // Determines if a scale mode should be used or not for the vertex\\n  float useScaleMode = float(\\n    (\\n      scaling == 3.0 ||                  // NEVER mode - keep the image the same size always\\n      (largerOnScreen && scaling == 2.0) // BOUND_MAX mode - only if we're larger than the font size do we scale down\\n    ) &&\\n    scaling != 1.0                       // ALWAYS mode - the image stays completely in world space allowing it to scale freely\\n  );\\n\\n  // Correct aspect ratio.  Sufficient fix for most applications.\\n  // Will need another solution in the case of:\\n  //  (cameraScale y != cameraScale.x) && (cameraScale.x != 1 && cameraScale.y != 1)\\n\\n  // If zooms are unequal, assume one is filtered to be 1.0\\n  float unequalZooms = float(cameraScale.x != cameraScale.y);\\n\\n  size = mix(\\n    size,\\n    (size * cameraScale.yx),\\n    unequalZooms\\n  );\\n\\n  // Destructure threejs's bug with the position requirement\\n  float normal = position.x;\\n  float side = position.y;\\n\\n  vec2 scaledAnchor = anchor * scale;\\n\\n  // Get the location of the anchor in world space\\n  vec2 worldAnchor = location + scaledAnchor;\\n\\n  vec2 adjustedAnchor = mix(\\n    scaledAnchor,\\n    (scaledAnchor * cameraScale.yx),\\n    unequalZooms\\n  );\\n\\n  // Get the position of the current vertex\\n  vec2 vertex = vec2(side, float(normal == 1.0)) * scale * size + location - adjustedAnchor;\\n\\n  // See how scaled the size on screen will be from the actual height of the label\\n  float labelScreenScale = mix(\\n    screenSize.y / size.y,\\n    screenSize.x / size.x,\\n    float((cameraScale.x != 1.0))\\n  );\\n\\n  float currentScale = labelScreenScale * scale;\\n\\n  // If our screen rendering is larger than the size the label is supposed to be, then we automagically\\n  // scale down our label to stay the correct size, centered on the anchor point\\n  vec2 anchorToVertex = vertex - location;\\n\\n  // We now choose between keeping the same image size or keeping it in world space\\n  vertex = mix(\\n    // This option keeps the image size in world space\\n    vertex,\\n    // This option counters the scaling of the image on the screen keeping it a static size\\n    (anchorToVertex / labelScreenScale) + location,\\n    // This is the flag determining if a scale mode should be applied to the vertex\\n    useScaleMode\\n  );\\n\\n  // --Texture and Color\\n  // Get the tex coord from our inject texture info\\n  texCoord = texture.xy + ((texture.zw - texture.xy) * vec2(side, float(normal == -1.0)));\\n  // Apply the label's color as a tint to the label (all labels are rendered white to the base texture)\\n  vertexColor = color;\\n\\n  gl_Position = clipSpace(vec3(vertex, depth));\\n  ${extend}\\n}\\n\"","module.exports = \"precision highp float;\\n\\n${picking}\\nvarying vec4 vertexColor;\\nvarying vec2 texCoord;\\n${extendHeader}\\n\\nvoid main() {\\n  gl_FragColor = texture2D(labelAtlas, texCoord) * vertexColor;\\n  setColor(gl_FragColor * gl_FragColor.a);\\n  ${extend}\\n}\\n\"","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar primitives_1 = require(\"../../primitives\");\nvar layer_1 = require(\"../../surface/layer\");\nvar types_1 = require(\"../../types\");\nvar types_2 = require(\"../types\");\nvar max = Math.max, min = Math.min;\nvar LabelLayer = (function (_super) {\n    __extends(LabelLayer, _super);\n    function LabelLayer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    LabelLayer.prototype.getInstancePickingMethods = function () {\n        return {\n            boundsAccessor: function (label) {\n                var anchor = [label.anchor.x || 0, label.anchor.y || 0];\n                var topLeft = [label.x - anchor[0], label.y - anchor[1]];\n                return new primitives_1.Bounds({\n                    height: label.height,\n                    width: label.width,\n                    x: topLeft[0],\n                    y: topLeft[1]\n                });\n            },\n            hitTest: function (label, point, view) {\n                var maxScale = max.apply(void 0, view.camera.scale);\n                var minScale = min.apply(void 0, view.camera.scale);\n                if (label.scaling === types_2.ScaleType.ALWAYS) {\n                    return true;\n                }\n                else if (label.scaling === types_2.ScaleType.BOUND_MAX) {\n                    if (minScale <= 1 && maxScale <= 1) {\n                        return true;\n                    }\n                    else {\n                        var anchor = [label.anchor.x || 0, label.anchor.y || 0];\n                        var topLeft = view.worldToScreen({\n                            x: label.x - anchor[0] / view.camera.scale[0],\n                            y: label.y - anchor[1] / view.camera.scale[1]\n                        });\n                        var screenPoint = view.worldToScreen(point);\n                        return new primitives_1.Bounds({\n                            height: label.height,\n                            width: label.width,\n                            x: topLeft.x,\n                            y: topLeft.y\n                        }).containsPoint(screenPoint);\n                    }\n                }\n                else if (label.scaling === types_2.ScaleType.NEVER) {\n                    var anchor = [label.anchor.x || 0, label.anchor.y || 0];\n                    var topLeft = view.worldToScreen({\n                        x: label.x - anchor[0] / view.camera.scale[0],\n                        y: label.y - anchor[1] / view.camera.scale[1]\n                    });\n                    var screenPoint = view.worldToScreen(point);\n                    return new primitives_1.Bounds({\n                        height: label.height,\n                        width: label.width,\n                        x: topLeft.x,\n                        y: topLeft.y\n                    }).containsPoint(screenPoint);\n                }\n                return true;\n            }\n        };\n    };\n    LabelLayer.prototype.initShader = function () {\n        var _this = this;\n        var vertexToNormal = {\n            0: 1,\n            1: 1,\n            2: -1,\n            3: 1,\n            4: -1,\n            5: -1\n        };\n        var vertexToSide = {\n            0: 0,\n            1: 0,\n            2: 0,\n            3: 1,\n            4: 1,\n            5: 1\n        };\n        return {\n            fs: require(\"./label-layer.fs\"),\n            instanceAttributes: [\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"location\",\n                    size: types_1.InstanceAttributeSize.TWO,\n                    update: function (o) { return [o.x, o.y]; }\n                },\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.THREE,\n                    name: \"anchor\",\n                    size: types_1.InstanceAttributeSize.TWO,\n                    update: function (o) { return [o.anchor.x || 0, o.anchor.y || 0]; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"size\",\n                    size: types_1.InstanceAttributeSize.TWO,\n                    update: function (o) { return [o.width, o.height]; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.THREE,\n                    name: \"depth\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.depth]; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.FOUR,\n                    name: \"scaling\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.scaling]; }\n                },\n                {\n                    atlas: {\n                        key: this.props.atlas || \"\",\n                        name: \"labelAtlas\"\n                    },\n                    block: 2,\n                    name: \"texture\",\n                    update: function (o) { return _this.resource.request(_this, o, o.resource); }\n                },\n                {\n                    block: 3,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"color\",\n                    size: types_1.InstanceAttributeSize.FOUR,\n                    update: function (o) { return o.color; }\n                },\n                {\n                    block: 4,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"scale\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.scale]; }\n                },\n                {\n                    block: 4,\n                    blockIndex: types_1.InstanceBlockIndex.TWO,\n                    name: \"maxScale\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.maxScale]; }\n                }\n            ],\n            uniforms: [\n                {\n                    name: \"scaleFactor\",\n                    size: types_1.UniformSize.ONE,\n                    update: function (_u) { return [1]; }\n                }\n            ],\n            vertexAttributes: [\n                {\n                    name: \"position\",\n                    size: types_1.VertexAttributeSize.THREE,\n                    update: function (vertex) { return [\n                        vertexToNormal[vertex],\n                        vertexToSide[vertex],\n                        0\n                    ]; }\n                }\n            ],\n            vertexCount: 6,\n            vs: require(\"./label-layer.vs\")\n        };\n    };\n    LabelLayer.prototype.getModelType = function () {\n        return {\n            drawMode: Three.TriangleStripDrawMode,\n            modelType: Three.Mesh\n        };\n    };\n    LabelLayer.prototype.getMaterialOptions = function () {\n        return {\n            blending: Three.CustomBlending,\n            blendSrc: Three.OneFactor,\n            premultipliedAlpha: true,\n            transparent: true\n        };\n    };\n    return LabelLayer;\n}(layer_1.Layer));\nexports.LabelLayer = LabelLayer;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar canvas;\nvar ImageRasterizer = (function () {\n    function ImageRasterizer() {\n    }\n    ImageRasterizer.awaitContext = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!!canvas) return [3, 2];\n                        this.getContext();\n                        return [4, new Promise(function (resolve) { return setTimeout(resolve, 10); })];\n                    case 1:\n                        _a.sent();\n                        return [3, 0];\n                    case 2: return [2];\n                }\n            });\n        });\n    };\n    ImageRasterizer.getContext = function () {\n        if (!canvas) {\n            canvas = document.createElement(\"canvas\").getContext(\"2d\");\n        }\n        return canvas;\n    };\n    ImageRasterizer.calculateImageSize = function (resource, _sampleScale) {\n        var image = resource.image.element;\n        if (!image) {\n            console.warn(\"Image does not exist! Please ensure the resource contains a valid image.\");\n            return;\n        }\n        if (!canvas) {\n            console.warn(\"The Image rasterizer was unable to establish a valid canvas context. Please ensure the system supports contexts and ensure the document is ready first.\");\n            return;\n        }\n        if (image.width === 0 || image.height === 0) {\n            console.warn(\"Images provided shoud have valid dimensions! Please ensure the image is loaded first.\");\n            return;\n        }\n        canvas.canvas.width = 100;\n        canvas.canvas.height = 100;\n        canvas.drawImage(image, 0, 0);\n        resource.rasterization = resource.rasterization || {\n            texture: { height: 0, width: 0 },\n            world: { height: 0, width: 0 }\n        };\n        resource.rasterization.texture = {\n            height: image.height * resource.sampleScale,\n            width: image.width * resource.sampleScale\n        };\n        resource.rasterization.world = {\n            height: image.height,\n            width: image.width\n        };\n        resource.rasterization.image = image;\n    };\n    ImageRasterizer.render = function (resource) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4, this.awaitContext()];\n                    case 1:\n                        _a.sent();\n                        this.calculateImageSize(resource, resource.sampleScale);\n                        return [2, resource];\n                }\n            });\n        });\n    };\n    ImageRasterizer.renderSync = function (resource) {\n        this.getContext();\n        if (!canvas) {\n            console.warn(\"Can not render a image synchronously without the canvas context being ready.\");\n            return resource;\n        }\n        this.calculateImageSize(resource, resource.sampleScale);\n        return resource;\n    };\n    return ImageRasterizer;\n}());\nexports.ImageRasterizer = ImageRasterizer;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar bounds_1 = require(\"../../primitives/bounds\");\nvar atlas_1 = require(\"./atlas\");\nvar color_atlas_resource_1 = require(\"./color-atlas-resource\");\nvar color_rasterizer_1 = require(\"./color-rasterizer\");\nvar image_atlas_resource_1 = require(\"./image-atlas-resource\");\nvar label_atlas_resource_1 = require(\"./label-atlas-resource\");\nvar label_rasterizer_1 = require(\"./label-rasterizer\");\nvar sub_texture_1 = require(\"./sub-texture\");\nvar debug = require(\"debug\")(\"webgl-surface:Atlas\");\nvar ZERO_IMAGE = {\n    aspectRatio: 0,\n    atlasBL: { x: 0, y: 0 },\n    atlasBR: { x: 0, y: 0 },\n    atlasReferenceID: \"\",\n    atlasTexture: null,\n    atlasTL: { x: 0, y: 0 },\n    atlasTR: { x: 0, y: 0 },\n    heightOnAtlas: 0,\n    isValid: false,\n    pixelHeight: 0,\n    pixelWidth: 0,\n    widthOnAtlas: 0\n};\nfunction isValidImage(image) {\n    var isValid = false;\n    if (image && image.isValid) {\n        if (image.pixelWidth && image.pixelHeight) {\n            isValid = true;\n        }\n    }\n    return isValid;\n}\nvar AtlasManager = (function () {\n    function AtlasManager() {\n        this.allAtlas = new Map();\n    }\n    AtlasManager.prototype.createAtlas = function (options, resources) {\n        return __awaiter(this, void 0, void 0, function () {\n            var atlas;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        atlas = new atlas_1.Atlas(options);\n                        atlas.setManager(this);\n                        this.allAtlas.set(atlas.id, atlas);\n                        if (!resources) return [3, 2];\n                        return [4, this.updateAtlas(atlas.id, resources)];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2:\n                        debug(\"Atlas Created-> %o\", atlas);\n                        return [2, atlas];\n                }\n            });\n        });\n    };\n    AtlasManager.prototype.destroy = function () {\n        this.allAtlas.forEach(function (value) { return value.destroy(); });\n    };\n    AtlasManager.prototype.destroyAtlas = function (atlasName) {\n        var atlas = this.allAtlas.get(atlasName);\n        if (atlas) {\n            atlas.destroy();\n        }\n    };\n    AtlasManager.prototype.setDefaultImage = function (image, atlasName) {\n        image = Object.assign(image, ZERO_IMAGE, { atlasReferenceID: atlasName });\n        return image;\n    };\n    AtlasManager.prototype.draw = function (atlas, resource) {\n        return __awaiter(this, void 0, void 0, function () {\n            var canvas, atlasName, loadedImage, rasterization, texture, rect, dimensions, packing, insertedNode, ux, uy, uw, uh, onePixelX, atlasDimensions, bottom, top_1, left, right;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        canvas = atlas.texture.image;\n                        atlasName = atlas.id;\n                        if (!atlas.registerResource(resource)) {\n                            console.warn(\"Could not draw resource to the atlas as the resource was not properly registered to the atlas first\", atlas, resource);\n                            return [2, Promise.resolve(false)];\n                        }\n                        return [4, this.loadImage(resource)];\n                    case 1:\n                        loadedImage = _a.sent();\n                        if (loadedImage && isValidImage(resource.texture)) {\n                            rasterization = resource.rasterization;\n                            texture = resource.texture;\n                            rect = new bounds_1.Bounds({\n                                left: 0,\n                                right: rasterization.texture.width,\n                                top: 0,\n                                bottom: rasterization.texture.height\n                            });\n                            dimensions = {\n                                first: texture,\n                                second: rect\n                            };\n                            dimensions.second.width += 1;\n                            dimensions.second.height += 1;\n                            packing = atlas.packing;\n                            insertedNode = packing.insert(dimensions);\n                            if (insertedNode) {\n                                debug(\"Atlas location determined: %o\", insertedNode);\n                                insertedNode.nodeImage = texture;\n                                ux = insertedNode.nodeDimensions.x / atlas.width;\n                                uy = insertedNode.nodeDimensions.y / atlas.height;\n                                uw = insertedNode.nodeDimensions.width / atlas.width;\n                                uh = insertedNode.nodeDimensions.height / atlas.height;\n                                onePixelX = 1 / atlas.width;\n                                atlasDimensions = new bounds_1.Bounds({\n                                    bottom: 1.0 - uy,\n                                    left: ux,\n                                    right: ux + uw,\n                                    top: 1.0 - (uy + uh)\n                                });\n                                bottom = atlasDimensions.bottom;\n                                top_1 = atlasDimensions.y;\n                                left = atlasDimensions.x;\n                                right = atlasDimensions.x + atlasDimensions.width - onePixelX;\n                                texture.atlasReferenceID = atlasName;\n                                texture.atlasTL = { x: left, y: top_1 };\n                                texture.atlasBR = { x: right, y: bottom };\n                                texture.atlasBL = { x: left, y: bottom };\n                                texture.atlasTR = { x: right, y: top_1 };\n                                texture.widthOnAtlas = Math.abs(texture.atlasTR.x - texture.atlasTL.x);\n                                texture.heightOnAtlas = Math.abs(texture.atlasTR.y - texture.atlasBR.y);\n                                texture.pixelWidth = rasterization.texture.width;\n                                texture.pixelHeight = rasterization.texture.height;\n                                canvas\n                                    .getContext(\"2d\")\n                                    .drawImage(loadedImage, insertedNode.nodeDimensions.x, insertedNode.nodeDimensions.y);\n                                return [2, true];\n                            }\n                            else {\n                                console.error(\"Could not fit resource into atlas\", resource);\n                                resource.texture = this.setDefaultImage(resource.texture, atlasName);\n                                return [2, false];\n                            }\n                        }\n                        else {\n                            if (!resource.texture.isValid) {\n                                debug(\"Resource was invalidated during load:\", resource);\n                            }\n                            else {\n                                console.error(\"Could not load resource:\", resource);\n                            }\n                            resource.texture = this.setDefaultImage(resource.texture, atlasName);\n                            return [2, false];\n                        }\n                        return [2];\n                }\n            });\n        });\n    };\n    AtlasManager.prototype.getAtlasTexture = function (atlasName) {\n        return this.allAtlas.get(atlasName);\n    };\n    AtlasManager.prototype.loadImage = function (resource) {\n        return __awaiter(this, void 0, void 0, function () {\n            var imageSrc, subTexture, image_1, image, image;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        imageSrc = \"\";\n                        subTexture = resource.texture || new sub_texture_1.SubTexture();\n                        resource.texture = subTexture;\n                        if (resource.texture.isValid === false)\n                            return [2, null];\n                        if (!(resource instanceof image_atlas_resource_1.ImageAtlasResource)) return [3, 4];\n                        if (!resource.image.element) return [3, 2];\n                        if (resource.image.element.width !== 0 &&\n                            resource.image.element.height !== 0) {\n                            image_1 = resource.image.element;\n                            subTexture.pixelWidth = image_1.width;\n                            subTexture.pixelHeight = image_1.height;\n                            subTexture.aspectRatio = image_1.width / image_1.height;\n                            return [2, image_1];\n                        }\n                        return [4, new Promise(function (resolve) {\n                                var image = resource.image.element;\n                                if (image) {\n                                    image.onload = function () {\n                                        subTexture.pixelWidth = image.width;\n                                        subTexture.pixelHeight = image.height;\n                                        subTexture.aspectRatio = image.width / image.height;\n                                        resolve(image);\n                                    };\n                                    image.onerror = function () {\n                                        resolve(null);\n                                    };\n                                }\n                                else {\n                                    resolve(null);\n                                }\n                            })];\n                    case 1:\n                        image = _a.sent();\n                        return [2, image];\n                    case 2:\n                        if (resource.image.path) {\n                            imageSrc = resource.image.path;\n                        }\n                        _a.label = 3;\n                    case 3: return [3, 10];\n                    case 4:\n                        if (!(resource instanceof label_atlas_resource_1.LabelAtlasResource)) return [3, 7];\n                        if (!!resource.rasterization.canvas) return [3, 6];\n                        return [4, label_rasterizer_1.LabelRasterizer.render(resource)];\n                    case 5:\n                        _a.sent();\n                        _a.label = 6;\n                    case 6:\n                        if (resource.rasterization.canvas) {\n                            debug(\"Rasterized label %o\", resource.rasterization);\n                            imageSrc = resource.rasterization.canvas.toDataURL(\"image/png\");\n                        }\n                        else {\n                            console.warn(\"The label was not able to be rasterized\");\n                        }\n                        return [3, 10];\n                    case 7:\n                        if (!(resource instanceof color_atlas_resource_1.ColorAtlasResource)) return [3, 10];\n                        if (!!resource.rasterization.canvas) return [3, 9];\n                        return [4, color_rasterizer_1.ColorRasterizer.render(resource)];\n                    case 8:\n                        _a.sent();\n                        _a.label = 9;\n                    case 9:\n                        if (resource.rasterization.canvas) {\n                            debug(\"Rasterized color %o\", resource.rasterization);\n                            imageSrc = resource.rasterization.canvas.toDataURL(\"image/png\");\n                        }\n                        else {\n                            console.warn(\"The color was not able to be rasterized\");\n                        }\n                        _a.label = 10;\n                    case 10:\n                        if (!imageSrc) return [3, 12];\n                        return [4, new Promise(function (resolve) {\n                                var image = new Image();\n                                image.onload = function () {\n                                    subTexture.pixelWidth = image.width;\n                                    subTexture.pixelHeight = image.height;\n                                    subTexture.aspectRatio = image.width / image.height;\n                                    resolve(image);\n                                };\n                                image.onerror = function () {\n                                    resolve(null);\n                                };\n                                image.src = imageSrc;\n                            })];\n                    case 11:\n                        image = _a.sent();\n                        return [2, image];\n                    case 12: return [2, null];\n                }\n            });\n        });\n    };\n    AtlasManager.prototype.updateAtlas = function (atlasName, resources) {\n        return __awaiter(this, void 0, void 0, function () {\n            var atlas, _i, resources_1, resource;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        atlas = this.allAtlas.get(atlasName);\n                        if (!atlas) return [3, 5];\n                        _i = 0, resources_1 = resources;\n                        _a.label = 1;\n                    case 1:\n                        if (!(_i < resources_1.length)) return [3, 4];\n                        resource = resources_1[_i];\n                        return [4, this.draw(atlas, resource)];\n                    case 2:\n                        _a.sent();\n                        _a.label = 3;\n                    case 3:\n                        _i++;\n                        return [3, 1];\n                    case 4:\n                        atlas.updateTexture();\n                        return [3, 6];\n                    case 5:\n                        console.warn(\"Can not update non-existing atlas:\", atlasName, \"These resources will not be loaded:\", resources);\n                        _a.label = 6;\n                    case 6: return [2];\n                }\n            });\n        });\n    };\n    return AtlasManager;\n}());\nexports.AtlasManager = AtlasManager;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar bounds_1 = require(\"../../primitives/bounds\");\nvar PackNode = (function () {\n    function PackNode(x, y, width, height) {\n        this.child = [null, null];\n        this.isLeaf = true;\n        this.nodeImage = null;\n        this.nodeDimensions = new bounds_1.Bounds({\n            height: height,\n            width: width,\n            x: x,\n            y: y\n        });\n    }\n    PackNode.prototype.destroy = function () {\n        var child0 = this.child[0];\n        var child1 = this.child[1];\n        this.nodeImage = null;\n        if (child0) {\n            child0.destroy();\n        }\n        if (child1) {\n            child1.destroy();\n        }\n        this.child[0] = null;\n        this.child[1] = null;\n    };\n    PackNode.prototype.hasChild = function () {\n        var child0 = this.child[0];\n        var child1 = this.child[1];\n        if (child0 && !child0.nodeImage) {\n            return !child0.isLeaf;\n        }\n        if (child1 && !child1.nodeImage) {\n            return !child1.isLeaf;\n        }\n        return false;\n    };\n    PackNode.prototype.insert = function (image) {\n        var child0 = this.child[0];\n        var child1 = this.child[1];\n        if (!this.isLeaf && child0 && child1) {\n            var newNode = child0.insert(image);\n            if (newNode !== null) {\n                return newNode;\n            }\n            return child1.insert(image);\n        }\n        else {\n            if (this.nodeImage) {\n                return null;\n            }\n            var fitFlag = this.nodeDimensions.fits(image.second);\n            if (fitFlag === 0) {\n                return null;\n            }\n            if (fitFlag === 1) {\n                return this;\n            }\n            this.isLeaf = false;\n            var imgWidth = image.second.width;\n            var imgHeight = image.second.height;\n            var dWidth = this.nodeDimensions.width - imgWidth;\n            var dHeight = this.nodeDimensions.height - image.second.height;\n            if (dWidth > dHeight) {\n                child0 = this.child[0] = new PackNode(this.nodeDimensions.x, this.nodeDimensions.y, imgWidth, this.nodeDimensions.height);\n                child1 = this.child[1] = new PackNode(this.nodeDimensions.x + imgWidth, this.nodeDimensions.y, dWidth, this.nodeDimensions.height);\n            }\n            else {\n                child0 = this.child[0] = new PackNode(this.nodeDimensions.x, this.nodeDimensions.y, this.nodeDimensions.width, imgHeight);\n                child1 = this.child[1] = new PackNode(this.nodeDimensions.x, this.nodeDimensions.y + imgHeight, this.nodeDimensions.width, dHeight);\n            }\n        }\n        return child0.insert(image);\n    };\n    PackNode.prototype.remove = function (image) {\n        var child0 = this.child[0];\n        var child1 = this.child[1];\n        if (child1 && child0 && !this.isLeaf) {\n            var removed = child0.remove(image);\n            if (removed) {\n                return true;\n            }\n            removed = child1.remove(image);\n            if (!child0.hasChild()) {\n                if (!child1.hasChild()) {\n                    this.child[0] = null;\n                    this.child[1] = null;\n                }\n            }\n            return removed;\n        }\n        else {\n            if (this.nodeImage === image) {\n                this.nodeImage = null;\n                delete image.atlasReferenceID;\n                image.pixelWidth = 0;\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n    };\n    return PackNode;\n}());\nexports.PackNode = PackNode;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar instance_provider_1 = require(\"../../instance-provider\");\nvar instance_1 = require(\"../../instance-provider/instance\");\nvar texture_1 = require(\"../../surface/texture\");\nvar types_1 = require(\"../types\");\nvar max = Math.max;\nvar rasterizationLookUp = new Map();\nvar anchorCalculator = (_a = {},\n    _a[types_1.AnchorType.TopLeft] = function (anchor, _image) {\n        anchor.x = -anchor.padding;\n        anchor.y = -anchor.padding;\n    },\n    _a[types_1.AnchorType.TopMiddle] = function (anchor, image) {\n        anchor.x = image.width / 2.0;\n        anchor.y = -anchor.padding;\n    },\n    _a[types_1.AnchorType.TopRight] = function (anchor, image) {\n        anchor.x = image.width + anchor.padding;\n        anchor.y = -anchor.padding;\n    },\n    _a[types_1.AnchorType.MiddleLeft] = function (anchor, image) {\n        anchor.x = -anchor.padding;\n        anchor.y = image.height / 2;\n    },\n    _a[types_1.AnchorType.Middle] = function (anchor, image) {\n        anchor.x = image.width / 2.0;\n        anchor.y = image.height / 2.0;\n    },\n    _a[types_1.AnchorType.MiddleRight] = function (anchor, image) {\n        anchor.x = image.width + anchor.padding;\n        anchor.y = image.height / 2.0;\n    },\n    _a[types_1.AnchorType.BottomLeft] = function (anchor, image) {\n        anchor.x = -anchor.padding;\n        anchor.y = image.height + anchor.padding;\n    },\n    _a[types_1.AnchorType.BottomMiddle] = function (anchor, image) {\n        anchor.x = image.width / 2.0;\n        anchor.y = image.height + anchor.padding;\n    },\n    _a[types_1.AnchorType.BottomRight] = function (anchor, image) {\n        anchor.x = image.width + anchor.padding;\n        anchor.y = image.height + anchor.padding;\n    },\n    _a[types_1.AnchorType.Custom] = function (anchor, _image) {\n        anchor.x = anchor.x || 0;\n        anchor.y = anchor.y || 0;\n    },\n    _a);\nvar ImageInstance = (function (_super) {\n    __extends(ImageInstance, _super);\n    function ImageInstance(options) {\n        var _this = _super.call(this, options) || this;\n        _this.tint = [0, 0, 0, 1];\n        _this.depth = 0;\n        _this.height = 1;\n        _this.scaling = types_1.ScaleType.BOUND_MAX;\n        _this.width = 1;\n        _this.x = 0;\n        _this.y = 0;\n        _this._sourceWidth = 0;\n        _this._sourceHeight = 0;\n        _this._isDestroyed = false;\n        _this._anchor = {\n            padding: 0,\n            type: types_1.AnchorType.TopLeft,\n            x: 0,\n            y: 0\n        };\n        _this.depth = options.depth || _this.depth;\n        _this.tint = options.tint || _this.tint;\n        _this.scaling = options.scaling || _this.scaling;\n        _this.x = options.x || _this.x;\n        _this.y = options.y || _this.y;\n        _this._element = options.element;\n        var rasterization = rasterizationLookUp.get(_this._path || _this._element);\n        if (rasterization) {\n            rasterization.references++;\n        }\n        if (!rasterization) {\n            rasterization = {\n                references: 1,\n                resource: new texture_1.ImageAtlasResource(_this)\n            };\n            rasterization.resource.sampleScale =\n                rasterization.resource.sampleScale || 1.0;\n            texture_1.ImageRasterizer.renderSync(rasterization.resource);\n            rasterizationLookUp.set(_this._path || _this._element, rasterization);\n        }\n        _this._rasterization = rasterization;\n        _this._sourceWidth = rasterization.resource.rasterization.world.width;\n        _this._sourceHeight = rasterization.resource.rasterization.world.height;\n        _this.width = options.width || _this._sourceWidth || 1;\n        _this.height = options.height || _this._sourceHeight || 1;\n        options.anchor && _this.setAnchor(options.anchor);\n        return _this;\n    }\n    ImageInstance.destroy = function () {\n        rasterizationLookUp.clear();\n    };\n    Object.defineProperty(ImageInstance.prototype, \"size\", {\n        get: function () {\n            return max(this.width, this.height);\n        },\n        set: function (value) {\n            var aspect = this.width / this.height;\n            this.width = value * aspect;\n            this.height = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageInstance.prototype, \"element\", {\n        get: function () {\n            return this._element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageInstance.prototype, \"isDestroyed\", {\n        get: function () {\n            return this._isDestroyed;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageInstance.prototype, \"path\", {\n        get: function () {\n            return this._path;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageInstance.prototype, \"resource\", {\n        get: function () {\n            return this._rasterization.resource;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageInstance.prototype, \"sourceWidth\", {\n        get: function () {\n            return this._sourceWidth;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageInstance.prototype, \"sourceHeight\", {\n        get: function () {\n            return this._sourceHeight;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ImageInstance.prototype.destroy = function () {\n        if (!this._isDestroyed) {\n            this._isDestroyed = true;\n            this._rasterization.references--;\n            if (this._rasterization.references === 0) {\n                this._rasterization.resource;\n                console.warn(\"The destroy method still needs completion\");\n            }\n        }\n    };\n    Object.defineProperty(ImageInstance.prototype, \"anchor\", {\n        get: function () {\n            return this._anchor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ImageInstance.prototype.setAnchor = function (anchor) {\n        var newAnchor = {\n            padding: anchor.padding || 0,\n            type: anchor.type,\n            x: anchor.x || 0,\n            y: anchor.y || 0\n        };\n        anchorCalculator[newAnchor.type](newAnchor, this);\n        this._anchor = newAnchor;\n    };\n    __decorate([\n        instance_provider_1.observable\n    ], ImageInstance.prototype, \"tint\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], ImageInstance.prototype, \"depth\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], ImageInstance.prototype, \"height\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], ImageInstance.prototype, \"scaling\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], ImageInstance.prototype, \"width\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], ImageInstance.prototype, \"x\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], ImageInstance.prototype, \"y\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], ImageInstance.prototype, \"_anchor\", void 0);\n    return ImageInstance;\n}(instance_1.Instance));\nexports.ImageInstance = ImageInstance;\nvar _a;\n","module.exports = \"precision highp float;\\n\\nvarying vec4 vertexColor;\\nvarying vec2 texCoord;\\n\\n${extendHeader}\\n\\nvoid main() {\\n  ${attributes}\\n\\n  // Figure out the size of the image as it'd show on the screen\\n  vec3 screenSize = cameraSpaceSize(vec3(size, 1.0));\\n  // Do the test for when the image is larger on the screen than the font size\\n  bool largerOnScreen = screenSize.y > size.y;\\n\\n  // Determines if a scale mode should be used or not for the vertex\\n  float useScaleMode = float(\\n    (\\n      scaling == 3.0 ||                  // NEVER mode - keep the image the same size always\\n      (largerOnScreen && scaling == 2.0) // BOUND_MAX mode - only if we're larger than the font size do we scale down\\n    ) &&\\n    scaling != 1.0                       // ALWAYS mode - the image stays completely in world space allowing it to scale freely\\n  );\\n  // If zooms are unequal, assume one is filtered to be 1.0\\n  float unequalZooms = float(cameraScale.x != cameraScale.y);\\n\\n  // Destructure threejs's bug with the position requirement\\n  float normal = position.x;\\n  float side = position.y;\\n\\n  // Get the location of the anchor in world space\\n  vec2 worldAnchor = location + anchor;\\n\\n  // Get the tex coord from our inject texture info\\n  texCoord = texture.xy + ((texture.zw - texture.xy) * vec2(side, float(normal == -1.0)));\\n  // Apply the image's tint as a tint to the image\\n  vertexColor = tint;\\n\\n  // Correct aspect ratio.\\n  size = mix(\\n    size,\\n    (size * cameraScale.yx),\\n    unequalZooms\\n  );\\n\\n  vec2 adjustedAnchor = mix(\\n    anchor,\\n    (anchor * cameraScale.yx),\\n    unequalZooms\\n  );\\n\\n  vec2 vertex = vec2(side, float(normal == 1.0)) * size + location - adjustedAnchor;\\n\\n  // See how scaled the size on screen will be from the actual height of the image\\n  float imageScreenScale = mix(\\n    screenSize.y / size.y,\\n    screenSize.x / size.x,\\n    float((cameraScale.x < 1.0) || (cameraScale.x > 1.0))\\n  );\\n\\n  // If our screen rendering is larger than the size the image is supposed to be, then we automagically\\n  // scale down our image to stay the correct size, centered on the anchor point\\n  vec2 anchorToVertex = vertex - location;\\n\\n  // We now choose between keeping the same image size or keeping it in world space\\n  vertex = mix(\\n    // This option keeps the image size in world space\\n    vertex,\\n    // This option counters the scaling of the image on the screen keeping it a static size\\n    (anchorToVertex / imageScreenScale) + location,\\n    // This is the flag determining if a scale mode should be applied to the vertex\\n    useScaleMode\\n  );\\n\\n  gl_Position = clipSpace(vec3(vertex, depth));\\n\\n  ${extend}\\n}\\n\"","module.exports = \"precision highp float;\\n\\n${picking}\\nvarying vec4 vertexColor;\\nvarying vec2 texCoord;\\n${extendHeader}\\n\\nvoid main() {\\n  gl_FragColor = texture2D(imageAtlas, texCoord) * vertexColor;\\n  setColor(gl_FragColor * gl_FragColor.a);\\n  ${extend}\\n}\\n\"","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar primitives_1 = require(\"../../primitives\");\nvar layer_1 = require(\"../../surface/layer\");\nvar types_1 = require(\"../../types\");\nvar types_2 = require(\"../types\");\nvar min = Math.min, max = Math.max;\nvar ImageLayer = (function (_super) {\n    __extends(ImageLayer, _super);\n    function ImageLayer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ImageLayer.prototype.getInstancePickingMethods = function () {\n        return {\n            boundsAccessor: function (image) {\n                var anchorEffect = [0, 0];\n                if (image.anchor) {\n                    anchorEffect[0] = image.anchor.x || 0;\n                    anchorEffect[1] = image.anchor.y || 0;\n                }\n                var topLeft = [image.x - anchorEffect[0], image.y - anchorEffect[1]];\n                return new primitives_1.Bounds({\n                    height: image.height,\n                    width: image.width,\n                    x: topLeft[0],\n                    y: topLeft[1]\n                });\n            },\n            hitTest: function (image, point, view) {\n                var maxScale = max.apply(void 0, view.camera.scale);\n                var minScale = min.apply(void 0, view.camera.scale);\n                if (image.scaling === types_2.ScaleType.ALWAYS) {\n                    return true;\n                }\n                else if (image.scaling === types_2.ScaleType.BOUND_MAX) {\n                    if (minScale <= 1 && maxScale <= 1) {\n                        return true;\n                    }\n                    else {\n                        var anchorEffect = [0, 0];\n                        if (image.anchor) {\n                            anchorEffect[0] = image.anchor.x || 0;\n                            anchorEffect[1] = image.anchor.y || 0;\n                        }\n                        var topLeft = view.worldToScreen({\n                            x: image.x - anchorEffect[0] / view.camera.scale[0],\n                            y: image.y - anchorEffect[1] / view.camera.scale[1]\n                        });\n                        var screenPoint = view.worldToScreen(point);\n                        return new primitives_1.Bounds({\n                            height: image.height,\n                            width: image.width,\n                            x: topLeft.x,\n                            y: topLeft.y\n                        }).containsPoint(screenPoint);\n                    }\n                }\n                else if (image.scaling === types_2.ScaleType.NEVER) {\n                    var anchorEffect = [0, 0];\n                    if (image.anchor) {\n                        anchorEffect[0] = image.anchor.x || 0;\n                        anchorEffect[1] = image.anchor.y || 0;\n                    }\n                    var topLeft = view.worldToScreen({\n                        x: image.x - anchorEffect[0] / view.camera.scale[0],\n                        y: image.y - anchorEffect[1] / view.camera.scale[1]\n                    });\n                    var screenPoint = view.worldToScreen(point);\n                    return new primitives_1.Bounds({\n                        height: image.height,\n                        width: image.width,\n                        x: topLeft.x,\n                        y: topLeft.y\n                    }).containsPoint(screenPoint);\n                }\n                return true;\n            }\n        };\n    };\n    ImageLayer.prototype.initShader = function () {\n        var _this = this;\n        var vertexToNormal = {\n            0: 1,\n            1: 1,\n            2: -1,\n            3: 1,\n            4: -1,\n            5: -1\n        };\n        var vertexToSide = {\n            0: 0,\n            1: 0,\n            2: 0,\n            3: 1,\n            4: 1,\n            5: 1\n        };\n        return {\n            fs: require(\"./image-layer.fs\"),\n            instanceAttributes: [\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"location\",\n                    size: types_1.InstanceAttributeSize.TWO,\n                    update: function (o) { return [o.x, o.y]; }\n                },\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.THREE,\n                    name: \"anchor\",\n                    size: types_1.InstanceAttributeSize.TWO,\n                    update: function (o) { return [o.anchor.x || 0, o.anchor.y || 0]; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"size\",\n                    size: types_1.InstanceAttributeSize.TWO,\n                    update: function (o) { return [o.width, o.height]; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.THREE,\n                    name: \"depth\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.depth]; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.FOUR,\n                    name: \"scaling\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.scaling]; }\n                },\n                {\n                    atlas: {\n                        key: this.props.atlas || \"\",\n                        name: \"imageAtlas\"\n                    },\n                    block: 2,\n                    name: \"texture\",\n                    update: function (o) { return _this.resource.request(_this, o, o.resource); }\n                },\n                {\n                    block: 3,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"tint\",\n                    size: types_1.InstanceAttributeSize.FOUR,\n                    update: function (o) { return o.tint; }\n                }\n            ],\n            uniforms: [\n                {\n                    name: \"scaleFactor\",\n                    size: types_1.UniformSize.ONE,\n                    update: function (_u) { return [1]; }\n                }\n            ],\n            vertexAttributes: [\n                {\n                    name: \"position\",\n                    size: types_1.VertexAttributeSize.THREE,\n                    update: function (vertex) { return [\n                        vertexToNormal[vertex],\n                        vertexToSide[vertex],\n                        0\n                    ]; }\n                }\n            ],\n            vertexCount: 6,\n            vs: require(\"./image-layer.vs\")\n        };\n    };\n    ImageLayer.prototype.getModelType = function () {\n        return {\n            drawMode: Three.TriangleStripDrawMode,\n            modelType: Three.Mesh\n        };\n    };\n    ImageLayer.prototype.getMaterialOptions = function () {\n        return {\n            blending: Three.CustomBlending,\n            blendSrc: Three.OneFactor,\n            premultipliedAlpha: true,\n            transparent: true\n        };\n    };\n    return ImageLayer;\n}(layer_1.Layer));\nexports.ImageLayer = ImageLayer;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar instance_1 = require(\"../../instance-provider/instance\");\nvar observable_1 = require(\"../../instance-provider/observable\");\nvar EdgeInstance = (function (_super) {\n    __extends(EdgeInstance, _super);\n    function EdgeInstance(options) {\n        var _this = _super.call(this, options) || this;\n        _this.colorStart = [1.0, 1.0, 1.0, 1.0];\n        _this.colorEnd = [1.0, 1.0, 1.0, 1.0];\n        _this.control = [[0, 0], [0, 0]];\n        _this.depth = 0;\n        _this.end = [0, 0];\n        _this.start = [0, 0];\n        _this.widthStart = 1.0;\n        _this.widthEnd = 1.0;\n        _this.colorStart = options.colorStart || _this.colorStart;\n        _this.colorEnd = options.colorEnd || _this.colorEnd;\n        _this.control = options.control || _this.control;\n        _this.depth = options.depth || _this.depth;\n        _this.end = options.end || _this.end;\n        _this.widthStart = options.widthStart || _this.widthStart;\n        _this.widthEnd = options.widthEnd || _this.widthEnd;\n        _this.start = options.start || _this.start;\n        return _this;\n    }\n    Object.defineProperty(EdgeInstance.prototype, \"length\", {\n        get: function () {\n            var delta = [this.end[0] - this.start[0], this.end[1] - this.start[1]];\n            return Math.sqrt(delta[0] * delta[0] + delta[1] * delta[1]);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EdgeInstance.prototype, \"midpoint\", {\n        get: function () {\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EdgeInstance.prototype, \"perpendicular\", {\n        get: function () {\n            var length = this.length;\n            return [\n                (this.end[1] - this.start[1]) / length,\n                -(this.end[0] - this.start[0]) / length\n            ];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    EdgeInstance.prototype.setEdgeWidth = function (width) {\n        if (width) {\n            this.widthEnd = width;\n            this.widthStart = width;\n        }\n    };\n    EdgeInstance.prototype.setColor = function (color) {\n        this.colorStart = color;\n        this.colorEnd = color;\n    };\n    __decorate([\n        observable_1.observable\n    ], EdgeInstance.prototype, \"colorStart\", void 0);\n    __decorate([\n        observable_1.observable\n    ], EdgeInstance.prototype, \"colorEnd\", void 0);\n    __decorate([\n        observable_1.observable\n    ], EdgeInstance.prototype, \"control\", void 0);\n    __decorate([\n        observable_1.observable\n    ], EdgeInstance.prototype, \"depth\", void 0);\n    __decorate([\n        observable_1.observable\n    ], EdgeInstance.prototype, \"end\", void 0);\n    __decorate([\n        observable_1.observable\n    ], EdgeInstance.prototype, \"start\", void 0);\n    __decorate([\n        observable_1.observable\n    ], EdgeInstance.prototype, \"widthStart\", void 0);\n    __decorate([\n        observable_1.observable\n    ], EdgeInstance.prototype, \"widthEnd\", void 0);\n    return EdgeInstance;\n}(instance_1.Instance));\nexports.EdgeInstance = EdgeInstance;\n","module.exports = \"precision highp float;\\n\\n${picking}\\nvarying vec4 vertexColor;\\n${extendHeader}\\n\\nvoid main() {\\n  setColor(vertexColor);\\n  ${extend}\\n}\\n\"","module.exports = \"/**\\n  This vertex shader calculates edges based in world space to make an edge based on\\n  bezier curves with 0, 1, and 2 control points.\\n**/\\nprecision highp float;\\n\\nvarying vec4 vertexColor;\\n\\n// Interpolation type injection\\n${interpolation}\\n\\nvoid main() {\\n  ${attributes}\\n\\n  // Destructure threejs's bug with the position requirement\\n  float normal = position.x;\\n  float interpolationTime = position.y;\\n  float interpolationIncrement = 1.0 / position.z;\\n\\n  // Convert our world points to screen space\\n  vec4 startClip = clipSpace(vec3(start, depth));\\n  vec4 endClip = clipSpace(vec3(end, depth));\\n  vec2 startScreen = (startClip.xy + vec2(1.0, 1.0)) * vec2(0.5, 0.5) * viewSize;\\n  vec2 endScreen = (endClip.xy + vec2(1.0, 1.0)) * vec2(0.5, 0.5) * viewSize;\\n  // Controls for this mode are screen space deltas from the end points\\n  vec2 control1 = startScreen + vec2(control.x, -control.y) * scaleFactor;\\n  vec2 control2 = endScreen + vec2(control.z, -control.w) * scaleFactor;\\n\\n  // Get the position of the current vertex\\n  vec2 currentPosition = interpolation(interpolationTime, startScreen, endScreen, control1, control2);\\n  // Calculate the next and previous segment's location on the line\\n  vec2 prePosition = interpolation(interpolationTime - interpolationIncrement, startScreen, endScreen, control1, control2);\\n  vec2 nextPosition = interpolation(interpolationTime + interpolationIncrement, startScreen, endScreen, control1, control2);\\n\\n  vec2 preLine = prePosition - currentPosition;\\n  vec2 nextLine = nextPosition - currentPosition;\\n\\n  // Get a spliced nromal at the joining of two segments to make a crisper curve\\n  vec2 currentNormal = mix(\\n    // Pick this value if we're at the beginning of the line\\n    normalize(vec2(preLine.y, -preLine.x)),\\n    mix(\\n      // Pick this value when we're between the ends\\n      normalize(vec2(preLine.y, -preLine.x) + vec2(-nextLine.y, nextLine.x)),\\n      // Pick this value if we're at the end of the line\\n      normalize(vec2(-nextLine.y, nextLine.x)),\\n      float(position.x >= 1.0)\\n    ),\\n    float(position.x > 0.0)\\n  );\\n\\n  // Get the thickness based on the side we're on\\n  float lineThickness = mix(widthStart, widthEnd, interpolationTime) / 2.0;\\n  // Start on the calculated line and push out by the normal's value\\n  vec2 vertex = currentPosition + currentNormal * (-normal * lineThickness * scaleFactor);\\n  // Get the color based on where we are on the line\\n  vertexColor = mix(colorStart, colorEnd, interpolationTime);\\n  vertexColor *= vertexColor.a;\\n\\n  gl_Position = vec4((vertex / viewSize) * vec2(2.0, 2.0) - vec2(1.0, 1.0), startClip.zw);\\n  gl_PointSize = 5.0;\\n}\\n\"","module.exports = \"precision highp float;\\n\\n/**\\n  This vertex shader calculates edges whose curve and width is in screen space where the curve is\\n  bezier curves with 0, 1, and 2 control points.\\n**/\\nvarying vec4 vertexColor;\\n\\n// Interpolation type injection\\n${interpolation}\\n\\n${extendHeader}\\n\\nvoid main() {\\n  ${attributes}\\n\\n  // Destructure threejs's bug with the position requirement\\n  float normal = position.x;\\n  float interpolationTime = position.y;\\n  float interpolationIncrement = 1.0 / position.z;\\n  // Get the position of the current vertex\\n  vec2 currentPosition = interpolation(interpolationTime, start, end, control.xy, control.zw);\\n  // Calculate the next and previous segment's location on the line\\n  vec2 prePosition = interpolation(interpolationTime - interpolationIncrement, start, end, control.xy, control.zw);\\n  vec2 nextPosition = interpolation(interpolationTime + interpolationIncrement, start, end, control.xy, control.zw);\\n\\n  vec2 preLine = prePosition - currentPosition;\\n  vec2 nextLine = nextPosition - currentPosition;\\n\\n  // Get a spliced nromal at the joining of two segments to make a crisper curve\\n  vec2 currentNormal = mix(\\n    // Pick this value if we're at the beginning of the line\\n    normalize(vec2(preLine.y, -preLine.x)),\\n    mix(\\n      // Pick this value when we're between the ends\\n      normalize(vec2(preLine.y, -preLine.x) + vec2(-nextLine.y, nextLine.x)),\\n      // Pick this value if we're at the end of the line\\n      normalize(vec2(-nextLine.y, nextLine.x)),\\n      float(position.x >= 1.0)\\n    ),\\n    float(position.x > 0.0)\\n  );\\n\\n  // Get the thickness based on the side we're on\\n  float lineThickness = mix(widthStart, widthEnd, interpolationTime) / 2.0;\\n  // Start on the calculated line and push out by the normal's value\\n  vec2 vertex = currentPosition + currentNormal * (normal * lineThickness);\\n  // Get the color based on where we are on the line\\n  vertexColor = mix(colorStart, colorEnd, interpolationTime);\\n  vertexColor *= vertexColor.a;\\n\\n  gl_Position = clipSpace(vec3(vertex, depth));\\n  gl_PointSize = 5.0;\\n\\n  ${extend}\\n}\\n\"","module.exports = \"/**\\n * Makes a linear interpolation between two points\\n *\\n * @param {vec2} s The start point\\n * @param {vec2} e The end point\\n * @param {vec2} c The bezier control point\\n * @param {float} t The interpolation value [0, 1]\\n *\\n * @returns {vec2} A point interpolated between the two provided points\\n */\\nvec2 interpolation(float t, vec2 p1, vec2 p2, vec2 c1, vec2 c2) {\\n  float t1 = 1.0 - t;\\n  return pow(t1, 3.0) * p1 + 3.0 * t * pow(t1, 2.0) * c1 + 3.0 * pow(t, 2.0) * t1 * c2 + pow(t, 3.0) * p2;\\n}\\n\"","module.exports = \"/**\\n * Makes a linear interpolation between two points\\n *\\n * @param {vec2} s The start point\\n * @param {vec2} e The end point\\n * @param {vec2} c The bezier control point\\n * @param {float} t The interpolation value [0, 1]\\n *\\n * @returns {vec2} A point interpolated between the two provided points\\n */\\nvec2 interpolation(float t, vec2 p1, vec2 p2, vec2 c1, vec2 c2) {\\n  return (1.0 - t) * (1.0 - t) * p1 + 2.0 * t * (1.0 - t) * c1 + t * t * p2;\\n}\\n\"","module.exports = \"/**\\n * Makes a linear interpolation between two points\\n *\\n * @param {vec2} s The start point\\n * @param {vec2} e The end point\\n * @param {vec2} c The bezier control point\\n * @param {float} t The interpolation value [0, 1]\\n *\\n * @returns {vec2} A point interpolated between the two provided points\\n */\\nvec2 interpolation(float t, vec2 p1, vec2 p2, vec2 c1, vec2 c2) {\\n  return p1 + (p2 - p1) * t;\\n}\\n\"","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar bounds_1 = require(\"../../primitives/bounds\");\nvar vector_1 = require(\"../../util/vector\");\nvar types_1 = require(\"./types\");\nvar pow = Math.pow;\nfunction linear(t, p1, p2, _c1, _c2) {\n    return vector_1.add2(vector_1.scale2(vector_1.subtract2(p2, p1), t), p1);\n}\nfunction bezier(t, p1, p2, c1, _c2) {\n    return [\n        (1.0 - t) * (1.0 - t) * p1[0] + 2.0 * t * (1.0 - t) * c1[0] + t * t * p2[0],\n        (1.0 - t) * (1.0 - t) * p1[1] + 2.0 * t * (1.0 - t) * c1[1] + t * t * p2[1]\n    ];\n}\nfunction bezier2(t, p1, p2, c1, c2) {\n    var t1 = 1.0 - t;\n    return [\n        pow(t1, 3.0) * p1[0] +\n            3.0 * t * pow(t1, 2.0) * c1[0] +\n            3.0 * pow(t, 2.0) * t1 * c2[0] +\n            pow(t, 3.0) * p2[0],\n        pow(t1, 3.0) * p1[1] +\n            3.0 * t * pow(t1, 2.0) * c1[1] +\n            3.0 * pow(t, 2.0) * t1 * c2[1] +\n            pow(t, 3.0) * p2[1]\n    ];\n}\nvar interpolation = (_a = {},\n    _a[types_1.EdgeType.LINE] = linear,\n    _a[types_1.EdgeType.BEZIER] = bezier,\n    _a[types_1.EdgeType.BEZIER2] = bezier2,\n    _a);\nfunction toPointObject(point) {\n    return {\n        x: point[0],\n        y: point[1]\n    };\n}\nfunction toPointArray(point) {\n    return [point.x, point.y];\n}\nfunction distanceTo(start, end, p) {\n    var vector = vector_1.subtract2(start, p);\n    var lineDirection = vector_1.subtract2(end, start);\n    var lineNormal = [lineDirection[1], -lineDirection[0]];\n    var distance = Math.abs(vector_1.dot2(vector, lineNormal)) / vector_1.length2(lineDirection);\n    return distance;\n}\nvar TEST_RESOLUTION = 50;\nfunction edgePicking(props) {\n    var broadphase = props.broadphase, _a = props.minPickDistance, minPickDistance = _a === void 0 ? 0 : _a, scaleType = props.scaleType, type = props.type;\n    var interpolate = interpolation[props.type];\n    var boundsAccessor = function (edge) {\n        var edgeWidthStart = edge.widthStart / 2 + minPickDistance;\n        var edgeWidthEnd = edge.widthEnd / 2 + minPickDistance;\n        var bounds = new bounds_1.Bounds({\n            height: edge.widthStart,\n            width: edge.widthStart,\n            x: edge.start[0] - edgeWidthStart,\n            y: edge.start[1] - edgeWidthStart\n        });\n        bounds.encapsulate(new bounds_1.Bounds({\n            height: edge.widthEnd,\n            width: edge.widthEnd,\n            x: edge.end[0] - edgeWidthEnd,\n            y: edge.end[1] - edgeWidthEnd\n        }));\n        if (props.type === types_1.EdgeType.BEZIER) {\n            bounds.encapsulate({\n                x: edge.control[0][0],\n                y: edge.control[0][1]\n            });\n        }\n        else if (props.type === types_1.EdgeType.BEZIER2) {\n            bounds.encapsulate({\n                x: edge.control[0][0],\n                y: edge.control[0][1]\n            });\n            bounds.encapsulate({\n                x: edge.control[1][0],\n                y: edge.control[1][1]\n            });\n        }\n        if (broadphase === types_1.EdgeBroadphase.PASS_X) {\n            bounds.x = Number.MIN_SAFE_INTEGER / 2;\n            bounds.width = Number.MAX_SAFE_INTEGER;\n        }\n        if (broadphase === types_1.EdgeBroadphase.PASS_Y) {\n            bounds.y = Number.MIN_SAFE_INTEGER / 2;\n            bounds.height = Number.MAX_SAFE_INTEGER;\n        }\n        return bounds;\n    };\n    if (scaleType === types_1.EdgeScaleType.SCREEN_CURVE) {\n        return {\n            boundsAccessor: boundsAccessor,\n            hitTest: function (edge, point, view) {\n                point = view.worldToScreen(point);\n                var mouse = [point.x, point.y];\n                var closestIndex = 0;\n                var closestDistance = Number.MAX_VALUE;\n                var secondClosestIndex = 0;\n                var secondClosestDistance = Number.MAX_VALUE;\n                var start = view.worldToScreen(toPointObject(edge.start));\n                var end = view.worldToScreen(toPointObject(edge.end));\n                var control1 = [0, 0];\n                var control2 = [0, 0];\n                if (type === types_1.EdgeType.BEZIER) {\n                    control1 = vector_1.add2(toPointArray(start), edge.control[0]);\n                }\n                else if (type === types_1.EdgeType.BEZIER2) {\n                    control1 = vector_1.add2(toPointArray(start), edge.control[0]);\n                    control2 = vector_1.add2(toPointArray(end), edge.control[1]);\n                }\n                var startPoint = toPointArray(start);\n                var endPoint = toPointArray(end);\n                control1 = edge.control.length > 0 ? control1 : [0, 0];\n                control2 = edge.control.length > 1 ? control2 : [0, 0];\n                for (var i = 0; i < TEST_RESOLUTION; ++i) {\n                    var linePoint = interpolate(i / TEST_RESOLUTION, startPoint, endPoint, control1, control2);\n                    var distance = vector_1.length2(vector_1.subtract2(mouse, linePoint));\n                    if (distance < closestDistance) {\n                        secondClosestIndex = closestIndex;\n                        secondClosestDistance = closestDistance;\n                        closestIndex = i;\n                        closestDistance = distance;\n                    }\n                    else if (distance < secondClosestDistance) {\n                        secondClosestIndex = i;\n                        closestDistance = distance;\n                    }\n                }\n                var t = closestIndex / TEST_RESOLUTION;\n                var lineWidth = (edge.widthEnd - edge.widthStart) * t + edge.widthStart;\n                if (closestIndex === secondClosestIndex) {\n                    return false;\n                }\n                var startSegment = interpolate(closestIndex / TEST_RESOLUTION, startPoint, endPoint, control1, control2);\n                var endSegment = interpolate(secondClosestIndex / TEST_RESOLUTION, startPoint, endPoint, control1, control2);\n                closestDistance = distanceTo(startSegment, endSegment, mouse);\n                if (vector_1.dot2(vector_1.subtract2(endSegment, startSegment), vector_1.subtract2(mouse, startSegment)) < 0) {\n                    return false;\n                }\n                return closestDistance < lineWidth / 2.0 + minPickDistance;\n            }\n        };\n    }\n    return {\n        boundsAccessor: boundsAccessor,\n        hitTest: function (edge, point, _view) {\n            var mouse = [point.x, point.y];\n            var closestIndex = 0;\n            var closestDistance = Number.MAX_VALUE;\n            for (var i = 0; i < TEST_RESOLUTION; ++i) {\n                var linePoint = interpolate(i / TEST_RESOLUTION, edge.start, edge.end, edge.control.length > 0 ? edge.control[0] : [0, 0], edge.control.length > 1 ? edge.control[1] : [0, 0]);\n                var distance = vector_1.length2(vector_1.subtract2(mouse, linePoint));\n                if (distance < closestDistance) {\n                    closestIndex = i;\n                    closestDistance = distance;\n                }\n            }\n            var t = closestIndex / TEST_RESOLUTION;\n            var lineWidth = (edge.widthEnd - edge.widthStart) * t + edge.widthStart;\n            return closestDistance < lineWidth / 2.0;\n        }\n    };\n}\nexports.edgePicking = edgePicking;\nvar _a;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar instance_provider_1 = require(\"../../instance-provider\");\nvar layer_1 = require(\"../../surface/layer\");\nvar types_1 = require(\"../../types\");\nvar util_1 = require(\"../../util\");\nvar edge_picking_1 = require(\"./edge-picking\");\nvar types_2 = require(\"./types\");\nfunction toInstanceIOValue(value) {\n    return [value[0][0], value[0][1], value[1][0], value[1][1]];\n}\nvar pickVS = (_a = {},\n    _a[types_2.EdgeType.LINE] = require(\"./shader/edge-layer-line.vs\"),\n    _a[types_2.EdgeType.BEZIER] = require(\"./shader/edge-layer-bezier.vs\"),\n    _a[types_2.EdgeType.BEZIER2] = require(\"./shader/edge-layer-bezier2.vs\"),\n    _a);\nvar baseVS = require(\"./shader/edge-layer.vs\");\nvar screenVS = require(\"./shader/edge-layer-screen-curve.vs\");\nvar edgeFS = require(\"./shader/edge-layer.fs\");\nvar EdgeLayer = (function (_super) {\n    __extends(EdgeLayer, _super);\n    function EdgeLayer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    EdgeLayer.prototype.getInstancePickingMethods = function () {\n        return edge_picking_1.edgePicking(this.props);\n    };\n    EdgeLayer.prototype.initShader = function () {\n        var _a = this.props, _b = _a.scaleFactor, scaleFactor = _b === void 0 ? function () { return 1; } : _b, type = _a.type, _c = _a.scaleType, scaleType = _c === void 0 ? types_2.EdgeScaleType.NONE : _c;\n        var MAX_SEGMENTS = type === types_2.EdgeType.LINE ? 2 : 50;\n        var vertexToNormal = (_d = {\n                0: 1\n            },\n            _d[MAX_SEGMENTS * 2 + 2] = -1,\n            _d);\n        var vertexInterpolation = (_e = {\n                0: 0\n            },\n            _e[MAX_SEGMENTS * 2 + 2] = 1,\n            _e);\n        var sign = 1;\n        for (var i = 0; i < MAX_SEGMENTS * 2; ++i) {\n            vertexToNormal[i + 1] = sign;\n            vertexInterpolation[i + 1] = Math.floor(i / 2) / (MAX_SEGMENTS - 1);\n            sign *= -1;\n        }\n        var vs = util_1.shaderTemplate({\n            options: {\n                attributes: \"${attributes}\",\n                interpolation: pickVS[type]\n            },\n            required: {\n                name: \"Edge Layer\",\n                values: [\"interpolation\"]\n            },\n            shader: scaleType === types_2.EdgeScaleType.NONE ? baseVS : screenVS\n        });\n        return {\n            fs: edgeFS,\n            instanceAttributes: [\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"start\",\n                    size: types_1.InstanceAttributeSize.TWO,\n                    update: function (o) { return o.start; }\n                },\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.THREE,\n                    name: \"end\",\n                    size: types_1.InstanceAttributeSize.TWO,\n                    update: function (o) { return o.end; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"widthStart\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.widthStart]; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.TWO,\n                    name: \"widthEnd\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.widthEnd]; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.THREE,\n                    name: \"depth\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (o) { return [o.depth]; }\n                },\n                {\n                    block: 2,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"colorStart\",\n                    size: types_1.InstanceAttributeSize.FOUR,\n                    update: function (o) { return o.colorStart; }\n                },\n                {\n                    block: 3,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    name: \"colorEnd\",\n                    size: types_1.InstanceAttributeSize.FOUR,\n                    update: function (o) { return o.colorEnd; }\n                },\n                type === types_2.EdgeType.LINE\n                    ? {\n                        block: 4,\n                        blockIndex: types_1.InstanceBlockIndex.ONE,\n                        name: \"control\",\n                        size: types_1.InstanceAttributeSize.FOUR,\n                        update: function (_o) { return [0, 0, 0, 0]; }\n                    }\n                    : null,\n                type === types_2.EdgeType.BEZIER\n                    ? {\n                        block: 4,\n                        blockIndex: types_1.InstanceBlockIndex.ONE,\n                        name: \"control\",\n                        size: types_1.InstanceAttributeSize.FOUR,\n                        update: function (o) { return [o.control[0][0], o.control[0][1], 0, 0]; }\n                    }\n                    : null,\n                type === types_2.EdgeType.BEZIER2\n                    ? {\n                        block: 4,\n                        blockIndex: types_1.InstanceBlockIndex.ONE,\n                        name: \"control\",\n                        size: types_1.InstanceAttributeSize.FOUR,\n                        update: function (o) { return toInstanceIOValue(o.control); }\n                    }\n                    : null\n            ],\n            uniforms: [\n                {\n                    name: \"scaleFactor\",\n                    size: types_1.UniformSize.ONE,\n                    update: function (_uniform) { return [scaleFactor()]; }\n                }\n            ],\n            vertexAttributes: [\n                {\n                    name: \"position\",\n                    size: types_1.VertexAttributeSize.THREE,\n                    update: function (vertex) { return [\n                        vertexToNormal[vertex],\n                        vertexInterpolation[vertex],\n                        MAX_SEGMENTS * 2\n                    ]; }\n                }\n            ],\n            vertexCount: MAX_SEGMENTS * 2 + 2,\n            vs: vs.shader\n        };\n        var _d, _e;\n    };\n    EdgeLayer.prototype.getModelType = function () {\n        return {\n            drawMode: Three.TriangleStripDrawMode,\n            modelType: Three.Mesh\n        };\n    };\n    EdgeLayer.prototype.getMaterialOptions = function () {\n        return {\n            premultipliedAlpha: true,\n            transparent: true\n        };\n    };\n    EdgeLayer.defaultProps = {\n        broadphase: types_2.EdgeBroadphase.ALL,\n        data: new instance_provider_1.InstanceProvider(),\n        key: \"none\",\n        scaleType: types_2.EdgeScaleType.NONE,\n        type: types_2.EdgeType.LINE\n    };\n    return EdgeLayer;\n}(layer_1.Layer));\nexports.EdgeLayer = EdgeLayer;\nvar _a;\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./edge-layer\"));\n__export(require(\"./edge-instance\"));\n__export(require(\"./types\"));\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar instance_provider_1 = require(\"../../instance-provider\");\nvar instance_1 = require(\"../../instance-provider/instance\");\nvar CircleInstance = (function (_super) {\n    __extends(CircleInstance, _super);\n    function CircleInstance(options) {\n        var _this = _super.call(this, options) || this;\n        _this.color = [1.0, 1.0, 1.0, 1.0];\n        _this.depth = 0;\n        _this.radius = 0;\n        _this.x = 0;\n        _this.y = 0;\n        _this.color = options.color || _this.color;\n        _this.radius = options.radius || _this.radius;\n        _this.x = options.x || _this.x;\n        _this.y = options.y || _this.y;\n        _this.depth = options.depth || _this.depth;\n        return _this;\n    }\n    Object.defineProperty(CircleInstance.prototype, \"width\", {\n        get: function () {\n            return this.radius * 2;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CircleInstance.prototype, \"height\", {\n        get: function () {\n            return this.radius * 2;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    __decorate([\n        instance_provider_1.observable\n    ], CircleInstance.prototype, \"color\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], CircleInstance.prototype, \"depth\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], CircleInstance.prototype, \"radius\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], CircleInstance.prototype, \"x\", void 0);\n    __decorate([\n        instance_provider_1.observable\n    ], CircleInstance.prototype, \"y\", void 0);\n    return CircleInstance;\n}(instance_1.Instance));\nexports.CircleInstance = CircleInstance;\n","module.exports = \"precision highp float;\\n\\nvarying vec4 vertexColor;\\nvarying float edgeSharpness;\\nvarying float edgeSharpnessBase;\\nvarying vec2 pointCoord;\\n\\n${extendHeader}\\n\\nvoid main() {\\n  ${attributes}\\n\\n  vertexColor = color * color.a;\\n  float size = radius * scaleFactor;\\n  edgeSharpness = mix(0.8, 0.0, min((size * 6.0 * pixelRatio) / (45.0 * pixelRatio), 1.0));\\n  edgeSharpnessBase = mix(0.1, 0.0, min((size * 6.0 * pixelRatio) / (45.0 * pixelRatio), 1.0));\\n  pointCoord = (position.xy + vec2(1.0, 1.0)) / 2.0;\\n\\n  // Center within clip space\\n  vec4 clipCenter = clipSpace(vec3(center, depth));\\n  // Center in screen space\\n  vec2 screenCenter = (clipCenter.xy + vec2(1.0, 1.0)) * vec2(0.5, 0.5) * viewSize;\\n  // Position in screen space\\n  vec2 vertex = (position.xy * size) + screenCenter;\\n  // Position back to clip space\\n  gl_Position = vec4((vertex / viewSize) * vec2(2.0, 2.0) - vec2(1.0, 1.0), clipCenter.zw);\\n\\n  ${extend}\\n}\\n\"","module.exports = \"precision highp float;\\n\\n${picking}\\n\\nvarying vec4 vertexColor;\\nvarying float edgeSharpness;\\nvarying float edgeSharpnessBase;\\nvarying vec2 pointCoord;\\n\\nfloat circle(vec2 coord, float radius){\\n  vec2 dist = coord - vec2(0.5);\\n\\n  return 1.0 - smoothstep(\\n    radius - (radius * edgeSharpness),\\n    radius + (radius * edgeSharpnessBase),\\n    dot(dist, dist) * 4.0\\n  );\\n}\\n\\n${extendHeader}\\n\\nvoid main() {\\n  float step_factor = circle(pointCoord.xy, 1.0);\\n\\n  setColor(mix(\\n    vec4(0.0, 0.0, 0.0, 0.0),\\n    vertexColor,\\n    step_factor\\n  ));\\n\\n  ${extend}\\n}\\n\"","module.exports = \"void main() {\\n  gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\\n}\"","module.exports = \"\"","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar types_1 = require(\"../types\");\nvar LayerInteractionHandler = (function () {\n    function LayerInteractionHandler(layer) {\n        this.isMouseOver = new Map();\n        this.isMouseDown = new Map();\n        this.layer = layer;\n    }\n    LayerInteractionHandler.prototype.getColorPickInstance = function () {\n        if (this.colorPicking) {\n            return this.layer.diffManager.colorPicking.uidToInstance.get(0xffffff - this.colorPicking.nearestColor);\n        }\n        return null;\n    };\n    LayerInteractionHandler.prototype.handleMouseOver = function (_view, _mouse) {\n    };\n    LayerInteractionHandler.prototype.handleMouseDown = function (view, mouse, button) {\n        var _this = this;\n        if (this.layer.picking && this.layer.picking.type !== types_1.PickType.NONE) {\n            var onMouseDown = this.layer.props.onMouseDown;\n            if (onMouseDown) {\n                var world_1 = view.viewToWorld(mouse);\n                var hitTest_1;\n                var query_1;\n                var querySpace = void 0;\n                var instances = [];\n                if (this.layer.picking.type === types_1.PickType.ALL) {\n                    hitTest_1 = this.layer.picking.hitTest;\n                    query_1 = this.layer.picking.quadTree.query.bind(this.layer.picking.quadTree);\n                    querySpace = function (check) {\n                        return query_1(check).filter(function (o) { return hitTest_1(o, world_1, view); });\n                    };\n                    instances = query_1(world_1).filter(function (o) { return hitTest_1(o, world_1, view); });\n                }\n                else if (this.layer.picking.type === types_1.PickType.SINGLE) {\n                    var instanceForColor = this.getColorPickInstance();\n                    if (instanceForColor) {\n                        instances.push(instanceForColor);\n                    }\n                }\n                var info = {\n                    button: button,\n                    instances: instances,\n                    layer: this.layer.id,\n                    projection: view,\n                    querySpace: querySpace,\n                    screen: [mouse.x, mouse.y],\n                    world: [world_1.x, world_1.y]\n                };\n                onMouseDown(info);\n                this.isMouseDown.clear();\n                instances.forEach(function (o) { return _this.isMouseDown.set(o, true); });\n            }\n        }\n    };\n    LayerInteractionHandler.prototype.handleMouseOut = function (view, mouse) {\n        if (this.layer.picking && this.layer.picking.type !== types_1.PickType.NONE) {\n            var onMouseOut = this.layer.props.onMouseOut;\n            if (onMouseOut) {\n                var world_2 = view.viewToWorld(mouse);\n                var hitTest_2;\n                var query_2;\n                var querySpace = void 0;\n                if (this.layer.picking.type === types_1.PickType.ALL) {\n                    hitTest_2 = this.layer.picking.hitTest;\n                    query_2 = this.layer.picking.quadTree.query.bind(this.layer.picking.quadTree);\n                    querySpace = function (check) {\n                        return query_2(check).filter(function (o) { return hitTest_2(o, world_2, view); });\n                    };\n                }\n                var info = {\n                    instances: Array.from(this.isMouseOver.keys()),\n                    layer: this.layer.id,\n                    projection: view,\n                    querySpace: querySpace,\n                    screen: [mouse.x, mouse.y],\n                    world: [world_2.x, world_2.y]\n                };\n                onMouseOut(info);\n            }\n        }\n        this.isMouseOver.clear();\n        this.isMouseDown.clear();\n    };\n    LayerInteractionHandler.prototype.handleMouseUp = function (view, mouse, button) {\n        if (this.layer.picking && this.layer.picking.type !== types_1.PickType.NONE) {\n            var onMouseUp = this.layer.props.onMouseUp;\n            if (onMouseUp) {\n                var world_3 = view.viewToWorld(mouse);\n                var hitTest_3;\n                var query_3;\n                var querySpace = void 0;\n                var instances = [];\n                if (this.layer.picking.type === types_1.PickType.ALL) {\n                    hitTest_3 = this.layer.picking.hitTest;\n                    query_3 = this.layer.picking.quadTree.query.bind(this.layer.picking.quadTree);\n                    querySpace = function (check) {\n                        return query_3(check).filter(function (o) { return hitTest_3(o, world_3, view); });\n                    };\n                    instances = query_3(world_3).filter(function (o) { return hitTest_3(o, world_3, view); });\n                }\n                else if (this.layer.picking.type === types_1.PickType.SINGLE) {\n                    var instanceForColor = this.getColorPickInstance();\n                    if (instanceForColor) {\n                        instances.push(instanceForColor);\n                    }\n                }\n                var info = {\n                    button: button,\n                    instances: instances,\n                    layer: this.layer.id,\n                    projection: view,\n                    querySpace: querySpace,\n                    screen: [mouse.x, mouse.y],\n                    world: [world_3.x, world_3.y]\n                };\n                onMouseUp(info);\n            }\n        }\n    };\n    LayerInteractionHandler.prototype.handleMouseMove = function (view, mouse) {\n        var _this = this;\n        var _a = this.layer.props, onMouseOver = _a.onMouseOver, onMouseMove = _a.onMouseMove, onMouseOut = _a.onMouseOut;\n        if (this.layer.picking && this.layer.picking.type !== types_1.PickType.NONE) {\n            if (onMouseOver || onMouseMove || onMouseOut) {\n                var info = void 0;\n                var world_4 = view.viewToWorld(mouse);\n                var hitTest_4;\n                var query_4;\n                var querySpace = void 0;\n                var instances = [];\n                if (this.layer.picking.type === types_1.PickType.ALL) {\n                    hitTest_4 = this.layer.picking.hitTest;\n                    query_4 = this.layer.picking.quadTree.query.bind(this.layer.picking.quadTree);\n                    querySpace = function (check) {\n                        return query_4(check).filter(function (o) { return hitTest_4(o, world_4, view); });\n                    };\n                    instances = query_4(world_4).filter(function (o) { return hitTest_4(o, world_4, view); });\n                }\n                else if (this.layer.picking.type === types_1.PickType.SINGLE) {\n                    var instanceForColor = this.getColorPickInstance();\n                    if (instanceForColor) {\n                        instances.push(instanceForColor);\n                    }\n                }\n                if (onMouseOver) {\n                    var notOverInstances = instances.filter(function (o) { return !_this.isMouseOver.get(o); });\n                    info = {\n                        instances: notOverInstances,\n                        layer: this.layer.id,\n                        projection: view,\n                        querySpace: querySpace,\n                        screen: [mouse.x, mouse.y],\n                        world: [world_4.x, world_4.y]\n                    };\n                    if (notOverInstances.length > 0)\n                        onMouseOver(info);\n                }\n                if (onMouseMove) {\n                    info = {\n                        instances: instances,\n                        layer: this.layer.id,\n                        projection: view,\n                        querySpace: querySpace,\n                        screen: [mouse.x, mouse.y],\n                        world: [world_4.x, world_4.y]\n                    };\n                    onMouseMove(info);\n                }\n                var isCurrentlyOver_1 = new Map();\n                instances.forEach(function (o) { return isCurrentlyOver_1.set(o, true); });\n                if (onMouseOut) {\n                    var noLongerOver = Array.from(this.isMouseOver.keys()).filter(function (o) { return !isCurrentlyOver_1.get(o); });\n                    info = {\n                        instances: noLongerOver,\n                        layer: this.layer.id,\n                        projection: view,\n                        querySpace: querySpace,\n                        screen: [mouse.x, mouse.y],\n                        world: [world_4.x, world_4.y]\n                    };\n                    if (noLongerOver.length > 0)\n                        onMouseOut(info);\n                }\n                this.isMouseOver = isCurrentlyOver_1;\n            }\n        }\n    };\n    LayerInteractionHandler.prototype.handleMouseClick = function (view, mouse, button) {\n        if (this.layer.picking && this.layer.picking.type !== types_1.PickType.NONE) {\n            var onMouseClick = this.layer.props.onMouseClick;\n            if (onMouseClick) {\n                var world_5 = view.viewToWorld(mouse);\n                var hitTest_5;\n                var query_5;\n                var querySpace = void 0;\n                var instances = [];\n                if (this.layer.picking.type === types_1.PickType.ALL) {\n                    hitTest_5 = this.layer.picking.hitTest;\n                    query_5 = this.layer.picking.quadTree.query.bind(this.layer.picking.quadTree);\n                    querySpace = function (check) {\n                        return query_5(check).filter(function (o) { return hitTest_5(o, world_5, view); });\n                    };\n                    instances = query_5(world_5).filter(function (o) { return hitTest_5(o, world_5, view); });\n                }\n                else if (this.layer.picking.type === types_1.PickType.SINGLE) {\n                    var instanceForColor = this.getColorPickInstance();\n                    if (instanceForColor) {\n                        instances.push(instanceForColor);\n                    }\n                }\n                var info = {\n                    button: button,\n                    instances: instances,\n                    layer: this.layer.id,\n                    projection: view,\n                    querySpace: querySpace,\n                    screen: [mouse.x, mouse.y],\n                    world: [world_5.x, world_5.y]\n                };\n                onMouseClick(info);\n            }\n        }\n    };\n    LayerInteractionHandler.prototype.handleMouseDrag = function (_view, _mouse) {\n    };\n    return LayerInteractionHandler;\n}());\nexports.LayerInteractionHandler = LayerInteractionHandler;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar types_1 = require(\"../types\");\nvar VECTOR_ACCESSORS = [\"x\", \"y\", \"z\", \"w\"];\nvar InstanceDiffManager = (function () {\n    function InstanceDiffManager(layer) {\n        this.layer = layer;\n    }\n    InstanceDiffManager.prototype.getDiffProcessor = function () {\n        if (this.layer.picking) {\n            if (this.layer.picking.type === types_1.PickType.ALL) {\n                this.quadPicking = this.layer.picking;\n                return [\n                    this.changeInstanceQuad,\n                    this.addInstanceQuad,\n                    this.removeInstanceQuad\n                ];\n            }\n            else if (this.layer.picking.type === types_1.PickType.SINGLE) {\n                this.colorPicking = this.layer.picking;\n                this.colorPicking.uidToInstance = new Map();\n                return [\n                    this.changeInstanceColorPick,\n                    this.addInstanceColorPick,\n                    this.removeInstanceColorPick\n                ];\n            }\n        }\n        return [this.changeInstance, this.addInstance, this.removeInstance];\n    };\n    InstanceDiffManager.prototype.addInstance = function (manager, instance, uniformCluster) {\n        if (uniformCluster) {\n            manager.changeInstance(manager, instance, uniformCluster);\n        }\n        else {\n            var uniforms = manager.layer.uniformManager.add(instance);\n            if (uniforms) {\n                instance.active = true;\n                manager.updateInstance(instance, uniforms);\n            }\n        }\n    };\n    InstanceDiffManager.prototype.addInstanceQuad = function (manager, instance, uniformCluster) {\n        if (uniformCluster) {\n            manager.changeInstanceQuad(manager, instance, uniformCluster);\n        }\n        else {\n            var uniforms = manager.layer.uniformManager.add(instance);\n            if (uniforms) {\n                instance.active = true;\n                manager.updateInstance(instance, uniforms);\n                manager.quadPicking.quadTree.remove(instance);\n                manager.quadPicking.quadTree.add(instance);\n            }\n        }\n    };\n    InstanceDiffManager.prototype.addInstanceColorPick = function (manager, instance, uniformCluster) {\n        if (uniformCluster) {\n            manager.changeInstanceColorPick(manager, instance, uniformCluster);\n        }\n        else {\n            var uniforms = manager.layer.uniformManager.add(instance);\n            if (uniforms) {\n                instance.active = true;\n                manager.updateInstance(instance, uniforms);\n                manager.colorPicking.uidToInstance.set(instance.uid, instance);\n            }\n            else {\n                console.warn(\"A data cluster was not provided by the manager to associate an instance with.\");\n            }\n        }\n    };\n    InstanceDiffManager.prototype.changeInstance = function (manager, instance, uniformCluster) {\n        if (uniformCluster) {\n            manager.updateInstance(instance, uniformCluster);\n        }\n        else {\n            manager.addInstance(manager, instance, uniformCluster);\n        }\n    };\n    InstanceDiffManager.prototype.changeInstanceQuad = function (manager, instance, uniformCluster) {\n        if (uniformCluster) {\n            manager.updateInstance(instance, uniformCluster);\n            manager.quadPicking.quadTree.remove(instance);\n            manager.quadPicking.quadTree.add(instance);\n        }\n        else {\n            manager.addInstanceQuad(manager, instance, uniformCluster);\n        }\n    };\n    InstanceDiffManager.prototype.changeInstanceColorPick = function (manager, instance, uniformCluster) {\n        if (uniformCluster) {\n            manager.updateInstance(instance, uniformCluster);\n        }\n        else {\n            manager.addInstanceColorPick(manager, instance, uniformCluster);\n        }\n    };\n    InstanceDiffManager.prototype.removeInstance = function (manager, instance, uniformCluster) {\n        if (uniformCluster) {\n            instance.active = false;\n            manager.updateInstance(instance, uniformCluster);\n            manager.layer.uniformManager.remove(instance);\n        }\n    };\n    InstanceDiffManager.prototype.removeInstanceQuad = function (manager, instance, uniformCluster) {\n        if (uniformCluster) {\n            instance.active = false;\n            manager.updateInstance(instance, uniformCluster);\n            manager.layer.uniformManager.remove(instance);\n            manager.quadPicking.quadTree.remove(instance);\n        }\n    };\n    InstanceDiffManager.prototype.removeInstanceColorPick = function (manager, instance, uniformCluster) {\n        if (uniformCluster) {\n            instance.active = false;\n            manager.updateInstance(instance, uniformCluster);\n            manager.layer.uniformManager.remove(instance);\n            manager.colorPicking.uidToInstance.delete(instance.uid);\n        }\n    };\n    InstanceDiffManager.prototype.updateInstance = function (instance, uniformCluster) {\n        if (instance.active) {\n            var uniforms = uniformCluster.uniform;\n            var uniformRangeStart = uniformCluster.uniformRange[0];\n            var instanceData = uniforms.value;\n            var instanceUniform = void 0, value = void 0, block = void 0, start = void 0;\n            var k = void 0, endk = void 0;\n            for (var i = 0, end = this.layer.instanceAttributes.length; i < end; ++i) {\n                instanceUniform = this.layer.instanceAttributes[i];\n                value = instanceUniform.update(instance);\n                block = instanceData[uniformRangeStart + instanceUniform.block];\n                instanceUniform.atlas &&\n                    this.layer.resource.setTargetAtlas(instanceUniform.atlas.key);\n                start = instanceUniform.blockIndex;\n                if (start === undefined) {\n                    continue;\n                }\n                for (k = start, endk = value.length + start; k < endk; ++k) {\n                    block[VECTOR_ACCESSORS[k]] = value[k - start];\n                }\n            }\n            uniforms.value = instanceData;\n        }\n        else {\n            var uniforms = uniformCluster.uniform;\n            var uniformRangeStart = uniformCluster.uniformRange[0];\n            var instanceData = uniforms.value;\n            var instanceUniform = void 0, value = void 0, block = void 0, start = void 0;\n            instanceUniform = this.layer.activeAttribute;\n            value = instanceUniform.update(instance);\n            block = instanceData[uniformRangeStart + instanceUniform.block];\n            instanceUniform.atlas &&\n                this.layer.resource.setTargetAtlas(instanceUniform.atlas.key);\n            start = instanceUniform.blockIndex;\n            if (start !== undefined) {\n                for (var k = start, endk = value.length + start; k < endk; ++k) {\n                    block[VECTOR_ACCESSORS[k]] = value[k - start];\n                }\n            }\n            uniforms.value = instanceData;\n        }\n    };\n    return InstanceDiffManager;\n}());\nexports.InstanceDiffManager = InstanceDiffManager;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction squareDistance(p1, p2) {\n    var dx = p1.x - p2.x;\n    var dy = p1.y - p2.y;\n    return dx * dx + dy * dy;\n}\nvar Point = (function () {\n    function Point() {\n    }\n    Point.add = function (p1, p2, out) {\n        if (out) {\n            out.x = p1.x + p2.x;\n            out.y = p1.y + p2.y;\n            return out;\n        }\n        return {\n            x: p1.x + p2.x,\n            y: p1.y + p2.y\n        };\n    };\n    Point.getClosest = function (testPoint, points) {\n        var closestDistance = Number.MAX_VALUE;\n        var closestPoint = testPoint;\n        var distance;\n        var findClosest = function (point) {\n            distance = squareDistance(point, testPoint);\n            if (distance < closestDistance) {\n                closestDistance = distance;\n                closestPoint = point;\n            }\n        };\n        points.forEach(findClosest);\n        return closestPoint;\n    };\n    Point.getClosestIndex = function (testPoint, points) {\n        var closestDistance = Number.MAX_VALUE;\n        var closestPoint = 0;\n        var distance;\n        var findClosest = function (point, i) {\n            distance = squareDistance(point, testPoint);\n            if (distance < closestDistance) {\n                closestDistance = distance;\n                closestPoint = i;\n            }\n        };\n        points.forEach(findClosest);\n        return closestPoint;\n    };\n    Point.subtract = function (amount, from, normalize) {\n        if (normalize === void 0) { normalize = false; }\n        var dx = from.x - amount.x;\n        var dy = from.y - amount.y;\n        if (normalize) {\n            var magnitude = Math.sqrt(dx * dx + dy * dy);\n            dx /= magnitude;\n            dy /= magnitude;\n        }\n        return {\n            x: dx,\n            y: dy\n        };\n    };\n    Point.getDistance = function (p1, p2, squared) {\n        if (squared === void 0) { squared = false; }\n        if (squared) {\n            return squareDistance(p1, p2);\n        }\n        return Math.sqrt(squareDistance(p1, p2));\n    };\n    Point.getMidpoint = function (p1, p2) {\n        var direction = Point.subtract(p1, p2);\n        return {\n            x: direction.x / 2 + p1.x,\n            y: direction.y / 2 + p1.y\n        };\n    };\n    Point.make = function (x, y) {\n        return { x: x, y: y };\n    };\n    Point.scale = function (p1, s, out) {\n        if (out) {\n            out.x = p1.x * s;\n            out.y = p1.y * s;\n            return out;\n        }\n        return {\n            x: p1.x * s,\n            y: p1.y * s\n        };\n    };\n    Point.zero = function () {\n        return {\n            x: 0,\n            y: 0\n        };\n    };\n    return Point;\n}());\nexports.Point = Point;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar types_1 = require(\"../types\");\nvar InstanceProvider = (function () {\n    function InstanceProvider() {\n        this.cleanObservation = {};\n        this.instanceChanges = new Map();\n        this.allowChanges = true;\n    }\n    Object.defineProperty(InstanceProvider.prototype, \"changeList\", {\n        get: function () {\n            this.allowChanges = false;\n            var changes = Array.from(this.instanceChanges.values());\n            return changes;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    InstanceProvider.prototype.add = function (instance) {\n        if (this.cleanObservation[instance.uid]) {\n            return instance;\n        }\n        if (this.allowChanges) {\n            instance.observer = this;\n            var disposer = instance.observableDisposer;\n            this.cleanObservation[instance.uid] = [instance, disposer];\n            this.instanceChanges.set(instance.uid, [\n                instance,\n                types_1.InstanceDiffType.INSERT,\n                instance.changes\n            ]);\n        }\n        return instance;\n    };\n    InstanceProvider.prototype.clear = function () {\n        var values = Object.values(this.cleanObservation);\n        for (var i = 0, end = values.length; i < end; ++i) {\n            this.remove(values[i][0]);\n        }\n    };\n    InstanceProvider.prototype.destroy = function () {\n        var values = Object.values(this.cleanObservation);\n        for (var i = 0, end = values.length; i < end; ++i) {\n            values[i][1]();\n        }\n        this.cleanObservation = {};\n        this.instanceChanges.clear();\n    };\n    InstanceProvider.prototype.instanceUpdated = function (instance, _property) {\n        if (this.allowChanges) {\n            this.instanceChanges.set(instance.uid, [\n                instance,\n                types_1.InstanceDiffType.CHANGE,\n                instance.changes\n            ]);\n        }\n    };\n    InstanceProvider.prototype.remove = function (instance) {\n        if (this.allowChanges) {\n            var disposer = this.cleanObservation[instance.uid];\n            if (disposer) {\n                disposer[1]();\n                delete this.cleanObservation[instance.uid];\n                this.instanceChanges.set(instance.uid, [\n                    instance,\n                    types_1.InstanceDiffType.REMOVE,\n                    {}\n                ]);\n            }\n        }\n        return false;\n    };\n    InstanceProvider.prototype.resolve = function () {\n        this.allowChanges = true;\n        this.instanceChanges.clear();\n    };\n    return InstanceProvider;\n}());\nexports.InstanceProvider = InstanceProvider;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Three = require(\"three\");\nvar instance_provider_1 = require(\"../../instance-provider\");\nvar primitives_1 = require(\"../../primitives\");\nvar layer_1 = require(\"../../surface/layer\");\nvar types_1 = require(\"../../types\");\nvar CircleLayer = (function (_super) {\n    __extends(CircleLayer, _super);\n    function CircleLayer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    CircleLayer.prototype.getInstancePickingMethods = function () {\n        var _this = this;\n        var noScaleFactor = function () { return 1; };\n        return {\n            boundsAccessor: function (circle) {\n                return new primitives_1.Bounds({\n                    height: circle.radius * 2,\n                    width: circle.radius * 2,\n                    x: circle.x - circle.radius,\n                    y: circle.y - circle.radius\n                });\n            },\n            hitTest: function (circle, point, view) {\n                var circleScreenCenter = view.worldToScreen(circle);\n                var mouseScreen = view.worldToScreen(point);\n                var r = circle.radius * (_this.props.scaleFactor || noScaleFactor)();\n                var delta = [\n                    mouseScreen.x - circleScreenCenter.x,\n                    mouseScreen.y - circleScreenCenter.y\n                ];\n                return delta[0] * delta[0] + delta[1] * delta[1] < r * r;\n            }\n        };\n    };\n    CircleLayer.prototype.initShader = function () {\n        var scaleFactor = this.props.scaleFactor || (function () { return 1; });\n        var animations = this.props.animate || {};\n        var animateCenter = animations.center, animateRadius = animations.radius, animateColor = animations.color;\n        var vertexToNormal = {\n            0: 1,\n            1: 1,\n            2: -1,\n            3: 1,\n            4: -1,\n            5: -1\n        };\n        var vertexToSide = {\n            0: -1,\n            1: -1,\n            2: -1,\n            3: 1,\n            4: 1,\n            5: 1\n        };\n        return {\n            fs: require(\"./circle-layer.fs\"),\n            instanceAttributes: [\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    easing: animateCenter,\n                    name: \"center\",\n                    size: types_1.InstanceAttributeSize.TWO,\n                    update: function (circle) { return [circle.x, circle.y]; }\n                },\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.THREE,\n                    easing: animateRadius,\n                    name: \"radius\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (circle) { return [circle.radius]; }\n                },\n                {\n                    block: 0,\n                    blockIndex: types_1.InstanceBlockIndex.FOUR,\n                    name: \"depth\",\n                    size: types_1.InstanceAttributeSize.ONE,\n                    update: function (circle) { return [circle.depth]; }\n                },\n                {\n                    block: 1,\n                    blockIndex: types_1.InstanceBlockIndex.ONE,\n                    easing: animateColor,\n                    name: \"color\",\n                    size: types_1.InstanceAttributeSize.FOUR,\n                    update: function (circle) { return circle.color; }\n                }\n            ],\n            uniforms: [\n                {\n                    name: \"scaleFactor\",\n                    size: types_1.UniformSize.ONE,\n                    update: function (_uniform) { return [scaleFactor()]; }\n                }\n            ],\n            vertexAttributes: [\n                {\n                    name: \"position\",\n                    size: types_1.VertexAttributeSize.THREE,\n                    update: function (vertex) { return [\n                        vertexToNormal[vertex],\n                        vertexToSide[vertex],\n                        0\n                    ]; }\n                }\n            ],\n            vertexCount: 6,\n            vs: require(\"./circle-layer.vs\")\n        };\n    };\n    CircleLayer.prototype.getModelType = function () {\n        return {\n            drawMode: Three.TriangleStripDrawMode,\n            modelType: Three.Mesh\n        };\n    };\n    CircleLayer.prototype.getMaterialOptions = function () {\n        return {\n            premultipliedAlpha: true,\n            transparent: true\n        };\n    };\n    CircleLayer.defaultProps = {\n        data: new instance_provider_1.InstanceProvider(),\n        fadeOutOversized: -1,\n        key: \"\",\n        scaleFactor: function () { return 1; }\n    };\n    return CircleLayer;\n}(layer_1.Layer));\nexports.CircleLayer = CircleLayer;\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./circle-layer\"));\n__export(require(\"./circle-instance\"));\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./circles\"));\n__export(require(\"./edges\"));\n__export(require(\"./images\"));\n__export(require(\"./labels\"));\n__export(require(\"./rectangle\"));\n__export(require(\"./rings\"));\n__export(require(\"./types\"));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar shader_templating_1 = require(\"../../util/shader-templating\");\nvar template_vars_1 = require(\"../template-vars\");\nfunction extendShader(shaderIO, vs, fs) {\n    var baseVS = shaderIO.vs;\n    var baseFS = shaderIO.fs;\n    var extendedVS = { shader: baseVS };\n    var extendedFS = { shader: baseFS };\n    if (vs) {\n        var options = {};\n        options[template_vars_1.templateVars.extendHeader] = vs.header\n            ? vs.header + \"\\n${\" + template_vars_1.templateVars.extendHeader + \"}\"\n            : \"\";\n        options[template_vars_1.templateVars.extend] = vs.body\n            ? vs.body + \"\\n${\" + template_vars_1.templateVars.extend + \"}\"\n            : \"\";\n        var required = {\n            name: \"Extend VS Shader\",\n            values: [template_vars_1.templateVars.extendHeader, template_vars_1.templateVars.extend]\n        };\n        extendedVS = shader_templating_1.shaderTemplate({\n            options: options,\n            required: required,\n            shader: baseVS,\n            onToken: function (token, replace) {\n                if (token === template_vars_1.templateVars.extendHeader ||\n                    token === template_vars_1.templateVars.extend) {\n                    return replace;\n                }\n                return \"${\" + token + \"}\";\n            }\n        });\n    }\n    if (fs) {\n        var options = {};\n        options[template_vars_1.templateVars.extendHeader] = fs.header\n            ? fs.header + \"\\n${\" + template_vars_1.templateVars.extendHeader + \"}\"\n            : \"\";\n        options[template_vars_1.templateVars.extend] = fs.body\n            ? fs.body + \"\\n${\" + template_vars_1.templateVars.extend + \"}\"\n            : \"\";\n        var required = {\n            name: \"Extend FS Shader\",\n            values: [template_vars_1.templateVars.extendHeader, template_vars_1.templateVars.extend]\n        };\n        extendedFS = shader_templating_1.shaderTemplate({\n            options: options,\n            required: required,\n            shader: baseFS,\n            onToken: function (token, replace) {\n                if (token === template_vars_1.templateVars.extendHeader ||\n                    token === template_vars_1.templateVars.extend) {\n                    return replace;\n                }\n                return \"${\" + token + \"}\";\n            }\n        });\n    }\n    return {\n        fs: extendedFS.shader,\n        vs: extendedVS.shader\n    };\n}\nexports.extendShader = extendShader;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar extend_shader_1 = require(\"../shaders/util/extend-shader\");\nfunction extendShaderInitialization(shaderIO, extend) {\n    var extendedShaders = extend_shader_1.extendShader(shaderIO, extend.vs, extend.fs);\n    return {\n        fs: extendedShaders.fs,\n        instanceAttributes: (shaderIO.instanceAttributes || []).concat(extend.instanceAttributes || []),\n        uniforms: (shaderIO.uniforms || []).concat(extend.uniforms || []),\n        vertexAttributes: (shaderIO.vertexAttributes || []).concat(extend.vertexAttributes || []),\n        vertexCount: shaderIO.vertexCount,\n        vs: extendedShaders.vs\n    };\n}\nexports.extendShaderInitialization = extendShaderInitialization;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar bounds_1 = require(\"../primitives/bounds\");\nvar maxPopulation = 5;\nvar maxDepth = 10;\nvar Quadrants = (function () {\n    function Quadrants(bounds, depth, getBounds, childToNode, childToBounds) {\n        var mid = bounds.mid;\n        this.TL = new Node(bounds.x, mid.x, bounds.y, mid.y, getBounds, depth);\n        this.TR = new Node(mid.x, bounds.right, bounds.y, mid.y, getBounds, depth);\n        this.BL = new Node(bounds.x, mid.x, mid.y, bounds.bottom, getBounds, depth);\n        this.BR = new Node(mid.x, bounds.right, mid.y, bounds.bottom, getBounds, depth);\n        this.TL.childToNode = childToNode;\n        this.TR.childToNode = childToNode;\n        this.BL.childToNode = childToNode;\n        this.BR.childToNode = childToNode;\n        this.TL.childToBounds = childToBounds;\n        this.TR.childToBounds = childToBounds;\n        this.BL.childToBounds = childToBounds;\n        this.BR.childToBounds = childToBounds;\n    }\n    Quadrants.prototype.destroy = function () {\n        this.TL.destroy();\n        this.TR.destroy();\n        this.BL.destroy();\n        this.BR.destroy();\n        delete this.TL;\n        delete this.TR;\n        delete this.BL;\n        delete this.BR;\n    };\n    return Quadrants;\n}());\nexports.Quadrants = Quadrants;\nvar Node = (function () {\n    function Node(left, right, top, bottom, getBounds, depth) {\n        if (depth === void 0) { depth = 0; }\n        this.children = [];\n        this.depth = 0;\n        this.nodes = null;\n        if (arguments.length >= 4) {\n            this.bounds = new bounds_1.Bounds({ left: left, right: right, top: top, bottom: bottom });\n        }\n        else {\n            this.bounds = new bounds_1.Bounds({ left: 0, right: 1, top: 1, bottom: 0 });\n        }\n        this.depth = depth;\n        this.getBounds = getBounds;\n        if (this.depth === 0) {\n            this.nullBounded = [];\n            this.childToNode = new Map();\n            this.childToBounds = new Map();\n        }\n    }\n    Node.prototype.destroy = function () {\n        delete this.children;\n        delete this.bounds;\n        if (this.nodes) {\n            this.nodes.destroy();\n            this.nodes = null;\n        }\n    };\n    Node.prototype.add = function (child) {\n        var bounds = this.childToBounds.get(child);\n        if (!bounds) {\n            bounds = this.getBounds(child);\n            this.childToBounds.set(child, bounds);\n        }\n        if (!bounds || bounds.isInside(this.bounds)) {\n            return this.doAdd(child, bounds);\n        }\n        else {\n            this.cover(bounds);\n            return this.add(child);\n        }\n    };\n    Node.prototype.addAll = function (children) {\n        var _this = this;\n        var minX = Number.MAX_VALUE;\n        var minY = Number.MAX_VALUE;\n        var maxX = -Number.MAX_VALUE;\n        var maxY = -Number.MAX_VALUE;\n        children.forEach(function (child) {\n            var bounds = _this.getBounds(child);\n            _this.childToBounds.set(child, bounds);\n            if (!bounds)\n                return;\n            if (bounds.x < minX) {\n                minX = bounds.x;\n            }\n            if (bounds.right > maxX) {\n                maxX = bounds.right;\n            }\n            if (bounds.bottom > maxY) {\n                maxY = bounds.bottom;\n            }\n            if (bounds.y < minY) {\n                minY = bounds.y;\n            }\n        });\n        if (minX !== Number.MAX_VALUE &&\n            minY !== Number.MAX_VALUE &&\n            maxX !== -Number.MAX_VALUE &&\n            maxY !== -Number.MAX_VALUE) {\n            this.cover(new bounds_1.Bounds({ left: minX, right: maxX, bottom: maxY, top: minY }));\n        }\n        children.forEach(function (child) {\n            return _this.doAdd(child, _this.childToBounds.get(child) || null, true);\n        });\n    };\n    Node.prototype.cover = function (bounds) {\n        var _this = this;\n        if (bounds.isInside(this.bounds)) {\n            return;\n        }\n        this.bounds.encapsulate(bounds);\n        this.bounds.x -= 1;\n        this.bounds.y -= 1;\n        this.bounds.width += 2;\n        this.bounds.height += 2;\n        var allChildren = this.gatherChildren([]);\n        this.children = [];\n        if (this.nodes) {\n            this.nodes.destroy();\n            this.nodes = null;\n        }\n        this.childToNode.clear();\n        allChildren.forEach(function (child) {\n            return _this.doAdd(child, _this.childToBounds.get(child) || null);\n        });\n    };\n    Node.prototype.doAdd = function (child, bounds, fromSplit) {\n        if (!bounds && this.depth === 0) {\n            this.nullBounded.push(child);\n            this.childToNode.set(child, this);\n            return true;\n        }\n        if (!bounds) {\n            console.warn(\"A null bounds was added to a Quad Tree node below the top node, which is invalid.\");\n            return false;\n        }\n        if (this.nodes) {\n            if (bounds.isInside(this.nodes.TL.bounds)) {\n                return this.nodes.TL.doAdd(child, bounds, fromSplit);\n            }\n            if (bounds.isInside(this.nodes.TR.bounds)) {\n                return this.nodes.TR.doAdd(child, bounds, fromSplit);\n            }\n            if (bounds.isInside(this.nodes.BL.bounds)) {\n                return this.nodes.BL.doAdd(child, bounds, fromSplit);\n            }\n            if (bounds.isInside(this.nodes.BR.bounds)) {\n                return this.nodes.BR.doAdd(child, bounds, fromSplit);\n            }\n            this.children.push(child);\n            this.childToNode.set(child, this);\n            return true;\n        }\n        else if (bounds.isInside(this.bounds)) {\n            this.children.push(child);\n            this.childToNode.set(child, this);\n            if (this.children.length > maxPopulation && this.depth < maxDepth) {\n                this.split();\n            }\n            return true;\n        }\n        if (isNaN(bounds.width + bounds.height + bounds.x + bounds.y)) {\n            console.error(\"Child did not fit into bounds because a dimension is NaN\", child, bounds);\n        }\n        else if (bounds.area === 0) {\n            console.error(\"Child did not fit into bounds because the area is zero\", child, bounds);\n        }\n        else {\n            console.error(\"Child did not get insertted.\", \"Parent:\", this.bounds.toString(), \"Child:\", bounds.toString(), \"Inside Checks:\", bounds.x >= this.bounds.x, bounds.right <= this.bounds.right, bounds.y >= this.bounds.y, bounds.bottom <= this.bounds.bottom);\n        }\n        return true;\n    };\n    Node.prototype.doRemove = function (child) {\n        var index = this.children.indexOf(child);\n        if (index > -1) {\n            this.children.splice(index, 1);\n            this.childToNode.delete(child);\n            this.childToBounds.delete(child);\n        }\n    };\n    Node.prototype.gatherChildren = function (list) {\n        this.children.forEach(function (child) { return list.push(child); });\n        if (this.nodes) {\n            this.nodes.TL.gatherChildren(list);\n            this.nodes.TR.gatherChildren(list);\n            this.nodes.BL.gatherChildren(list);\n            this.nodes.BR.gatherChildren(list);\n        }\n        return list;\n    };\n    Node.prototype.query = function (bounds, visit) {\n        var found = [];\n        if (this.depth === 0) {\n            found = this.nullBounded.slice(0);\n        }\n        if (bounds instanceof bounds_1.Bounds) {\n            if (bounds.hitBounds(this.bounds)) {\n                return this.queryBounds(bounds, found, visit);\n            }\n        }\n        if (this.bounds.containsPoint(bounds)) {\n            return this.queryPoint(bounds, found, visit);\n        }\n        return found;\n    };\n    Node.prototype.queryBounds = function (b, list, visit) {\n        var _this = this;\n        this.children.forEach(function (c) {\n            var bounds = _this.childToBounds.get(c);\n            if (bounds && bounds.hitBounds(b)) {\n                list.push(c);\n            }\n        });\n        if (visit) {\n            visit(this);\n        }\n        if (this.nodes) {\n            if (b.hitBounds(this.nodes.TL.bounds)) {\n                this.nodes.TL.queryBounds(b, list, visit);\n            }\n            if (b.hitBounds(this.nodes.TR.bounds)) {\n                this.nodes.TR.queryBounds(b, list, visit);\n            }\n            if (b.hitBounds(this.nodes.BL.bounds)) {\n                this.nodes.BL.queryBounds(b, list, visit);\n            }\n            if (b.hitBounds(this.nodes.BR.bounds)) {\n                this.nodes.BR.queryBounds(b, list, visit);\n            }\n        }\n        return list;\n    };\n    Node.prototype.queryPoint = function (p, list, visit) {\n        var _this = this;\n        this.children.forEach(function (c) {\n            var bounds = _this.childToBounds.get(c);\n            if (bounds && bounds.containsPoint(p)) {\n                list.push(c);\n            }\n        });\n        if (visit) {\n            visit(this);\n        }\n        if (this.nodes) {\n            if (this.nodes.TL.bounds.containsPoint(p)) {\n                this.nodes.TL.queryPoint(p, list, visit);\n            }\n            if (this.nodes.TR.bounds.containsPoint(p)) {\n                this.nodes.TR.queryPoint(p, list, visit);\n            }\n            if (this.nodes.BL.bounds.containsPoint(p)) {\n                this.nodes.BL.queryPoint(p, list, visit);\n            }\n            if (this.nodes.BR.bounds.containsPoint(p)) {\n                this.nodes.BR.queryPoint(p, list, visit);\n            }\n        }\n        return list;\n    };\n    Node.prototype.remove = function (child) {\n        if (this.childToNode) {\n            var node = this.childToNode.get(child);\n            if (node && node.depth === 0) {\n                var index = node.nullBounded.indexOf(child);\n                if (index > -1) {\n                    node.nullBounded.splice(index);\n                    this.childToNode.delete(child);\n                    this.childToBounds.delete(child);\n                    return;\n                }\n            }\n            if (node) {\n                node.doRemove(child);\n            }\n        }\n    };\n    Node.prototype.split = function () {\n        var allChildren = this.gatherChildren([]);\n        this.nodes = new Quadrants(this.bounds, this.depth + 1, this.getBounds, this.childToNode, this.childToBounds);\n        this.children = [];\n        for (var i = 0, end = allChildren.length; i < end; ++i) {\n            var child = allChildren[i];\n            this.doAdd(child, this.childToBounds.get(child) || null, true);\n        }\n    };\n    Node.prototype.visit = function (cb) {\n        var finished = Boolean(cb(this));\n        if (this.nodes && !finished) {\n            this.nodes.TL.visit(cb);\n            this.nodes.TR.visit(cb);\n            this.nodes.BL.visit(cb);\n            this.nodes.BR.visit(cb);\n        }\n    };\n    return Node;\n}());\nexports.Node = Node;\nvar TrackedQuadTree = (function (_super) {\n    __extends(TrackedQuadTree, _super);\n    function TrackedQuadTree() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return TrackedQuadTree;\n}(Node));\nexports.TrackedQuadTree = TrackedQuadTree;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar chart_camera_1 = require(\"./chart-camera\");\nvar ReferenceCamera = (function (_super) {\n    __extends(ReferenceCamera, _super);\n    function ReferenceCamera(options) {\n        var _this = _super.call(this) || this;\n        _this.offsetFilter = function (offset) { return offset; };\n        _this.scaleFilter = function (scale) { return scale; };\n        Object.assign(_this, options);\n        return _this;\n    }\n    Object.defineProperty(ReferenceCamera.prototype, \"offset\", {\n        get: function () {\n            return this.offsetFilter(this.base.offset);\n        },\n        set: function (_val) {\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ReferenceCamera.prototype, \"scale\", {\n        get: function () {\n            return this.scaleFilter(this.base.scale);\n        },\n        set: function (_val) {\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return ReferenceCamera;\n}(chart_camera_1.ChartCamera));\nexports.ReferenceCamera = ReferenceCamera;\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  if (ms >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (ms >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (ms >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (ms >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  return plural(ms, d, 'day') ||\n    plural(ms, h, 'hour') ||\n    plural(ms, m, 'minute') ||\n    plural(ms, s, 'second') ||\n    ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) {\n    return;\n  }\n  if (ms < n * 1.5) {\n    return Math.floor(ms / n) + ' ' + name;\n  }\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = createDebug.debug = createDebug['default'] = createDebug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * Active `debug` instances.\n */\nexports.instances = [];\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n */\n\nexports.formatters = {};\n\n/**\n * Select a color.\n * @param {String} namespace\n * @return {Number}\n * @api private\n */\n\nfunction selectColor(namespace) {\n  var hash = 0, i;\n\n  for (i in namespace) {\n    hash  = ((hash << 5) - hash) + namespace.charCodeAt(i);\n    hash |= 0; // Convert to 32bit integer\n  }\n\n  return exports.colors[Math.abs(hash) % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction createDebug(namespace) {\n\n  var prevTime;\n\n  function debug() {\n    // disabled?\n    if (!debug.enabled) return;\n\n    var self = debug;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // turn the `arguments` into a proper Array\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %O\n      args.unshift('%O');\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-zA-Z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    // apply env-specific formatting (colors, etc.)\n    exports.formatArgs.call(self, args);\n\n    var logFn = debug.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n\n  debug.namespace = namespace;\n  debug.enabled = exports.enabled(namespace);\n  debug.useColors = exports.useColors();\n  debug.color = selectColor(namespace);\n  debug.destroy = destroy;\n\n  // env-specific initialization logic for debug instances\n  if ('function' === typeof exports.init) {\n    exports.init(debug);\n  }\n\n  exports.instances.push(debug);\n\n  return debug;\n}\n\nfunction destroy () {\n  var index = exports.instances.indexOf(this);\n  if (index !== -1) {\n    exports.instances.splice(index, 1);\n    return true;\n  } else {\n    return false;\n  }\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  exports.names = [];\n  exports.skips = [];\n\n  var i;\n  var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n\n  for (i = 0; i < exports.instances.length; i++) {\n    var instance = exports.instances[i];\n    instance.enabled = exports.enabled(instance.namespace);\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  if (name[name.length - 1] === '*') {\n    return true;\n  }\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","module.exports = __WEBPACK_EXTERNAL_MODULE__114__;","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction isNumber(val) {\n    return !isNaN(val);\n}\nvar AnimationHelper = (function () {\n    function AnimationHelper(surface) {\n        this.surface = surface;\n    }\n    AnimationHelper.prototype.groupAnimation = function (easingMethod, groupCount, baseDelay, delayGap, modifyInstances) {\n        var startFrameTime = this.surface.frameMetrics.currentTime;\n        this.surface.commit(startFrameTime);\n        for (var i = 0; i < groupCount; ++i) {\n            var gap = isNumber(delayGap)\n                ? delayGap\n                : delayGap(i, easingMethod.delay);\n            easingMethod.delay = baseDelay + gap * i;\n            modifyInstances(i);\n            this.surface.commit(startFrameTime);\n        }\n    };\n    return AnimationHelper;\n}());\nexports.AnimationHelper = AnimationHelper;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar bounds_1 = require(\"../primitives/bounds\");\nvar event_manager_1 = require(\"../surface/event-manager\");\nvar util_1 = require(\"../util\");\nvar CameraBoundsAnchor;\n(function (CameraBoundsAnchor) {\n    CameraBoundsAnchor[CameraBoundsAnchor[\"TOP_LEFT\"] = 0] = \"TOP_LEFT\";\n    CameraBoundsAnchor[CameraBoundsAnchor[\"TOP_MIDDLE\"] = 1] = \"TOP_MIDDLE\";\n    CameraBoundsAnchor[CameraBoundsAnchor[\"TOP_RIGHT\"] = 2] = \"TOP_RIGHT\";\n    CameraBoundsAnchor[CameraBoundsAnchor[\"MIDDLE_LEFT\"] = 3] = \"MIDDLE_LEFT\";\n    CameraBoundsAnchor[CameraBoundsAnchor[\"MIDDLE\"] = 4] = \"MIDDLE\";\n    CameraBoundsAnchor[CameraBoundsAnchor[\"MIDDLE_RIGHT\"] = 5] = \"MIDDLE_RIGHT\";\n    CameraBoundsAnchor[CameraBoundsAnchor[\"BOTTOM_LEFT\"] = 6] = \"BOTTOM_LEFT\";\n    CameraBoundsAnchor[CameraBoundsAnchor[\"BOTTOM_MIDDLE\"] = 7] = \"BOTTOM_MIDDLE\";\n    CameraBoundsAnchor[CameraBoundsAnchor[\"BOTTOM_RIGHT\"] = 8] = \"BOTTOM_RIGHT\";\n})(CameraBoundsAnchor = exports.CameraBoundsAnchor || (exports.CameraBoundsAnchor = {}));\nvar max = Math.max, min = Math.min;\nvar BasicCameraController = (function (_super) {\n    __extends(BasicCameraController, _super);\n    function BasicCameraController(options) {\n        var _this = _super.call(this) || this;\n        _this.isPanning = false;\n        _this.panFilter = function (offset, _view, _allViews) { return offset; };\n        _this.scaleFilter = function (scale, _view, _allViews) { return scale; };\n        _this.startViews = [];\n        _this.onRangeChanged = function (_camera, _targetView) {\n        };\n        _this.startViewDidStart = false;\n        _this.applyBounds = function () {\n            if (_this.bounds && _this.camera) {\n                var targetView = _this.getView(_this.bounds.view);\n                _this.applyScaleBounds();\n                if (targetView) {\n                    _this.camera.offset[0] = _this.boundsHorizontalOffset(targetView, _this.bounds);\n                    _this.camera.offset[1] = _this.boundsVerticalOffset(targetView, _this.bounds);\n                }\n            }\n        };\n        _this.applyScaleBounds = function () {\n            if (_this.camera && _this.bounds) {\n                if (_this.bounds.scaleMin) {\n                    _this.camera.scale = [\n                        max(_this.camera.scale[0], _this.bounds.scaleMin[0]),\n                        max(_this.camera.scale[1], _this.bounds.scaleMin[1]),\n                        max(_this.camera.scale[2], _this.bounds.scaleMin[2])\n                    ];\n                }\n                if (_this.bounds.scaleMax) {\n                    _this.camera.scale = [\n                        min(_this.camera.scale[0], _this.bounds.scaleMax[0]),\n                        min(_this.camera.scale[1], _this.bounds.scaleMax[1]),\n                        min(_this.camera.scale[2], _this.bounds.scaleMax[2])\n                    ];\n                }\n            }\n        };\n        if (options.bounds) {\n            _this.setBounds(options.bounds);\n        }\n        _this.camera = options.camera;\n        _this.scaleFactor = options.scaleFactor || 1000.0;\n        _this.ignoreCoverViews = options.ignoreCoverViews || false;\n        if (options.startView) {\n            _this.startViews = Array.isArray(options.startView)\n                ? options.startView\n                : [options.startView];\n        }\n        _this.panFilter = options.panFilter || _this.panFilter;\n        _this.scaleFilter = options.scaleFilter || _this.scaleFilter;\n        _this.onRangeChanged = options.onRangeChanged || _this.onRangeChanged;\n        return _this;\n    }\n    BasicCameraController.prototype.anchoredByBoundsHorizontal = function (targetView, bounds) {\n        switch (bounds.anchor) {\n            case CameraBoundsAnchor.TOP_LEFT:\n            case CameraBoundsAnchor.MIDDLE_LEFT:\n            case CameraBoundsAnchor.BOTTOM_LEFT:\n                return -(bounds.worldBounds.left -\n                    bounds.screenPadding.left / this.camera.scale[0]);\n            case CameraBoundsAnchor.TOP_MIDDLE:\n            case CameraBoundsAnchor.MIDDLE:\n            case CameraBoundsAnchor.BOTTOM_MIDDLE:\n                return -(bounds.worldBounds.right -\n                    bounds.worldBounds.width / 2 -\n                    0.5 *\n                        ((targetView.screenBounds.width + bounds.screenPadding.right) /\n                            this.camera.scale[0]));\n            case CameraBoundsAnchor.TOP_RIGHT:\n            case CameraBoundsAnchor.MIDDLE_RIGHT:\n            case CameraBoundsAnchor.BOTTOM_RIGHT:\n                return -(bounds.worldBounds.right -\n                    (targetView.screenBounds.width - bounds.screenPadding.right) /\n                        this.camera.scale[0]);\n        }\n    };\n    BasicCameraController.prototype.anchoredByBoundsVertical = function (targetView, bounds) {\n        switch (bounds.anchor) {\n            case CameraBoundsAnchor.TOP_LEFT:\n            case CameraBoundsAnchor.TOP_MIDDLE:\n            case CameraBoundsAnchor.TOP_RIGHT:\n                return (-bounds.worldBounds.top - -bounds.screenPadding.top / this.scale[1]);\n            case CameraBoundsAnchor.MIDDLE_LEFT:\n            case CameraBoundsAnchor.MIDDLE:\n            case CameraBoundsAnchor.MIDDLE_RIGHT:\n                return (-(bounds.worldBounds.bottom - bounds.worldBounds.height / 2) +\n                    0.5 *\n                        (targetView.screenBounds.height - bounds.screenPadding.bottom) /\n                        this.scale[1]);\n            case CameraBoundsAnchor.BOTTOM_LEFT:\n            case CameraBoundsAnchor.BOTTOM_MIDDLE:\n            case CameraBoundsAnchor.BOTTOM_RIGHT:\n                return -(bounds.worldBounds.bottom -\n                    (targetView.screenBounds.height - bounds.screenPadding.bottom) /\n                        this.scale[1]);\n        }\n    };\n    BasicCameraController.prototype.boundsHorizontalOffset = function (targetView, bounds) {\n        var worldTLinScreenSpace = targetView.worldToScreen({\n            x: bounds.worldBounds.left,\n            y: bounds.worldBounds.top\n        });\n        var worldBRinScreenSpace = targetView.worldToScreen({\n            x: bounds.worldBounds.right,\n            y: bounds.worldBounds.bottom\n        });\n        var widthDifference = worldBRinScreenSpace.x -\n            worldTLinScreenSpace.x +\n            bounds.screenPadding.left +\n            bounds.screenPadding.right -\n            targetView.screenBounds.width;\n        if (widthDifference < 0) {\n            return this.anchoredByBoundsHorizontal(targetView, bounds);\n        }\n        if (worldBRinScreenSpace.x <\n            targetView.screenBounds.right - bounds.screenPadding.right) {\n            return (-bounds.worldBounds.right +\n                (targetView.screenBounds.width - bounds.screenPadding.right) /\n                    this.camera.scale[0]);\n        }\n        if (worldTLinScreenSpace.x >\n            targetView.screenBounds.left + bounds.screenPadding.left) {\n            return (-bounds.worldBounds.left +\n                bounds.screenPadding.left / this.camera.scale[0]);\n        }\n        return this.camera.offset[0];\n    };\n    BasicCameraController.prototype.boundsVerticalOffset = function (targetView, bounds) {\n        var worldTLinScreenSpace = targetView.worldToScreen({\n            x: bounds.worldBounds.left,\n            y: bounds.worldBounds.top\n        });\n        var worldBRinScreenSpace = targetView.worldToScreen({\n            x: bounds.worldBounds.right,\n            y: bounds.worldBounds.bottom\n        });\n        var heightDifference = worldBRinScreenSpace.y -\n            worldTLinScreenSpace.y +\n            bounds.screenPadding.top +\n            bounds.screenPadding.bottom -\n            targetView.screenBounds.height;\n        if (heightDifference < 0) {\n            return this.anchoredByBoundsVertical(targetView, bounds);\n        }\n        if (worldTLinScreenSpace.y >\n            targetView.screenBounds.top - bounds.screenPadding.top) {\n            return -(bounds.worldBounds.top -\n                bounds.screenPadding.top / this.camera.scale[1]);\n        }\n        if (worldBRinScreenSpace.y <\n            targetView.screenBounds.bottom + bounds.screenPadding.bottom) {\n            return -(bounds.worldBounds.bottom +\n                (-targetView.screenBounds.height + bounds.screenPadding.bottom) /\n                    this.camera.scale[1]);\n        }\n        return this.camera.offset[1];\n    };\n    BasicCameraController.prototype.canStart = function (viewId) {\n        return (this.startViews.length === 0 ||\n            (this.startViews && this.startViews.indexOf(viewId) > -1) ||\n            (this.startViewDidStart && this.ignoreCoverViews));\n    };\n    BasicCameraController.prototype.findCoveredStartView = function (e) {\n        var _this = this;\n        var found = e.viewsUnderMouse.find(function (under) { return _this.startViews.indexOf(under.view.id) > -1; });\n        this.startViewDidStart = Boolean(found);\n        if (found) {\n            this.coveredStartView = found.view;\n        }\n    };\n    BasicCameraController.prototype.getTargetView = function (e) {\n        if (this.startViews && !this.ignoreCoverViews) {\n            return e.target.view;\n        }\n        else {\n            return this.coveredStartView;\n        }\n    };\n    BasicCameraController.prototype.handleMouseDown = function (e, _button) {\n        if (this.startViews) {\n            this.findCoveredStartView(e);\n            if (e.start) {\n                this.isPanning = this.canStart(e.start.view.id) || this.isPanning;\n            }\n        }\n    };\n    BasicCameraController.prototype.handleMouseUp = function (_e) {\n        this.startViewDidStart = false;\n        this.isPanning = false;\n    };\n    BasicCameraController.prototype.handleDrag = function (e, drag) {\n        if (e.start) {\n            if (this.canStart(e.start.view.id)) {\n                var pan = [\n                    drag.screen.delta.x / this.camera.scale[0],\n                    drag.screen.delta.y / this.camera.scale[1],\n                    0\n                ];\n                if (this.panFilter) {\n                    pan = this.panFilter(pan, e.start.view, e.viewsUnderMouse.map(function (v) { return v.view; }));\n                }\n                this.camera.offset[0] += pan[0];\n                this.camera.offset[1] += pan[1];\n                this.applyBounds();\n                this.onRangeChanged(this.camera, e.start.view);\n                this.applyBounds();\n            }\n        }\n    };\n    BasicCameraController.prototype.handleWheel = function (e, wheelMetrics) {\n        this.findCoveredStartView(e);\n        if (this.canStart(e.target.view.id)) {\n            var targetView = this.getTargetView(e);\n            var beforeZoom = targetView.screenToWorld(e.screen.mouse);\n            var currentZoomX = this.camera.scale[0] || 1.0;\n            var currentZoomY = this.camera.scale[1] || 1.0;\n            var scale = [\n                wheelMetrics.wheel[1] / this.scaleFactor * currentZoomX,\n                wheelMetrics.wheel[1] / this.scaleFactor * currentZoomY,\n                1\n            ];\n            if (this.scaleFilter) {\n                scale = this.scaleFilter(scale, targetView, e.viewsUnderMouse.map(function (v) { return v.view; }));\n            }\n            this.camera.scale[0] = currentZoomX + scale[0];\n            this.camera.scale[1] = currentZoomY + scale[1];\n            this.applyScaleBounds();\n            var afterZoom = targetView.screenToWorld(e.screen.mouse);\n            this.camera.offset[0] -= beforeZoom.x - afterZoom.x;\n            this.camera.offset[1] -= beforeZoom.y - afterZoom.y;\n            this.applyBounds();\n            this.onRangeChanged(this.camera, targetView);\n            this.applyBounds();\n        }\n    };\n    BasicCameraController.prototype.handleMouseOut = function (_e) {\n    };\n    BasicCameraController.prototype.handleClick = function (_e) {\n    };\n    BasicCameraController.prototype.handleMouseMove = function (_e) {\n    };\n    BasicCameraController.prototype.handleMouseOver = function (_e) {\n    };\n    BasicCameraController.prototype.getRange = function (viewId) {\n        var projection = this.getProjection(viewId);\n        var screenBounds = this.getViewScreenBounds(viewId);\n        if (projection && screenBounds) {\n            var topLeft = projection.screenToWorld(screenBounds);\n            var bottomRight = projection.screenToWorld({\n                x: screenBounds.right,\n                y: screenBounds.bottom\n            });\n            return new bounds_1.Bounds({\n                height: bottomRight.y - topLeft.y,\n                width: bottomRight.x - topLeft.x,\n                x: topLeft.x,\n                y: topLeft.y\n            });\n        }\n        return new bounds_1.Bounds({ x: 0, y: 0, width: 1, height: 1 });\n    };\n    Object.defineProperty(BasicCameraController.prototype, \"pan\", {\n        get: function () {\n            return this.camera.offset;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    BasicCameraController.prototype.setBounds = function (bounds) {\n        this.bounds = bounds;\n        this.applyBounds();\n    };\n    Object.defineProperty(BasicCameraController.prototype, \"scale\", {\n        get: function () {\n            return this.camera.scale;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    BasicCameraController.prototype.setRange = function (newWorld, viewId) {\n        var projection = this.getProjection(viewId);\n        var screenBounds = this.getViewScreenBounds(viewId);\n        var view = this.getView(viewId);\n        if (projection && screenBounds && view) {\n            var deltaScale = util_1.subtract3([\n                screenBounds.width / newWorld.width,\n                screenBounds.height / newWorld.height,\n                1\n            ], this.camera.scale);\n            this.camera.scale = util_1.add3(this.camera.scale, this.scaleFilter(deltaScale, view, [view]));\n            var deltaPan = util_1.subtract3([-newWorld.x, -newWorld.y, 0], this.camera.offset);\n            this.camera.offset = util_1.add3(this.camera.offset, this.scaleFilter(deltaPan, view, [view]));\n            this.applyBounds();\n            this.onRangeChanged(this.camera, view);\n            this.applyBounds();\n        }\n    };\n    return BasicCameraController;\n}(event_manager_1.EventManager));\nexports.BasicCameraController = BasicCameraController;\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./basic-camera-controller\"));\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./base-event-managers\"));\n__export(require(\"./base-layers\"));\n__export(require(\"./instance-provider\"));\n__export(require(\"./primitives\"));\n__export(require(\"./surface\"));\n__export(require(\"./types\"));\n__export(require(\"./util\"));\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./voidgl\"));\n"],"sourceRoot":""}